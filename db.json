{"meta":{"version":1,"warehouse":"4.0.0"},"models":{"Asset":[{"_id":"themes/maupassant/source/css/copycode.scss","path":"css/copycode.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/copyright.scss","path":"css/copyright.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/default.css","path":"css/default.css","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/donate.css","path":"css/donate.css","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/jquery.fancybox.css","path":"css/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/search.scss","path":"css/search.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/css/style.scss","path":"css/style.scss","modified":0,"renderable":1},{"_id":"themes/maupassant/source/donate/index.html","path":"donate/index.html","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/AliPayQR.png","path":"img/AliPayQR.png","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/BTCQR.png","path":"img/BTCQR.png","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/WeChatQR.png","path":"img/WeChatQR.png","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/alipay.svg","path":"img/alipay.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/bitcoin.svg","path":"img/bitcoin.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/github.svg","path":"img/github.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/like.svg","path":"img/like.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/paypal.svg","path":"img/paypal.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/img/wechat.svg","path":"img/wechat.svg","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","path":"js/codeblock-resizer.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/copycode.js","path":"js/copycode.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/copyright.js","path":"js/copyright.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/donate.js","path":"js/donate.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/fancybox.js","path":"js/fancybox.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/gitment.browser.js","path":"js/gitment.browser.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/love.js","path":"js/love.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/search.js","path":"js/search.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/share.js","path":"js/share.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/smartresize.js","path":"js/smartresize.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/toggle_menu.js","path":"js/toggle_menu.js","modified":0,"renderable":1},{"_id":"themes/maupassant/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1},{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/favicon.ico","path":"favicon.ico","modified":0,"renderable":0},{"_id":"source/apple-touch-icon.png","path":"apple-touch-icon.png","modified":0,"renderable":0},{"_id":"source/robots.txt","path":"robots.txt","modified":0,"renderable":0}],"Cache":[{"_id":"source/CNAME","hash":"8e84eb65c9edda5062eb18d71a9cd8205d454d92","modified":1578214853941},{"_id":"source/404.md","hash":"65021f69f80ebd61a888cd2be9452e6aed3acab6","modified":1578214853941},{"_id":"source/robots.txt","hash":"44e1074a8c541de9864b4968c0e68c78b11c2cb5","modified":1578214854029},{"_id":"source/about/index.md","hash":"951bb6d159a290e39b8d274065261dc5dae26a44","modified":1578214854029},{"_id":"source/apple-touch-icon.png","hash":"7e2e56e1cb840e834fad069d8125f817a0dd9cbc","modified":1578214854029},{"_id":"source/favicon.ico","hash":"18e3bb1c4dff6529c9b54aa5d0a7401eb9127731","modified":1578214854029},{"_id":"source/_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it.md","hash":"e667ead582e6f9bcc9dd894e8a6bce2d35153cb3","modified":1578214853941},{"_id":"source/_posts/apc-undefined-symbol-pcre-exec-in-unknown-on-line-0.md","hash":"dd8e51f58ee66beb98accf79d2b46c3229dde411","modified":1578214853942},{"_id":"source/_posts/centos-64-upgrade-to-kernel-3x.md","hash":"ff4dda5628107f2e6a9ae9ed4728d5ed31ce282f","modified":1578214853942},{"_id":"source/_posts/change-idx-sub-order.md","hash":"1487df337b0e2c3747a928fa70c601ab4aab8dc9","modified":1578214853942},{"_id":"source/_posts/computing-cryptographic-hash-values-with-certutil.md","hash":"0a7a26d79501270b26835a6665eb78ea8d915648","modified":1578214853942},{"_id":"source/_posts/crm-contacts-and-accounts-are-not-showing-up-in-outlook.md","hash":"c521112d5593494623fad39249ee1df7e5ea8afe","modified":1578214853942},{"_id":"source/_posts/exception-from-hresult-0x800a03ec.md","hash":"568de4072422d425f5d68048318c2282cb2a8fd6","modified":1578214853946},{"_id":"source/_posts/deploying-hexo-on-github.md","hash":"3e10f9cb425bca11450bd07efa52c303dca6debc","modified":1578214853942},{"_id":"source/_posts/exchange-2010-best-practice-01-cas-array.md","hash":"2ec924f547e317e7b1214aaeec1e3b8bbc352509","modified":1578214853946},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser.md","hash":"466415e06c771426fee1a1e887c1337ca1a082f8","modified":1578214853943},{"_id":"source/_posts/exchange-2010-update-rollup-2.md","hash":"0fd15037b86ade0aeb0ee12cd9f57043af94378e","modified":1578214853946},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response.md","hash":"1965d541b5f2372119007bf0d9b6218d7f3a6791","modified":1578214853946},{"_id":"source/_posts/fix-java8-install-1603-error.md","hash":"322aef4b70c2758780a860859f4592e89e8783b1","modified":1578214853950},{"_id":"source/_posts/exchange-log-part1-basic-knowledge.md","hash":"b7c0dfc069440a78c437935753f6f701b2e0d967","modified":1578214853948},{"_id":"source/_posts/fix-vmware-esxi-40-vc-hardware-status-error.md","hash":"1bff74aa082c58712390f80896b70aee8d8abd05","modified":1578214853951},{"_id":"source/_posts/fix-wsus-slow-download-problem.md","hash":"6ca53bb6e5e6ea5480b0a1a262f7cde121f76afa","modified":1578214853951},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010.md","hash":"d7a4a05adde267445ffa1e2eb2f130154817596a","modified":1578214853951},{"_id":"source/_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware.md","hash":"17f31adf4c7e3438ec1a15a686a25d556eaaf229","modified":1578214853953},{"_id":"source/_posts/extending-lvm-root-partition-on-centos6-vm.md","hash":"a394a65d7d0391311cfa45cfe062ca34ffbb69ea","modified":1551951497330},{"_id":"source/_posts/hmc-40-update-rollup-3-has-been-updated.md","hash":"3cd294d7ba5fe2d2f71855bffc06be4537c6e0cb","modified":1578214853954},{"_id":"source/_posts/hmc-40-update-rollup-5-has-been-released.md","hash":"a5656b76fbd36e00ac92aeee2d29f01886f3b987","modified":1578214853954},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation.md","hash":"42f48c4e8f4b4abab703da6c59e9f7ed4e750e14","modified":1578214853955},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory.md","hash":"72472c9cc0a936bd0ae5b17fea8a232182b1d3d8","modified":1578214853954},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office.md","hash":"b060ecfd2fc5f50015abbbdbb75de48fad9cbd37","modified":1578214853955},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations.md","hash":"f788ae0f98b13570b5d48becabc938632336cb23","modified":1578214853955},{"_id":"source/_posts/hmc-45-is-out.md","hash":"ad994696a7c7d951523345949aff83961db1c1d5","modified":1578214853956},{"_id":"source/_posts/hmc-45-update-rollup-3-has-been-released.md","hash":"7ca11e3a2446ba4a1c532c3baf9a586c70d70e90","modified":1578214853956},{"_id":"source/_posts/hmc-45-update-rollup-5-has-been-released.md","hash":"9e9a734c8b35ba4265d3cc23b0d6ddcf4f31eb60","modified":1578214853956},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment.md","hash":"91047d6724b5a25cbc1090e02a00261ae6701df7","modified":1578214853956},{"_id":"source/_posts/hmc-45-rollup-1.md","hash":"f9b86b9a5182e071e947e16a0ad09b2637ca8626","modified":1578214853956},{"_id":"source/_posts/hmc-45-update-rollup-6-has-been-released.md","hash":"552364bd88f240ba948bcccd3c50607dafd141bb","modified":1578214853957},{"_id":"source/_posts/hmc-45-ur-2-has-been-released.md","hash":"c66bad8bfe1aa7042335d5f85b29eff723ebfd90","modified":1578214853957},{"_id":"source/_posts/how-to-add-send-on-behalf-permission-to-users-with-mps.md","hash":"6dc71c0f82aeadafc39a9931d3840f7c174c79e4","modified":1578214853957},{"_id":"source/_posts/hmc-resource-management-part2-hmc-resource-management-and-active-directory.md","hash":"a489ac2943b14421450466653338b2120e372d82","modified":1578214853957},{"_id":"source/_posts/how-to-build-geoip-database-from-maxmind-csv-format.md","hash":"688d1f04a8a7718a0626d57faceb247aafc883f9","modified":1578214853958},{"_id":"source/_posts/hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept.md","hash":"5b711781f70ccf130d21e6fb2c32941bb2c2a313","modified":1578214853957},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail.md","hash":"ce7aac0425a3bcb004fc3088a134e6610f656d4b","modified":1578214853958},{"_id":"source/_posts/how-to-extract-rpm-package-on-centos.md","hash":"51ef193d423c8100a82d9ffcaee0287bd72dd7bd","modified":1578214853967},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu.md","hash":"69e11f4d80070a1e1ace5ad05dcd7fad7451a9b2","modified":1578214853968},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying.md","hash":"e4aa9ec0f7b46fe2a1a2faae75111c12ae61eda2","modified":1578214853971},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors.md","hash":"bea726548f5bff2740410d5b49c3c997d41240bb","modified":1578415537589},{"_id":"source/_posts/how-to-fix-sql2008-ssrs-teradata-extension-load-error.md","hash":"a793833d893d50cb67f8760f697b50fa3d597ac0","modified":1578214853975},{"_id":"source/_posts/how-to-fix-wordpress-admin-blank-white-screen.md","hash":"17b67e2879c1ea35f6d4f4dc8c4160233d3d1097","modified":1578214853975},{"_id":"source/_posts/how-to-install-sql2005-on-win10.md","hash":"b45d1d17053f53d1b472bf782da4c006525977f8","modified":1578214853976},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password.md","hash":"16ca817fe288a7e46fbd942548bc6066df3696a6","modified":1578214853980},{"_id":"source/_posts/how-to-retrieve-computer-serial-number-from-command-line.md","hash":"76fd38356e8f07bcaae1be0757f701d7be4d4bd4","modified":1538208442212},{"_id":"source/_posts/how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully.md","hash":"6c6cb0211ddc9cb900dd6babd09a8d39c24f200a","modified":1578214853985},{"_id":"source/_posts/how-to-send-password-expiry-email-with-exchange-2010.md","hash":"2e6a64100e9b4a55d9b539a2c1954fe7a8f0715d","modified":1534837630676},{"_id":"source/_posts/how-to-turn-off-password-expiration-in-hmc-40.md","hash":"e675a47d4ad798a28d0c82a97718c62797c5d362","modified":1578214853994},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb.md","hash":"38ba545c6295453c6cc780dab897def2ca814a71","modified":1578214853986},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7.md","hash":"734a0123e10d31d9901db508f0a6e42572696d41","modified":1578214853994},{"_id":"source/_posts/hp-elitedesk-800-g3-dm-hackintosh.md","hash":"39c9a52d445f6c5595a49b073732642e24c0a7d8","modified":1549092321091},{"_id":"source/_posts/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi.md","hash":"009b4ba6507ab0ff12cf68f6399fa542fc45fc35","modified":1546423442679},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16.md","hash":"dbbf991981c3da674b0d1353715458b4e103d321","modified":1578214853999},{"_id":"source/_posts/install-microsoft-dynamics-crm-4-0-server-on-multiple-computers.md","hash":"729c8782e4ea7e572a62ef790b90c0a769113795","modified":1578214854004},{"_id":"source/_posts/installing-lighttpd-php5-mysql-on-centos-64.md","hash":"0fc9d1bb8562dff7fa1efca6d4d8dff950db64a9","modified":1578214854004},{"_id":"source/_posts/installing-mscrm-4-0-without-internet-access.md","hash":"63245d4c14e344df0410b9e15e475ece4b6ca3ad","modified":1578214854004},{"_id":"source/_posts/intel-nuc8i7beh-mod-hackintosh.md","hash":"626e11e8a84c3c1a5acbc6a043acc66eb63d9377","modified":1578412018592},{"_id":"source/_posts/installing-vmware-tools-on-centos.md","hash":"a4ba8406912fc1eea3e149f1236891c4b6abf967","modified":1578214854004},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016.md","hash":"6aa818c03671f3af00eab96c5961e0ab21298d37","modified":1578214854005},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost.md","hash":"08d7c158ee14bf71226687a9f2232db70c46bd21","modified":1578214854006},{"_id":"source/_posts/kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations.md","hash":"8855d77b4e3bb2d4040f36ca1bce30617e364e21","modified":1578214854007},{"_id":"source/_posts/movabletype-2-wordpress.md","hash":"98856a5ed6c811920867546559df2aa83b902992","modified":1578214854008},{"_id":"source/_posts/lync-server-2010-publish-topology-error.md","hash":"4e4a86844f7d6796d04f1b7c8662187f99ceb740","modified":1578214854007},{"_id":"source/_posts/move-to-hexo.md","hash":"bf3dfcd78687923bec06f8914670d8b5333fe3f5","modified":1578214854008},{"_id":"source/_posts/migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2.md","hash":"e8cda23e5725e360c6055cae99b2503356cf36d8","modified":1578214854008},{"_id":"source/_posts/mpf-service-account-error-in-deployment-tools.md","hash":"143233982812fb855d73ec252b4d984ebe1e012c","modified":1578214854008},{"_id":"source/_posts/mscrm-2011-beta-installation.md","hash":"43f4a6f75e748f21fd21f53dafa26a1ad3a762b8","modified":1578214854008},{"_id":"source/_posts/mscrm-40-email-router-404-notfound.md","hash":"75100502910c1252008e69d0c80a5ccc15a1f084","modified":1578214854019},{"_id":"source/_posts/multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released.md","hash":"03cae877a2f42cf6280b13571ab572d5eb3fbabf","modified":1578214854019},{"_id":"source/_posts/mscrm-contacts-and-accounts-are-not-showing-up-in-outlook.md","hash":"c8ca60852f979772d114e561e0229284415b3057","modified":1578214854019},{"_id":"source/_posts/packtpub-offer-free-learning.md","hash":"b51908a774dc767b4beff8701cb60669342338d4","modified":1578214854020},{"_id":"source/_posts/ocs-docs.md","hash":"6839c32197a85dd2a624cdde037c9c45cc03e856","modified":1578214854020},{"_id":"source/_posts/patches-for-hmc40.md","hash":"72139259203bec444b8b8db07b1fb56a9aca6a75","modified":1578214854021},{"_id":"source/_posts/problem-when-installing-ocs2007-r2-cu6-dotnet-40.md","hash":"72091e6abceb429ec1dda5c780a20748b72fc60a","modified":1578214854021},{"_id":"source/_posts/python-practice-1-ustc-online-course-downloader.md","hash":"1862285619d5abafd6e0f02413ee67f2702fd543","modified":1578214854021},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2.md","hash":"38eea665b1ac6081c20d58009460aa83287e60e8","modified":1578214854022},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1.md","hash":"de3a8a5b39f0205b5e2753fbe71bada4e5ba7e80","modified":1578214854022},{"_id":"source/_posts/sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45.md","hash":"b857360829b5e2c83c64b6c30a21c7af68e0a1a4","modified":1578214854023},{"_id":"source/_posts/reporting-service-cant-start-event-id-107.md","hash":"36f498beb14c853d3e72d2a2d6332727eeeb8ab7","modified":1578214854022},{"_id":"source/_posts/tencent-404-support-https-now.md","hash":"2179ddbfc4dfea9bfc6236f4a7e89ab1bf249979","modified":1578214854023},{"_id":"source/_posts/the-reportservervirtualdirectory-element-is-missing.md","hash":"8d6e7e0b5c7bcfe4ee07fe3cf578d5780e872468","modified":1578214854023},{"_id":"source/_posts/unofficial-consolidated-server-deployment-guide-for-hmc4.md","hash":"e5c0c0e0a492e8ab5b5f5476280f77200611e158","modified":1578214854024},{"_id":"source/_posts/upgrade-to-exchange-2010-sp1-issues.md","hash":"9bc619b4c49339745caa15f83e076e4b01ac33f9","modified":1578214854027},{"_id":"source/_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process.md","hash":"18ab36de9f282e7855ee9f018a6f8f6205692684","modified":1578214854023},{"_id":"source/_posts/virtual-server-undo-disks-merge-parent-disk-part-of-saved-state.md","hash":"205978425210c13fd2d9c461058398022c188193","modified":1578214854027},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment.md","hash":"aad98d55a5d370782f8597f85c0ef87858500267","modified":1546393218122},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7.md","hash":"2bc02b7f142b83db5c82ac1038e38868141fa8cd","modified":1578214854027},{"_id":"source/_posts/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip","hash":"32ba92bf220583bf0d7d01a3fb7c428e5a0de643","modified":1578214853942},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg","hash":"2e1d63669c41a2b53ec30b606da85f67e386f65a","modified":1578214853948},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg","hash":"98ede366e0a494534c78e79c933287078b58170b","modified":1578214853952},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg","hash":"38d4a4f630cab196b8de87bc7f4fbbeba694cbca","modified":1578214853953},{"_id":"source/_posts/fix-java8-install-1603-error/Java8_Error_1603.png","hash":"a638a3dce361673ae2c0a31bc170a44776a44b85","modified":1578214853951},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg","hash":"ac358406a7daeaa34a1ec661e1646fa71990c5ec","modified":1578214853949},{"_id":"source/_posts/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg","hash":"a593a5d877cf8e5359692406a0fe02678d89a85f","modified":1578214853958},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg","hash":"648558deb0ed837e94682f3a41fdc426926f09af","modified":1578214853950},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg","hash":"d78d4e4778cd156bad0d274dc648b2b247c4a52e","modified":1578214853959},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg","hash":"8595d4764df1e1b15267e4586d58a0f9b669d52d","modified":1578214853959},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg","hash":"55ed2fc2e33767195fe249ea2407b975b32b3927","modified":1578214853960},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg","hash":"859211ff7a3c54461a0090d03cbb0d30c2ad3509","modified":1578214853960},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg","hash":"858d8ef08c49e1caef82233f7b87e7994a8452d7","modified":1578214853961},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg","hash":"75cf1fdde35cf3a8a2bfa7a130176ba4d79598e4","modified":1578214853961},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg","hash":"20538dbcdb41bb69be5436b60a59896e034fe57e","modified":1578214853962},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg","hash":"5bdf0a299af2a9a1f43c75f0569de035666e6331","modified":1578214853962},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg","hash":"5ae81c5f5ca5a796fbe917c5f9eb3788581bdccb","modified":1578214853962},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg","hash":"c78ef1b656087a5e0a32a17d54db598cb32a3d2c","modified":1578214853964},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg","hash":"75eeafd0f39f294eb0116939a672c677af5a360b","modified":1578214853965},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg","hash":"b1741993cb42f50cce78d0564148604c19440635","modified":1578214853965},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg","hash":"3fd96f713a284a6ed534c2832db0300eae1827f7","modified":1578214853965},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg","hash":"c4b18811567a23e30d57169471fdbe6bb8350897","modified":1578214853971},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg","hash":"202fda4f84459ff11730e8380849e70dc520214c","modified":1578214853967},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg","hash":"390e2ee3337ef6ee33c3b714436c3bed8a05948c","modified":1578214853967},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg","hash":"493704a580e8581a7cce3864a012767fdc601541","modified":1578214853972},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg","hash":"e0a10966fbdcadd0bff3baf8bb4597f8232dfe63","modified":1578214853973},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg","hash":"89692ca9c84483e3b24d308448c60515d3b92ef5","modified":1578214853973},{"_id":"source/_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg","hash":"8d03e220365b0f24f9430ca668b3fb261543f831","modified":1578214853954},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg","hash":"afa20288a39ca20f600003539ce34d0dd040988f","modified":1578214853979},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg","hash":"6e5a3bee5a9cd59c48f21a460794f43c527cfd02","modified":1578214853968},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg","hash":"3f9197d13a513f7319a074f0dc669ac36351f0d2","modified":1578214853970},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg","hash":"23cc29c549063744cfd9e92856f60fd323480bf7","modified":1578214853980},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg","hash":"64ac53f6ef4df3689db210ed9ed6c5db20688242","modified":1578214853971},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg","hash":"df2cc38f2833462d3489d2984563d6a6538fa3a5","modified":1578214853981},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg","hash":"f83f1d906285ec094743444391e8b7d8c433161c","modified":1578214853981},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg","hash":"8ad97be76143335c5d6157758c8cef0f7fadb75e","modified":1578214853983},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg","hash":"60f0afae55d521d8fcc84ae60d830ddad193e958","modified":1578214853983},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg","hash":"1d0066fb8669572f7e4b54a08e884f8f356fe085","modified":1578214853984},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg","hash":"d28b576656247bb6bb878fc5280a8c7e04934459","modified":1578214853984},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_9.jpg","hash":"b22d8b214bdf35bc085797166c1c6538f4374f03","modified":1578214853985},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie11-eupp-registry.zip","hash":"5483d8766f28af75b398f93764bc93813f37f68f","modified":1578214853993},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png","hash":"02161d62941bc34d1890171d866cd6d46907e74c","modified":1578412281000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg","hash":"81275626ff835875883d2094048249417b11e455","modified":1578214853994},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg","hash":"a2062bdd9a8582f012fd4790d730f1620d809ce8","modified":1578214853994},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg","hash":"d40f89bbb714eb6ec06a98ffab4d01a3bf20a46a","modified":1578214853995},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg","hash":"9276c435282bd997ed348b2c41254e975900a9a8","modified":1578214853995},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg","hash":"9283b5f07a5cbf626922fae3e5a7580a23bc442e","modified":1578214853995},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg","hash":"4884407c4ef6f2347012b3174fb7421eb5e29f26","modified":1578214853996},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg","hash":"2df7b30c8f7fe6b3406ee3c764f70e9202160e38","modified":1578214853996},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg","hash":"9d67a3752f6b4e2459e64ef3287f7727eee0ad0a","modified":1578214853997},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg","hash":"fa767532e1cbbe482d0895f431f5067150c418bc","modified":1578214853997},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg","hash":"3459567d2c74f8a52102e10c2702e619678cdea2","modified":1578214853997},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg","hash":"a9f93734136b5a8ad89d96d67a22c19f909504ea","modified":1578214853998},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg","hash":"e0d13719bf978de2e640edfcd21b5d8d07fdc56c","modified":1578214853998},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg","hash":"f58f2a546b2e3ea7c9593719d90d4ca3f10758b3","modified":1578214853998},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg","hash":"420389f63f08a89f17ee0dc73e826655ace6e449","modified":1578214853998},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/apt-update-docker.jpg","hash":"6b9948bff43d58745b53931ee7ec031a4f782fad","modified":1578214854001},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/apt-update.jpg","hash":"fb9905a53c786928fba06607521b175d49a36eee","modified":1578214854001},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg","hash":"5c359cb345c1ab770cb38f226e9d96caabbb880e","modified":1578214854001},{"_id":"source/_posts/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg","hash":"e58996348b7c0c58169f6fa56d70e268927a5e26","modified":1545982071344},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/docker-permission.jpg","hash":"4fcc1b00b4e76857e64dfc7ec01bbfe2ae83963e","modified":1578214854003},{"_id":"source/_posts/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg","hash":"8675c8aa274da07351254817a88c4c82d8eeaa01","modified":1545981913803},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg","hash":"f812ec8964b35fa67dec7421d03f53f8c6c516b2","modified":1578214854003},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg","hash":"8d31428125b3a0d69cc5f5de115dedc00e12282a","modified":1578214854005},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg","hash":"0f19fa1b05ccb15a31456b0c6a5db087f6b33f8c","modified":1578214854005},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg","hash":"0067e21cdaeec747cca6aac1957106d920f20b74","modified":1578214854007},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg","hash":"f26e8d506a08b96c76d2a644fe27b926f17d572f","modified":1578214854007},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg","hash":"7d65bcde1c532ecf174b81c56a2c31a3d02e63d5","modified":1578214854022},{"_id":"source/_posts/packtpub-offer-free-learning/packtpub-eBook-2.jpg","hash":"8ed66f5df6e34dcefd86d078ad2d9e0bda845934","modified":1578214854021},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_0.jpg","hash":"d880a6432c3811f70aeb08423dfa22614b3553a9","modified":1578214854009},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_1.jpg","hash":"5868fccc2e155dd30b5fc91c687ef21b7fdb1420","modified":1578214854009},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_10.jpg","hash":"71c77937a593e26759fd466fa48d7d9cc1577423","modified":1578214854010},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_11.jpg","hash":"b855d4d4387d2ae1e6d1d02232e6d5f046fb83a6","modified":1578214854010},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_12.jpg","hash":"44c12c2af1f813ab83e85499607c16bc391f310e","modified":1578214854011},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_13.jpg","hash":"a3067f3c4f0e4302d410fcd7bbb88cd76ffc8e86","modified":1578214854011},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_15.jpg","hash":"940f335fb2908d6f3b14e8485d9a4c0a4b75e89d","modified":1578214854012},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_17.jpg","hash":"bc28aa38103d1b362f5d1c4abaab59dee347c7bb","modified":1578214854013},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_16.jpg","hash":"e17cd76bbded50be1bdcae0b30ea3b4e7c0c4949","modified":1578214854013},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_19.jpg","hash":"e338972ab9c3bf0f1f3b50a26b578e026ee823ad","modified":1578214854014},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_20.jpg","hash":"e8096c3dcef7feb9540e13ae0b32fbac985d8de7","modified":1578214854016},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_4.jpg","hash":"3457f6b7698a8909da940f134ab1043f868240c3","modified":1578214854017},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_5.jpg","hash":"d3ac2bdc0876bbaf7c8df02d6f4cf7c00334101d","modified":1578214854017},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_6.jpg","hash":"dfe19c4e9b526ad4b995a0c6434da46275418e3b","modified":1578214854018},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_7.jpg","hash":"1ebb95f895838cca8c477f5faf9829e027f912c4","modified":1578214854018},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_8.jpg","hash":"fb1d5ac70d690c5b70f6ed22d252f862d4a65c49","modified":1578214854018},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_9.jpg","hash":"bd493c0bed44e914005417209d080803c6dcd189","modified":1578214854019},{"_id":"source/_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg","hash":"f56a89eda146641d225f2298b6442759be2a2d69","modified":1578214854024},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg","hash":"1574401fef18374f7247f2cc9e3b744be62d4945","modified":1578214854028},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg","hash":"247f0d0a593cefc3ee70a2ce4222d63f3dbb4be7","modified":1578214854029},{"_id":"source/_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg","hash":"1fa0b4f68b4c4cdecc6a2c957897072efb996a7c","modified":1578214853942},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg","hash":"5556c4d7b1e744308c2005cd96902b686a1b0f5b","modified":1578214853943},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg","hash":"11fc5cd8a3cc6b030a44f2f91662e3cd9fe5f174","modified":1578214853947},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg","hash":"b9127c997b2a3fbe5af3d567a963fb1622497853","modified":1578214853948},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg","hash":"ed7100cbbd8a5410dfc276943e2b0f3a8290dfe3","modified":1578214853952},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg","hash":"6e684cb2b60c1c18350368f0fb8160ae5d7fc0f6","modified":1578214853950},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg","hash":"b214a67ff9b85bf6926b2f2dde6288c6fb31c768","modified":1578214853963},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg","hash":"065cc2c737e72df36f02f6d6fe1621a8c30decfc","modified":1578214853964},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg","hash":"4d271b10f323eb58a1705c61a3c6ffeaddc095a4","modified":1578214853966},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg","hash":"7d2d985c36f747f9a14b2a7bf6acf6c5e90b5845","modified":1578214853975},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg","hash":"4ab8389d0931109788a538b2a785e48699b18260","modified":1578214853978},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg","hash":"43e768fbb62fb672a5df3e64344521803d75b1ea","modified":1578214853977},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg","hash":"af1c044b8ab90746d8c4a6bce9038bfb96fe39ef","modified":1578214853977},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg","hash":"b90ee5c089ff785133db3bc72014280104a24763","modified":1578214853979},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg","hash":"c61006f9c116bdfc6eed68181782478643084158","modified":1578214853982},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg","hash":"10ef5e40876f1bad3666efe785a1b0d5c8012496","modified":1578214854002},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg","hash":"316b0d368d9c86ebc64493e14b2cd0b3afe91a02","modified":1578214854006},{"_id":"source/_posts/packtpub-offer-free-learning/packtpub-eBook-1.jpg","hash":"7e8f359eebcd3daf7781debef2f452562aac9c7f","modified":1578214854020},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_14.jpg","hash":"8f53e5482f9679b542a6d111f4dd2671d5c1616e","modified":1578214854012},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_18.jpg","hash":"cec7b294319925e755e57f605f3fd7eaf4bdd111","modified":1578214854014},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_2.jpg","hash":"f5f0f7d94f7536c687cdf3c7b2077784d1d4c3ac","modified":1578214854015},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_3.jpg","hash":"eca6231c7c9019a81d4ffa3047e4c4eb08cc9d6e","modified":1578214854016},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg","hash":"63b1fe61c8207fc0dde83b79c6e4d5b5a06063bc","modified":1578214854028},{"_id":"themes/maupassant/LICENSE","hash":"dde2fd301d984b142989c2b208b5b360602f64cb","modified":1521436934000},{"_id":"themes/maupassant/README.md","hash":"a3dcfa9b646980ee5811ec03b4c5786618b85ff9","modified":1533880582000},{"_id":"themes/maupassant/package.json","hash":"f092433469eb87362e831326425a6a5c3c9fea0d","modified":1521466516000},{"_id":"themes/maupassant/_config.yml","hash":"8b0b8ee7e855392de364bb5a3f2a2a17fa9ed93b","modified":1648994542090},{"_id":"themes/maupassant/.gitignore","hash":"2da79b8fb11dea4b2bee6e0078415eacce8fddf2","modified":1521436934000},{"_id":"themes/maupassant/layout/archive.pug","hash":"6fa3bb9c1bda67efb62217f200e2e0a36d638645","modified":1648992093000},{"_id":"themes/maupassant/.travis.yml","hash":"6266b8281f0cf7a8764b0b62621ce9a3ab78ac27","modified":1521436934000},{"_id":"themes/maupassant/layout/index.pug","hash":"f61a97536314b29ec75ff621da36c58edd3736b7","modified":1648993609607},{"_id":"themes/maupassant/layout/base.pug","hash":"f273456f5dfe4c755d20c610b22956bebe405f0f","modified":1521503579032},{"_id":"themes/maupassant/layout/page.pug","hash":"8eadfbc53764a03eebae9747bf137f588e02bf80","modified":1648991748000},{"_id":"themes/maupassant/layout/post.pug","hash":"1d0d75aa83a973ee93400ea9960d41db7d910b8c","modified":1648992140000},{"_id":"themes/maupassant/layout/base-without-sidebar.pug","hash":"584fe2c81ea0aceb657f221013249551102999d5","modified":1648991667000},{"_id":"themes/maupassant/layout/single-column.pug","hash":"0593f261dc208bb0b5c4232eb41eff597a291bd9","modified":1521467184000},{"_id":"themes/maupassant/layout/tagcloud.pug","hash":"bbb51f5a863873f24f40ac3499f15a48bfa6112b","modified":1648633257000},{"_id":"themes/maupassant/layout/timeline.pug","hash":"b111e07430d5eada1f275cad0b5a5eb096fc8ade","modified":1648992164000},{"_id":"themes/maupassant/languages/en.yml","hash":"c3fb5c155560a00889a75882c680afe1197ebf1a","modified":1526210824000},{"_id":"themes/maupassant/languages/fr-FR.yml","hash":"b47906ec0abf867fb3e3360bc046b7afb68aee25","modified":1526210824000},{"_id":"themes/maupassant/languages/de-DE.yml","hash":"5d3556a885e355a8c2da65ef3e7b3ee36a628bfa","modified":1526210824000},{"_id":"themes/maupassant/languages/ru.yml","hash":"2476a631f4d3c668de04af85a6c2c97ba2a57e96","modified":1526210824000},{"_id":"themes/maupassant/languages/es-ES.yml","hash":"58e1d04bcd1834fa9d2960e18e027abbbccbedc9","modified":1526210824000},{"_id":"themes/maupassant/languages/ko.yml","hash":"909a33e0befa6978e8e72157c6b415b48551ee31","modified":1526210824000},{"_id":"themes/maupassant/layout/_partial/after_footer.pug","hash":"f3574f195d04f520ad9695b71a4d76c2894c797b","modified":1648990628000},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg","hash":"d91f8da8efa5a7958511b2307bf84ea04f780f46","modified":1541741211509},{"_id":"themes/maupassant/languages/zh-CN.yml","hash":"413f57a7893c9f1a5cb7b3c14c7bf8c3f83d2403","modified":1648990530000},{"_id":"themes/maupassant/languages/zh-TW.yml","hash":"e9747f9b3ec1314a3cae44a9a90e7649af739633","modified":1648990576000},{"_id":"themes/maupassant/layout/_partial/comments.pug","hash":"c47c9c787c711d08326ba1929b96cc43a16b608f","modified":1648995039839},{"_id":"themes/maupassant/layout/_partial/darkmode.pug","hash":"82567449d68025cc7fee5259d4769f5ee015aa26","modified":1648633257000},{"_id":"themes/maupassant/layout/_partial/helpers.pug","hash":"acdf9e2d52ee86c831fa15ce1570930c5779bc78","modified":1533880837000},{"_id":"themes/maupassant/layout/_partial/head.pug","hash":"1489a493d2cc04923f860009a073c57a89f15da3","modified":1648991461711},{"_id":"themes/maupassant/layout/_partial/footer.pug","hash":"ef47c714ffad899d1dc7f71cb96b787400f94741","modified":1648980010070},{"_id":"themes/maupassant/layout/_partial/mathjax.pug","hash":"b54b56faff9e47ab3ca3cdd55056c73e60776f3c","modified":1648991504000},{"_id":"themes/maupassant/layout/_partial/mathjax2.pug","hash":"d6ac5dc4e9c7a1b866f1f92d88988cfb35aded4c","modified":1648991496000},{"_id":"themes/maupassant/layout/_partial/totop.pug","hash":"8225bbc3cdb9648bc2e6872e5c616a9a1e4def4f","modified":1521436934000},{"_id":"themes/maupassant/layout/_partial/tag.pug","hash":"cff69108d67333d3dfcdc2d6d7c91c4d2a46cfc4","modified":1648991515000},{"_id":"themes/maupassant/layout/_partial/post_nav.pug","hash":"a2d698c84bb6da08195fe870dbd7215f65388d3f","modified":1521436934000},{"_id":"themes/maupassant/layout/_partial/paginator.pug","hash":"53f9cb77448e84a98da5eb688e2e12b173c555bb","modified":1521436934000},{"_id":"themes/maupassant/layout/_partial/wordcount.pug","hash":"7dde69ef8f86745b83ba5f03c75717a782752f2b","modified":1648991555000},{"_id":"themes/maupassant/layout/_partial/toggle_menu.pug","hash":"1f4621ef1c1f46c096ad7f2d4219c87707baccda","modified":1521504454806},{"_id":"themes/maupassant/layout/_widget/donate.pug","hash":"859eddafd2762072bc5af850038ff377578b0ce4","modified":1648633257000},{"_id":"themes/maupassant/layout/_widget/hit_counter.pug","hash":"d69f2a14d7d6327035a292bcd494d1f9db84e3b1","modified":1521440739077},{"_id":"themes/maupassant/layout/_widget/copyright.pug","hash":"17e68ea3e87f128819d16ec30cd506a51fe80a7f","modified":1648633257000},{"_id":"themes/maupassant/layout/_widget/category.pug","hash":"7c6aed762934ca51aa2669b886254da24b77bc14","modified":1521436934000},{"_id":"themes/maupassant/layout/_widget/links.pug","hash":"3f6048423887f359bb97d17621e961495d209a7c","modified":1648992015000},{"_id":"themes/maupassant/layout/_widget/recent_comments.pug","hash":"3b364ea62f2851acf1fae7713a9f51c36311931a","modified":1648992023000},{"_id":"themes/maupassant/layout/_widget/tag.pug","hash":"9b73975ac67b471ae91803b8477932d2c5e5a4f2","modified":1648992074000},{"_id":"themes/maupassant/source/css/copycode.scss","hash":"e2463b8dacf629e180a1b6cd80667ca8044292eb","modified":1648633257000},{"_id":"themes/maupassant/layout/_widget/search.pug","hash":"a141293ce93b312f4db9f28207d02ee578ede359","modified":1648992068000},{"_id":"themes/maupassant/layout/_widget/recent_posts.pug","hash":"5a86fcd97933c665b5afef701d8b30cfd2952691","modified":1648992055000},{"_id":"themes/maupassant/source/css/jquery.fancybox.css","hash":"f42f761157f26244673eb2f4a9215c70956f80dc","modified":1521436934000},{"_id":"themes/maupassant/source/css/copyright.scss","hash":"a418da11a88d1feb14500df42ed97a64da6a7611","modified":1648633257000},{"_id":"themes/maupassant/source/css/default.css","hash":"7fbb18b73b44ed11193739c55fce53a6f173cf68","modified":1521349524000},{"_id":"themes/maupassant/source/css/search.scss","hash":"9406e138d7bb6a9ef4a067eba1dafa627519c8a7","modified":1648633257000},{"_id":"themes/maupassant/source/css/donate.css","hash":"d0079ba8202d925a93ab1cb44f2087b81f476755","modified":1521436934000},{"_id":"themes/maupassant/source/css/style.scss","hash":"105ff960493741588867edea4ea1350623464067","modified":1648992821000},{"_id":"themes/maupassant/source/img/WeChatQR.png","hash":"8c41aca7883e5ff714c56556f5fff8e7e7c38093","modified":1521349524000},{"_id":"themes/maupassant/source/img/AliPayQR.png","hash":"7787b5d91cbf0e19a1260df24f7d949771c7d45b","modified":1521349524000},{"_id":"themes/maupassant/source/img/BTCQR.png","hash":"7d1c80f953bfb6f0a37d432b04c936ea165bfd97","modified":1521349524000},{"_id":"themes/maupassant/source/donate/index.html","hash":"bd5cbe475b7bce89a8c96375c56c8e3e188d6afc","modified":1533881225000},{"_id":"themes/maupassant/source/img/paypal.svg","hash":"92f3bc495f20a0190d3041be03345c46d6238c25","modified":1521349524000},{"_id":"themes/maupassant/source/img/alipay.svg","hash":"46cc0552a9f6d700d618db3fcad25e1b8e697e36","modified":1521349524000},{"_id":"themes/maupassant/source/img/bitcoin.svg","hash":"635f7cca5e675d192be2717788175c7a2146013a","modified":1521349524000},{"_id":"themes/maupassant/source/img/github.svg","hash":"277798d16cb6106e45ef74f6b9972011fa43401b","modified":1648992862000},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","hash":"5d0b786d60bf225d9eabcc9cece2719ff4d9b6cd","modified":1521436934000},{"_id":"themes/maupassant/source/img/wechat.svg","hash":"330496ad42446a29f37a2b97fc388ebd77a8cb9f","modified":1521349524000},{"_id":"themes/maupassant/source/js/copycode.js","hash":"fde1f153bab1f00ae8930668094c00aa9ff3c7a3","modified":1648633257000},{"_id":"themes/maupassant/source/img/like.svg","hash":"e6e4bd1af076be9358316cac89efdc22ef4a5064","modified":1648992869000},{"_id":"themes/maupassant/source/js/copyright.js","hash":"7b1bd775ea22abf33d57f78628f436bf656e439a","modified":1648633257000},{"_id":"themes/maupassant/source/js/fancybox.js","hash":"13c4781570339f4fba76a3d7f202e442817dd605","modified":1521436934000},{"_id":"themes/maupassant/source/js/donate.js","hash":"6f0e2bbf4e2221b185727993e2e544acb044f953","modified":1648992942000},{"_id":"themes/maupassant/source/js/toggle_menu.js","hash":"b7202fe35eae823e75f1772e3ac3a20f6390f667","modified":1521436934000},{"_id":"themes/maupassant/source/js/love.js","hash":"5cf89f622bf891cf1986845eb92eadef6f358eb7","modified":1648633257000},{"_id":"themes/maupassant/source/js/smartresize.js","hash":"3ef157fd877167e3290f42c67a624ea375a46c24","modified":1521436934000},{"_id":"themes/maupassant/source/js/search.js","hash":"d3609497b54a27de56c747856cb74b8c39eceeda","modified":1648993044000},{"_id":"themes/maupassant/source/js/share.js","hash":"a2f9de374523dc7f2ddb90ed5f24b668c20d9272","modified":1521467316000},{"_id":"themes/maupassant/source/js/totop.js","hash":"7dbf8fcf582a4fb6eb9b2c60d6de9f9c2091ec4c","modified":1521436934000},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg","hash":"adee013d8d668683c4bf73c19e2cc16af3e6158f","modified":1578214853945},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg","hash":"f2faae14d65527104d037df1b010fdb77168ce88","modified":1578214853945},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif","hash":"d63852b98ea45f6b4b5a65112a05506d18ccc501","modified":1578214853970},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg","hash":"9da094aa3c108ac2d5cf1b40d0e8114d971c2dd5","modified":1578214853987},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg","hash":"f291456a8a0e1c8a45f5eb1c345eadb04f48f7c8","modified":1578214854000},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/dhcputil.zip","hash":"b7bcebec04bede62917c45adc896e9c540e8f48b","modified":1541439678630},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg","hash":"c4f707ecd6539939b4f44bb1433d270c780b9752","modified":1578214853974},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg","hash":"72b51d470bc831e5cbba13654cc6cfd8b0a85b7f","modified":1578214853992},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg","hash":"5d0f1bd6dae34f18f8bd14d217374f7d3601d913","modified":1578214853993},{"_id":"themes/maupassant/source/js/gitment.browser.js","hash":"376446d9c5930576016f97dd63e5e6616c94d8d4","modified":1521436934000},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png","hash":"51f74ba6c597310adda8e407a2b73966c8ac564c","modified":1578116134000},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png","hash":"9e95b776e6ce27b39e58a0b2b0cccc5024101b0d","modified":1578116294000},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg","hash":"3275ee031e1ac4dd6031a7161274059fc5871c72","modified":1578214853990},{"_id":"source/_posts/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf","hash":"92cc9753001ff66e14d155ec3f7f4133244cce51","modified":1578214854027},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/msvcr110.zip","hash":"bcbe6f0713033bbbedecd42f123f33b8d433f053","modified":1541746970273},{"_id":"public/404.html","hash":"73e81beb0e6f46407c338850174fd4b2044147c2","modified":1649005210590},{"_id":"public/atom.xml","hash":"d06eebad09c1ed74707685233714360ab51f5501","modified":1649005210590},{"_id":"public/sitemap.xml","hash":"fdabfd57ae26b2fc895b758fda199c9ebc2b048a","modified":1649005210590},{"_id":"public/about/index.html","hash":"05a374e3f4a34ebd39a968142ef479ad83821494","modified":1649005210590},{"_id":"public/intel-nuc8i7beh-mod-hackintosh/index.html","hash":"047eb61e27a8472edabf9eff163340c8733377bc","modified":1649005210590},{"_id":"public/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/index.html","hash":"5b054c1d7d7c7873cc8ae4f2aca1d3ced6fdf829","modified":1649005210590},{"_id":"public/extending-lvm-root-partition-on-centos6-vm/index.html","hash":"931d29fcd61430106381168c1d2bec6f4a56555a","modified":1649005210590},{"_id":"public/hp-elitedesk-800-g3-dm-hackintosh/index.html","hash":"c6dae43fbdb05cf96c7cc095b929908139e83cff","modified":1649005210590},{"_id":"public/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/index.html","hash":"50795622e7a00c7c05fcc23108deb1f4b1f98953","modified":1649005210590},{"_id":"public/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/index.html","hash":"cc5010eaf0702a6fe86f1cb0ca0ff252478cd63b","modified":1649005210590},{"_id":"public/how-to-retrieve-computer-serial-number-from-command-line/index.html","hash":"ae826a86938174a9128d7b795b8de33322c626ae","modified":1649005210590},{"_id":"public/how-to-send-password-expiry-email-with-exchange-2010/index.html","hash":"f57b86dc9edbf7dd4c0efbe8a6e4ccd970fe525c","modified":1649005210590},{"_id":"public/tencent-404-support-https-now/index.html","hash":"5adc929e4a9f047dabaa558e4b39e34cb9b97ece","modified":1649005210590},{"_id":"public/computing-cryptographic-hash-values-with-certutil/index.html","hash":"9c407941737e4f090ba3e367a38b7caf9ab5346e","modified":1649005210590},{"_id":"public/easily-reveal-hidden-passwords-in-any-browser/index.html","hash":"7dd08f9956767237b7bc30ccdc4509d3cf010056","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/index.html","hash":"4914e73aa1cd34fdc550a5fb1c5da1588f7f75fe","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/index.html","hash":"a5fda181e5864cee1a9bb224de2991f2d33e19dd","modified":1649005210590},{"_id":"public/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/index.html","hash":"52fbaea021aac5ec8f44b1b7cf65ef8dc706840d","modified":1649005210590},{"_id":"public/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/index.html","hash":"1ca06ef1259fedacb08be54c6c2ef8a171e2dd49","modified":1649005210590},{"_id":"public/packtpub-offer-free-learning/index.html","hash":"15ae75a6f2bbfb9bed3f6f0feca1591b6283bc32","modified":1649005210590},{"_id":"public/python-practice-1-ustc-online-course-downloader/index.html","hash":"4ac1513f371beef88b8afe73a150f19c83240a84","modified":1649005210590},{"_id":"public/deploying-hexo-on-github/index.html","hash":"04dc6a18735a8f50af9b04f95561018bb0e2d90a","modified":1649005210590},{"_id":"public/move-to-hexo/index.html","hash":"0ede59d3628e54a6e31cd9979004aee7a8dcbd04","modified":1649005210590},{"_id":"public/how-to-install-sql2005-on-win10/index.html","hash":"ce12257807ff71ce70d4a962c547a706e4a2e784","modified":1649005210590},{"_id":"public/how-to-build-geoip-database-from-maxmind-csv-format/index.html","hash":"d3a932bd157b4403f1b6d3f6faa1168290dd6fd0","modified":1649005210590},{"_id":"public/fix-java8-install-1603-error/index.html","hash":"e067b2ac56d7ddcdeadf0a45c69bcf44acd56e2b","modified":1649005210590},{"_id":"public/fix-wsus-slow-download-problem/index.html","hash":"20a77c11c551561f64cf325e6ef1e74a64bdae01","modified":1649005210590},{"_id":"public/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/index.html","hash":"fa28a9bf7af31b0e1af450c0469ebb115ad77bd2","modified":1649005210590},{"_id":"public/kb289949-items-place-outlook-today-seem-lost/index.html","hash":"dfc8fcf9ad7dfc55c3e48d8de5169e46e1adbe9e","modified":1649005210590},{"_id":"public/exchange-2010-best-practice-01-cas-array/index.html","hash":"45257b6aab2262b609a59aafa906fa26aad6ec8a","modified":1649005210590},{"_id":"public/migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2/index.html","hash":"09b523b6afedabc909634ac796250b697b51f323","modified":1649005210590},{"_id":"public/active-directory-tips-01-extend-password-expiration-date-not-changing-it/index.html","hash":"ced9fff8198409d8a4db8aafec0266370eda995e","modified":1649005210590},{"_id":"public/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2/index.html","hash":"f8d6a1405d0402ca64b87f9d20cf51e432847174","modified":1649005210590},{"_id":"public/exchange-activesync-returned-an-http-500-response/index.html","hash":"3f869bf5977fe98612d4d1aeae1e8059c5af542e","modified":1649005210590},{"_id":"public/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/index.html","hash":"89dace265664ebb7084edebc058383defbeac2a0","modified":1649005210590},{"_id":"public/apc-undefined-symbol-pcre-exec-in-unknown-on-line-0/index.html","hash":"6984408f74e52413d149af3a4a091d70bf512c72","modified":1649005210590},{"_id":"public/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/index.html","hash":"d80ba77731b4c1d7d1811cff3485cfff7fbbd046","modified":1649005210590},{"_id":"public/how-to-extract-rpm-package-on-centos/index.html","hash":"e91691fed31f0439d70d92590026accf57eb45bf","modified":1649005210590},{"_id":"public/installing-lighttpd-php5-mysql-on-centos-64/index.html","hash":"a6043e96132aaae4c5fa5eb0dcddb8c73539cfc3","modified":1649005210590},{"_id":"public/installing-vmware-tools-on-centos/index.html","hash":"5aed002ee1a3fd1e874e00c2b27f3571eb5bcad8","modified":1649005210590},{"_id":"public/centos-64-upgrade-to-kernel-3x/index.html","hash":"467fa9f1500d908f5d436c7bb488c195eae8d30b","modified":1649005210590},{"_id":"public/how-to-fix-wordpress-admin-blank-white-screen/index.html","hash":"02042c6c3d6dad7bd43a6edbf7ce2bf668647321","modified":1649005210590},{"_id":"public/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/index.html","hash":"0fa1273df6a54fe2a09ea888f447e0a3af0784b3","modified":1649005210590},{"_id":"public/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/index.html","hash":"d8b68b41063c8fe3af73ebc6322c1a62fe1df258","modified":1649005210590},{"_id":"public/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/index.html","hash":"1dbe3720c67deb24db239e951bf5e8b4619306ed","modified":1649005210590},{"_id":"public/movabletype-2-wordpress/index.html","hash":"14527a9386224a6c444cd320857933067ccbf285","modified":1649005210590},{"_id":"public/multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released/index.html","hash":"ceed9866bc7be3388c7d9678d7cb0c8eb00952f9","modified":1649005210590},{"_id":"public/exchange-log-part1-basic-knowledge/index.html","hash":"7a5df1c05c8f22e3eac83d595707aed91e28f797","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/index.html","hash":"0dc6fe5f34cc1d1ac0fb42a0ddedebdc67f80f01","modified":1649005210590},{"_id":"public/lync-server-2010-publish-topology-error/index.html","hash":"3c01c3f2eed6c4fcd24a2d1f44f62d7c48609233","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/index.html","hash":"a055d960112a92c29b0a8387c19d2b09830f01c2","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/index.html","hash":"510f734798364fb674ac9e2986e7fe87a40a57e8","modified":1649005210590},{"_id":"public/upgrade-to-exchange-2010-sp1-issues/index.html","hash":"7cd7a85f3db98d4f9eaf4007c3672e87cc4a1770","modified":1649005210590},{"_id":"public/problem-when-installing-ocs2007-r2-cu6-dotnet-40/index.html","hash":"61863855e4b12989d9e59da4d1d04c87ba32754d","modified":1649005210590},{"_id":"public/how-to-fix-sql2008-ssrs-teradata-extension-load-error/index.html","hash":"96b8109dcc4c047538df3231ceffcc4ab2037c87","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/index.html","hash":"d812888b581819f2bb263a48e31f42f2f4eb61c5","modified":1649005210590},{"_id":"public/fix-vmware-esxi-40-vc-hardware-status-error/index.html","hash":"2fec5bc62c7a0f50c26a26d9f20f4acac49faae3","modified":1649005210590},{"_id":"public/how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully/index.html","hash":"f199bb47c0ffaba06e0f89b47d1d38a8842ed3e8","modified":1649005210590},{"_id":"public/exchange-2010-update-rollup-2/index.html","hash":"40536ca531e09b501eab92a6180788cb6bc4f124","modified":1649005210590},{"_id":"public/hmc-40-update-rollup-3-has-been-updated/index.html","hash":"b1165bb1a3ec810b35eee28ffa21bac3a475d7af","modified":1649005210590},{"_id":"public/hmc-45-update-rollup-6-has-been-released/index.html","hash":"c8855af308790bafa3cf0932c07269be0d8a4499","modified":1649005210590},{"_id":"public/hmc-45-update-rollup-5-has-been-released/index.html","hash":"c70cce179207c8fab6ad5e777e4706e84ee4e962","modified":1649005210590},{"_id":"public/reporting-service-cant-start-event-id-107/index.html","hash":"f77e73e88ba22c27ad1422ee8d35932ec20cf6a3","modified":1649005210590},{"_id":"public/hmc-resource-management-part2-hmc-resource-management-and-active-directory/index.html","hash":"c361062c36007f5e2050b920b409b2b8a58ea9b1","modified":1649005210590},{"_id":"public/hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept/index.html","hash":"666970ced67c47aa17a790c69593d51e920ec3ac","modified":1649005210590},{"_id":"public/kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations/index.html","hash":"f544d700ee2123d7a1646d3ab59f48e6c1f835a9","modified":1649005210590},{"_id":"public/mscrm-40-email-router-404-notfound/index.html","hash":"e1208a0382fcb9bd5f35bfea28d21f60194d29f8","modified":1649005210590},{"_id":"public/exception-from-hresult-0x800a03ec/index.html","hash":"7f620a77cf9b8e97ce80a98d8ae61fa7d3da67bf","modified":1649005210590},{"_id":"public/the-reportservervirtualdirectory-element-is-missing/index.html","hash":"d010d8b75079817f0e032eae7d5300045b7aa325","modified":1649005210590},{"_id":"public/hmc-45-update-rollup-3-has-been-released/index.html","hash":"730da65553ba64352637c9e2a72cfcf0cd62f90e","modified":1649005210590},{"_id":"public/hmc-40-update-rollup-5-has-been-released/index.html","hash":"45cc7d81d71d063b6162466e123c7d759dc403ef","modified":1649005210590},{"_id":"public/hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment/index.html","hash":"1aa5c1f9050dca22c7c164144fc2ccadd344d240","modified":1649005210590},{"_id":"public/hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office/index.html","hash":"0fb2959449bdffb82c0c1c72fb56fa4cf6339835","modified":1649005210590},{"_id":"public/hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations/index.html","hash":"f38696f32e974509cc58d0342a8d7a5f413cf424","modified":1649005210590},{"_id":"public/hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation/index.html","hash":"c4c00851aa70f6529a41e3eea7775a7f396abde1","modified":1649005210590},{"_id":"public/virtual-server-undo-disks-merge-parent-disk-part-of-saved-state/index.html","hash":"539668bc1fdb3db3d0b798c7bad5711c917b8c7f","modified":1649005210590},{"_id":"public/hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory/index.html","hash":"93cc5200f620fe427ff2de7ea8972195078f55ee","modified":1649005210590},{"_id":"public/sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45/index.html","hash":"e218ccb0d5ec360e7d9cffa50d8753ca35a0279e","modified":1649005210590},{"_id":"public/hmc-45-ur-2-has-been-released/index.html","hash":"8d6ca2d48cfff5a9feb163282fab61e869c8af7f","modified":1649005210590},{"_id":"public/how-to-add-send-on-behalf-permission-to-users-with-mps/index.html","hash":"89423e289df701ac2a25b8895a09d82d2e76f8c0","modified":1649005210590},{"_id":"public/ocs-docs/index.html","hash":"1287e874ec36759fce40ff232f3894a70d14bac8","modified":1649005210590},{"_id":"public/hmc-45-rollup-1/index.html","hash":"6f7df742a9d2d5ab0370fc3a01811ab1d621b50c","modified":1649005210590},{"_id":"public/patches-for-hmc40/index.html","hash":"983152925cc3fed740c0198a657931c26cc17768","modified":1649005210590},{"_id":"public/crm-contacts-and-accounts-are-not-showing-up-in-outlook/index.html","hash":"a158637fc8775c3e19bbe189a8612ccaf425a508","modified":1649005210590},{"_id":"public/mscrm-contacts-and-accounts-are-not-showing-up-in-outlook/index.html","hash":"d570d1dc6bc73b336508863e2c4d20d4788e5fc4","modified":1649005210590},{"_id":"public/install-microsoft-dynamics-crm-4-0-server-on-multiple-computers/index.html","hash":"40eb0cf65490bab65d1862deb63e0372e2259116","modified":1649005210590},{"_id":"public/hmc-45-is-out/index.html","hash":"0f69fa73aa5a21313630d913cc4fb9c992a77d9e","modified":1649005210590},{"_id":"public/mpf-service-account-error-in-deployment-tools/index.html","hash":"02df28e0fdebb18c4f7dbf3ab5b2c55ad1723b4d","modified":1649005210590},{"_id":"public/installing-mscrm-4-0-without-internet-access/index.html","hash":"a8b663870e7e230a9f63da9c7bbb9a867a85cdd8","modified":1649005210590},{"_id":"public/how-to-turn-off-password-expiration-in-hmc-40/index.html","hash":"19df608a2f90564da065b69b68f326f1306e2820","modified":1649005210590},{"_id":"public/unofficial-consolidated-server-deployment-guide-for-hmc4/index.html","hash":"0050e9ff925d5f99bafbf8bdb24dda76bd1af047","modified":1649005210590},{"_id":"public/change-idx-sub-order/index.html","hash":"116df3c3a83a19e7d8829bce90203e5b3433f2cd","modified":1649005210590},{"_id":"public/archives/index.html","hash":"db05a5eb83011dbd143a1b8cfac2b790a5f9e288","modified":1649005210590},{"_id":"public/archives/page/2/index.html","hash":"44da41e2501cadf7af128bd5a1dae53c97f909d8","modified":1649005210590},{"_id":"public/archives/page/3/index.html","hash":"8a0ed160068d2d564ad5d654929debed26354f0e","modified":1649005210590},{"_id":"public/archives/page/4/index.html","hash":"650bbb140041fa2736ce3080c43ebee79e8044d0","modified":1649005210590},{"_id":"public/archives/page/5/index.html","hash":"cf05d4211d21f6cd2cf6c51eab0c0b4419bed69b","modified":1649005210590},{"_id":"public/archives/page/6/index.html","hash":"de81fba8bd4f3b1d362480214d057649df9fc423","modified":1649005210590},{"_id":"public/archives/page/7/index.html","hash":"6c3285a6cb265d34d2d50c717861e61e1ec74ae8","modified":1649005210590},{"_id":"public/archives/page/8/index.html","hash":"1b47a3f77e4f1fdacb81957dba66c1c4f639d1d1","modified":1649005210590},{"_id":"public/archives/page/9/index.html","hash":"7a9ea1bf32182e15f07a5934418e7bf862ae023b","modified":1649005210590},{"_id":"public/archives/2005/index.html","hash":"58fbd18de4f131dc72165f771910b5e1c4aeadd7","modified":1649005210590},{"_id":"public/archives/2005/04/index.html","hash":"58fbd18de4f131dc72165f771910b5e1c4aeadd7","modified":1649005210590},{"_id":"public/archives/2007/index.html","hash":"bfc896d1f67593e54bbd008edd71a865034841b6","modified":1649005210590},{"_id":"public/archives/2007/06/index.html","hash":"5efb0b8340366191729f5f1e0d1f3c97d08246a1","modified":1649005210590},{"_id":"public/archives/2007/11/index.html","hash":"82426cfa74af12dbc72124ede98bbeb22eb0dfbf","modified":1649005210590},{"_id":"public/archives/2008/index.html","hash":"48719a54a22b2f5aaa2eddeddcc9e434699e9c7f","modified":1649005210590},{"_id":"public/archives/2008/01/index.html","hash":"a61c255a9e26268aa5867646cdf27630c035a672","modified":1649005210590},{"_id":"public/archives/2008/05/index.html","hash":"8d0657d0d815fb8f451852bc32b0bcc3f8b0d15f","modified":1649005210590},{"_id":"public/archives/2008/06/index.html","hash":"dd6187e579c18768abc453a14eea205dc363c93c","modified":1649005210590},{"_id":"public/archives/2008/09/index.html","hash":"4cfc1aa8918b494662d277f286c313957da428a4","modified":1649005210590},{"_id":"public/archives/2008/11/index.html","hash":"30b0ce6c38d79f202cc46bd974abb657376eaf9e","modified":1649005210590},{"_id":"public/archives/2009/index.html","hash":"7466fcccb682e7d9d9dc3861d35ff76a0321302e","modified":1649005210590},{"_id":"public/archives/2009/page/2/index.html","hash":"c6599f2931366c179cd9be7e80e92543dbf4e944","modified":1649005210590},{"_id":"public/archives/2009/02/index.html","hash":"b356cdc8f05369ad4c55952e35d37f6e40a02316","modified":1649005210590},{"_id":"public/archives/2009/05/index.html","hash":"a7bdd56f0454a6e5049af15e020bf2bb8ec0f46c","modified":1649005210590},{"_id":"public/archives/2009/08/index.html","hash":"64d006a29c14f6be7b2e962cd11b1b11268a1258","modified":1649005210590},{"_id":"public/archives/2009/10/index.html","hash":"999867e60811c2244a02978a5df132f1d85b5ad2","modified":1649005210590},{"_id":"public/archives/2009/12/index.html","hash":"33d959942774f08324c8dac6ef59a00e211c8de6","modified":1649005210590},{"_id":"public/archives/2010/index.html","hash":"743e6df336cbad2cea277533b74d6130efdabaae","modified":1649005210590},{"_id":"public/archives/2010/page/2/index.html","hash":"f60202df89a0b630444221d66681476c06b0260d","modified":1649005210590},{"_id":"public/archives/2010/03/index.html","hash":"0c7e4ea18ea93b6949fb41d06d1342bf9888f581","modified":1649005210590},{"_id":"public/archives/2010/04/index.html","hash":"94e718979c094bc17619e1bc28c2720925561bd1","modified":1649005210590},{"_id":"public/archives/2010/06/index.html","hash":"bff84137154e568ca80a0922dda201908d63eab6","modified":1649005210590},{"_id":"public/archives/2010/07/index.html","hash":"94e36255fb282a44813adfebc2f09c56e2f05778","modified":1649005210590},{"_id":"public/archives/2010/08/index.html","hash":"c27c5fbd4a2ca29d3344b11ea89e2180abeeff5c","modified":1649005210590},{"_id":"public/archives/2010/09/index.html","hash":"cebbc89930a3a622c6ac3999d40000679d8308a4","modified":1649005210590},{"_id":"public/archives/2010/10/index.html","hash":"18dc27cafef6f979f73fb05f1deab214b2ab3f7b","modified":1649005210590},{"_id":"public/archives/2010/12/index.html","hash":"4d88c374143cff67fc8683dd89f23bea5a372b9a","modified":1649005210590},{"_id":"public/archives/2011/index.html","hash":"d84a085307510c0984cc53742d76292bede6abc9","modified":1649005210590},{"_id":"public/archives/2011/09/index.html","hash":"9ccac88b958522995f2341f78d7a7d7d5f651f57","modified":1649005210590},{"_id":"public/archives/2011/10/index.html","hash":"81a3fa613cbc4ad8df2673ba11b2e1ffcd3a8649","modified":1649005210590},{"_id":"public/archives/2011/12/index.html","hash":"2dcf57ee30ce615ba1fab8286e874d1e16c1fb55","modified":1649005210590},{"_id":"public/archives/2013/index.html","hash":"0b3293bb8e87cf883f66b6ae496bb279f331e96e","modified":1649005210590},{"_id":"public/archives/2013/page/2/index.html","hash":"7b630438a590f6ed3381f333e60053572598584d","modified":1649005210590},{"_id":"public/archives/2013/01/index.html","hash":"7ee811dadb2835a4eaf3a99a766898a7470cab92","modified":1649005210590},{"_id":"public/archives/2013/03/index.html","hash":"e895e2d346df04beeb4fd0e6c2e9b7aa1af0c863","modified":1649005210590},{"_id":"public/archives/2013/04/index.html","hash":"d4f48dfa8535a4e96bf230112685f663dd79d2d9","modified":1649005210590},{"_id":"public/archives/2013/05/index.html","hash":"fc2671577510b8f7cf25b9b35ee1599ac40e9f6b","modified":1649005210590},{"_id":"public/archives/2013/07/index.html","hash":"66f8ed5347796a48d082ff84ae835d89129e5077","modified":1649005210590},{"_id":"public/archives/2013/10/index.html","hash":"46fc63c7bdd84c65dcbf13e3fac0a1c302c586b1","modified":1649005210590},{"_id":"public/archives/2013/11/index.html","hash":"385300b8d8e4b12399111c3856927bf030f6a04d","modified":1649005210590},{"_id":"public/archives/2013/12/index.html","hash":"cb73884e4b15130a40cae35c2f8f66c426e99e79","modified":1649005210590},{"_id":"public/archives/2014/index.html","hash":"9502e597e2baae7e2697e301e53632b8f2308ff9","modified":1649005210590},{"_id":"public/archives/2014/02/index.html","hash":"372c8856cc505ceffda057a36a498c01cd6a5aed","modified":1649005210590},{"_id":"public/archives/2014/04/index.html","hash":"aefa25da327f28dfaf9843800fb9f07fbff4f381","modified":1649005210590},{"_id":"public/archives/2014/06/index.html","hash":"f5e84284456d2526c9baf4386dc84bf3ae2de403","modified":1649005210590},{"_id":"public/archives/2015/index.html","hash":"a1bdcb992c79e11ddd3afc19e8273f6428e672df","modified":1649005210590},{"_id":"public/archives/2015/03/index.html","hash":"a5be675250f9177647ceefa846071c0ed5c336a8","modified":1649005210590},{"_id":"public/archives/2015/06/index.html","hash":"3eee50cd6c455b7b2deb76af1ada19960b668af3","modified":1649005210590},{"_id":"public/archives/2015/11/index.html","hash":"d0a07659df7e3a860ed2695d155fd12cfb56829e","modified":1649005210590},{"_id":"public/archives/2017/index.html","hash":"cff6615807e95e5a1b10887830231044e1ff9f65","modified":1649005210590},{"_id":"public/archives/2017/06/index.html","hash":"25653a56eae3454a85da8cd4d2cb85795af1049d","modified":1649005210590},{"_id":"public/archives/2017/07/index.html","hash":"b70fb8b10b0600be659e04056184d92dbb2fd5c5","modified":1649005210590},{"_id":"public/archives/2017/08/index.html","hash":"97f19f09e16aa92244f560104ddcf5b26e2d88cf","modified":1649005210590},{"_id":"public/archives/2017/09/index.html","hash":"4bfccd212b4518fd078a23431941c4fc7e52f61c","modified":1649005210590},{"_id":"public/archives/2017/11/index.html","hash":"fc5bfa63a8dc8fe6578b9f4589795126e783516b","modified":1649005210590},{"_id":"public/archives/2018/index.html","hash":"5be58904990ed0476a3b1824c42dc125c611d7db","modified":1649005210590},{"_id":"public/archives/2018/02/index.html","hash":"2effe4788fac25ddca8d8cae771628d8b7b032d8","modified":1649005210590},{"_id":"public/archives/2018/03/index.html","hash":"b79f56bf2f6d9c4cd46dc54bcb95a9ba9391c271","modified":1649005210590},{"_id":"public/archives/2018/08/index.html","hash":"85afd4027446ab7de03d53109422fc9921c4dbc0","modified":1649005210590},{"_id":"public/archives/2018/09/index.html","hash":"b2109ee8acff414725dcbbce1c82629f0ac987f4","modified":1649005210590},{"_id":"public/archives/2018/11/index.html","hash":"ec16347c243552f634dab7763b3f239d56260559","modified":1649005210590},{"_id":"public/archives/2018/12/index.html","hash":"dc31d639ba826a582d240085f6dd8db0a503075f","modified":1649005210590},{"_id":"public/archives/2019/index.html","hash":"3452ba44842352180d83001c1baa752f58a87e2b","modified":1649005210590},{"_id":"public/archives/2019/02/index.html","hash":"3314af4ca11fe39607af2f4310581e9ac7c39c8f","modified":1649005210590},{"_id":"public/archives/2019/11/index.html","hash":"dc3d57af61a0a5f57f5174bdbeb4de13fa83a89c","modified":1649005210590},{"_id":"public/archives/2020/index.html","hash":"3a673edb9466238703dcee4130822630e5b88713","modified":1649005210590},{"_id":"public/archives/2020/01/index.html","hash":"3a673edb9466238703dcee4130822630e5b88713","modified":1649005210590},{"_id":"public/categories/Microsoft/index.html","hash":"69a788ebb983bb49d7313a5d7e9ad05d3839c7fa","modified":1649005210590},{"_id":"public/categories/Microsoft/page/2/index.html","hash":"48c8bb7ea2bca1a37432caf9d3e6f04e686b5f51","modified":1649005210590},{"_id":"public/categories/Microsoft/page/3/index.html","hash":"77a70621e93d86c55ef632d6db23a42dbf687430","modified":1649005210590},{"_id":"public/categories/Microsoft/page/4/index.html","hash":"3e5a5944ff2e6a47cfb055b53a6180b908b351f7","modified":1649005210590},{"_id":"public/categories/Microsoft/page/5/index.html","hash":"af005dd5ae420702afc7de0340b32fa550c8a194","modified":1649005210590},{"_id":"public/categories/Nix/index.html","hash":"4a23d55ae444add32a49e932240a258e24e464e5","modified":1649005210590},{"_id":"public/categories/数码影音/index.html","hash":"16c2548809cb4f4dcf1f9ae51bbc27e7e2532660","modified":1649005210590},{"_id":"public/categories/Windows/index.html","hash":"990d093484828958b43c4915ee4790cf1304c05f","modified":1649005210590},{"_id":"public/categories/Microsoft/活动目录/index.html","hash":"985103625d17db3059e62a72ca4fb4e718b19325","modified":1649005210590},{"_id":"public/categories/MSCRM/index.html","hash":"65eaefc38938f47e42b186fa21f142aeb5af759f","modified":1649005210590},{"_id":"public/categories/网站相关/index.html","hash":"94c1370912f3939f2a3733136d7e27de63078104","modified":1649005210590},{"_id":"public/categories/Microsoft/Office/index.html","hash":"09b25f117360d5f56a41a90e962b15644cc275d2","modified":1649005210590},{"_id":"public/categories/Microsoft/Exchange/index.html","hash":"9dab316832cd839dcd5a00b465b532fcd293fd54","modified":1649005210590},{"_id":"public/categories/虚拟化/index.html","hash":"c15f271a325e38f3ceba0375d2d82cb3ae8b505d","modified":1649005210590},{"_id":"public/categories/Microsoft/HMC/index.html","hash":"18805f25fc6e03b684d8c647c925f3d035d1ac46","modified":1649005210590},{"_id":"public/categories/Microsoft/HMC/page/2/index.html","hash":"8ed88d3dd0661939541865ee918deef406bb89bb","modified":1649005210590},{"_id":"public/categories/Microsoft/HMC/page/3/index.html","hash":"1013de718a73c344f1d39033502c2194c27ddbd3","modified":1649005210590},{"_id":"public/categories/沟通协作/index.html","hash":"57f2863c608920cdc825ea52f0a92d297030fb8b","modified":1649005210590},{"_id":"public/categories/Ubuntu/index.html","hash":"9bf1bdc425c4c32c9dddecfc02c2606c9e059435","modified":1649005210590},{"_id":"public/categories/Hackintosh/index.html","hash":"63337d2c4b91f8d79fc7aa3bfe27c06d576e89f8","modified":1649005210590},{"_id":"public/categories/Microsoft/MSSQL/index.html","hash":"cb370165aa437f3637489c661034fb2e14838194","modified":1649005210590},{"_id":"public/categories/Microsoft/SQL数据库/index.html","hash":"198402b047aaf47b87fbb9397daa2013b741e552","modified":1649005210590},{"_id":"public/categories/Microsoft/Windows/index.html","hash":"ac2c692350c4e4118051670da204759e5a32b9d6","modified":1649005210590},{"_id":"public/categories/Docker/index.html","hash":"48516d50a10463b808fcde78530c8f523b2912f7","modified":1649005210590},{"_id":"public/categories/Microsoft/MSCRM/index.html","hash":"f0663d240163f5dfc2b2f2042b9d71c2c14247ad","modified":1649005210590},{"_id":"public/categories/eBook/index.html","hash":"6b2fcd4ea275839d3843d9a8f71ed372b799a7af","modified":1649005210590},{"_id":"public/categories/Python/index.html","hash":"2f0d68da7e700bbdebe70c0915d6dbe7d64d0c0d","modified":1649005210590},{"_id":"public/index.html","hash":"b3720e509ef801d757ee6e0017404caeb05623ce","modified":1649005210590},{"_id":"public/page/2/index.html","hash":"a36e13a8369ad917dec6b300cf5788299ea4c6b7","modified":1649005210590},{"_id":"public/page/3/index.html","hash":"c34607f8492c0795fb1883f5bedb53eacc0454b6","modified":1649005210590},{"_id":"public/page/4/index.html","hash":"ad5f18e5f42a6e7d258a944177fac21328e69db9","modified":1649005210590},{"_id":"public/page/5/index.html","hash":"994b8a14a57e72cc2dfea80481b87564720adbf3","modified":1649005210590},{"_id":"public/page/6/index.html","hash":"a3de0c82d29ebbdbdf41ef2976ae338691adbb2f","modified":1649005210590},{"_id":"public/page/7/index.html","hash":"e3a09c24de10a70eeda70373a0fb3c43975a591c","modified":1649005210590},{"_id":"public/page/8/index.html","hash":"581626c5051f4d2bce5a1dfa2d1fb2d141c04c8f","modified":1649005210590},{"_id":"public/page/9/index.html","hash":"905232717f07a8d7716169778d782417621f07a6","modified":1649005210590},{"_id":"public/tags/Active-Directory/index.html","hash":"f85f4641f3bd60da57fd7c97805b646a3a5593a2","modified":1649005210590},{"_id":"public/tags/Tips/index.html","hash":"c9bcc4fed280cc4e23a6e83c8d7ec2c9abcfb981","modified":1649005210590},{"_id":"public/tags/APC/index.html","hash":"d14649bedd9ae9127df9a2afcde0d75486818e3e","modified":1649005210590},{"_id":"public/tags/PECL/index.html","hash":"a2479a7c0f6ec6cda5998dadb0645edd3f641be7","modified":1649005210590},{"_id":"public/tags/PHP/index.html","hash":"398ab906ec436b3bd5286da20a8789e64b803dc7","modified":1649005210590},{"_id":"public/tags/Yum/index.html","hash":"95ce4b01431318d5f4a0030f4be23fe599c994d5","modified":1649005210590},{"_id":"public/tags/Vobsub/index.html","hash":"b28e0bac7d1105fb8131fef020b02e4456d9ee0e","modified":1649005210590},{"_id":"public/tags/Windows/index.html","hash":"12bb72b3e0b3fbab326b171cae93e155dd9dc876","modified":1649005210590},{"_id":"public/tags/CentOS/index.html","hash":"ec5cb31bd64ff5900af808008c4632d90015852b","modified":1649005210590},{"_id":"public/tags/Kernel/index.html","hash":"792ab7df00f8c80de30f8a43d33c0929b8571233","modified":1649005210590},{"_id":"public/tags/VMware/index.html","hash":"a065e9ffdd35eb4fc90680bca9b59bd3c5b086e5","modified":1649005210590},{"_id":"public/tags/GitHub/index.html","hash":"eb29c8be1ee51b792051d2ee93926dc0f0c9cfd8","modified":1649005210590},{"_id":"public/tags/Hexo/index.html","hash":"996ef207fd033517d08d2cad06c8526a6a9e53bc","modified":1649005210590},{"_id":"public/tags/DCOM/index.html","hash":"75d24febb70668460a33b29ad7f034eebeb51ed4","modified":1649005210590},{"_id":"public/tags/Excel/index.html","hash":"fd60b12f3cd0bb5f852723399a18922b741f9800","modified":1649005210590},{"_id":"public/tags/最佳实践/index.html","hash":"4ab5d78d79342d08e840de14590c58025c0c894a","modified":1649005210590},{"_id":"public/tags/Exchange/index.html","hash":"522e8922b3cda943d6775936db214f51006d930a","modified":1649005210590},{"_id":"public/tags/Exchange/page/2/index.html","hash":"5b4bf7f8b13f90abb926e260617e17a7fbf99ef9","modified":1649005210590},{"_id":"public/tags/Kerberos/index.html","hash":"fe77a6289d3f7b26effc91c313639af67c798423","modified":1649005210590},{"_id":"public/tags/Rollup/index.html","hash":"866e5cc5d9c081208c6a0f167e3f744c6b1d5538","modified":1649005210590},{"_id":"public/tags/Activesync/index.html","hash":"da4161eb4d91b56068c4dcf3108395674d589860","modified":1649005210590},{"_id":"public/tags/Android/index.html","hash":"3ab73f4d52558bdff423549007e3450f79a84bd4","modified":1649005210590},{"_id":"public/tags/Google/index.html","hash":"2c5afa38422cc2d547d21f794a8382ef31361165","modified":1649005210590},{"_id":"public/tags/Nexus/index.html","hash":"656d970778a5c2d851a288c84553678bcce43a68","modified":1649005210590},{"_id":"public/tags/日志/index.html","hash":"5e1901a7a2f1a0f601e85790be0a3b386f9367b3","modified":1649005210590},{"_id":"public/tags/CentOS-LVM-扩容-根分区/index.html","hash":"67dafa17a51966d4d56a695a205ef4f341e1815e","modified":1649005210590},{"_id":"public/tags/Java/index.html","hash":"0ba08d10ae485c9dc2811694daff95e7fb276fc5","modified":1649005210590},{"_id":"public/tags/JRE/index.html","hash":"dfe9cca9041be51bb965f274472ebf440c983baf","modified":1649005210590},{"_id":"public/tags/MSI/index.html","hash":"7fe7a99ea5d0f6afc1a90113ab3fa5e5330a0173","modified":1649005210590},{"_id":"public/tags/Virtual-Center/index.html","hash":"404dfc6394ab1a3614e564229eed84fef3763019","modified":1649005210590},{"_id":"public/tags/BITS/index.html","hash":"e3737fec7cff79a0ca1ecf7f54f806435863a72b","modified":1649005210590},{"_id":"public/tags/Microsoft/index.html","hash":"e84b53f546760be78afa578f7fc71ec8e472aa53","modified":1649005210590},{"_id":"public/tags/WSUS/index.html","hash":"1b1e9622b9178fe13e2e88dd42ca45c54c15cb87","modified":1649005210590},{"_id":"public/tags/Office/index.html","hash":"535b0a209539d471f31356efe6fa697860b0a37b","modified":1649005210590},{"_id":"public/tags/HMC/index.html","hash":"355c6077db4ae67667d84bca24cf007ddd865e95","modified":1649005210590},{"_id":"public/tags/HMC/page/2/index.html","hash":"d0a3d80749c8bee8d091a3ef4d3eed0334b7c595","modified":1649005210590},{"_id":"public/tags/HMC/page/3/index.html","hash":"c66eafc4890c338ab8c17e592b23df1c8a815b43","modified":1649005210590},{"_id":"public/tags/Autodiscover/index.html","hash":"e412c525b458a56d9a6f40dfc663be7a7eab60aa","modified":1649005210590},{"_id":"public/tags/MultiTenancy/index.html","hash":"390a2c992a13576b62fcf67ca27f0d6bfbf0c891","modified":1649005210590},{"_id":"public/tags/GeoIP/index.html","hash":"9e70be2ff77fcf0c134ac3ad17bfb8ce3aba3273","modified":1649005210590},{"_id":"public/tags/MaxMind/index.html","hash":"e919d5dd237d4a89b83109e0ab598cc6fccfa55b","modified":1649005210590},{"_id":"public/tags/XMPP/index.html","hash":"60aebc9f65450dde38e45f9da8f18cdbd6324ebc","modified":1649005210590},{"_id":"public/tags/Gmail/index.html","hash":"bf2dce6e8eaacfec13e2c2f9db1761e9c7c19b55","modified":1649005210590},{"_id":"public/tags/Ubuntu/index.html","hash":"9a88a665804d9269c052166e0ef9942f7e75578b","modified":1649005210590},{"_id":"public/tags/Linux/index.html","hash":"b000397530b1cdb8446635424b7b78f49aee67d0","modified":1649005210590},{"_id":"public/tags/Hackintosh-macOS-Mojave/index.html","hash":"e3778b23bcf30ddb448969299a29f95f1dd9368f","modified":1649005210590},{"_id":"public/tags/MSSQL/index.html","hash":"439fe0bfb814e9ae2440d0fd170d5b77426d0996","modified":1649005210590},{"_id":"public/tags/SSRS/index.html","hash":"6f190ea53f65fbec56f9506bfaa6c7d4bbacb685","modified":1649005210590},{"_id":"public/tags/TeraData/index.html","hash":"99114b3ccf8d8a111a1ef7f1849e16bd757f970a","modified":1649005210590},{"_id":"public/tags/WordPress/index.html","hash":"7c46abb356612473a4e210cb22066ea50cc88bc7","modified":1649005210590},{"_id":"public/tags/Communicator/index.html","hash":"b2174e70693ee7629683902d820ea4f008c79fa8","modified":1649005210590},{"_id":"public/tags/SCVMM/index.html","hash":"fbf09bbeba94025d43b3c06def24c766239e5c94","modified":1649005210590},{"_id":"public/tags/VMHost/index.html","hash":"493690381c3253f972c91e6075250c9e16654e5a","modified":1649005210590},{"_id":"public/tags/Internet-Explorer/index.html","hash":"ad9d0348240387c11d276817f10dc0a4e4ee9de1","modified":1649005210590},{"_id":"public/tags/Fiddler/index.html","hash":"eb6014a335f0bf8d1013ed944ba970a28f3b40ed","modified":1649005210590},{"_id":"public/tags/WMIC/index.html","hash":"6163f5fa812e5e14e459491645f1dae0d59c5788","modified":1649005210590},{"_id":"public/tags/VBScript/index.html","hash":"6a1e9bd70d19a6e16a7dc3b373240afb6ae142a1","modified":1649005210590},{"_id":"public/tags/PowerShell/index.html","hash":"861780d7aaaf69157d6dfbf422ef8bdf0d1a9602","modified":1649005210590},{"_id":"public/tags/IIS/index.html","hash":"39ab5338503e5d3f3a43113fd779e444d9d54509","modified":1649005210590},{"_id":"public/tags/Rewrite/index.html","hash":"1b8abbe46c7cd459d38e974020d32e341c229344","modified":1649005210590},{"_id":"public/tags/HP-EliteDesk-黑苹果-Hackintosh/index.html","hash":"25f58044f68ef17c6ee6b0a5a8f09b72907fa940","modified":1649005210590},{"_id":"public/tags/Docker/index.html","hash":"48516d50a10463b808fcde78530c8f523b2912f7","modified":1649005210590},{"_id":"public/tags/MSCRM/index.html","hash":"f0663d240163f5dfc2b2f2042b9d71c2c14247ad","modified":1649005210590},{"_id":"public/tags/LEMP/index.html","hash":"54559812614ffc8ac0de7bc3b90bbd68e7c27160","modified":1649005210590},{"_id":"public/tags/Nginx/index.html","hash":"245d922f59d285c7cd2351b618a8e9ca875aa70e","modified":1649005210590},{"_id":"public/tags/MariaDB/index.html","hash":"92b33260b25ddebf7a4124fe560fd48a2cabdf0d","modified":1649005210590},{"_id":"public/tags/MySQL/index.html","hash":"55bfb1b85ab96ad7b3c5dbbf8223567abec9ddda","modified":1649005210590},{"_id":"public/tags/Lighttpd/index.html","hash":"70a70629b2dd0521af95fb58dcbf65f468248d26","modified":1649005210590},{"_id":"public/tags/VMware-Tools/index.html","hash":"eee3a08c13a608e72424a9b42f70f4cda364cfcc","modified":1649005210590},{"_id":"public/tags/Intel-NUC-Bean-Canyon-黑苹果-Hackintosh-读卡器-魔改/index.html","hash":"001fdde6eaf4a58ee7032fe88dd56fdd1e9233ae","modified":1649005210590},{"_id":"public/tags/Event-ID/index.html","hash":"4da94532a966a6899e053e8b13502fc2c3b1cbc0","modified":1649005210590},{"_id":"public/tags/Group-Policy/index.html","hash":"e6498498897e132e6602fc49d5d61bfe79ca10a4","modified":1649005210590},{"_id":"public/tags/Zonemapping/index.html","hash":"cf4ca4a24ab979117a53e0ee14d1c03f8906bc92","modified":1649005210590},{"_id":"public/tags/Outlook/index.html","hash":"1d7f6746d76b9428b59830c958cdbc37fba02fd4","modified":1649005210590},{"_id":"public/tags/Lync/index.html","hash":"cba905f78d08947f2cdbf2ef8c3eb0b104e150b0","modified":1649005210590},{"_id":"public/tags/OCS/index.html","hash":"0abf30e96d1a5cf19672ca5cf577f21c17ea2f14","modified":1649005210590},{"_id":"public/tags/Movable-Type/index.html","hash":"508f4d48c10a70c6cb1362d150df5e12386454b7","modified":1649005210590},{"_id":"public/tags/Hosting/index.html","hash":"6ed701fdfe34bb91c566fd44b3891cd4f8508208","modified":1649005210590},{"_id":"public/tags/Packt/index.html","hash":"07dbe9d00a0d7a33fb86c3f0fe1526038b664fe9","modified":1649005210590},{"_id":"public/tags/eBook/index.html","hash":"6b2fcd4ea275839d3843d9a8f71ed372b799a7af","modified":1649005210590},{"_id":"public/tags/Python/index.html","hash":"2f0d68da7e700bbdebe70c0915d6dbe7d64d0c0d","modified":1649005210590},{"_id":"public/tags/Reporting-Service/index.html","hash":"eeb3551e4767481c4ba26bbc9e3a6b7245e06046","modified":1649005210590},{"_id":"public/tags/SPN/index.html","hash":"91771a5e8de7363b2e8740a3edab0f510df20687","modified":1649005210590},{"_id":"public/tags/Web-404-https-腾讯/index.html","hash":"26ccf80edc7bce21bb845034e2f71feaf16b18cd","modified":1649005210590},{"_id":"public/tags/Chrome/index.html","hash":"5192d1848edfeef1eb3252a2ce75a046cef203ea","modified":1649005210590},{"_id":"public/tags/Cookie/index.html","hash":"edc401427b842410e33e19faf413e9680eca1e57","modified":1649005210590},{"_id":"public/tags/MSDN/index.html","hash":"45022654be959edec4e8adf6934fc0dad63c45d4","modified":1649005210590},{"_id":"public/tags/Skype-for-Business/index.html","hash":"1f3269e2dcff0ec99e5eedc2602459a661418ebb","modified":1649005210590},{"_id":"public/tags/DHCP/index.html","hash":"a9edb4224b670ede23a03592400ac3accbb842c4","modified":1649005210590},{"_id":"public/tags/Cisco/index.html","hash":"11f8d5f20f579cd35709ba229d61b16365dfd147","modified":1649005210590},{"_id":"public/tags/Virtual-Server/index.html","hash":"559aadd492cbeb3a270b8eb548906ed785da9667","modified":1649005210590},{"_id":"public/tags/VirtualBox/index.html","hash":"00ae3bfb7a97d936c3f4176292e4a66a49ffb77d","modified":1649005210590},{"_id":"public/img/AliPayQR.png","hash":"7787b5d91cbf0e19a1260df24f7d949771c7d45b","modified":1649005210590},{"_id":"public/img/BTCQR.png","hash":"7d1c80f953bfb6f0a37d432b04c936ea165bfd97","modified":1649005210590},{"_id":"public/img/WeChatQR.png","hash":"8c41aca7883e5ff714c56556f5fff8e7e7c38093","modified":1649005210590},{"_id":"public/img/alipay.svg","hash":"46cc0552a9f6d700d618db3fcad25e1b8e697e36","modified":1649005210590},{"_id":"public/img/bitcoin.svg","hash":"635f7cca5e675d192be2717788175c7a2146013a","modified":1649005210590},{"_id":"public/img/github.svg","hash":"277798d16cb6106e45ef74f6b9972011fa43401b","modified":1649005210590},{"_id":"public/img/paypal.svg","hash":"92f3bc495f20a0190d3041be03345c46d6238c25","modified":1649005210590},{"_id":"public/img/like.svg","hash":"e6e4bd1af076be9358316cac89efdc22ef4a5064","modified":1649005210590},{"_id":"public/img/wechat.svg","hash":"330496ad42446a29f37a2b97fc388ebd77a8cb9f","modified":1649005210590},{"_id":"public/CNAME","hash":"8e84eb65c9edda5062eb18d71a9cd8205d454d92","modified":1649005210590},{"_id":"public/favicon.ico","hash":"18e3bb1c4dff6529c9b54aa5d0a7401eb9127731","modified":1649005210590},{"_id":"public/apple-touch-icon.png","hash":"7e2e56e1cb840e834fad069d8125f817a0dd9cbc","modified":1649005210590},{"_id":"public/robots.txt","hash":"44e1074a8c541de9864b4968c0e68c78b11c2cb5","modified":1649005210590},{"_id":"public/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip","hash":"32ba92bf220583bf0d7d01a3fb7c428e5a0de643","modified":1649005210590},{"_id":"public/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg","hash":"2e1d63669c41a2b53ec30b606da85f67e386f65a","modified":1649005210590},{"_id":"public/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg","hash":"ac358406a7daeaa34a1ec661e1646fa71990c5ec","modified":1649005210590},{"_id":"public/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg","hash":"648558deb0ed837e94682f3a41fdc426926f09af","modified":1649005210590},{"_id":"public/fix-java8-install-1603-error/Java8_Error_1603.png","hash":"a638a3dce361673ae2c0a31bc170a44776a44b85","modified":1649005210590},{"_id":"public/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg","hash":"98ede366e0a494534c78e79c933287078b58170b","modified":1649005210590},{"_id":"public/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg","hash":"8d03e220365b0f24f9430ca668b3fb261543f831","modified":1649005210590},{"_id":"public/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg","hash":"38d4a4f630cab196b8de87bc7f4fbbeba694cbca","modified":1649005210590},{"_id":"public/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg","hash":"a593a5d877cf8e5359692406a0fe02678d89a85f","modified":1649005210590},{"_id":"public/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg","hash":"6e5a3bee5a9cd59c48f21a460794f43c527cfd02","modified":1649005210590},{"_id":"public/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg","hash":"64ac53f6ef4df3689db210ed9ed6c5db20688242","modified":1649005210590},{"_id":"public/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg","hash":"3f9197d13a513f7319a074f0dc669ac36351f0d2","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg","hash":"55ed2fc2e33767195fe249ea2407b975b32b3927","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg","hash":"8595d4764df1e1b15267e4586d58a0f9b669d52d","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg","hash":"859211ff7a3c54461a0090d03cbb0d30c2ad3509","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg","hash":"858d8ef08c49e1caef82233f7b87e7994a8452d7","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg","hash":"75cf1fdde35cf3a8a2bfa7a130176ba4d79598e4","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg","hash":"d78d4e4778cd156bad0d274dc648b2b247c4a52e","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg","hash":"5bdf0a299af2a9a1f43c75f0569de035666e6331","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg","hash":"5ae81c5f5ca5a796fbe917c5f9eb3788581bdccb","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg","hash":"20538dbcdb41bb69be5436b60a59896e034fe57e","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg","hash":"c78ef1b656087a5e0a32a17d54db598cb32a3d2c","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg","hash":"75eeafd0f39f294eb0116939a672c677af5a360b","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg","hash":"3fd96f713a284a6ed534c2832db0300eae1827f7","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg","hash":"b1741993cb42f50cce78d0564148604c19440635","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg","hash":"390e2ee3337ef6ee33c3b714436c3bed8a05948c","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg","hash":"202fda4f84459ff11730e8380849e70dc520214c","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg","hash":"493704a580e8581a7cce3864a012767fdc601541","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg","hash":"e0a10966fbdcadd0bff3baf8bb4597f8232dfe63","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg","hash":"c4b18811567a23e30d57169471fdbe6bb8350897","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg","hash":"89692ca9c84483e3b24d308448c60515d3b92ef5","modified":1649005210590},{"_id":"public/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png","hash":"02161d62941bc34d1890171d866cd6d46907e74c","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg","hash":"23cc29c549063744cfd9e92856f60fd323480bf7","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg","hash":"f83f1d906285ec094743444391e8b7d8c433161c","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg","hash":"8ad97be76143335c5d6157758c8cef0f7fadb75e","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg","hash":"df2cc38f2833462d3489d2984563d6a6538fa3a5","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg","hash":"60f0afae55d521d8fcc84ae60d830ddad193e958","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg","hash":"1d0066fb8669572f7e4b54a08e884f8f356fe085","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_9.jpg","hash":"b22d8b214bdf35bc085797166c1c6538f4374f03","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg","hash":"d28b576656247bb6bb878fc5280a8c7e04934459","modified":1649005210590},{"_id":"public/how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg","hash":"afa20288a39ca20f600003539ce34d0dd040988f","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/apt-update-docker.jpg","hash":"6b9948bff43d58745b53931ee7ec031a4f782fad","modified":1649005210590},{"_id":"public/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie11-eupp-registry.zip","hash":"5483d8766f28af75b398f93764bc93813f37f68f","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/apt-update.jpg","hash":"fb9905a53c786928fba06607521b175d49a36eee","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg","hash":"5c359cb345c1ab770cb38f226e9d96caabbb880e","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/docker-permission.jpg","hash":"4fcc1b00b4e76857e64dfc7ec01bbfe2ae83963e","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg","hash":"a2062bdd9a8582f012fd4790d730f1620d809ce8","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg","hash":"f812ec8964b35fa67dec7421d03f53f8c6c516b2","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg","hash":"9276c435282bd997ed348b2c41254e975900a9a8","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg","hash":"81275626ff835875883d2094048249417b11e455","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg","hash":"d40f89bbb714eb6ec06a98ffab4d01a3bf20a46a","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg","hash":"9283b5f07a5cbf626922fae3e5a7580a23bc442e","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg","hash":"4884407c4ef6f2347012b3174fb7421eb5e29f26","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg","hash":"2df7b30c8f7fe6b3406ee3c764f70e9202160e38","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg","hash":"9d67a3752f6b4e2459e64ef3287f7727eee0ad0a","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg","hash":"3459567d2c74f8a52102e10c2702e619678cdea2","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg","hash":"fa767532e1cbbe482d0895f431f5067150c418bc","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg","hash":"e0d13719bf978de2e640edfcd21b5d8d07fdc56c","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg","hash":"a9f93734136b5a8ad89d96d67a22c19f909504ea","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg","hash":"420389f63f08a89f17ee0dc73e826655ace6e449","modified":1649005210590},{"_id":"public/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg","hash":"f58f2a546b2e3ea7c9593719d90d4ca3f10758b3","modified":1649005210590},{"_id":"public/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg","hash":"e58996348b7c0c58169f6fa56d70e268927a5e26","modified":1649005210590},{"_id":"public/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg","hash":"8675c8aa274da07351254817a88c4c82d8eeaa01","modified":1649005210590},{"_id":"public/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg","hash":"8d31428125b3a0d69cc5f5de115dedc00e12282a","modified":1649005210590},{"_id":"public/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg","hash":"0f19fa1b05ccb15a31456b0c6a5db087f6b33f8c","modified":1649005210590},{"_id":"public/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg","hash":"0067e21cdaeec747cca6aac1957106d920f20b74","modified":1649005210590},{"_id":"public/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg","hash":"f26e8d506a08b96c76d2a644fe27b926f17d572f","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_0.jpg","hash":"d880a6432c3811f70aeb08423dfa22614b3553a9","modified":1649005210590},{"_id":"public/packtpub-offer-free-learning/packtpub-eBook-2.jpg","hash":"8ed66f5df6e34dcefd86d078ad2d9e0bda845934","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_1.jpg","hash":"5868fccc2e155dd30b5fc91c687ef21b7fdb1420","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_10.jpg","hash":"71c77937a593e26759fd466fa48d7d9cc1577423","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_12.jpg","hash":"44c12c2af1f813ab83e85499607c16bc391f310e","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_13.jpg","hash":"a3067f3c4f0e4302d410fcd7bbb88cd76ffc8e86","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_15.jpg","hash":"940f335fb2908d6f3b14e8485d9a4c0a4b75e89d","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_17.jpg","hash":"bc28aa38103d1b362f5d1c4abaab59dee347c7bb","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_16.jpg","hash":"e17cd76bbded50be1bdcae0b30ea3b4e7c0c4949","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_19.jpg","hash":"e338972ab9c3bf0f1f3b50a26b578e026ee823ad","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_20.jpg","hash":"e8096c3dcef7feb9540e13ae0b32fbac985d8de7","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_11.jpg","hash":"b855d4d4387d2ae1e6d1d02232e6d5f046fb83a6","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_4.jpg","hash":"3457f6b7698a8909da940f134ab1043f868240c3","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_5.jpg","hash":"d3ac2bdc0876bbaf7c8df02d6f4cf7c00334101d","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_6.jpg","hash":"dfe19c4e9b526ad4b995a0c6434da46275418e3b","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_8.jpg","hash":"fb1d5ac70d690c5b70f6ed22d252f862d4a65c49","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_7.jpg","hash":"1ebb95f895838cca8c477f5faf9829e027f912c4","modified":1649005210590},{"_id":"public/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg","hash":"7d65bcde1c532ecf174b81c56a2c31a3d02e63d5","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_9.jpg","hash":"bd493c0bed44e914005417209d080803c6dcd189","modified":1649005210590},{"_id":"public/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg","hash":"f56a89eda146641d225f2298b6442759be2a2d69","modified":1649005210590},{"_id":"public/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg","hash":"247f0d0a593cefc3ee70a2ce4222d63f3dbb4be7","modified":1649005210590},{"_id":"public/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg","hash":"1574401fef18374f7247f2cc9e3b744be62d4945","modified":1649005210590},{"_id":"public/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg","hash":"1fa0b4f68b4c4cdecc6a2c957897072efb996a7c","modified":1649005210590},{"_id":"public/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg","hash":"5556c4d7b1e744308c2005cd96902b686a1b0f5b","modified":1649005210590},{"_id":"public/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg","hash":"11fc5cd8a3cc6b030a44f2f91662e3cd9fe5f174","modified":1649005210590},{"_id":"public/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg","hash":"b9127c997b2a3fbe5af3d567a963fb1622497853","modified":1649005210590},{"_id":"public/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg","hash":"6e684cb2b60c1c18350368f0fb8160ae5d7fc0f6","modified":1649005210590},{"_id":"public/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg","hash":"ed7100cbbd8a5410dfc276943e2b0f3a8290dfe3","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg","hash":"065cc2c737e72df36f02f6d6fe1621a8c30decfc","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg","hash":"b214a67ff9b85bf6926b2f2dde6288c6fb31c768","modified":1649005210590},{"_id":"public/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg","hash":"4d271b10f323eb58a1705c61a3c6ffeaddc095a4","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg","hash":"7d2d985c36f747f9a14b2a7bf6acf6c5e90b5845","modified":1649005210590},{"_id":"public/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg","hash":"c61006f9c116bdfc6eed68181782478643084158","modified":1649005210590},{"_id":"public/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg","hash":"4ab8389d0931109788a538b2a785e48699b18260","modified":1649005210590},{"_id":"public/how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg","hash":"43e768fbb62fb672a5df3e64344521803d75b1ea","modified":1649005210590},{"_id":"public/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg","hash":"af1c044b8ab90746d8c4a6bce9038bfb96fe39ef","modified":1649005210590},{"_id":"public/how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg","hash":"b90ee5c089ff785133db3bc72014280104a24763","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg","hash":"10ef5e40876f1bad3666efe785a1b0d5c8012496","modified":1649005210590},{"_id":"public/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg","hash":"316b0d368d9c86ebc64493e14b2cd0b3afe91a02","modified":1649005210590},{"_id":"public/packtpub-offer-free-learning/packtpub-eBook-1.jpg","hash":"7e8f359eebcd3daf7781debef2f452562aac9c7f","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_14.jpg","hash":"8f53e5482f9679b542a6d111f4dd2671d5c1616e","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_18.jpg","hash":"cec7b294319925e755e57f605f3fd7eaf4bdd111","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_2.jpg","hash":"f5f0f7d94f7536c687cdf3c7b2077784d1d4c3ac","modified":1649005210590},{"_id":"public/mscrm-2011-beta-installation/CRM2011_3.jpg","hash":"eca6231c7c9019a81d4ffa3047e4c4eb08cc9d6e","modified":1649005210590},{"_id":"public/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg","hash":"d91f8da8efa5a7958511b2307bf84ea04f780f46","modified":1649005210590},{"_id":"public/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg","hash":"63b1fe61c8207fc0dde83b79c6e4d5b5a06063bc","modified":1649005210590},{"_id":"public/css/copyright.css","hash":"e857156bd1f971fe6abdc22d2b8c82e495387438","modified":1649005210590},{"_id":"public/css/donate.css","hash":"d0079ba8202d925a93ab1cb44f2087b81f476755","modified":1649005210590},{"_id":"public/css/copycode.css","hash":"803d8bf898f47c3929665eb7af97da22f11efacd","modified":1649005210590},{"_id":"public/css/jquery.fancybox.css","hash":"f42f761157f26244673eb2f4a9215c70956f80dc","modified":1649005210590},{"_id":"public/css/search.css","hash":"0d0f73b357c3bc5077ef657c73f679b22bea93fb","modified":1649005210590},{"_id":"public/donate/index.html","hash":"bd5cbe475b7bce89a8c96375c56c8e3e188d6afc","modified":1649005210590},{"_id":"public/js/codeblock-resizer.js","hash":"5d0b786d60bf225d9eabcc9cece2719ff4d9b6cd","modified":1649005210590},{"_id":"public/js/copycode.js","hash":"fde1f153bab1f00ae8930668094c00aa9ff3c7a3","modified":1649005210590},{"_id":"public/js/fancybox.js","hash":"13c4781570339f4fba76a3d7f202e442817dd605","modified":1649005210590},{"_id":"public/js/copyright.js","hash":"7b1bd775ea22abf33d57f78628f436bf656e439a","modified":1649005210590},{"_id":"public/js/love.js","hash":"5cf89f622bf891cf1986845eb92eadef6f358eb7","modified":1649005210590},{"_id":"public/js/donate.js","hash":"860f5d07175f8ad077e8dc4310732bba8daa7159","modified":1649005210590},{"_id":"public/js/share.js","hash":"a2f9de374523dc7f2ddb90ed5f24b668c20d9272","modified":1649005210590},{"_id":"public/js/search.js","hash":"d3609497b54a27de56c747856cb74b8c39eceeda","modified":1649005210590},{"_id":"public/js/smartresize.js","hash":"3ef157fd877167e3290f42c67a624ea375a46c24","modified":1649005210590},{"_id":"public/js/totop.js","hash":"7dbf8fcf582a4fb6eb9b2c60d6de9f9c2091ec4c","modified":1649005210590},{"_id":"public/js/toggle_menu.js","hash":"b7202fe35eae823e75f1772e3ac3a20f6390f667","modified":1649005210590},{"_id":"public/css/default.css","hash":"7fbb18b73b44ed11193739c55fce53a6f173cf68","modified":1649005210590},{"_id":"public/css/style.css","hash":"cd3a461322b0838161585077e7d7a6bc6af8e5df","modified":1649005210590},{"_id":"public/js/gitment.browser.js","hash":"376446d9c5930576016f97dd63e5e6616c94d8d4","modified":1649005210590},{"_id":"public/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg","hash":"f2faae14d65527104d037df1b010fdb77168ce88","modified":1649005210590},{"_id":"public/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg","hash":"adee013d8d668683c4bf73c19e2cc16af3e6158f","modified":1649005210590},{"_id":"public/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif","hash":"d63852b98ea45f6b4b5a65112a05506d18ccc501","modified":1649005210590},{"_id":"public/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg","hash":"9da094aa3c108ac2d5cf1b40d0e8114d971c2dd5","modified":1649005210590},{"_id":"public/install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg","hash":"f291456a8a0e1c8a45f5eb1c345eadb04f48f7c8","modified":1649005210590},{"_id":"public/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/dhcputil.zip","hash":"b7bcebec04bede62917c45adc896e9c540e8f48b","modified":1649005210590},{"_id":"public/how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg","hash":"c4f707ecd6539939b4f44bb1433d270c780b9752","modified":1649005210590},{"_id":"public/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg","hash":"5d0f1bd6dae34f18f8bd14d217374f7d3601d913","modified":1649005210590},{"_id":"public/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg","hash":"72b51d470bc831e5cbba13654cc6cfd8b0a85b7f","modified":1649005210590},{"_id":"public/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png","hash":"9e95b776e6ce27b39e58a0b2b0cccc5024101b0d","modified":1649005210590},{"_id":"public/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png","hash":"51f74ba6c597310adda8e407a2b73966c8ac564c","modified":1649005210590},{"_id":"public/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg","hash":"3275ee031e1ac4dd6031a7161274059fc5871c72","modified":1649005210590},{"_id":"public/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf","hash":"92cc9753001ff66e14d155ec3f7f4133244cce51","modified":1649005210590},{"_id":"public/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/msvcr110.zip","hash":"bcbe6f0713033bbbedecd42f123f33b8d433f053","modified":1649005210590}],"Category":[{"name":"Microsoft","_id":"cl1jj4kt50004k84s8l7l9m7d"},{"name":"*Nix","_id":"cl1jj4kt80009k84s6s6idm4o"},{"name":"数码影音","_id":"cl1jj4kt9000dk84s268h7kzj"},{"name":"Windows","_id":"cl1jj4ktb000kk84s1uz1exmw"},{"name":"活动目录","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktd000pk84s12c3fx8r"},{"name":"MSCRM","_id":"cl1jj4kth000zk84setwncqtf"},{"name":"网站相关","_id":"cl1jj4ktl0018k84s608zdrrv"},{"name":"Office","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kto001ok84scxnd0x3a"},{"name":"Exchange","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktq001uk84s7083dyzs"},{"name":"虚拟化","_id":"cl1jj4ktw002mk84s16sng7zz"},{"name":"HMC","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kty0030k84saix34ohd"},{"name":"沟通协作","_id":"cl1jj4kum0064k84s1vs5coqg"},{"name":"Ubuntu","_id":"cl1jj4kun006ak84s6k6b3wko"},{"name":"Hackintosh","_id":"cl1jj4kup006ik84sgtot8jfj"},{"name":"MSSQL","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuq006qk84s8ep8hojf"},{"name":"SQL数据库","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kus006xk84s9f73ezsd"},{"name":"Windows","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuv007ck84sh4179srj"},{"name":"Docker","_id":"cl1jj4kuy007sk84s3a8oau3l"},{"name":"MSCRM","parent":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuz007yk84s05leei37"},{"name":"eBook","_id":"cl1jj4kv30092k84s96ohhsw4"},{"name":"Python","_id":"cl1jj4kv40097k84sgmv09ak6"}],"Data":[],"Page":[{"layout":"false","comments":0,"_content":"\n<html>\n<head>\n<meta charset=\"utf-8\">\n<meta name=\"description\" content=\"你访问的页面找不回来了，但是我们可以一起寻找失踪宝贝\" />\n<meta name=\"description\" content=\"公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。\" />\n<meta name=\"description\" content=\"Winotes.net - 闻道录也在此尽一点微薄之力。\" />\n<title>一起寻找失踪宝贝_闻道录</title>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"https://winotes.net\" homePageName=\"返回主页\"></script>\n</body>\n</html>\n","source":"404.md","raw":"layout: false \ncomments: false\npermalink: /404.html\n---\n\n<html>\n<head>\n<meta charset=\"utf-8\">\n<meta name=\"description\" content=\"你访问的页面找不回来了，但是我们可以一起寻找失踪宝贝\" />\n<meta name=\"description\" content=\"公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。\" />\n<meta name=\"description\" content=\"Winotes.net - 闻道录也在此尽一点微薄之力。\" />\n<title>一起寻找失踪宝贝_闻道录</title>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"https://winotes.net\" homePageName=\"返回主页\"></script>\n</body>\n</html>\n","date":"2022-04-03T09:51:39.471Z","updated":"2020-01-05T09:00:53.941Z","path":"/404.html","title":"","_id":"cl1jj4ksy0000k84s6wko1ugv","content":"<html><head>\n<meta charset=\"utf-8\">\n<meta name=\"description\" content=\"你访问的页面找不回来了，但是我们可以一起寻找失踪宝贝\">\n<meta name=\"description\" content=\"公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。\">\n<meta name=\"description\" content=\"Winotes.net - 闻道录也在此尽一点微薄之力。\">\n<title>一起寻找失踪宝贝_闻道录</title>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homepageurl=\"https://winotes.net\" homepagename=\"返回主页\"></script>\n\n\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head>\n<meta charset=\"utf-8\">\n<meta name=\"description\" content=\"你访问的页面找不回来了，但是我们可以一起寻找失踪宝贝\">\n<meta name=\"description\" content=\"公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。\">\n<meta name=\"description\" content=\"Winotes.net - 闻道录也在此尽一点微薄之力。\">\n<title>一起寻找失踪宝贝_闻道录</title>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\" homepageurl=\"https://winotes.net\" homepagename=\"返回主页\"></script>\n\n\n</body></html>"},{"layout":"page","comments":0,"title":"我是谁","_content":"<script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async></script>\n\nRandy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，于是 http://www.powerk6.org 这个网站就顺理成章地成为了我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。\n\n* 大学主修环境工程，出于对计算机的热爱选择了 IT 行业。\n* 目前我和家人居住在深圳。\n* 湖南人，爱吃辣椒。\n* 出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。\n* 一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。\n\n你可以通过以下几种方式联系到我：\n\n<i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a>\n\n<i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a>\n\n<i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a>\n\n<i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a>\n\n<i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a>\n","source":"about/index.md","raw":"---\nlayout: page \ncomments: false\ntitle: 我是谁\n---\n<script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async></script>\n\nRandy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，于是 http://www.powerk6.org 这个网站就顺理成章地成为了我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。\n\n* 大学主修环境工程，出于对计算机的热爱选择了 IT 行业。\n* 目前我和家人居住在深圳。\n* 湖南人，爱吃辣椒。\n* 出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。\n* 一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。\n\n你可以通过以下几种方式联系到我：\n\n<i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a>\n\n<i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a>\n\n<i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a>\n\n<i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a>\n\n<i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a>\n","date":"2022-03-30T15:02:47.817Z","updated":"2020-01-05T09:00:54.029Z","path":"about/index.html","_id":"cl1jj4kt30002k84s97wx1i87","content":"<html><head><script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async=\"\"></script>\n\n</head><body><p>Randy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，于是 <a href=\"http://www.powerk6.org/\">http://www.powerk6.org</a> 这个网站就顺理成章地成为了我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。</p>\n<ul>\n<li>大学主修环境工程，出于对计算机的热爱选择了 IT 行业。</li>\n<li>目前我和家人居住在深圳。</li>\n<li>湖南人，爱吃辣椒。</li>\n<li>出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。</li>\n<li>一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。</li>\n</ul>\n<p>你可以通过以下几种方式联系到我：</p>\n<p><i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a></p>\n<p><i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a></p>\n<p><i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a></p>\n<p><i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a></p>\n<p><i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head><script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async=\"\"></script>\n\n</head><body><p>Randy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，于是 <a href=\"http://www.powerk6.org/\">http://www.powerk6.org</a> 这个网站就顺理成章地成为了我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。</p>\n<ul>\n<li>大学主修环境工程，出于对计算机的热爱选择了 IT 行业。</li>\n<li>目前我和家人居住在深圳。</li>\n<li>湖南人，爱吃辣椒。</li>\n<li>出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。</li>\n<li>一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。</li>\n</ul>\n<p>你可以通过以下几种方式联系到我：</p>\n<p><i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a></p>\n<p><i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a></p>\n<p><i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a></p>\n<p><i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a></p>\n<p><i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a></p>\n</body></html>"}],"Post":[{"title":"AD 管理小技巧系列01 - 不重置密码也可延长密码有效期","date":"2013-11-19T02:19:10.000Z","_content":"\n在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。\n\n如果你想不修改密码，延长你的账户有效期的话，这里有个办法：\n\n在 AD 用户的账号属性页面，有个选项叫做 “_用户下次登录时须更改密码_”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。\n\n*   **User must change password at next logon **\n![AD 用户属性页面](active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg)\n","source":"_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it.md","raw":"---\ntitle: AD 管理小技巧系列01 - 不重置密码也可延长密码有效期\ntags:\n  - Active Directory\n  - Tips\ncategories:\n  - Microsoft\n  - 活动目录\ndate: 2013-11-19 10:19:10\n---\n\n在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。\n\n如果你想不修改密码，延长你的账户有效期的话，这里有个办法：\n\n在 AD 用户的账号属性页面，有个选项叫做 “_用户下次登录时须更改密码_”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。\n\n*   **User must change password at next logon **\n![AD 用户属性页面](active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg)\n","slug":"active-directory-tips-01-extend-password-expiration-date-not-changing-it","published":1,"updated":"2020-01-05T09:00:53.941Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt00001k84sbt8dg481","content":"<html><head></head><body><p>在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。</p>\n<p>如果你想不修改密码，延长你的账户有效期的话，这里有个办法：</p>\n<p>在 AD 用户的账号属性页面，有个选项叫做 “_用户下次登录时须更改密码_”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。</p>\n<ul>\n<li>**User must change password at next logon **<br><img src=\"/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg\" alt=\"AD 用户属性页面\"></li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。</p>\n<p>如果你想不修改密码，延长你的账户有效期的话，这里有个办法：</p>\n<p>在 AD 用户的账号属性页面，有个选项叫做 “_用户下次登录时须更改密码_”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。</p>\n<ul>\n<li>**User must change password at next logon **<br><img src=\"/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg\" alt=\"AD 用户属性页面\"></li>\n</ul>\n</body></html>"},{"title":"APC: undefined symbol: pcre_exec in Unknown on line 0","date":"2013-05-12T14:46:45.000Z","_content":"\nAPC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：\n\nProblem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0\n\n以下是解决方法：\n1. 先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp\n```bash\ncp /etc/php.d/apc.ini /tmp\n```\n2. 移除原来的安装包\n```bash\nyum remove php-pecl-apc\n```\n3. 用 pecl 来安装 apc\n```bash\npecl install apc\n```\n4. 再把 apc.ini 复制回去\n```bash\nmv /tmp/apc.ini /etc/php.d/apc.ini\n```","source":"_posts/apc-undefined-symbol-pcre-exec-in-unknown-on-line-0.md","raw":"---\ntitle: 'APC: undefined symbol: pcre_exec in Unknown on line 0'\ntags:\n  - APC\n  - PECL\n  - PHP\n  - Yum\ncategories:\n  - '*Nix'\ndate: 2013-05-12 22:46:45\n---\n\nAPC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：\n\nProblem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0\n\n以下是解决方法：\n1. 先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp\n```bash\ncp /etc/php.d/apc.ini /tmp\n```\n2. 移除原来的安装包\n```bash\nyum remove php-pecl-apc\n```\n3. 用 pecl 来安装 apc\n```bash\npecl install apc\n```\n4. 再把 apc.ini 复制回去\n```bash\nmv /tmp/apc.ini /etc/php.d/apc.ini\n```","slug":"apc-undefined-symbol-pcre-exec-in-unknown-on-line-0","published":1,"updated":"2020-01-05T09:00:53.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt30003k84sc0flf2kc","content":"<html><head></head><body><p>APC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：</p>\n<p>Problem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0</p>\n<p>以下是解决方法：</p>\n<ol>\n<li>先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> /etc/php.d/apc.ini /tmp</span><br></pre></td></tr></tbody></table></figure></li>\n<li>移除原来的安装包<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove php-pecl-apc</span><br></pre></td></tr></tbody></table></figure></li>\n<li>用 pecl 来安装 apc<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pecl install apc</span><br></pre></td></tr></tbody></table></figure></li>\n<li>再把 apc.ini 复制回去<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mv</span> /tmp/apc.ini /etc/php.d/apc.ini</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>APC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：</p>\n<p>Problem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0</p>\n<p>以下是解决方法：</p>\n<ol>\n<li>先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cp</span> /etc/php.d/apc.ini /tmp</span><br></pre></td></tr></tbody></table></figure></li>\n<li>移除原来的安装包<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum remove php-pecl-apc</span><br></pre></td></tr></tbody></table></figure></li>\n<li>用 pecl 来安装 apc<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">pecl install apc</span><br></pre></td></tr></tbody></table></figure></li>\n<li>再把 apc.ini 复制回去<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mv</span> /tmp/apc.ini /etc/php.d/apc.ini</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n</body></html>"},{"title":"修改idx/sub字幕的字幕显示顺序","date":"2005-04-02T14:50:50.000Z","_content":"\n如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？\n\n编辑.idx文件\n\n找到\n\\# Language index in use\n\nlangidx: 0\n\n把langidx: 0 的数字改成中文字幕的index no\n比如在这个文件里面\n\\# Chinese\n\nid: zh, index: 2\n\n那就改成langidx: 2，保存。\n\n后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，\n\n注册表里面的设置是优先的，位置在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages`\n\n里面有一个名为Langx的字串值，修改Lang0 的键值为 \"Chinese\" 才能使默认显示为中文\n\n如果是Vobsub2.23及其以前版本在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub`\n\nVSFilter2.3x则在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter`\n","source":"_posts/change-idx-sub-order.md","raw":"---\ntitle: 修改idx/sub字幕的字幕显示顺序\ntags:\n  - Vobsub\ncategories:\n  - 数码影音\ndate: 2005-04-02 22:50:50\n---\n\n如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？\n\n编辑.idx文件\n\n找到\n\\# Language index in use\n\nlangidx: 0\n\n把langidx: 0 的数字改成中文字幕的index no\n比如在这个文件里面\n\\# Chinese\n\nid: zh, index: 2\n\n那就改成langidx: 2，保存。\n\n后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，\n\n注册表里面的设置是优先的，位置在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages`\n\n里面有一个名为Langx的字串值，修改Lang0 的键值为 \"Chinese\" 才能使默认显示为中文\n\n如果是Vobsub2.23及其以前版本在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub`\n\nVSFilter2.3x则在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter`\n","slug":"change-idx-sub-order","published":1,"updated":"2020-01-05T09:00:53.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt60006k84sauale8de","content":"<html><head></head><body><p>如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？</p>\n<p>编辑.idx文件</p>\n<p>找到<br># Language index in use</p>\n<p>langidx: 0</p>\n<p>把langidx: 0 的数字改成中文字幕的index no<br>比如在这个文件里面<br># Chinese</p>\n<p>id: zh, index: 2</p>\n<p>那就改成langidx: 2，保存。</p>\n<p>后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，</p>\n<p>注册表里面的设置是优先的，位置在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages</code></p>\n<p>里面有一个名为Langx的字串值，修改Lang0 的键值为 “Chinese” 才能使默认显示为中文</p>\n<p>如果是Vobsub2.23及其以前版本在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub</code></p>\n<p>VSFilter2.3x则在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter</code></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？</p>\n<p>编辑.idx文件</p>\n<p>找到<br># Language index in use</p>\n<p>langidx: 0</p>\n<p>把langidx: 0 的数字改成中文字幕的index no<br>比如在这个文件里面<br># Chinese</p>\n<p>id: zh, index: 2</p>\n<p>那就改成langidx: 2，保存。</p>\n<p>后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，</p>\n<p>注册表里面的设置是优先的，位置在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages</code></p>\n<p>里面有一个名为Langx的字串值，修改Lang0 的键值为 “Chinese” 才能使默认显示为中文</p>\n<p>如果是Vobsub2.23及其以前版本在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub</code></p>\n<p>VSFilter2.3x则在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter</code></p>\n</body></html>"},{"title":"使用 Windows 内置的 CertUtil 程序计算文件的哈希校验值","date":"2018-03-08T03:51:23.000Z","keywords":"Windows, MD5，Hashfile，checksum, CertUtil, Cryptographic, FCIV","description":"使用 Windows 内置的 CertUtil 程序计算文件的哈希校验值","_content":"\n在 Windows 中，通常我们需要计算一个文件的 MD5 或者 SHA1 值的时候，需要下载一些第三方的工具，哪怕是微软的，也有 File Checksum Integrity Verifier ([FCIV](https://support.microsoft.com/en-us/help/841290/availability-and-description-of-the-file-checksum-integrity-verifier-u)) 或者 Sysinternals 的 [Sigcheck](https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck) 小工具来做，不过可能很少有人知道，Windows 内置的 **CertUtil** 程序也可以干这个事。\n\nCertUtil 是个强大的证书相关的管理工具，涉及到证书的加解密，所以相关的 MD5/SHA1 之类的加密算法都是支持的，在 CertUtil 中有个参数 -hashfile 可以帮助我们计算任意文件的哈希校验值，不过如果你在命令行中输入\n`CertUtil -hashfile -?` 来试图获取帮助的时候，给出来的帮助信息很简单：\n\n```\nCertUtil [Options] -hashfile InFile [HashAlgorithm]\n  Generate and display cryptographic hash over a file\n```\n\n其实，完全的信息应该是这样的：\n``` \nUsage:\n  CertUtil [Options] -hashfile InFile [HashAlgorithm]\n  Generate and display cryptographic hash over a file\n\nOptions:\n  -gmt              -- Display times as GMT\n  -seconds          -- Display times with seconds and milliseconds\n  -v                -- Verbose operation\n  -privatekey       -- Display password and private key data\n\nHashAlgorithm:    MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512 \n\nCertUtil -?              -- Display a verb list (command list)\nCertUtil -hashfile -?    -- Display help text for the \"hashfile\" verb\nCertUtil -v -?           -- Display all help text for all verbs\n```\n\nCertUtil 所支持的加密算法有 **MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512**\n\n### 例子\n比如我们要得到计算器程序的 MD5 值\n`CertUtil -hashfile c:\\Windows\\System32\\calc.exe MD5` 注意，这里的 MD5 一定要大写\n\n```\nMD5 hash of file c:\\Windows\\System32\\calc.exe:\n10 e4 a1 d2 13 2c cb 5c 67 59 f0 38 cd b6 f3 c9\nCertUtil: -hashfile command completed successfully.\n```\n如果 MD5 没有大写，这样运行命令的话：\n`CertUtil -hashfile c:\\Windows\\System32\\calc.exe md5`\n\n程序会报错\n```\nCertUtil: -hashfile command FAILED: 0xd00000bb (-805306181)\nCertUtil: WsResetMetadata\n```\n","source":"_posts/computing-cryptographic-hash-values-with-certutil.md","raw":"---\ntitle: 使用 Windows 内置的 CertUtil 程序计算文件的哈希校验值\ntags:\n  - Windows\ncategories:\n  - Windows\ndate: 2018-03-08 11:51:23\nkeywords: Windows, MD5，Hashfile，checksum, CertUtil, Cryptographic, FCIV\ndescription: 使用 Windows 内置的 CertUtil 程序计算文件的哈希校验值\n---\n\n在 Windows 中，通常我们需要计算一个文件的 MD5 或者 SHA1 值的时候，需要下载一些第三方的工具，哪怕是微软的，也有 File Checksum Integrity Verifier ([FCIV](https://support.microsoft.com/en-us/help/841290/availability-and-description-of-the-file-checksum-integrity-verifier-u)) 或者 Sysinternals 的 [Sigcheck](https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck) 小工具来做，不过可能很少有人知道，Windows 内置的 **CertUtil** 程序也可以干这个事。\n\nCertUtil 是个强大的证书相关的管理工具，涉及到证书的加解密，所以相关的 MD5/SHA1 之类的加密算法都是支持的，在 CertUtil 中有个参数 -hashfile 可以帮助我们计算任意文件的哈希校验值，不过如果你在命令行中输入\n`CertUtil -hashfile -?` 来试图获取帮助的时候，给出来的帮助信息很简单：\n\n```\nCertUtil [Options] -hashfile InFile [HashAlgorithm]\n  Generate and display cryptographic hash over a file\n```\n\n其实，完全的信息应该是这样的：\n``` \nUsage:\n  CertUtil [Options] -hashfile InFile [HashAlgorithm]\n  Generate and display cryptographic hash over a file\n\nOptions:\n  -gmt              -- Display times as GMT\n  -seconds          -- Display times with seconds and milliseconds\n  -v                -- Verbose operation\n  -privatekey       -- Display password and private key data\n\nHashAlgorithm:    MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512 \n\nCertUtil -?              -- Display a verb list (command list)\nCertUtil -hashfile -?    -- Display help text for the \"hashfile\" verb\nCertUtil -v -?           -- Display all help text for all verbs\n```\n\nCertUtil 所支持的加密算法有 **MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512**\n\n### 例子\n比如我们要得到计算器程序的 MD5 值\n`CertUtil -hashfile c:\\Windows\\System32\\calc.exe MD5` 注意，这里的 MD5 一定要大写\n\n```\nMD5 hash of file c:\\Windows\\System32\\calc.exe:\n10 e4 a1 d2 13 2c cb 5c 67 59 f0 38 cd b6 f3 c9\nCertUtil: -hashfile command completed successfully.\n```\n如果 MD5 没有大写，这样运行命令的话：\n`CertUtil -hashfile c:\\Windows\\System32\\calc.exe md5`\n\n程序会报错\n```\nCertUtil: -hashfile command FAILED: 0xd00000bb (-805306181)\nCertUtil: WsResetMetadata\n```\n","slug":"computing-cryptographic-hash-values-with-certutil","published":1,"updated":"2020-01-05T09:00:53.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt70007k84s0z3b5i3v","content":"<html><head></head><body><p>在 Windows 中，通常我们需要计算一个文件的 MD5 或者 SHA1 值的时候，需要下载一些第三方的工具，哪怕是微软的，也有 File Checksum Integrity Verifier (<a href=\"https://support.microsoft.com/en-us/help/841290/availability-and-description-of-the-file-checksum-integrity-verifier-u\">FCIV</a>) 或者 Sysinternals 的 <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck\">Sigcheck</a> 小工具来做，不过可能很少有人知道，Windows 内置的 <strong>CertUtil</strong> 程序也可以干这个事。</p>\n<p>CertUtil 是个强大的证书相关的管理工具，涉及到证书的加解密，所以相关的 MD5/SHA1 之类的加密算法都是支持的，在 CertUtil 中有个参数 -hashfile 可以帮助我们计算任意文件的哈希校验值，不过如果你在命令行中输入<br><code>CertUtil -hashfile -?</code> 来试图获取帮助的时候，给出来的帮助信息很简单：</p>\n<figure class=\"highlight css\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CertUtil <span class=\"selector-attr\">[Options]</span> -hashfile InFile <span class=\"selector-attr\">[HashAlgorithm]</span></span><br><span class=\"line\">  Generate and <span class=\"attribute\">display</span> cryptographic hash over <span class=\"selector-tag\">a</span> file</span><br></pre></td></tr></tbody></table></figure>\n\n<p>其实，完全的信息应该是这样的：</p>\n<figure class=\"highlight livecodeserver\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Usage:</span><br><span class=\"line\">  CertUtil [Options] -hashfile InFile [HashAlgorithm]</span><br><span class=\"line\">  Generate <span class=\"keyword\">and</span> display cryptographic hash over <span class=\"keyword\">a</span> <span class=\"built_in\">file</span></span><br><span class=\"line\"></span><br><span class=\"line\">Options:</span><br><span class=\"line\">  -gmt              <span class=\"comment\">-- Display times as GMT</span></span><br><span class=\"line\">  -<span class=\"built_in\">seconds</span>          <span class=\"comment\">-- Display times with seconds and milliseconds</span></span><br><span class=\"line\">  -v                <span class=\"comment\">-- Verbose operation</span></span><br><span class=\"line\">  -privatekey       <span class=\"comment\">-- Display password and private key data</span></span><br><span class=\"line\"></span><br><span class=\"line\">HashAlgorithm:    MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512 </span><br><span class=\"line\"></span><br><span class=\"line\">CertUtil -?              <span class=\"comment\">-- Display a verb list (command list)</span></span><br><span class=\"line\">CertUtil -hashfile -?    <span class=\"comment\">-- Display help text for the \"hashfile\" verb</span></span><br><span class=\"line\">CertUtil -v -?           <span class=\"comment\">-- Display all help text for all verbs</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>CertUtil 所支持的加密算法有 <strong>MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512</strong></p>\n<h3 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h3><p>比如我们要得到计算器程序的 MD5 值<br><code>CertUtil -hashfile c:\\Windows\\System32\\calc.exe MD5</code> 注意，这里的 MD5 一定要大写</p>\n<figure class=\"highlight apache\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">MD5</span> hash of file c:\\Windows\\System32\\calc.exe:</span><br><span class=\"line\"><span class=\"attribute\">10</span> e4 a1 d2 <span class=\"number\">13</span> <span class=\"number\">2</span>c cb <span class=\"number\">5</span>c <span class=\"number\">67</span> <span class=\"number\">59</span> f0 <span class=\"number\">38</span> cd b6 f3 c9</span><br><span class=\"line\"><span class=\"attribute\">CertUtil</span>: -hashfile command completed successfully.</span><br></pre></td></tr></tbody></table></figure>\n<p>如果 MD5 没有大写，这样运行命令的话：<br><code>CertUtil -hashfile c:\\Windows\\System32\\calc.exe md5</code></p>\n<p>程序会报错</p>\n<figure class=\"highlight apache\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">CertUtil</span>: -hashfile command FAILED: <span class=\"number\">0</span>xd00000bb (-<span class=\"number\">805306181</span>)</span><br><span class=\"line\"><span class=\"attribute\">CertUtil</span>: WsResetMetadata</span><br></pre></td></tr></tbody></table></figure>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>在 Windows 中，通常我们需要计算一个文件的 MD5 或者 SHA1 值的时候，需要下载一些第三方的工具，哪怕是微软的，也有 File Checksum Integrity Verifier (<a href=\"https://support.microsoft.com/en-us/help/841290/availability-and-description-of-the-file-checksum-integrity-verifier-u\">FCIV</a>) 或者 Sysinternals 的 <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/sigcheck\">Sigcheck</a> 小工具来做，不过可能很少有人知道，Windows 内置的 <strong>CertUtil</strong> 程序也可以干这个事。</p>\n<p>CertUtil 是个强大的证书相关的管理工具，涉及到证书的加解密，所以相关的 MD5/SHA1 之类的加密算法都是支持的，在 CertUtil 中有个参数 -hashfile 可以帮助我们计算任意文件的哈希校验值，不过如果你在命令行中输入<br><code>CertUtil -hashfile -?</code> 来试图获取帮助的时候，给出来的帮助信息很简单：</p>\n<figure class=\"highlight css\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CertUtil <span class=\"selector-attr\">[Options]</span> -hashfile InFile <span class=\"selector-attr\">[HashAlgorithm]</span></span><br><span class=\"line\">  Generate and <span class=\"attribute\">display</span> cryptographic hash over <span class=\"selector-tag\">a</span> file</span><br></pre></td></tr></tbody></table></figure>\n\n<p>其实，完全的信息应该是这样的：</p>\n<figure class=\"highlight livecodeserver\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Usage:</span><br><span class=\"line\">  CertUtil [Options] -hashfile InFile [HashAlgorithm]</span><br><span class=\"line\">  Generate <span class=\"keyword\">and</span> display cryptographic hash over <span class=\"keyword\">a</span> <span class=\"built_in\">file</span></span><br><span class=\"line\"></span><br><span class=\"line\">Options:</span><br><span class=\"line\">  -gmt              <span class=\"comment\">-- Display times as GMT</span></span><br><span class=\"line\">  -<span class=\"built_in\">seconds</span>          <span class=\"comment\">-- Display times with seconds and milliseconds</span></span><br><span class=\"line\">  -v                <span class=\"comment\">-- Verbose operation</span></span><br><span class=\"line\">  -privatekey       <span class=\"comment\">-- Display password and private key data</span></span><br><span class=\"line\"></span><br><span class=\"line\">HashAlgorithm:    MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512 </span><br><span class=\"line\"></span><br><span class=\"line\">CertUtil -?              <span class=\"comment\">-- Display a verb list (command list)</span></span><br><span class=\"line\">CertUtil -hashfile -?    <span class=\"comment\">-- Display help text for the \"hashfile\" verb</span></span><br><span class=\"line\">CertUtil -v -?           <span class=\"comment\">-- Display all help text for all verbs</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>CertUtil 所支持的加密算法有 <strong>MD2 MD4 MD5 SHA1 SHA256 SHA384 SHA512</strong></p>\n<h3 id=\"例子\"><a href=\"#例子\" class=\"headerlink\" title=\"例子\"></a>例子</h3><p>比如我们要得到计算器程序的 MD5 值<br><code>CertUtil -hashfile c:\\Windows\\System32\\calc.exe MD5</code> 注意，这里的 MD5 一定要大写</p>\n<figure class=\"highlight apache\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">MD5</span> hash of file c:\\Windows\\System32\\calc.exe:</span><br><span class=\"line\"><span class=\"attribute\">10</span> e4 a1 d2 <span class=\"number\">13</span> <span class=\"number\">2</span>c cb <span class=\"number\">5</span>c <span class=\"number\">67</span> <span class=\"number\">59</span> f0 <span class=\"number\">38</span> cd b6 f3 c9</span><br><span class=\"line\"><span class=\"attribute\">CertUtil</span>: -hashfile command completed successfully.</span><br></pre></td></tr></tbody></table></figure>\n<p>如果 MD5 没有大写，这样运行命令的话：<br><code>CertUtil -hashfile c:\\Windows\\System32\\calc.exe md5</code></p>\n<p>程序会报错</p>\n<figure class=\"highlight apache\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">CertUtil</span>: -hashfile command FAILED: <span class=\"number\">0</span>xd00000bb (-<span class=\"number\">805306181</span>)</span><br><span class=\"line\"><span class=\"attribute\">CertUtil</span>: WsResetMetadata</span><br></pre></td></tr></tbody></table></figure>\n</body></html>"},{"title":"CentOS 6.4 升级到 3.x Kernel","date":"2013-04-28T04:12:57.000Z","_content":"\n#### 1.前言\n\n好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。\n\n#### 2.准备工作\n\nCentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。\n\n以下是准备工作：\n\n2.1. 安装组件:\n```bash\nyum groupinstall \"Development Tools\" #这样做会确定你拥有编译时所需的一切工具。\nyum install ncurses-devel #你必须这样才能让 make *config 这个指令正确地执行。\nyum install qt-devel #如果你没有 X 环境，这一条可以不用。\nyum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel #创建 CentOS-6 内核时需要它们。\n```\n2.2. 安装 wget\n```bash\nyum -y install wget #安装 wget 下载工具\n```\n2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 www.kernel.org 获取\n```bash\nwget http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz\n```\n\n#### 3.编译/安装内核\n\n3.1. 解压缩源码包\n```bash\nxz -d linux-3.2.21.tar.xz\ntar xvf linux-3.2.21.tar\n```\n3.2. 配置内核选项\n```bash\ncd linux-3.2.21\nmake oldconfig\nmake menuconfig\n```\n在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个 `kernel panic not syncing attempted to kill init` 之类的错误，这里提供我的一份 .config 文件\n\n{% asset_link config-3.2.21-vmware1.zip Kernel 3.2.21 的.config 文件 %} 点击下载\n\n下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）\n\n3.3. 开始编译\n```bash\nmake bzImage modules modules_install\nmake install #安装\n```\n编辑 GRUB引导菜单，将 default=1 改成 default=0\n`vi /etc/grub.conf` \n\n你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单\n\n`reboot` #重启\n\n至此，CentOS 6.4 升级到 3.x Kernel 完成。\n\n#### 4.补充\n\n如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：\n\n<span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span>\n\n从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见[这篇文章](http://delxu.blog.51cto.com/975660/288682/ \"图解VMware内存机制\")），可能的原因有2个：\n\n首先，确认你的 .config 文件里面有  **CONFIG_VMWARE_BALLOON=m **这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers -&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *\n\n其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：\n```bash\ncd /lib/modules/3.x.xx/kernel/drivers/misc #将版本号改成你自己的\nln -s vmw_balloon.ko vmware_balloon.ko #建立软连接\n```\n**Tips:**\n\n如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：\n`grep -R --include=Makefile '\\bNAME\\.o\\b'`","source":"_posts/centos-64-upgrade-to-kernel-3x.md","raw":"---\ntitle: CentOS 6.4 升级到 3.x Kernel\ntags:\n  - CentOS\n  - Kernel\n  - VMware\ncategories:\n  - '*Nix'\ndate: 2013-04-28 12:12:57\n---\n\n#### 1.前言\n\n好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。\n\n#### 2.准备工作\n\nCentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。\n\n以下是准备工作：\n\n2.1. 安装组件:\n```bash\nyum groupinstall \"Development Tools\" #这样做会确定你拥有编译时所需的一切工具。\nyum install ncurses-devel #你必须这样才能让 make *config 这个指令正确地执行。\nyum install qt-devel #如果你没有 X 环境，这一条可以不用。\nyum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel #创建 CentOS-6 内核时需要它们。\n```\n2.2. 安装 wget\n```bash\nyum -y install wget #安装 wget 下载工具\n```\n2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 www.kernel.org 获取\n```bash\nwget http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz\n```\n\n#### 3.编译/安装内核\n\n3.1. 解压缩源码包\n```bash\nxz -d linux-3.2.21.tar.xz\ntar xvf linux-3.2.21.tar\n```\n3.2. 配置内核选项\n```bash\ncd linux-3.2.21\nmake oldconfig\nmake menuconfig\n```\n在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个 `kernel panic not syncing attempted to kill init` 之类的错误，这里提供我的一份 .config 文件\n\n{% asset_link config-3.2.21-vmware1.zip Kernel 3.2.21 的.config 文件 %} 点击下载\n\n下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）\n\n3.3. 开始编译\n```bash\nmake bzImage modules modules_install\nmake install #安装\n```\n编辑 GRUB引导菜单，将 default=1 改成 default=0\n`vi /etc/grub.conf` \n\n你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单\n\n`reboot` #重启\n\n至此，CentOS 6.4 升级到 3.x Kernel 完成。\n\n#### 4.补充\n\n如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：\n\n<span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span>\n\n从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见[这篇文章](http://delxu.blog.51cto.com/975660/288682/ \"图解VMware内存机制\")），可能的原因有2个：\n\n首先，确认你的 .config 文件里面有  **CONFIG_VMWARE_BALLOON=m **这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers -&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *\n\n其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：\n```bash\ncd /lib/modules/3.x.xx/kernel/drivers/misc #将版本号改成你自己的\nln -s vmw_balloon.ko vmware_balloon.ko #建立软连接\n```\n**Tips:**\n\n如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：\n`grep -R --include=Makefile '\\bNAME\\.o\\b'`","slug":"centos-64-upgrade-to-kernel-3x","published":1,"updated":"2020-01-05T09:00:53.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt70008k84s4umoe63i","content":"<html><head></head><body><h4 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1.前言\"></a>1.前言</h4><p>好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。</p>\n<h4 id=\"2-准备工作\"><a href=\"#2-准备工作\" class=\"headerlink\" title=\"2.准备工作\"></a>2.准备工作</h4><p>CentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。</p>\n<p>以下是准备工作：</p>\n<p>2.1. 安装组件:</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum groupinstall <span class=\"string\">\"Development Tools\"</span> <span class=\"comment\">#这样做会确定你拥有编译时所需的一切工具。</span></span><br><span class=\"line\">yum install ncurses-devel <span class=\"comment\">#你必须这样才能让 make *config 这个指令正确地执行。</span></span><br><span class=\"line\">yum install qt-devel <span class=\"comment\">#如果你没有 X 环境，这一条可以不用。</span></span><br><span class=\"line\">yum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel <span class=\"comment\">#创建 CentOS-6 内核时需要它们。</span></span><br></pre></td></tr></tbody></table></figure>\n<p>2.2. 安装 wget</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install wget <span class=\"comment\">#安装 wget 下载工具</span></span><br></pre></td></tr></tbody></table></figure>\n<p>2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 <a href=\"http://www.kernel.org/\">www.kernel.org</a> 获取</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget&nbsp;http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"3-编译-x2F-安装内核\"><a href=\"#3-编译-x2F-安装内核\" class=\"headerlink\" title=\"3.编译/安装内核\"></a>3.编译/安装内核</h4><p>3.1. 解压缩源码包</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xz -d linux-3.2.21.tar.xz</span><br><span class=\"line\">tar xvf linux-3.2.21.tar</span><br></pre></td></tr></tbody></table></figure>\n<p>3.2. 配置内核选项</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> linux-3.2.21</span><br><span class=\"line\">make oldconfig</span><br><span class=\"line\">make menuconfig</span><br></pre></td></tr></tbody></table></figure>\n<p>在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个&nbsp;<code>kernel panic not syncing attempted to kill init</code> 之类的错误，这里提供我的一份 .config 文件</p>\n<a href=\"/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip\" title=\"Kernel 3.2.21 的.config 文件\">Kernel 3.2.21 的.config 文件</a> 点击下载\n\n<p>下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）</p>\n<p>3.3. 开始编译</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make bzImage modules modules_install</span><br><span class=\"line\">make install <span class=\"comment\">#安装</span></span><br></pre></td></tr></tbody></table></figure>\n<p>编辑 GRUB引导菜单，将 default=1 改成 default=0<br><code>vi /etc/grub.conf</code> </p>\n<p>你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单</p>\n<p><code>reboot</code> #重启</p>\n<p>至此，CentOS 6.4 升级到 3.x Kernel 完成。</p>\n<h4 id=\"4-补充\"><a href=\"#4-补充\" class=\"headerlink\" title=\"4.补充\"></a>4.补充</h4><p>如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：</p>\n<p><span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span></p>\n<p>从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见<a href=\"http://delxu.blog.51cto.com/975660/288682/\" title=\"图解VMware内存机制\">这篇文章</a>），可能的原因有2个：</p>\n<p>首先，确认你的 .config 文件里面有 &nbsp;**CONFIG_VMWARE_BALLOON=m **这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers&nbsp;-&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *</p>\n<p>其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /lib/modules/3.x.xx/kernel/drivers/misc <span class=\"comment\">#将版本号改成你自己的</span></span><br><span class=\"line\"><span class=\"built_in\">ln</span> -s vmw_balloon.ko vmware_balloon.ko <span class=\"comment\">#建立软连接</span></span><br></pre></td></tr></tbody></table></figure>\n<p><strong>Tips:</strong></p>\n<p>如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：<br><code>grep -R --include=Makefile '\\bNAME\\.o\\b'</code></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h4 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1.前言\"></a>1.前言</h4><p>好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。</p>\n<h4 id=\"2-准备工作\"><a href=\"#2-准备工作\" class=\"headerlink\" title=\"2.准备工作\"></a>2.准备工作</h4><p>CentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。</p>\n<p>以下是准备工作：</p>\n<p>2.1. 安装组件:</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum groupinstall <span class=\"string\">\"Development Tools\"</span> <span class=\"comment\">#这样做会确定你拥有编译时所需的一切工具。</span></span><br><span class=\"line\">yum install ncurses-devel <span class=\"comment\">#你必须这样才能让 make *config 这个指令正确地执行。</span></span><br><span class=\"line\">yum install qt-devel <span class=\"comment\">#如果你没有 X 环境，这一条可以不用。</span></span><br><span class=\"line\">yum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel <span class=\"comment\">#创建 CentOS-6 内核时需要它们。</span></span><br></pre></td></tr></tbody></table></figure>\n<p>2.2. 安装 wget</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y install wget <span class=\"comment\">#安装 wget 下载工具</span></span><br></pre></td></tr></tbody></table></figure>\n<p>2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 <a href=\"http://www.kernel.org/\">www.kernel.org</a> 获取</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget&nbsp;http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"3-编译-x2F-安装内核\"><a href=\"#3-编译-x2F-安装内核\" class=\"headerlink\" title=\"3.编译/安装内核\"></a>3.编译/安装内核</h4><p>3.1. 解压缩源码包</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">xz -d linux-3.2.21.tar.xz</span><br><span class=\"line\">tar xvf linux-3.2.21.tar</span><br></pre></td></tr></tbody></table></figure>\n<p>3.2. 配置内核选项</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> linux-3.2.21</span><br><span class=\"line\">make oldconfig</span><br><span class=\"line\">make menuconfig</span><br></pre></td></tr></tbody></table></figure>\n<p>在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个&nbsp;<code>kernel panic not syncing attempted to kill init</code> 之类的错误，这里提供我的一份 .config 文件</p>\n<a href=\"/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip\" title=\"Kernel 3.2.21 的.config 文件\">Kernel 3.2.21 的.config 文件</a> 点击下载\n\n<p>下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）</p>\n<p>3.3. 开始编译</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">make bzImage modules modules_install</span><br><span class=\"line\">make install <span class=\"comment\">#安装</span></span><br></pre></td></tr></tbody></table></figure>\n<p>编辑 GRUB引导菜单，将 default=1 改成 default=0<br><code>vi /etc/grub.conf</code> </p>\n<p>你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单</p>\n<p><code>reboot</code> #重启</p>\n<p>至此，CentOS 6.4 升级到 3.x Kernel 完成。</p>\n<h4 id=\"4-补充\"><a href=\"#4-补充\" class=\"headerlink\" title=\"4.补充\"></a>4.补充</h4><p>如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：</p>\n<p><span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span></p>\n<p>从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见<a href=\"http://delxu.blog.51cto.com/975660/288682/\" title=\"图解VMware内存机制\">这篇文章</a>），可能的原因有2个：</p>\n<p>首先，确认你的 .config 文件里面有 &nbsp;**CONFIG_VMWARE_BALLOON=m **这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers&nbsp;-&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *</p>\n<p>其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> /lib/modules/3.x.xx/kernel/drivers/misc <span class=\"comment\">#将版本号改成你自己的</span></span><br><span class=\"line\"><span class=\"built_in\">ln</span> -s vmw_balloon.ko vmware_balloon.ko <span class=\"comment\">#建立软连接</span></span><br></pre></td></tr></tbody></table></figure>\n<p><strong>Tips:</strong></p>\n<p>如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：<br><code>grep -R --include=Makefile '\\bNAME\\.o\\b'</code></p>\n</body></html>"},{"title":"CRM Contacts and Accounts are not showing up in Outlook?","id":"70","date":"2008-09-08T03:09:11.000Z","_content":"\nIn Outlook, go to Tools|Address Book. From the drop-down list, choose the \"CRM Contacts\" Address Book. Is it blank?\n\n&nbsp;\n\nIf so, there's an easy way to correct the problem.\n\n1.  In Outlook, choose Options from the CRM Menu\n2.  <div>Click on the Address Book tab:</div>\n3.  Select \"Match all contacts in Microsoft Dynamics CRM\" and \"Match all items in Microsoft Dynamics CRM\"\n4.  Click OK\n5.  Synchronize with CRM by choose \"Synchronize with CRM\" from the CRM menu\n6.  <div>Return to CRM Address book. You should now see entries there.</div>\nYou might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.","source":"_posts/crm-contacts-and-accounts-are-not-showing-up-in-outlook.md","raw":"---\ntitle: CRM Contacts and Accounts are not showing up in Outlook?\nid: 70\ncategories:\n  - MSCRM\ndate: 2008-09-08 11:09:11\ntags:\n---\n\nIn Outlook, go to Tools|Address Book. From the drop-down list, choose the \"CRM Contacts\" Address Book. Is it blank?\n\n&nbsp;\n\nIf so, there's an easy way to correct the problem.\n\n1.  In Outlook, choose Options from the CRM Menu\n2.  <div>Click on the Address Book tab:</div>\n3.  Select \"Match all contacts in Microsoft Dynamics CRM\" and \"Match all items in Microsoft Dynamics CRM\"\n4.  Click OK\n5.  Synchronize with CRM by choose \"Synchronize with CRM\" from the CRM menu\n6.  <div>Return to CRM Address book. You should now see entries there.</div>\nYou might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.","slug":"crm-contacts-and-accounts-are-not-showing-up-in-outlook","published":1,"updated":"2020-01-05T09:00:53.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt8000bk84s4kd55lpo","content":"<html><head></head><body><p>In Outlook, go to Tools|Address Book. From the drop-down list, choose the “CRM Contacts” Address Book. Is it blank?</p>\n<p>&amp;nbsp;</p>\n<p>If so, there’s an easy way to correct the problem.</p>\n<ol>\n<li>In Outlook, choose Options from the CRM Menu</li>\n<li><div>Click on the Address Book tab:</div></li>\n<li>Select “Match all contacts in Microsoft Dynamics CRM” and “Match all items in Microsoft Dynamics CRM”</li>\n<li>Click OK</li>\n<li>Synchronize with CRM by choose “Synchronize with CRM” from the CRM menu</li>\n<li><div>Return to CRM Address book. You should now see entries there.</div>\nYou might need to synch several times before they all get there.&nbsp; This setting is not set by default in 4.0 for some reason.</li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>In Outlook, go to Tools|Address Book. From the drop-down list, choose the “CRM Contacts” Address Book. Is it blank?</p>\n<p>&amp;nbsp;</p>\n<p>If so, there’s an easy way to correct the problem.</p>\n<ol>\n<li>In Outlook, choose Options from the CRM Menu</li>\n<li><div>Click on the Address Book tab:</div></li>\n<li>Select “Match all contacts in Microsoft Dynamics CRM” and “Match all items in Microsoft Dynamics CRM”</li>\n<li>Click OK</li>\n<li>Synchronize with CRM by choose “Synchronize with CRM” from the CRM menu</li>\n<li><div>Return to CRM Address book. You should now see entries there.</div>\nYou might need to synch several times before they all get there.&nbsp; This setting is not set by default in 4.0 for some reason.</li>\n</ol>\n</body></html>"},{"title":"在 GitHub Pages 上面搭建 Hexo 静态博客","date":"2017-07-08T03:46:31.000Z","_content":"### 前言\n本站迁移至 GitHub Pages 已经月余，毕竟是静态页面，访问速度令人满意，不过其搭建和发布还是不同于传统的博客程序，在此记录下搭建过程。\n\n### 介绍\nGitHub Pages 本用于介绍托管在 GitHub 的项目，也可以用来搭建博客，有1GB 的免费空间。官方推荐使用 [Jekyll](http://jekyllrb.com/) 来搭建，不过我看上了 Hexo 的主题，所以选了它。\n\nHexo 是一个基于 Node.js 的快速、简洁且高效的博客框架，使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页并托管在 Github Pages 和 Heroku 等平台上。Hexo 作者是来自台湾的 [tommy351](https://github.com/tommy351)。\n\n<!--more-->\n\n### GitHub Pages 设置\n1. 首先你需要注册一个 GitHub 帐号；\n2. 新建一个与你用户名对应的仓库，仓库名必须为 **username.github.io**；\n3. 在仓库中新建一个分支，比如 hexo；\n4. 将该分支设置成缺省分支；\n\n>上面最后两个操作的用意是将 hexo 分支用作 Hexo 博客源码的备份分支，将原来的默认缺省分支 master 作为发布静态内容的目标分支，这样你可以很方便的切换你的写作环境到另外一台电脑。\n\n### Hexo 安装\n因为 GitHub Pages 是纯静态托管平台，不能像传统博客程序那样，找个浏览器就可以写，所以需要搭建能发布静态内容的环境，我们这里用 Hexo 来生成静态内容并发布到 GitHub Pages。\n\n#### 安装 Git\n我使用的发行版是 Ubuntu 16.04 LTS （Xenial Xerus），所以安装 Git 的命令就很简单 `$ sudo apt-get install git-core`\n\n#### 安装 Node.js\n最好的方法是使用 [ Node Version Manager](https://github.com/creationix/nvm)。\n\n##### cURL:\n`$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash`\n\n##### Wget:\n\n`$ wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash`\n\n当 nvm 装好以后，关掉 terminal 终端窗口再重新打开，运行以下命令安装 Node.js：\n\n`$ nvm install stable`\n\n#### 安装 Hexo\n`$ npm install -g hexo-cli`\n\n如果你的网络访问 npm 源比较慢，你可以使用淘宝的 NPM 镜像（每10分钟与官方源同步一次）来安装：\n\n`npm install -g hexo-cli --registry=https://registry.npm.taobao.org`\n\n#### Hexo 初始化\n当 Hexo 安装好以后，运行 hexo init `<folder>` 来初始化。\n\n``` bash\n$ hexo init <folder>\n$ cd <folder>\n$ npm install\n```\n\n初始化之后，目录结构看起来应该像下面的样子:\n\n``` plain\n.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n##### _config.yml\n\n网站的**配置**信息，您可以在此配置大部分的参数。\n\n##### package.json\n应用程序的信息。[EJS](http://embeddedjs.com/), [Stylus](http://learnboost.github.io/stylus/) 和 [Markdown](http://daringfireball.net/projects/markdown/) renderer 已默认安装，您可以自由移除。\n\n``` json\n{\n  \"name\": \"hexo-site\",\n  \"version\": \"0.0.0\",\n  \"private\": true,\n  \"hexo\": {\n    \"version\": \"\"\n  },\n  \"dependencies\": {\n    \"hexo\": \"^3.0.0\",\n    \"hexo-generator-archive\": \"^0.1.0\",\n    \"hexo-generator-category\": \"^0.1.0\",\n    \"hexo-generator-index\": \"^0.1.0\",\n    \"hexo-generator-tag\": \"^0.1.0\",\n    \"hexo-renderer-ejs\": \"^0.1.0\",\n    \"hexo-renderer-stylus\": \"^0.2.0\",\n    \"hexo-renderer-marked\": \"^0.2.4\",\n    \"hexo-server\": \"^0.1.2\"\n  }\n}\n```\n\n##### scaffolds\n\n**模版**文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n\nHexo的模板是指在新建的markdown文件中默认填充的内容。例如，如果您修改scaffold/post.md中的Front-matter内容，那么每次新建一篇文章时都会包含这个修改。\n\n##### source\n\n资源文件夹是存放用户资源的地方。除 `_posts` 文件夹之外，开头命名为 `_` (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 `public` 文件夹，而其他文件会被拷贝过去。\n\n##### themes\n\n**主题**文件夹。Hexo 会根据主题来生成静态页面。\n\n更多关于 Hexo 建站和配置的详细信息，可以参考[官方文档](https://hexo.io/zh-cn/docs/setup.html)\n\n#### 发布 & 部署\n##### 新建文章\n\n``` bash\n$ hexo new [layout] <title>\n```\n\n新建一篇文章。如果没有设置 `layout` 的话，默认使用 [_config.yml](configuration.html) 中的 `default_layout` 参数代替。如果标题包含空格的话，请使用引号括起来。\n\n##### 生成静态内容\n\n``` bash\n$ hexo generate\n```\n生成静态文件。\n\n选项 | 描述\n--- | ---\n`-d`, `--deploy` | 文件生成后立即部署网站\n`-w`, `--watch` | 监视文件变动\n\n该命令可以简写为\n```bash\n$ hexo g\n```\n\n##### 本地调试\n\n``` bash\n$ hexo server\n```\n\n启动服务器。默认情况下，访问网址为： `http://localhost:4000/`。\n\n选项 | 描述\n--- | ---\n`-p`, `--port` | 重设端口\n`-s`, `--static` | 只使用静态文件\n`-l`, `--log` | 启动日记记录，使用覆盖记录格式\n\n##### 部署\n部署到 Github 前需要配置 **_config.yml** 文件，首先找到下面的内容\n``` plain\n# Deployment\n## Docs: http://hexo.io/docs/deployment.html\ndeploy:\n  type:\n```\n\n然后将它们修改为\n``` plain\n# Deployment\n## Docs: http://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo:https://github.com/randyzhong/randyzhong.github.io.git\n  branch: master\n```\n另外，还需要安装 git 部署插件：\n``` bash\n$ npm install hexo-deployer-git --save\n```\n\n**部署网站：**\n``` bash\n$ hexo deploy\n```\n\n参数 | 描述\n--- | ---\n`-g`, `--generate` | 部署之前预先生成静态文件\n\n生成静态文件并发布的命令可以简写为：\n```bash\n$ hexo -d g\n```\n\n### 附加配置\n本站使用了 maupassant 主题，并且安装了几个插件，所以 package.json 文件内容相比默认的有变化\n\n``` json\n{\n  \"name\": \"hexo-site\",\n  \"version\": \"0.0.0\",\n  \"private\": true,\n  \"hexo\": {\n    \"version\": \"3.3.8\"\n  },\n  \"dependencies\": {\n    \"hexo\": \"^3.2.0\",\n    \"hexo-asset-image\": \"0.0.3\",\n    \"hexo-deployer-git\": \"^0.3.1\",\n    \"hexo-generator-archive\": \"^0.1.4\",\n    \"hexo-generator-category\": \"^0.1.3\",\n    \"hexo-generator-feed\": \"^1.2.2\",\n    \"hexo-generator-index\": \"^0.2.0\",\n    \"hexo-generator-sitemap\": \"^1.2.0\",\n    \"hexo-generator-tag\": \"^0.2.0\",\n    \"hexo-helper-qrcode\": \"^1.0.2\",\n    \"hexo-renderer-ejs\": \"^0.3.1\",\n    \"hexo-renderer-jade\": \"^0.3.0\",\n    \"hexo-renderer-marked\": \"^0.3.0\",\n    \"hexo-renderer-sass\": \"^0.3.2\",\n    \"hexo-renderer-stylus\": \"^0.3.1\",\n    \"hexo-server\": \"^0.2.0\",\n    \"hexo-wordcount\": \"^3.0.2\"\n  }\n}\n```\n\n所以在安装了 Hexo 之后，可以运行如下命令添加这些插件：\n``` bash\n$ npm install hexo-asset-image --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-deployer-git --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-generator-feed --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-generator-sitemap --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-renderer-jade --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-renderer-stylus --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-wordcount --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-helper-qrcode --registry=https://registry.npm.taobao.org --save\n```\n\n#### CNAME 设置\n在发布完成以后，就可以使用 https://yourname.github.io 来访问你的主页了。\n如果你不想用 github.io 的二级域名，你可以使用自己的域名。\n1. 在Hexo 的 source 目录下创建 CNAME 文件。\n2. 填写自己的域名如 winotes.net 或者 www.winotes.net，保存退出。\n3. 登录你的域名解析商，比如 DNSPod，先添加域名，然后添加记录，设置如下：\n\n主机记录 | 记录类型 | 线路类型 | 记录值 | MX优先级 | TTL\n--- | ---\n@ | CNAME | 默认 | yourname.github.io. | - | 10\nwww | CNAME | 默认 | yourname.github.io. | - | 10\n\n当然，你也可以通过创建DNS A 记录直接指定 GitHub Pages 的 IP 来解析：\n* 192.30.252.153\n* 192.30.252.154\n\n### 博客源码备份\n``` bash\n$ git add .\n$ git commit -m \"comments\"\n$ git push original hexo\n```\n以下目录不用上传，所以在 .gitignore 里面排除掉即可：\n``` plain\n.git/\npublic/\n.deploy_git/\n```\n\n\n","source":"_posts/deploying-hexo-on-github.md","raw":"---\ntitle: 在 GitHub Pages 上面搭建 Hexo 静态博客\ntags:\n  - GitHub\n  - Hexo\ncategories:\n  - 网站相关\ndate: 2017-07-08 11:46:31\n---\n### 前言\n本站迁移至 GitHub Pages 已经月余，毕竟是静态页面，访问速度令人满意，不过其搭建和发布还是不同于传统的博客程序，在此记录下搭建过程。\n\n### 介绍\nGitHub Pages 本用于介绍托管在 GitHub 的项目，也可以用来搭建博客，有1GB 的免费空间。官方推荐使用 [Jekyll](http://jekyllrb.com/) 来搭建，不过我看上了 Hexo 的主题，所以选了它。\n\nHexo 是一个基于 Node.js 的快速、简洁且高效的博客框架，使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页并托管在 Github Pages 和 Heroku 等平台上。Hexo 作者是来自台湾的 [tommy351](https://github.com/tommy351)。\n\n<!--more-->\n\n### GitHub Pages 设置\n1. 首先你需要注册一个 GitHub 帐号；\n2. 新建一个与你用户名对应的仓库，仓库名必须为 **username.github.io**；\n3. 在仓库中新建一个分支，比如 hexo；\n4. 将该分支设置成缺省分支；\n\n>上面最后两个操作的用意是将 hexo 分支用作 Hexo 博客源码的备份分支，将原来的默认缺省分支 master 作为发布静态内容的目标分支，这样你可以很方便的切换你的写作环境到另外一台电脑。\n\n### Hexo 安装\n因为 GitHub Pages 是纯静态托管平台，不能像传统博客程序那样，找个浏览器就可以写，所以需要搭建能发布静态内容的环境，我们这里用 Hexo 来生成静态内容并发布到 GitHub Pages。\n\n#### 安装 Git\n我使用的发行版是 Ubuntu 16.04 LTS （Xenial Xerus），所以安装 Git 的命令就很简单 `$ sudo apt-get install git-core`\n\n#### 安装 Node.js\n最好的方法是使用 [ Node Version Manager](https://github.com/creationix/nvm)。\n\n##### cURL:\n`$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash`\n\n##### Wget:\n\n`$ wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash`\n\n当 nvm 装好以后，关掉 terminal 终端窗口再重新打开，运行以下命令安装 Node.js：\n\n`$ nvm install stable`\n\n#### 安装 Hexo\n`$ npm install -g hexo-cli`\n\n如果你的网络访问 npm 源比较慢，你可以使用淘宝的 NPM 镜像（每10分钟与官方源同步一次）来安装：\n\n`npm install -g hexo-cli --registry=https://registry.npm.taobao.org`\n\n#### Hexo 初始化\n当 Hexo 安装好以后，运行 hexo init `<folder>` 来初始化。\n\n``` bash\n$ hexo init <folder>\n$ cd <folder>\n$ npm install\n```\n\n初始化之后，目录结构看起来应该像下面的样子:\n\n``` plain\n.\n├── _config.yml\n├── package.json\n├── scaffolds\n├── source\n|   ├── _drafts\n|   └── _posts\n└── themes\n```\n##### _config.yml\n\n网站的**配置**信息，您可以在此配置大部分的参数。\n\n##### package.json\n应用程序的信息。[EJS](http://embeddedjs.com/), [Stylus](http://learnboost.github.io/stylus/) 和 [Markdown](http://daringfireball.net/projects/markdown/) renderer 已默认安装，您可以自由移除。\n\n``` json\n{\n  \"name\": \"hexo-site\",\n  \"version\": \"0.0.0\",\n  \"private\": true,\n  \"hexo\": {\n    \"version\": \"\"\n  },\n  \"dependencies\": {\n    \"hexo\": \"^3.0.0\",\n    \"hexo-generator-archive\": \"^0.1.0\",\n    \"hexo-generator-category\": \"^0.1.0\",\n    \"hexo-generator-index\": \"^0.1.0\",\n    \"hexo-generator-tag\": \"^0.1.0\",\n    \"hexo-renderer-ejs\": \"^0.1.0\",\n    \"hexo-renderer-stylus\": \"^0.2.0\",\n    \"hexo-renderer-marked\": \"^0.2.4\",\n    \"hexo-server\": \"^0.1.2\"\n  }\n}\n```\n\n##### scaffolds\n\n**模版**文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。\n\nHexo的模板是指在新建的markdown文件中默认填充的内容。例如，如果您修改scaffold/post.md中的Front-matter内容，那么每次新建一篇文章时都会包含这个修改。\n\n##### source\n\n资源文件夹是存放用户资源的地方。除 `_posts` 文件夹之外，开头命名为 `_` (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 `public` 文件夹，而其他文件会被拷贝过去。\n\n##### themes\n\n**主题**文件夹。Hexo 会根据主题来生成静态页面。\n\n更多关于 Hexo 建站和配置的详细信息，可以参考[官方文档](https://hexo.io/zh-cn/docs/setup.html)\n\n#### 发布 & 部署\n##### 新建文章\n\n``` bash\n$ hexo new [layout] <title>\n```\n\n新建一篇文章。如果没有设置 `layout` 的话，默认使用 [_config.yml](configuration.html) 中的 `default_layout` 参数代替。如果标题包含空格的话，请使用引号括起来。\n\n##### 生成静态内容\n\n``` bash\n$ hexo generate\n```\n生成静态文件。\n\n选项 | 描述\n--- | ---\n`-d`, `--deploy` | 文件生成后立即部署网站\n`-w`, `--watch` | 监视文件变动\n\n该命令可以简写为\n```bash\n$ hexo g\n```\n\n##### 本地调试\n\n``` bash\n$ hexo server\n```\n\n启动服务器。默认情况下，访问网址为： `http://localhost:4000/`。\n\n选项 | 描述\n--- | ---\n`-p`, `--port` | 重设端口\n`-s`, `--static` | 只使用静态文件\n`-l`, `--log` | 启动日记记录，使用覆盖记录格式\n\n##### 部署\n部署到 Github 前需要配置 **_config.yml** 文件，首先找到下面的内容\n``` plain\n# Deployment\n## Docs: http://hexo.io/docs/deployment.html\ndeploy:\n  type:\n```\n\n然后将它们修改为\n``` plain\n# Deployment\n## Docs: http://hexo.io/docs/deployment.html\ndeploy:\n  type: git\n  repo:https://github.com/randyzhong/randyzhong.github.io.git\n  branch: master\n```\n另外，还需要安装 git 部署插件：\n``` bash\n$ npm install hexo-deployer-git --save\n```\n\n**部署网站：**\n``` bash\n$ hexo deploy\n```\n\n参数 | 描述\n--- | ---\n`-g`, `--generate` | 部署之前预先生成静态文件\n\n生成静态文件并发布的命令可以简写为：\n```bash\n$ hexo -d g\n```\n\n### 附加配置\n本站使用了 maupassant 主题，并且安装了几个插件，所以 package.json 文件内容相比默认的有变化\n\n``` json\n{\n  \"name\": \"hexo-site\",\n  \"version\": \"0.0.0\",\n  \"private\": true,\n  \"hexo\": {\n    \"version\": \"3.3.8\"\n  },\n  \"dependencies\": {\n    \"hexo\": \"^3.2.0\",\n    \"hexo-asset-image\": \"0.0.3\",\n    \"hexo-deployer-git\": \"^0.3.1\",\n    \"hexo-generator-archive\": \"^0.1.4\",\n    \"hexo-generator-category\": \"^0.1.3\",\n    \"hexo-generator-feed\": \"^1.2.2\",\n    \"hexo-generator-index\": \"^0.2.0\",\n    \"hexo-generator-sitemap\": \"^1.2.0\",\n    \"hexo-generator-tag\": \"^0.2.0\",\n    \"hexo-helper-qrcode\": \"^1.0.2\",\n    \"hexo-renderer-ejs\": \"^0.3.1\",\n    \"hexo-renderer-jade\": \"^0.3.0\",\n    \"hexo-renderer-marked\": \"^0.3.0\",\n    \"hexo-renderer-sass\": \"^0.3.2\",\n    \"hexo-renderer-stylus\": \"^0.3.1\",\n    \"hexo-server\": \"^0.2.0\",\n    \"hexo-wordcount\": \"^3.0.2\"\n  }\n}\n```\n\n所以在安装了 Hexo 之后，可以运行如下命令添加这些插件：\n``` bash\n$ npm install hexo-asset-image --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-deployer-git --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-generator-feed --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-generator-sitemap --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-renderer-jade --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-renderer-stylus --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-wordcount --registry=https://registry.npm.taobao.org --save\n$ npm install hexo-helper-qrcode --registry=https://registry.npm.taobao.org --save\n```\n\n#### CNAME 设置\n在发布完成以后，就可以使用 https://yourname.github.io 来访问你的主页了。\n如果你不想用 github.io 的二级域名，你可以使用自己的域名。\n1. 在Hexo 的 source 目录下创建 CNAME 文件。\n2. 填写自己的域名如 winotes.net 或者 www.winotes.net，保存退出。\n3. 登录你的域名解析商，比如 DNSPod，先添加域名，然后添加记录，设置如下：\n\n主机记录 | 记录类型 | 线路类型 | 记录值 | MX优先级 | TTL\n--- | ---\n@ | CNAME | 默认 | yourname.github.io. | - | 10\nwww | CNAME | 默认 | yourname.github.io. | - | 10\n\n当然，你也可以通过创建DNS A 记录直接指定 GitHub Pages 的 IP 来解析：\n* 192.30.252.153\n* 192.30.252.154\n\n### 博客源码备份\n``` bash\n$ git add .\n$ git commit -m \"comments\"\n$ git push original hexo\n```\n以下目录不用上传，所以在 .gitignore 里面排除掉即可：\n``` plain\n.git/\npublic/\n.deploy_git/\n```\n\n\n","slug":"deploying-hexo-on-github","published":1,"updated":"2020-01-05T09:00:53.942Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kt9000ck84s2vs57rn3","content":"<html><head></head><body><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>本站迁移至 GitHub Pages 已经月余，毕竟是静态页面，访问速度令人满意，不过其搭建和发布还是不同于传统的博客程序，在此记录下搭建过程。</p>\n<h3 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h3><p>GitHub Pages 本用于介绍托管在 GitHub 的项目，也可以用来搭建博客，有1GB 的免费空间。官方推荐使用 <a href=\"http://jekyllrb.com/\">Jekyll</a> 来搭建，不过我看上了 Hexo 的主题，所以选了它。</p>\n<p>Hexo 是一个基于 Node.js 的快速、简洁且高效的博客框架，使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页并托管在 Github Pages 和 Heroku 等平台上。Hexo 作者是来自台湾的 <a href=\"https://github.com/tommy351\">tommy351</a>。</p>\n<span id=\"more\"></span>\n\n<h3 id=\"GitHub-Pages-设置\"><a href=\"#GitHub-Pages-设置\" class=\"headerlink\" title=\"GitHub Pages 设置\"></a>GitHub Pages 设置</h3><ol>\n<li>首先你需要注册一个 GitHub 帐号；</li>\n<li>新建一个与你用户名对应的仓库，仓库名必须为 <strong>username.github.io</strong>；</li>\n<li>在仓库中新建一个分支，比如 hexo；</li>\n<li>将该分支设置成缺省分支；</li>\n</ol>\n<blockquote>\n<p>上面最后两个操作的用意是将 hexo 分支用作 Hexo 博客源码的备份分支，将原来的默认缺省分支 master 作为发布静态内容的目标分支，这样你可以很方便的切换你的写作环境到另外一台电脑。</p>\n</blockquote>\n<h3 id=\"Hexo-安装\"><a href=\"#Hexo-安装\" class=\"headerlink\" title=\"Hexo 安装\"></a>Hexo 安装</h3><p>因为 GitHub Pages 是纯静态托管平台，不能像传统博客程序那样，找个浏览器就可以写，所以需要搭建能发布静态内容的环境，我们这里用 Hexo 来生成静态内容并发布到 GitHub Pages。</p>\n<h4 id=\"安装-Git\"><a href=\"#安装-Git\" class=\"headerlink\" title=\"安装 Git\"></a>安装 Git</h4><p>我使用的发行版是 Ubuntu 16.04 LTS （Xenial Xerus），所以安装 Git 的命令就很简单 <code>$ sudo apt-get install git-core</code></p>\n<h4 id=\"安装-Node-js\"><a href=\"#安装-Node-js\" class=\"headerlink\" title=\"安装 Node.js\"></a>安装 Node.js</h4><p>最好的方法是使用 <a href=\"https://github.com/creationix/nvm\"> Node Version Manager</a>。</p>\n<h5 id=\"cURL\"><a href=\"#cURL\" class=\"headerlink\" title=\"cURL:\"></a>cURL:</h5><p><code>$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</code></p>\n<h5 id=\"Wget\"><a href=\"#Wget\" class=\"headerlink\" title=\"Wget:\"></a>Wget:</h5><p><code>$ wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</code></p>\n<p>当 nvm 装好以后，关掉 terminal 终端窗口再重新打开，运行以下命令安装 Node.js：</p>\n<p><code>$ nvm install stable</code></p>\n<h4 id=\"安装-Hexo\"><a href=\"#安装-Hexo\" class=\"headerlink\" title=\"安装 Hexo\"></a>安装 Hexo</h4><p><code>$ npm install -g hexo-cli</code></p>\n<p>如果你的网络访问 npm 源比较慢，你可以使用淘宝的 NPM 镜像（每10分钟与官方源同步一次）来安装：</p>\n<p><code>npm install -g hexo-cli --registry=https://registry.npm.taobao.org</code></p>\n<h4 id=\"Hexo-初始化\"><a href=\"#Hexo-初始化\" class=\"headerlink\" title=\"Hexo 初始化\"></a>Hexo 初始化</h4><p>当 Hexo 安装好以后，运行 hexo init <code>&lt;folder&gt;</code> 来初始化。</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo init &lt;folder&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> &lt;folder&gt;</span><br><span class=\"line\">$ npm install</span><br></pre></td></tr></tbody></table></figure>\n\n<p>初始化之后，目录结构看起来应该像下面的样子:</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── _config.yml</span><br><span class=\"line\">├── package.json</span><br><span class=\"line\">├── scaffolds</span><br><span class=\"line\">├── source</span><br><span class=\"line\">|   ├── _drafts</span><br><span class=\"line\">|   └── _posts</span><br><span class=\"line\">└── themes</span><br></pre></td></tr></tbody></table></figure>\n<h5 id=\"config-yml\"><a href=\"#config-yml\" class=\"headerlink\" title=\"_config.yml\"></a>_config.yml</h5><p>网站的<strong>配置</strong>信息，您可以在此配置大部分的参数。</p>\n<h5 id=\"package-json\"><a href=\"#package-json\" class=\"headerlink\" title=\"package.json\"></a>package.json</h5><p>应用程序的信息。<a href=\"http://embeddedjs.com/\">EJS</a>, <a href=\"http://learnboost.github.io/stylus/\">Stylus</a> 和 <a href=\"http://daringfireball.net/projects/markdown/\">Markdown</a> renderer 已默认安装，您可以自由移除。</p>\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo-site\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"0.0.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"private\"</span><span class=\"punctuation\">:</span> <span class=\"keyword\">true</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^3.0.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-archive\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-category\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-index\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-tag\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-ejs\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-stylus\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-marked\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.4\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-server\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.2\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h5 id=\"scaffolds\"><a href=\"#scaffolds\" class=\"headerlink\" title=\"scaffolds\"></a>scaffolds</h5><p><strong>模版</strong>文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。</p>\n<p>Hexo的模板是指在新建的markdown文件中默认填充的内容。例如，如果您修改scaffold/post.md中的Front-matter内容，那么每次新建一篇文章时都会包含这个修改。</p>\n<h5 id=\"source\"><a href=\"#source\" class=\"headerlink\" title=\"source\"></a>source</h5><p>资源文件夹是存放用户资源的地方。除 <code>_posts</code> 文件夹之外，开头命名为 <code>_</code> (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 <code>public</code> 文件夹，而其他文件会被拷贝过去。</p>\n<h5 id=\"themes\"><a href=\"#themes\" class=\"headerlink\" title=\"themes\"></a>themes</h5><p><strong>主题</strong>文件夹。Hexo 会根据主题来生成静态页面。</p>\n<p>更多关于 Hexo 建站和配置的详细信息，可以参考<a href=\"https://hexo.io/zh-cn/docs/setup.html\">官方文档</a></p>\n<h4 id=\"发布-amp-部署\"><a href=\"#发布-amp-部署\" class=\"headerlink\" title=\"发布 &amp; 部署\"></a>发布 &amp; 部署</h4><h5 id=\"新建文章\"><a href=\"#新建文章\" class=\"headerlink\" title=\"新建文章\"></a>新建文章</h5><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></tbody></table></figure>\n\n<p>新建一篇文章。如果没有设置 <code>layout</code> 的话，默认使用 <a href=\"configuration.html\">_config.yml</a> 中的 <code>default_layout</code> 参数代替。如果标题包含空格的话，请使用引号括起来。</p>\n<h5 id=\"生成静态内容\"><a href=\"#生成静态内容\" class=\"headerlink\" title=\"生成静态内容\"></a>生成静态内容</h5><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></tbody></table></figure>\n<p>生成静态文件。</p>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-d</code>, <code>--deploy</code></td>\n<td>文件生成后立即部署网站</td>\n</tr>\n<tr>\n<td><code>-w</code>, <code>--watch</code></td>\n<td>监视文件变动</td>\n</tr>\n</tbody></table>\n<p>该命令可以简写为</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo g</span><br></pre></td></tr></tbody></table></figure>\n\n<h5 id=\"本地调试\"><a href=\"#本地调试\" class=\"headerlink\" title=\"本地调试\"></a>本地调试</h5><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></tbody></table></figure>\n\n<p>启动服务器。默认情况下，访问网址为： <code>http://localhost:4000/</code>。</p>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-p</code>, <code>--port</code></td>\n<td>重设端口</td>\n</tr>\n<tr>\n<td><code>-s</code>, <code>--static</code></td>\n<td>只使用静态文件</td>\n</tr>\n<tr>\n<td><code>-l</code>, <code>--log</code></td>\n<td>启动日记记录，使用覆盖记录格式</td>\n</tr>\n</tbody></table>\n<h5 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h5><p>部署到 Github 前需要配置 <strong>_config.yml</strong> 文件，首先找到下面的内容</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: http://hexo.io/docs/deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type:</span><br></pre></td></tr></tbody></table></figure>\n\n<p>然后将它们修改为</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: http://hexo.io/docs/deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo:https://github.com/randyzhong/randyzhong.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></tbody></table></figure>\n<p>另外，还需要安装 git 部署插件：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></tbody></table></figure>\n\n<p><strong>部署网站：</strong></p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></tbody></table></figure>\n\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-g</code>, <code>--generate</code></td>\n<td>部署之前预先生成静态文件</td>\n</tr>\n</tbody></table>\n<p>生成静态文件并发布的命令可以简写为：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo -d g</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"附加配置\"><a href=\"#附加配置\" class=\"headerlink\" title=\"附加配置\"></a>附加配置</h3><p>本站使用了 maupassant 主题，并且安装了几个插件，所以 package.json 文件内容相比默认的有变化</p>\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo-site\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"0.0.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"private\"</span><span class=\"punctuation\">:</span> <span class=\"keyword\">true</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"3.3.8\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^3.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-asset-image\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"0.0.3\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-deployer-git\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.1\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-archive\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.4\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-category\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.3\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-feed\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^1.2.2\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-index\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-sitemap\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^1.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-tag\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-helper-qrcode\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^1.0.2\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-ejs\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.1\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-jade\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-marked\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-sass\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.2\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-stylus\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.1\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-server\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-wordcount\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^3.0.2\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>所以在安装了 Hexo 之后，可以运行如下命令添加这些插件：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-asset-image --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-deployer-git --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-generator-feed --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-generator-sitemap --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-renderer-jade --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-renderer-stylus --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-wordcount --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-helper-qrcode --registry=https://registry.npm.taobao.org --save</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"CNAME-设置\"><a href=\"#CNAME-设置\" class=\"headerlink\" title=\"CNAME 设置\"></a>CNAME 设置</h4><p>在发布完成以后，就可以使用 <a href=\"https://yourname.github.io/\">https://yourname.github.io</a> 来访问你的主页了。<br>如果你不想用 github.io 的二级域名，你可以使用自己的域名。</p>\n<ol>\n<li>在Hexo 的 source 目录下创建 CNAME 文件。</li>\n<li>填写自己的域名如 winotes.net 或者 <a href=\"http://www.winotes.net,保存退出./\">www.winotes.net，保存退出。</a></li>\n<li>登录你的域名解析商，比如 DNSPod，先添加域名，然后添加记录，设置如下：</li>\n</ol>\n<p>主机记录 | 记录类型 | 线路类型 | 记录值 | MX优先级 | TTL<br>— | —<br>@ | CNAME | 默认 | yourname.github.io. | - | 10<br>www | CNAME | 默认 | yourname.github.io. | - | 10</p>\n<p>当然，你也可以通过创建DNS A 记录直接指定 GitHub Pages 的 IP 来解析：</p>\n<ul>\n<li>192.30.252.153</li>\n<li>192.30.252.154</li>\n</ul>\n<h3 id=\"博客源码备份\"><a href=\"#博客源码备份\" class=\"headerlink\" title=\"博客源码备份\"></a>博客源码备份</h3><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git add .</span><br><span class=\"line\">$ git commit -m <span class=\"string\">\"comments\"</span></span><br><span class=\"line\">$ git push original hexo</span><br></pre></td></tr></tbody></table></figure>\n<p>以下目录不用上传，所以在 .gitignore 里面排除掉即可：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.git/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy_git/</span><br></pre></td></tr></tbody></table></figure>\n\n\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>本站迁移至 GitHub Pages 已经月余，毕竟是静态页面，访问速度令人满意，不过其搭建和发布还是不同于传统的博客程序，在此记录下搭建过程。</p>\n<h3 id=\"介绍\"><a href=\"#介绍\" class=\"headerlink\" title=\"介绍\"></a>介绍</h3><p>GitHub Pages 本用于介绍托管在 GitHub 的项目，也可以用来搭建博客，有1GB 的免费空间。官方推荐使用 <a href=\"http://jekyllrb.com/\">Jekyll</a> 来搭建，不过我看上了 Hexo 的主题，所以选了它。</p>\n<p>Hexo 是一个基于 Node.js 的快速、简洁且高效的博客框架，使用 Markdown（或其他渲染引擎）解析文章，在几秒内，即可利用靓丽的主题生成静态网页并托管在 Github Pages 和 Heroku 等平台上。Hexo 作者是来自台湾的 <a href=\"https://github.com/tommy351\">tommy351</a>。</p></body></html>","more":"<html><head></head><body><h3 id=\"GitHub-Pages-设置\"><a href=\"#GitHub-Pages-设置\" class=\"headerlink\" title=\"GitHub Pages 设置\"></a>GitHub Pages 设置</h3><ol>\n<li>首先你需要注册一个 GitHub 帐号；</li>\n<li>新建一个与你用户名对应的仓库，仓库名必须为 <strong>username.github.io</strong>；</li>\n<li>在仓库中新建一个分支，比如 hexo；</li>\n<li>将该分支设置成缺省分支；</li>\n</ol>\n<blockquote>\n<p>上面最后两个操作的用意是将 hexo 分支用作 Hexo 博客源码的备份分支，将原来的默认缺省分支 master 作为发布静态内容的目标分支，这样你可以很方便的切换你的写作环境到另外一台电脑。</p>\n</blockquote>\n<h3 id=\"Hexo-安装\"><a href=\"#Hexo-安装\" class=\"headerlink\" title=\"Hexo 安装\"></a>Hexo 安装</h3><p>因为 GitHub Pages 是纯静态托管平台，不能像传统博客程序那样，找个浏览器就可以写，所以需要搭建能发布静态内容的环境，我们这里用 Hexo 来生成静态内容并发布到 GitHub Pages。</p>\n<h4 id=\"安装-Git\"><a href=\"#安装-Git\" class=\"headerlink\" title=\"安装 Git\"></a>安装 Git</h4><p>我使用的发行版是 Ubuntu 16.04 LTS （Xenial Xerus），所以安装 Git 的命令就很简单 <code>$ sudo apt-get install git-core</code></p>\n<h4 id=\"安装-Node-js\"><a href=\"#安装-Node-js\" class=\"headerlink\" title=\"安装 Node.js\"></a>安装 Node.js</h4><p>最好的方法是使用 <a href=\"https://github.com/creationix/nvm\"> Node Version Manager</a>。</p>\n<h5 id=\"cURL\"><a href=\"#cURL\" class=\"headerlink\" title=\"cURL:\"></a>cURL:</h5><p><code>$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</code></p>\n<h5 id=\"Wget\"><a href=\"#Wget\" class=\"headerlink\" title=\"Wget:\"></a>Wget:</h5><p><code>$ wget -qO- https://raw.githubusercontent.com/creationix/nvm/v0.33.2/install.sh | bash</code></p>\n<p>当 nvm 装好以后，关掉 terminal 终端窗口再重新打开，运行以下命令安装 Node.js：</p>\n<p><code>$ nvm install stable</code></p>\n<h4 id=\"安装-Hexo\"><a href=\"#安装-Hexo\" class=\"headerlink\" title=\"安装 Hexo\"></a>安装 Hexo</h4><p><code>$ npm install -g hexo-cli</code></p>\n<p>如果你的网络访问 npm 源比较慢，你可以使用淘宝的 NPM 镜像（每10分钟与官方源同步一次）来安装：</p>\n<p><code>npm install -g hexo-cli --registry=https://registry.npm.taobao.org</code></p>\n<h4 id=\"Hexo-初始化\"><a href=\"#Hexo-初始化\" class=\"headerlink\" title=\"Hexo 初始化\"></a>Hexo 初始化</h4><p>当 Hexo 安装好以后，运行 hexo init <code>&lt;folder&gt;</code> 来初始化。</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo init &lt;folder&gt;</span><br><span class=\"line\">$ <span class=\"built_in\">cd</span> &lt;folder&gt;</span><br><span class=\"line\">$ npm install</span><br></pre></td></tr></tbody></table></figure>\n\n<p>初始化之后，目录结构看起来应该像下面的样子:</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.</span><br><span class=\"line\">├── _config.yml</span><br><span class=\"line\">├── package.json</span><br><span class=\"line\">├── scaffolds</span><br><span class=\"line\">├── source</span><br><span class=\"line\">|   ├── _drafts</span><br><span class=\"line\">|   └── _posts</span><br><span class=\"line\">└── themes</span><br></pre></td></tr></tbody></table></figure>\n<h5 id=\"config-yml\"><a href=\"#config-yml\" class=\"headerlink\" title=\"_config.yml\"></a>_config.yml</h5><p>网站的<strong>配置</strong>信息，您可以在此配置大部分的参数。</p>\n<h5 id=\"package-json\"><a href=\"#package-json\" class=\"headerlink\" title=\"package.json\"></a>package.json</h5><p>应用程序的信息。<a href=\"http://embeddedjs.com/\">EJS</a>, <a href=\"http://learnboost.github.io/stylus/\">Stylus</a> 和 <a href=\"http://daringfireball.net/projects/markdown/\">Markdown</a> renderer 已默认安装，您可以自由移除。</p>\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo-site\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"0.0.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"private\"</span><span class=\"punctuation\">:</span> <span class=\"keyword\">true</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^3.0.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-archive\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-category\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-index\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-tag\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-ejs\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-stylus\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-marked\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.4\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-server\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.2\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h5 id=\"scaffolds\"><a href=\"#scaffolds\" class=\"headerlink\" title=\"scaffolds\"></a>scaffolds</h5><p><strong>模版</strong>文件夹。当您新建文章时，Hexo 会根据 scaffold 来建立文件。</p>\n<p>Hexo的模板是指在新建的markdown文件中默认填充的内容。例如，如果您修改scaffold/post.md中的Front-matter内容，那么每次新建一篇文章时都会包含这个修改。</p>\n<h5 id=\"source\"><a href=\"#source\" class=\"headerlink\" title=\"source\"></a>source</h5><p>资源文件夹是存放用户资源的地方。除 <code>_posts</code> 文件夹之外，开头命名为 <code>_</code> (下划线)的文件 / 文件夹和隐藏的文件将会被忽略。Markdown 和 HTML 文件会被解析并放到 <code>public</code> 文件夹，而其他文件会被拷贝过去。</p>\n<h5 id=\"themes\"><a href=\"#themes\" class=\"headerlink\" title=\"themes\"></a>themes</h5><p><strong>主题</strong>文件夹。Hexo 会根据主题来生成静态页面。</p>\n<p>更多关于 Hexo 建站和配置的详细信息，可以参考<a href=\"https://hexo.io/zh-cn/docs/setup.html\">官方文档</a></p>\n<h4 id=\"发布-amp-部署\"><a href=\"#发布-amp-部署\" class=\"headerlink\" title=\"发布 &amp; 部署\"></a>发布 &amp; 部署</h4><h5 id=\"新建文章\"><a href=\"#新建文章\" class=\"headerlink\" title=\"新建文章\"></a>新建文章</h5><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new [layout] &lt;title&gt;</span><br></pre></td></tr></tbody></table></figure>\n\n<p>新建一篇文章。如果没有设置 <code>layout</code> 的话，默认使用 <a href=\"configuration.html\">_config.yml</a> 中的 <code>default_layout</code> 参数代替。如果标题包含空格的话，请使用引号括起来。</p>\n<h5 id=\"生成静态内容\"><a href=\"#生成静态内容\" class=\"headerlink\" title=\"生成静态内容\"></a>生成静态内容</h5><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo generate</span><br></pre></td></tr></tbody></table></figure>\n<p>生成静态文件。</p>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-d</code>, <code>--deploy</code></td>\n<td>文件生成后立即部署网站</td>\n</tr>\n<tr>\n<td><code>-w</code>, <code>--watch</code></td>\n<td>监视文件变动</td>\n</tr>\n</tbody></table>\n<p>该命令可以简写为</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo g</span><br></pre></td></tr></tbody></table></figure>\n\n<h5 id=\"本地调试\"><a href=\"#本地调试\" class=\"headerlink\" title=\"本地调试\"></a>本地调试</h5><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></tbody></table></figure>\n\n<p>启动服务器。默认情况下，访问网址为： <code>http://localhost:4000/</code>。</p>\n<table>\n<thead>\n<tr>\n<th>选项</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-p</code>, <code>--port</code></td>\n<td>重设端口</td>\n</tr>\n<tr>\n<td><code>-s</code>, <code>--static</code></td>\n<td>只使用静态文件</td>\n</tr>\n<tr>\n<td><code>-l</code>, <code>--log</code></td>\n<td>启动日记记录，使用覆盖记录格式</td>\n</tr>\n</tbody></table>\n<h5 id=\"部署\"><a href=\"#部署\" class=\"headerlink\" title=\"部署\"></a>部署</h5><p>部署到 Github 前需要配置 <strong>_config.yml</strong> 文件，首先找到下面的内容</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: http://hexo.io/docs/deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type:</span><br></pre></td></tr></tbody></table></figure>\n\n<p>然后将它们修改为</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Deployment</span><br><span class=\"line\">## Docs: http://hexo.io/docs/deployment.html</span><br><span class=\"line\">deploy:</span><br><span class=\"line\">  type: git</span><br><span class=\"line\">  repo:https://github.com/randyzhong/randyzhong.github.io.git</span><br><span class=\"line\">  branch: master</span><br></pre></td></tr></tbody></table></figure>\n<p>另外，还需要安装 git 部署插件：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-deployer-git --save</span><br></pre></td></tr></tbody></table></figure>\n\n<p><strong>部署网站：</strong></p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo deploy</span><br></pre></td></tr></tbody></table></figure>\n\n<table>\n<thead>\n<tr>\n<th>参数</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>-g</code>, <code>--generate</code></td>\n<td>部署之前预先生成静态文件</td>\n</tr>\n</tbody></table>\n<p>生成静态文件并发布的命令可以简写为：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo -d g</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"附加配置\"><a href=\"#附加配置\" class=\"headerlink\" title=\"附加配置\"></a>附加配置</h3><p>本站使用了 maupassant 主题，并且安装了几个插件，所以 package.json 文件内容相比默认的有变化</p>\n<figure class=\"highlight json\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">{</span></span><br><span class=\"line\">  <span class=\"attr\">\"name\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"hexo-site\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"0.0.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"private\"</span><span class=\"punctuation\">:</span> <span class=\"keyword\">true</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"version\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"3.3.8\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">\"dependencies\"</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">{</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^3.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-asset-image\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"0.0.3\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-deployer-git\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.1\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-archive\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.4\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-category\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.1.3\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-feed\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^1.2.2\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-index\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-sitemap\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^1.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-generator-tag\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-helper-qrcode\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^1.0.2\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-ejs\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.1\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-jade\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-marked\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-sass\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.2\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-renderer-stylus\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.3.1\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-server\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^0.2.0\"</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">\"hexo-wordcount\"</span><span class=\"punctuation\">:</span> <span class=\"string\">\"^3.0.2\"</span></span><br><span class=\"line\">  <span class=\"punctuation\">}</span></span><br><span class=\"line\"><span class=\"punctuation\">}</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>所以在安装了 Hexo 之后，可以运行如下命令添加这些插件：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-asset-image --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-deployer-git --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-generator-feed --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-generator-sitemap --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-renderer-jade --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-renderer-stylus --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-wordcount --registry=https://registry.npm.taobao.org --save</span><br><span class=\"line\">$ npm install hexo-helper-qrcode --registry=https://registry.npm.taobao.org --save</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"CNAME-设置\"><a href=\"#CNAME-设置\" class=\"headerlink\" title=\"CNAME 设置\"></a>CNAME 设置</h4><p>在发布完成以后，就可以使用 <a href=\"https://yourname.github.io/\">https://yourname.github.io</a> 来访问你的主页了。<br>如果你不想用 github.io 的二级域名，你可以使用自己的域名。</p>\n<ol>\n<li>在Hexo 的 source 目录下创建 CNAME 文件。</li>\n<li>填写自己的域名如 winotes.net 或者 <a href=\"http://www.winotes.net,保存退出./\">www.winotes.net，保存退出。</a></li>\n<li>登录你的域名解析商，比如 DNSPod，先添加域名，然后添加记录，设置如下：</li>\n</ol>\n<p>主机记录 | 记录类型 | 线路类型 | 记录值 | MX优先级 | TTL<br>— | —<br>@ | CNAME | 默认 | yourname.github.io. | - | 10<br>www | CNAME | 默认 | yourname.github.io. | - | 10</p>\n<p>当然，你也可以通过创建DNS A 记录直接指定 GitHub Pages 的 IP 来解析：</p>\n<ul>\n<li>192.30.252.153</li>\n<li>192.30.252.154</li>\n</ul>\n<h3 id=\"博客源码备份\"><a href=\"#博客源码备份\" class=\"headerlink\" title=\"博客源码备份\"></a>博客源码备份</h3><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git add .</span><br><span class=\"line\">$ git commit -m <span class=\"string\">\"comments\"</span></span><br><span class=\"line\">$ git push original hexo</span><br></pre></td></tr></tbody></table></figure>\n<p>以下目录不用上传，所以在 .gitignore 里面排除掉即可：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.git/</span><br><span class=\"line\">public/</span><br><span class=\"line\">.deploy_git/</span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"无需插件查看浏览器中已保存的星号密码","date":"2018-02-28T02:28:23.000Z","keywords":"Windows, Browser，Chrome，Internet Excplorer, Firefox, reveal password","description":"最近帮人重新配置路由器，不过他忘记了 PPPOE 的拨号密码是多少，还好原来的路由器 WAN 配置界面上还能看到，不过全是星号，要怎么才能看到里面的密码明文内容呢？这里教大家一个简单易用的方法，不需要安装什么星号密码查看器的软件，也不用啥浏览器的插件，使用浏览器自带的“审查元素”功能即可简单几步查看星号密码内容。","_content":"\n### 起因\n最近帮人重新配置路由器，不过他忘记了 PPPOE 的拨号密码是多少，还好原来的路由器 WAN 配置界面上还能看到，不过全是星号，要怎么才能看到里面的密码明文内容呢？这里教大家一个简单易用的方法，不需要安装什么星号密码查看器的软件，也不用啥浏览器的插件，使用浏览器自带的“审查元素”功能即可简单几步查看星号密码内容。\n\n### 步骤：\n1. 在 Chrome 浏览器中，鼠标悬停在网页保存的密码字段，点击右键，选择 **Inspect**;\n![Inspect](easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg)\n\n2. 在开发者工具的页面中，找到密码字段对应的 HTML 源码，然后将 <input type=\"password\" 改成 <input type=\"text\" （如下图）\n![Change input type to text](easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg)\n\n这时在前端网页上面，密码已经明文显示出来了。\n![Reveal password](easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg)\n\n\n> 注：以上示例是使用 Google Chrome 浏览器，Internet Explorer 和 Firefox 也是类似的方法。\n\n","source":"_posts/easily-reveal-hidden-passwords-in-any-browser.md","raw":"---\ntitle: 无需插件查看浏览器中已保存的星号密码\ntags:\n  - Windows\ncategories:\n  - Windows\ndate: 2018-02-28 10:28:23\nkeywords: Windows, Browser，Chrome，Internet Excplorer, Firefox, reveal password\ndescription: 最近帮人重新配置路由器，不过他忘记了 PPPOE 的拨号密码是多少，还好原来的路由器 WAN 配置界面上还能看到，不过全是星号，要怎么才能看到里面的密码明文内容呢？这里教大家一个简单易用的方法，不需要安装什么星号密码查看器的软件，也不用啥浏览器的插件，使用浏览器自带的“审查元素”功能即可简单几步查看星号密码内容。\n---\n\n### 起因\n最近帮人重新配置路由器，不过他忘记了 PPPOE 的拨号密码是多少，还好原来的路由器 WAN 配置界面上还能看到，不过全是星号，要怎么才能看到里面的密码明文内容呢？这里教大家一个简单易用的方法，不需要安装什么星号密码查看器的软件，也不用啥浏览器的插件，使用浏览器自带的“审查元素”功能即可简单几步查看星号密码内容。\n\n### 步骤：\n1. 在 Chrome 浏览器中，鼠标悬停在网页保存的密码字段，点击右键，选择 **Inspect**;\n![Inspect](easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg)\n\n2. 在开发者工具的页面中，找到密码字段对应的 HTML 源码，然后将 <input type=\"password\" 改成 <input type=\"text\" （如下图）\n![Change input type to text](easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg)\n\n这时在前端网页上面，密码已经明文显示出来了。\n![Reveal password](easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg)\n\n\n> 注：以上示例是使用 Google Chrome 浏览器，Internet Explorer 和 Firefox 也是类似的方法。\n\n","slug":"easily-reveal-hidden-passwords-in-any-browser","published":1,"updated":"2020-01-05T09:00:53.943Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kta000fk84s4nsr3jmx","content":"<html><head></head><body><h3 id=\"起因\"><a href=\"#起因\" class=\"headerlink\" title=\"起因\"></a>起因</h3><p>最近帮人重新配置路由器，不过他忘记了 PPPOE 的拨号密码是多少，还好原来的路由器 WAN 配置界面上还能看到，不过全是星号，要怎么才能看到里面的密码明文内容呢？这里教大家一个简单易用的方法，不需要安装什么星号密码查看器的软件，也不用啥浏览器的插件，使用浏览器自带的“审查元素”功能即可简单几步查看星号密码内容。</p>\n<h3 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h3><ol>\n<li><p>在 Chrome 浏览器中，鼠标悬停在网页保存的密码字段，点击右键，选择 <strong>Inspect</strong>;<br><img src=\"/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg\" alt=\"Inspect\"></p>\n</li>\n<li><p>在开发者工具的页面中，找到密码字段对应的 HTML 源码，然后将 &lt;input type=”password” 改成 &lt;input type=”text” （如下图）<br><img src=\"/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg\" alt=\"Change input type to text\"></p>\n</li>\n</ol>\n<p>这时在前端网页上面，密码已经明文显示出来了。<br><img src=\"/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg\" alt=\"Reveal password\"></p>\n<blockquote>\n<p>注：以上示例是使用 Google Chrome 浏览器，Internet Explorer 和 Firefox 也是类似的方法。</p>\n</blockquote>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h3 id=\"起因\"><a href=\"#起因\" class=\"headerlink\" title=\"起因\"></a>起因</h3><p>最近帮人重新配置路由器，不过他忘记了 PPPOE 的拨号密码是多少，还好原来的路由器 WAN 配置界面上还能看到，不过全是星号，要怎么才能看到里面的密码明文内容呢？这里教大家一个简单易用的方法，不需要安装什么星号密码查看器的软件，也不用啥浏览器的插件，使用浏览器自带的“审查元素”功能即可简单几步查看星号密码内容。</p>\n<h3 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h3><ol>\n<li><p>在 Chrome 浏览器中，鼠标悬停在网页保存的密码字段，点击右键，选择 <strong>Inspect</strong>;<br><img src=\"/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg\" alt=\"Inspect\"></p>\n</li>\n<li><p>在开发者工具的页面中，找到密码字段对应的 HTML 源码，然后将 &lt;input type=”password” 改成 &lt;input type=”text” （如下图）<br><img src=\"/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg\" alt=\"Change input type to text\"></p>\n</li>\n</ol>\n<p>这时在前端网页上面，密码已经明文显示出来了。<br><img src=\"/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg\" alt=\"Reveal password\"></p>\n<blockquote>\n<p>注：以上示例是使用 Google Chrome 浏览器，Internet Explorer 和 Firefox 也是类似的方法。</p>\n</blockquote>\n</body></html>"},{"title":"Exception from HRESULT: 0x800A03EC","date":"2009-08-20T06:09:45.000Z","_content":"\n我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是 **SYSTEM** 但是在执行中报出了一下错误:\n> Exception from HRESULT: **0x800A03EC\n> **   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)\n\nGoogle 了大半天, 总算是找到了问题所在:\n\n[http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required](http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required)\n\n在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户 \"Desktop\" 文件夹似乎是必须的\n\n* Windows 2008 Server x64\n\n在 \"C:\\Windows\\**SysWOW64**\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n\n* Windows 2008 Server x86\n\n在 \"C:\\Windows\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n\n注意 64-bit 的要在 **SysWOW64** 下面\n","source":"_posts/exception-from-hresult-0x800a03ec.md","raw":"---\ntitle: 'Exception from HRESULT: 0x800A03EC'\ntags:\n  - DCOM\n  - Excel\ncategories:\n  - Microsoft\n  - Office\ndate: 2009-08-20 14:09:45\n---\n\n我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是 **SYSTEM** 但是在执行中报出了一下错误:\n> Exception from HRESULT: **0x800A03EC\n> **   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)\n\nGoogle 了大半天, 总算是找到了问题所在:\n\n[http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required](http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required)\n\n在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户 \"Desktop\" 文件夹似乎是必须的\n\n* Windows 2008 Server x64\n\n在 \"C:\\Windows\\**SysWOW64**\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n\n* Windows 2008 Server x86\n\n在 \"C:\\Windows\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n\n注意 64-bit 的要在 **SysWOW64** 下面\n","slug":"exception-from-hresult-0x800a03ec","published":1,"updated":"2020-01-05T09:00:53.946Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktb000hk84s10ri5g0g","content":"<html><head></head><body><p>我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是&nbsp;<strong>SYSTEM</strong>&nbsp;但是在执行中报出了一下错误:</p>\n<blockquote>\n<p>Exception from HRESULT:&nbsp;**0x800A03EC<br>**&nbsp;&nbsp; at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)</p>\n</blockquote>\n<p>Google 了大半天, 总算是找到了问题所在:</p>\n<p><a href=\"http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required\">http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required</a></p>\n<p>在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户&nbsp;“Desktop” 文件夹似乎是必须的</p>\n<ul>\n<li>Windows 2008 Server x64</li>\n</ul>\n<p>在 “C:\\Windows**SysWOW64**\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>    `C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n</code></pre>\n<ul>\n<li>Windows 2008 Server x86</li>\n</ul>\n<p>在 “C:\\Windows\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>    `C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n</code></pre>\n<p>注意 64-bit 的要在&nbsp;<strong>SysWOW64</strong>&nbsp;下面</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是&nbsp;<strong>SYSTEM</strong>&nbsp;但是在执行中报出了一下错误:</p>\n<blockquote>\n<p>Exception from HRESULT:&nbsp;**0x800A03EC<br>**&nbsp;&nbsp; at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)</p>\n</blockquote>\n<p>Google 了大半天, 总算是找到了问题所在:</p>\n<p><a href=\"http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required\">http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required</a></p>\n<p>在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户&nbsp;“Desktop” 文件夹似乎是必须的</p>\n<ul>\n<li>Windows 2008 Server x64</li>\n</ul>\n<p>在 “C:\\Windows**SysWOW64**\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>    `C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n</code></pre>\n<ul>\n<li>Windows 2008 Server x86</li>\n</ul>\n<p>在 “C:\\Windows\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>    `C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n</code></pre>\n<p>注意 64-bit 的要在&nbsp;<strong>SysWOW64</strong>&nbsp;下面</p>\n</body></html>"},{"title":"Exchange 2010 最佳实践01 - CAS Array","date":"2013-12-06T01:44:56.000Z","_content":"\nCAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。\n\n实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  \n\n**CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。**\n\nWhy? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。\n\na)  内部 Outlook 用户 (TCP连接)。\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。\n* Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。\n* 连接建立。\n\nb)  外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）\n\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。\n* Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。\n* 而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。\n* 当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。\n默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。\n\n当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。\n\nc)  外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。\n* Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。\n\n** CAS Array **的场景下，客户端最好能做** Kerberos **认证 （Exchange 2010 SP1）。\n\n在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）\n\n而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：[http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx](http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx)\n\n那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。\n\n**即便你只有一个 CAS 服务器，也建议配置 CAS Array **。","source":"_posts/exchange-2010-best-practice-01-cas-array.md","raw":"---\ntitle: Exchange 2010 最佳实践01 - CAS Array\ntags:\n  - 最佳实践\n  - Exchange\n  - Kerberos\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2013-12-06 09:44:56\n---\n\nCAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。\n\n实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  \n\n**CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。**\n\nWhy? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。\n\na)  内部 Outlook 用户 (TCP连接)。\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。\n* Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。\n* 连接建立。\n\nb)  外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）\n\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。\n* Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。\n* 而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。\n* 当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。\n默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。\n\n当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。\n\nc)  外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。\n* Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。\n\n** CAS Array **的场景下，客户端最好能做** Kerberos **认证 （Exchange 2010 SP1）。\n\n在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）\n\n而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：[http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx](http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx)\n\n那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。\n\n**即便你只有一个 CAS 服务器，也建议配置 CAS Array **。","slug":"exchange-2010-best-practice-01-cas-array","published":1,"updated":"2020-01-05T09:00:53.946Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktb000mk84sd2n6f3bk","content":"<html><head></head><body><p>CAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。</p>\n<p>实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  </p>\n<p><strong>CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。</strong></p>\n<p>Why? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。</p>\n<p>a) &nbsp;内部 Outlook 用户 (TCP连接)。</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。</li>\n<li>Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。</li>\n<li>连接建立。</li>\n</ul>\n<p>b)&nbsp; 外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。</li>\n<li>Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。</li>\n<li>而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。</li>\n<li>当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。<br>默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。</li>\n</ul>\n<p>当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。</p>\n<p>c)&nbsp; 外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。</li>\n<li>Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。</li>\n</ul>\n<p>** CAS Array <strong>的场景下，客户端最好能做</strong> Kerberos **认证 （Exchange 2010 SP1）。</p>\n<p>在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）</p>\n<p>而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：<a href=\"http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx\">http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx</a></p>\n<p>那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。</p>\n<p>**即便你只有一个 CAS 服务器，也建议配置 CAS Array **。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>CAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。</p>\n<p>实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  </p>\n<p><strong>CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。</strong></p>\n<p>Why? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。</p>\n<p>a) &nbsp;内部 Outlook 用户 (TCP连接)。</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。</li>\n<li>Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。</li>\n<li>连接建立。</li>\n</ul>\n<p>b)&nbsp; 外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。</li>\n<li>Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。</li>\n<li>而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。</li>\n<li>当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。<br>默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。</li>\n</ul>\n<p>当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。</p>\n<p>c)&nbsp; 外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。</li>\n<li>Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。</li>\n</ul>\n<p>** CAS Array <strong>的场景下，客户端最好能做</strong> Kerberos **认证 （Exchange 2010 SP1）。</p>\n<p>在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）</p>\n<p>而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：<a href=\"http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx\">http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx</a></p>\n<p>那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。</p>\n<p>**即便你只有一个 CAS 服务器，也建议配置 CAS Array **。</p>\n</body></html>"},{"title":"Exchange 2010 Update Rollup 2","date":"2010-03-06T00:42:16.000Z","_content":"\nToday Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010\\. RU2 comes 3 months after the release of RU1\\. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:\n\n*   [977633](http://support.microsoft.com/kb/977633/) Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server\n*   [979431](http://support.microsoft.com/kb/979431/) The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server\n*   [979480](http://support.microsoft.com/kb/979480/) Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients\n*   [979563](http://support.microsoft.com/kb/979563/) Exchange Server 2010 Push Notifications does not work\n*   [979566](http://support.microsoft.com/kb/979566/) A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010\n*   [980261](http://support.microsoft.com/kb/980261/) This fix introduces the supports for Exchange Server 2010 page patching when a \"-1022″ disk I/O error is generated\n*   [980262](http://support.microsoft.com/kb/980262/) Event ID 2156 is logged on a computer that is running Exchange Server 2010\nThe related knowledgebase article (KB979611) can be found [here](http://support.microsoft.com/?kbid=979611). You can download Exchange 2010 Rollup 2 directly from [here](http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en).","source":"_posts/exchange-2010-update-rollup-2.md","raw":"---\ntitle: Exchange 2010 Update Rollup 2\ntags:\n  - Exchange\n  - Rollup\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2010-03-06 08:42:16\n---\n\nToday Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010\\. RU2 comes 3 months after the release of RU1\\. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:\n\n*   [977633](http://support.microsoft.com/kb/977633/) Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server\n*   [979431](http://support.microsoft.com/kb/979431/) The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server\n*   [979480](http://support.microsoft.com/kb/979480/) Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients\n*   [979563](http://support.microsoft.com/kb/979563/) Exchange Server 2010 Push Notifications does not work\n*   [979566](http://support.microsoft.com/kb/979566/) A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010\n*   [980261](http://support.microsoft.com/kb/980261/) This fix introduces the supports for Exchange Server 2010 page patching when a \"-1022″ disk I/O error is generated\n*   [980262](http://support.microsoft.com/kb/980262/) Event ID 2156 is logged on a computer that is running Exchange Server 2010\nThe related knowledgebase article (KB979611) can be found [here](http://support.microsoft.com/?kbid=979611). You can download Exchange 2010 Rollup 2 directly from [here](http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en).","slug":"exchange-2010-update-rollup-2","published":1,"updated":"2020-01-05T09:00:53.946Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktc000nk84s3s6l9ug3","content":"<html><head></head><body><p>Today Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010. RU2 comes 3 months after the release of RU1. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/977633/\">977633</a>&nbsp;Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server</li>\n<li><a href=\"http://support.microsoft.com/kb/979431/\">979431</a>&nbsp;The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server</li>\n<li><a href=\"http://support.microsoft.com/kb/979480/\">979480</a>&nbsp;Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients</li>\n<li><a href=\"http://support.microsoft.com/kb/979563/\">979563</a>&nbsp;Exchange Server 2010 Push Notifications does not work</li>\n<li><a href=\"http://support.microsoft.com/kb/979566/\">979566</a>&nbsp;A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010</li>\n<li><a href=\"http://support.microsoft.com/kb/980261/\">980261</a>&nbsp;This fix introduces the supports for Exchange Server 2010 page patching when a “-1022″ disk I/O error is generated</li>\n<li><a href=\"http://support.microsoft.com/kb/980262/\">980262</a>&nbsp;Event ID 2156 is logged on a computer that is running Exchange Server 2010<br>The related knowledgebase article (KB979611) can be found&nbsp;<a href=\"http://support.microsoft.com/?kbid=979611\">here</a>. You can download Exchange 2010 Rollup 2 directly from&nbsp;<a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en\">here</a>.</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Today Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010. RU2 comes 3 months after the release of RU1. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/977633/\">977633</a>&nbsp;Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server</li>\n<li><a href=\"http://support.microsoft.com/kb/979431/\">979431</a>&nbsp;The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server</li>\n<li><a href=\"http://support.microsoft.com/kb/979480/\">979480</a>&nbsp;Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients</li>\n<li><a href=\"http://support.microsoft.com/kb/979563/\">979563</a>&nbsp;Exchange Server 2010 Push Notifications does not work</li>\n<li><a href=\"http://support.microsoft.com/kb/979566/\">979566</a>&nbsp;A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010</li>\n<li><a href=\"http://support.microsoft.com/kb/980261/\">980261</a>&nbsp;This fix introduces the supports for Exchange Server 2010 page patching when a “-1022″ disk I/O error is generated</li>\n<li><a href=\"http://support.microsoft.com/kb/980262/\">980262</a>&nbsp;Event ID 2156 is logged on a computer that is running Exchange Server 2010<br>The related knowledgebase article (KB979611) can be found&nbsp;<a href=\"http://support.microsoft.com/?kbid=979611\">here</a>. You can download Exchange 2010 Rollup 2 directly from&nbsp;<a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en\">here</a>.</li>\n</ul>\n</body></html>"},{"title":"Exchange Activesync returned an HTTP 500 response","date":"2013-07-19T05:40:52.000Z","_content":"\nExchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。\n\n去到 [TestExchangeConnectivity](https://www.testexchangeconnectivity.com/ \"Microsoft Remote Connectivity Analyzer\") 网站测试，发现有报错：\n\nAttempting the FolderSync command on the Exchange ActiveSync session.\nThe test of the FolderSync command failed.\n\nAdditional Details\nExchange Activesync returned an HTTP 500 response. (Internal Server Error)\n\n{% asset_img FolderSync-Failed.jpg 500 error %}\n\n换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：\n\n{% asset_img EventID-1053.jpg EventID-1053 %}\n\nExchange ActiveSync doesn't have sufficient permissions to create the \"CN=Randy Zhong,OU=IT,DC=company,DC=com\" container under Active Directory user \"Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span>\n\nActive directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0\".\n\n<span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type \"msExchActiveSyncDevices\" and doesn't have any deny permissions that block such operations.\n\nDetails:%3\n\n\n从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.\n\n**解决方法：**\n\n1. 在DC上打开Active Directory Users and Computers\n2. 在菜单上点击 View, 勾选 Advanced Features\n3. 找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡\n4. 点击 Advanced，选中 Include inheritable permissions from this object's parent.\n5. \n{% asset_img AdvancedSecurity-Setting.jpg AdvancedSecurity-Setting %}\n\n等待 AD 复制完成后，再尝试配置手机，问题解决。\n\n<span style=\"color: #ff0000\">补充：\n</span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span>","source":"_posts/exchange-activesync-returned-an-http-500-response.md","raw":"\n---\ntitle: Exchange Activesync returned an HTTP 500 response\ntags:\n  - Activesync\n  - Android\n  - Exchange\n  - Google\n  - Nexus\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2013-07-19 13:40:52\n---\n\nExchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。\n\n去到 [TestExchangeConnectivity](https://www.testexchangeconnectivity.com/ \"Microsoft Remote Connectivity Analyzer\") 网站测试，发现有报错：\n\nAttempting the FolderSync command on the Exchange ActiveSync session.\nThe test of the FolderSync command failed.\n\nAdditional Details\nExchange Activesync returned an HTTP 500 response. (Internal Server Error)\n\n{% asset_img FolderSync-Failed.jpg 500 error %}\n\n换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：\n\n{% asset_img EventID-1053.jpg EventID-1053 %}\n\nExchange ActiveSync doesn't have sufficient permissions to create the \"CN=Randy Zhong,OU=IT,DC=company,DC=com\" container under Active Directory user \"Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span>\n\nActive directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0\".\n\n<span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type \"msExchActiveSyncDevices\" and doesn't have any deny permissions that block such operations.\n\nDetails:%3\n\n\n从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.\n\n**解决方法：**\n\n1. 在DC上打开Active Directory Users and Computers\n2. 在菜单上点击 View, 勾选 Advanced Features\n3. 找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡\n4. 点击 Advanced，选中 Include inheritable permissions from this object's parent.\n5. \n{% asset_img AdvancedSecurity-Setting.jpg AdvancedSecurity-Setting %}\n\n等待 AD 复制完成后，再尝试配置手机，问题解决。\n\n<span style=\"color: #ff0000\">补充：\n</span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span>","slug":"exchange-activesync-returned-an-http-500-response","published":1,"updated":"2020-01-05T09:00:53.946Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kte000rk84s70m39o6o","content":"<html><head></head><body><p>Exchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。</p>\n<p>去到 <a href=\"https://www.testexchangeconnectivity.com/\" title=\"Microsoft Remote Connectivity Analyzer\">TestExchangeConnectivity</a> 网站测试，发现有报错：</p>\n<p>Attempting the FolderSync command on the Exchange ActiveSync session.<br>The test of the FolderSync command failed.</p>\n<p>Additional Details<br>Exchange Activesync returned an HTTP 500 response. (Internal Server Error)</p>\n<img src=\"/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg\" class=\"\" width=\"500\" title=\"error\">\n\n<p>换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：</p>\n<img src=\"/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg\" class=\"\" title=\"EventID-1053\">\n\n<p>Exchange ActiveSync doesn’t have sufficient permissions to create the “CN=Randy Zhong,OU=IT,DC=company,DC=com” container under Active Directory user “Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>Active directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0”.</p>\n<p><span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type “msExchActiveSyncDevices” and doesn’t have any deny permissions that block such operations.</p>\n<p>Details:%3</p>\n<p>从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.</p>\n<p><strong>解决方法：</strong></p>\n<ol>\n<li>在DC上打开Active Directory Users and Computers</li>\n<li>在菜单上点击 View, 勾选 Advanced Features</li>\n<li>找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡</li>\n<li>点击 Advanced，选中&nbsp;Include inheritable permissions from this object’s parent.</li>\n<li><img src=\"/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg\" class=\"\" title=\"AdvancedSecurity-Setting\"></li>\n</ol>\n<p>等待 AD 复制完成后，再尝试配置手机，问题解决。</p>\n<p><span style=\"color: #ff0000\">补充：<br></span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Exchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。</p>\n<p>去到 <a href=\"https://www.testexchangeconnectivity.com/\" title=\"Microsoft Remote Connectivity Analyzer\">TestExchangeConnectivity</a> 网站测试，发现有报错：</p>\n<p>Attempting the FolderSync command on the Exchange ActiveSync session.<br>The test of the FolderSync command failed.</p>\n<p>Additional Details<br>Exchange Activesync returned an HTTP 500 response. (Internal Server Error)</p>\n<img src=\"/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg\" class=\"\" width=\"500\" title=\"error\">\n\n<p>换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：</p>\n<img src=\"/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg\" class=\"\" title=\"EventID-1053\">\n\n<p>Exchange ActiveSync doesn’t have sufficient permissions to create the “CN=Randy Zhong,OU=IT,DC=company,DC=com” container under Active Directory user “Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>Active directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0”.</p>\n<p><span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type “msExchActiveSyncDevices” and doesn’t have any deny permissions that block such operations.</p>\n<p>Details:%3</p>\n<p>从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.</p>\n<p><strong>解决方法：</strong></p>\n<ol>\n<li>在DC上打开Active Directory Users and Computers</li>\n<li>在菜单上点击 View, 勾选 Advanced Features</li>\n<li>找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡</li>\n<li>点击 Advanced，选中&nbsp;Include inheritable permissions from this object’s parent.</li>\n<li><img src=\"/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg\" class=\"\" title=\"AdvancedSecurity-Setting\"></li>\n</ol>\n<p>等待 AD 复制完成后，再尝试配置手机，问题解决。</p>\n<p><span style=\"color: #ff0000\">补充：<br></span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span></p>\n</body></html>"},{"title":"Exchange 日志文件详解（上）：基础知识","date":"2011-10-11T00:52:45.000Z","_content":"\n#### 1. ESE - Extensible Storage Engine 可扩展存储引擎\n\n众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。\n![Figure 1 - 平衡树结构示意图](exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg)\n\n目前，有四个正在使用的 ESE 版本：\n\n* **ESE97** Exchange Server 5.5 中的数据库引擎。\n* **ESENT** 用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。\n* **ESE98** Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，\n* **ESE for Exchange 2007/2010** Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。\n\n越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。\n\n#### 2. Transaction Log 事务日志文件\n除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。\n\n**ESE基于事务的ACID特征**\n\nESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从\"收件箱\"移动到\"已删除邮件\"文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。\n\n为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。\n\n万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。\n\n**ESE 的处理机制**\n\n这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。\n\n因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。\n\n当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。\n\n因此，ESE至少需要三种类型的数据：\n1. 在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。\n2. 硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。\n3. 硬盘上的 .edb 邮件数据库文件。\n\n具体步骤来说：\n1. 需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。\n2. 已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。\n3. 如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。\n4. 更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。\n\n下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。\n![Figure 2 - Exchange 2010存储步骤示Figure意图](exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg)\n\n**ESE数据库相关的文件**\n* .edb - ESE主数据库文件，又称之为 MAPI 数据库文件\n* Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。\n* .stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。\n\n在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。\n\n而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。\n\n这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.\n* Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。\n* Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。\n* Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。\n* E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。\n* E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。\n* E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。\n* E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。\n* Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。\n* .jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。\nExchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)\nExchange 2010 ：E0xres00001.jrs ... E0xres00009.jrs (10个，共计10MB)\n![Figure 3 - Exchange 2010 的日志预留文件](exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg)\n\n##### 未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复","source":"_posts/exchange-log-part1-basic-knowledge.md","raw":"---\ntitle: Exchange 日志文件详解（上）：基础知识\ntags:\n  - Exchange\n  - 日志\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2011-10-11 08:52:45\n---\n\n#### 1. ESE - Extensible Storage Engine 可扩展存储引擎\n\n众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。\n![Figure 1 - 平衡树结构示意图](exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg)\n\n目前，有四个正在使用的 ESE 版本：\n\n* **ESE97** Exchange Server 5.5 中的数据库引擎。\n* **ESENT** 用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。\n* **ESE98** Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，\n* **ESE for Exchange 2007/2010** Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。\n\n越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。\n\n#### 2. Transaction Log 事务日志文件\n除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。\n\n**ESE基于事务的ACID特征**\n\nESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从\"收件箱\"移动到\"已删除邮件\"文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。\n\n为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。\n\n万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。\n\n**ESE 的处理机制**\n\n这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。\n\n因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。\n\n当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。\n\n因此，ESE至少需要三种类型的数据：\n1. 在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。\n2. 硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。\n3. 硬盘上的 .edb 邮件数据库文件。\n\n具体步骤来说：\n1. 需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。\n2. 已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。\n3. 如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。\n4. 更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。\n\n下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。\n![Figure 2 - Exchange 2010存储步骤示Figure意图](exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg)\n\n**ESE数据库相关的文件**\n* .edb - ESE主数据库文件，又称之为 MAPI 数据库文件\n* Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。\n* .stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。\n\n在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。\n\n而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。\n\n这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.\n* Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。\n* Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。\n* Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。\n* E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。\n* E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。\n* E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。\n* E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。\n* Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。\n* .jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。\nExchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)\nExchange 2010 ：E0xres00001.jrs ... E0xres00009.jrs (10个，共计10MB)\n![Figure 3 - Exchange 2010 的日志预留文件](exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg)\n\n##### 未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复","slug":"exchange-log-part1-basic-knowledge","published":1,"updated":"2020-01-05T09:00:53.948Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kte000sk84sgsvpczda","content":"<html><head></head><body><h4 id=\"1-ESE-Extensible-Storage-Engine-可扩展存储引擎\"><a href=\"#1-ESE-Extensible-Storage-Engine-可扩展存储引擎\" class=\"headerlink\" title=\"1. ESE - Extensible Storage Engine 可扩展存储引擎\"></a>1. ESE - Extensible Storage Engine 可扩展存储引擎</h4><p>众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。<br><img src=\"/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg\" alt=\"Figure 1 - 平衡树结构示意图\"></p>\n<p>目前，有四个正在使用的 ESE 版本：</p>\n<ul>\n<li><strong>ESE97</strong>&nbsp;Exchange Server 5.5 中的数据库引擎。</li>\n<li><strong>ESENT</strong>&nbsp;用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。</li>\n<li><strong>ESE98</strong>&nbsp;Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，</li>\n<li><strong>ESE for Exchange 2007/2010</strong>&nbsp;Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。</li>\n</ul>\n<p>越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。</p>\n<h4 id=\"2-Transaction-Log-事务日志文件\"><a href=\"#2-Transaction-Log-事务日志文件\" class=\"headerlink\" title=\"2. Transaction Log 事务日志文件\"></a>2. Transaction Log 事务日志文件</h4><p>除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。</p>\n<p><strong>ESE基于事务的ACID特征</strong></p>\n<p>ESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从”收件箱”移动到”已删除邮件”文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。</p>\n<p>为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。</p>\n<p>万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。</p>\n<p><strong>ESE 的处理机制</strong></p>\n<p>这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。</p>\n<p>因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。</p>\n<p>当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。</p>\n<p>因此，ESE至少需要三种类型的数据：</p>\n<ol>\n<li>在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。</li>\n<li>硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。</li>\n<li>硬盘上的 .edb 邮件数据库文件。</li>\n</ol>\n<p>具体步骤来说：</p>\n<ol>\n<li>需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。</li>\n<li>已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。</li>\n<li>如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。</li>\n<li>更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。</li>\n</ol>\n<p>下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。<br><img src=\"/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg\" alt=\"Figure 2 - Exchange 2010存储步骤示Figure意图\"></p>\n<p><strong>ESE数据库相关的文件</strong></p>\n<ul>\n<li>.edb - ESE主数据库文件，又称之为 MAPI 数据库文件</li>\n<li>Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。</li>\n<li>.stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。</li>\n</ul>\n<p>在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。</p>\n<p>而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。</p>\n<p>这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.</p>\n<ul>\n<li>Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。</li>\n<li>Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。</li>\n<li>Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。</li>\n<li>E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。</li>\n<li>E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。</li>\n<li>E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。</li>\n<li>E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。</li>\n<li>Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。</li>\n<li>.jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。<br>Exchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)<br>Exchange 2010 ：E0xres00001.jrs … E0xres00009.jrs (10个，共计10MB)<br><img src=\"/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg\" alt=\"Figure 3 - Exchange 2010 的日志预留文件\"></li>\n</ul>\n<h5 id=\"未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\"><a href=\"#未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\" class=\"headerlink\" title=\"未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复\"></a>未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复</h5></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h4 id=\"1-ESE-Extensible-Storage-Engine-可扩展存储引擎\"><a href=\"#1-ESE-Extensible-Storage-Engine-可扩展存储引擎\" class=\"headerlink\" title=\"1. ESE - Extensible Storage Engine 可扩展存储引擎\"></a>1. ESE - Extensible Storage Engine 可扩展存储引擎</h4><p>众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。<br><img src=\"/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg\" alt=\"Figure 1 - 平衡树结构示意图\"></p>\n<p>目前，有四个正在使用的 ESE 版本：</p>\n<ul>\n<li><strong>ESE97</strong>&nbsp;Exchange Server 5.5 中的数据库引擎。</li>\n<li><strong>ESENT</strong>&nbsp;用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。</li>\n<li><strong>ESE98</strong>&nbsp;Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，</li>\n<li><strong>ESE for Exchange 2007/2010</strong>&nbsp;Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。</li>\n</ul>\n<p>越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。</p>\n<h4 id=\"2-Transaction-Log-事务日志文件\"><a href=\"#2-Transaction-Log-事务日志文件\" class=\"headerlink\" title=\"2. Transaction Log 事务日志文件\"></a>2. Transaction Log 事务日志文件</h4><p>除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。</p>\n<p><strong>ESE基于事务的ACID特征</strong></p>\n<p>ESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从”收件箱”移动到”已删除邮件”文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。</p>\n<p>为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。</p>\n<p>万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。</p>\n<p><strong>ESE 的处理机制</strong></p>\n<p>这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。</p>\n<p>因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。</p>\n<p>当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。</p>\n<p>因此，ESE至少需要三种类型的数据：</p>\n<ol>\n<li>在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。</li>\n<li>硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。</li>\n<li>硬盘上的 .edb 邮件数据库文件。</li>\n</ol>\n<p>具体步骤来说：</p>\n<ol>\n<li>需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。</li>\n<li>已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。</li>\n<li>如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。</li>\n<li>更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。</li>\n</ol>\n<p>下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。<br><img src=\"/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg\" alt=\"Figure 2 - Exchange 2010存储步骤示Figure意图\"></p>\n<p><strong>ESE数据库相关的文件</strong></p>\n<ul>\n<li>.edb - ESE主数据库文件，又称之为 MAPI 数据库文件</li>\n<li>Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。</li>\n<li>.stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。</li>\n</ul>\n<p>在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。</p>\n<p>而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。</p>\n<p>这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.</p>\n<ul>\n<li>Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。</li>\n<li>Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。</li>\n<li>Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。</li>\n<li>E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。</li>\n<li>E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。</li>\n<li>E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。</li>\n<li>E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。</li>\n<li>Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。</li>\n<li>.jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。<br>Exchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)<br>Exchange 2010 ：E0xres00001.jrs … E0xres00009.jrs (10个，共计10MB)<br><img src=\"/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg\" alt=\"Figure 3 - Exchange 2010 的日志预留文件\"></li>\n</ul>\n<h5 id=\"未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\"><a href=\"#未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\" class=\"headerlink\" title=\"未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复\"></a>未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复</h5></body></html>"},{"title":"CentOS 6 虚拟机扩容 LVM 根分区","date":"2019-02-28T09:48:35.000Z","keywords":"CentOS, LVM, 扩容, 根分区, 虚拟机","description":"单位有一台基于 CentOS 6.3 搭建的 Cacti 监控系统，使用了很长一段时间了，最后发现 / 根分区空间已经满了，无法再提供服务，于是有了扩容的需求，以下是扩容过程：","_content":"\n环境介绍：\n- VMware 5.5\n- CentOS 6.3 64-bit\n- / 根分区为 LVM\n- 原磁盘大小 40GB\n- 扩容后磁盘大小： 50GB\n\n查看原来的磁盘文件系统空间状态， 根分区已经 100% 爆了！\n```shell\n[root@localhost ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/VolGroup-lv_root\n                       38G   38G     0 100% /\ntmpfs                 246M     0  246M   0% /dev/shm\n/dev/sda1             485M   32M  428M   7% /boot\n```\n\n在 VMware 中对原磁盘扩容到 50GB, 查看磁盘 sda 已经扩展到 50GB\n**安全起见，在扩容前，建议对数据进行备份。**\n```shell\n[root@localhost ~]# fdisk /dev/sda -l\n\nDisk /dev/sda: 53.7 GB, 53687091200 bytes\n255 heads, 63 sectors/track, 6527 cylinders\nUnits = cylinders of 16065 * 512 = 8225280 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk identifier: 0x00026a39\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *           1          64      512000   83  Linux\nPartition 1 does not end on cylinder boundary.\n/dev/sda2              64        5222    41430016   8e  Linux LVM\n```\n在本文的例子中，磁盘 /dev/sda 已经扩展至 53.7 GB 而且当前只有两个主分区，所以我们后面就直接创建主分区 sda3 来帮助扩容。\n\n查看 PV, VG, LV 状态，大小还没有变化\n```shell\n[root@localhost ~]# pvs\n  PV         VG       Fmt  Attr PSize  PFree\n  /dev/sda2  VolGroup lvm2 a--  39.51g    0\n[root@localhost ~]# vgs\n  /etc/lvm/archive/.lvm_localhost.localdomain_18508_1413645104: write error failed: No space left on device\n  Volume group \"VolGroup\" metadata archive failed.\n  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device\n  Backup of volume group VolGroup metadata failed.\n  VG       #PV #LV #SN Attr   VSize  VFree\n  VolGroup   1   2   0 wz--n- 39.51g    0\n[root@localhost ~]# lvs\n  LV      VG       Attr     LSize   Pool Origin Data%  Move Log Copy%  Convert\n  lv_root VolGroup -wi-ao--  38.54g\n  lv_swap VolGroup -wi-ao-- 992.00m\n```\n\n接下来我们需要将扩展出未曾使用的 10GB 空间创建一个新的主分区 **sda3** 来给逻辑卷扩容用。\n```shell\n[root@localhost ~]# fdisk /dev/sda\n\nWARNING: DOS-compatible mode is deprecated. It's strongly recommended to\n         switch off the mode (command 'c') and change display units to\n         sectors (command 'u').\n\nCommand (m for help): m\nCommand action\n   a   toggle a bootable flag\n   b   edit bsd disklabel\n   c   toggle the dos compatibility flag\n   d   delete a partition\n   l   list known partition types\n   m   print this menu\n   n   add a new partition\n   o   create a new empty DOS partition table\n   p   print the partition table\n   q   quit without saving changes\n   s   create a new empty Sun disklabel\n   t   change a partition's system id\n   u   change display/entry units\n   v   verify the partition table\n   w   write table to disk and exit\n   x   extra functionality (experts only)\n\nCommand (m for help): n\nCommand action\n   e   extended\n   p   primary partition (1-4)\np\nPartition number (1-4): 3\nFirst cylinder (5222-6527, default 5222):\nUsing default value 5222\nLast cylinder, +cylinders or +size{K,M,G} (5222-6527, default 6527):\nUsing default value 6527\n```\n\n然后修改分区类型为 8e 并写入分区表保存\n```shell\nCommand (m for help): t\nPartition number (1-4): 3\nHex code (type L to list codes): 8e\nChanged system type of partition 3 to 8e (Linux LVM)\n\nCommand (m for help): w\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\n\nWARNING: Re-reading the partition table failed with error 16: Device or resource busy.\nThe kernel still uses the old table. The new table will be used at\nthe next reboot or after you run partprobe(8) or kpartx(8)\nSyncing disks.\n```\n\n重新扫描磁盘检查分区情况\n```shell\n[root@localhost ~]# partx -v -a /dev/sda\ndevice /dev/sda: start 0 size 104857600\ngpt: 0 slices\ndos: 4 slices\n# 1:      2048-  1026047 (  1024000 sectors,    524 MB)\n# 2:   1026048- 83886079 ( 82860032 sectors,  42424 MB)\n# 3:  83886080-104856254 ( 20970175 sectors,  10736 MB)\n# 4:         0-       -1 (        0 sectors,      0 MB)\nBLKPG: Device or resource busy\nerror adding partition 1\nBLKPG: Device or resource busy\nerror adding partition 2\nadded partition 3\n```\n分区 1/2 的报错可以忽略，我们需要看到的是分区 3 已经添加成功，如果看不到分区 3 或者添加失败需要重启使之生效。\n\n创建新的 PV\n```shell\n[root@localhost ~]# pvcreate /dev/sda3\n  Writing physical volume data to disk \"/dev/sda3\"\n  Physical volume \"/dev/sda3\" successfully created\n```\n\n找到当前系统所使用的卷组名\n```shell\n[root@localhost ~]# vgdisplay\n  --- Volume group ---\n  VG Name               VolGroup\n  System ID\n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               39.51 GiB\n  PE Size               4.00 MiB\n  Total PE              10114\n  Alloc PE / Size       10114 / 39.51 GiB\n  Free  PE / Size       0 / 0\n  VG UUID               2JrSeG-4Is7-ocIQ-zVrN-eha1-gYJQ-L1UnPn\n\n  /etc/lvm/archive/.lvm_localhost.localdomain_15862_675165963: write error failed: No space left on device\n  Volume group \"VolGroup\" metadata archive failed.\n  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device\n  Backup of volume group VolGroup metadata failed.\n```\n**VolGroup** 就是它了！\n\n接下来 **vgextend** 扩容VG：\n```shell\n[root@localhost ~]# vgextend VolGroup /dev/sda3\n  /etc/lvm/archive/.lvm_localhost.localdomain_17322_173527374: write error failed: No space left on device\n  Volume group \"VolGroup\" metadata archive failed.\n  Internal error: Attempt to unlock unlocked VG #orphans.\n```\n结果因为剩余空间为零扩容失败，囧， 删除掉一些文件再试。\n\n```shell\n[root@localhost ~]# vgextend VolGroup /dev/sda3\n  Volume group \"VolGroup\" successfully extended\n```\n\n用 **pvscan** 来查看 PV 空间使用情况来决定谁给谁加以及加多少空间。\n```shell\n[root@localhost ~]# pvscan\n  PV /dev/sda2   VG VolGroup   lvm2 [39.51 GiB / 0    free]\n  PV /dev/sda3   VG VolGroup   lvm2 [10.00 GiB / 10.00 GiB free]\n  Total: 2 [49.50 GiB] / in use: 2 [49.50 GiB] / in no VG: 0 [0   ]\n```\n\n在本文例子中我们需要增加 / 根分区的空间，用 **df** 命令来查看根分区所挂载的逻辑卷。\n```shell\n[root@localhost ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/VolGroup-lv_root\n                       38G  8.3G   28G  23% /\ntmpfs                 246M     0  246M   0% /dev/shm\n/dev/sda1             485M   32M  428M   7% /boot\n```\n\n所以我们可以看到 / 根分区是挂载在 **VolGroup-lv_root** 卷组下面的 **root** 逻辑卷\n\n扩容 root 逻辑卷\n```shell\n[root@localhost ~]# lvextend -L+10G /dev/mapper/VolGroup-lv_root  /dev/sda3\n  Extending logical volume lv_root to 48.54 GiB\n  Insufficient free space: 2560 extents needed, but only 2559 available\n\n[root@localhost ~]# lvextend -L+9.99G /dev/mapper/VolGroup-lv_root  /dev/sda3\n  Rounding size to boundary between physical extents: 9.99 GiB\n  Extending logical volume lv_root to 48.53 GiB\n  Logical volume lv_root successfully resized\n```\n\n文件系统扩容:\n```shell\n[root@localhost ~]# resize2fs /dev/mapper/VolGroup-lv_root\nresize2fs 1.41.12 (17-May-2010)\nFilesystem at /dev/mapper/VolGroup-lv_root is mounted on /; on-line resizing required\nold desc_blocks = 3, new_desc_blocks = 4\nPerforming an on-line resize of /dev/mapper/VolGroup-lv_root to 12722176 (4k) blocks.\nThe filesystem on /dev/mapper/VolGroup-lv_root is now 12722176 blocks long.\n```\n扩容完毕！\n```shell\n[root@localhost ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/VolGroup-lv_root\n                       48G  8.4G   37G  19% /\ntmpfs                 246M     0  246M   0% /dev/shm\n/dev/sda1             485M   32M  428M   7% /boot\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/extending-lvm-root-partition-on-centos6-vm.md","raw":"---\ntitle: CentOS 6 虚拟机扩容 LVM 根分区\ntags:\n  - CentOS, LVM, 扩容, 根分区\ncategories:\n  - '*Nix'\ndate: 2019-2-28 17:48:35\nkeywords: CentOS, LVM, 扩容, 根分区, 虚拟机\ndescription: 单位有一台基于 CentOS 6.3 搭建的 Cacti 监控系统，使用了很长一段时间了，最后发现 / 根分区空间已经满了，无法再提供服务，于是有了扩容的需求，以下是扩容过程：\n---\n\n环境介绍：\n- VMware 5.5\n- CentOS 6.3 64-bit\n- / 根分区为 LVM\n- 原磁盘大小 40GB\n- 扩容后磁盘大小： 50GB\n\n查看原来的磁盘文件系统空间状态， 根分区已经 100% 爆了！\n```shell\n[root@localhost ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/VolGroup-lv_root\n                       38G   38G     0 100% /\ntmpfs                 246M     0  246M   0% /dev/shm\n/dev/sda1             485M   32M  428M   7% /boot\n```\n\n在 VMware 中对原磁盘扩容到 50GB, 查看磁盘 sda 已经扩展到 50GB\n**安全起见，在扩容前，建议对数据进行备份。**\n```shell\n[root@localhost ~]# fdisk /dev/sda -l\n\nDisk /dev/sda: 53.7 GB, 53687091200 bytes\n255 heads, 63 sectors/track, 6527 cylinders\nUnits = cylinders of 16065 * 512 = 8225280 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk identifier: 0x00026a39\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/sda1   *           1          64      512000   83  Linux\nPartition 1 does not end on cylinder boundary.\n/dev/sda2              64        5222    41430016   8e  Linux LVM\n```\n在本文的例子中，磁盘 /dev/sda 已经扩展至 53.7 GB 而且当前只有两个主分区，所以我们后面就直接创建主分区 sda3 来帮助扩容。\n\n查看 PV, VG, LV 状态，大小还没有变化\n```shell\n[root@localhost ~]# pvs\n  PV         VG       Fmt  Attr PSize  PFree\n  /dev/sda2  VolGroup lvm2 a--  39.51g    0\n[root@localhost ~]# vgs\n  /etc/lvm/archive/.lvm_localhost.localdomain_18508_1413645104: write error failed: No space left on device\n  Volume group \"VolGroup\" metadata archive failed.\n  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device\n  Backup of volume group VolGroup metadata failed.\n  VG       #PV #LV #SN Attr   VSize  VFree\n  VolGroup   1   2   0 wz--n- 39.51g    0\n[root@localhost ~]# lvs\n  LV      VG       Attr     LSize   Pool Origin Data%  Move Log Copy%  Convert\n  lv_root VolGroup -wi-ao--  38.54g\n  lv_swap VolGroup -wi-ao-- 992.00m\n```\n\n接下来我们需要将扩展出未曾使用的 10GB 空间创建一个新的主分区 **sda3** 来给逻辑卷扩容用。\n```shell\n[root@localhost ~]# fdisk /dev/sda\n\nWARNING: DOS-compatible mode is deprecated. It's strongly recommended to\n         switch off the mode (command 'c') and change display units to\n         sectors (command 'u').\n\nCommand (m for help): m\nCommand action\n   a   toggle a bootable flag\n   b   edit bsd disklabel\n   c   toggle the dos compatibility flag\n   d   delete a partition\n   l   list known partition types\n   m   print this menu\n   n   add a new partition\n   o   create a new empty DOS partition table\n   p   print the partition table\n   q   quit without saving changes\n   s   create a new empty Sun disklabel\n   t   change a partition's system id\n   u   change display/entry units\n   v   verify the partition table\n   w   write table to disk and exit\n   x   extra functionality (experts only)\n\nCommand (m for help): n\nCommand action\n   e   extended\n   p   primary partition (1-4)\np\nPartition number (1-4): 3\nFirst cylinder (5222-6527, default 5222):\nUsing default value 5222\nLast cylinder, +cylinders or +size{K,M,G} (5222-6527, default 6527):\nUsing default value 6527\n```\n\n然后修改分区类型为 8e 并写入分区表保存\n```shell\nCommand (m for help): t\nPartition number (1-4): 3\nHex code (type L to list codes): 8e\nChanged system type of partition 3 to 8e (Linux LVM)\n\nCommand (m for help): w\nThe partition table has been altered!\n\nCalling ioctl() to re-read partition table.\n\nWARNING: Re-reading the partition table failed with error 16: Device or resource busy.\nThe kernel still uses the old table. The new table will be used at\nthe next reboot or after you run partprobe(8) or kpartx(8)\nSyncing disks.\n```\n\n重新扫描磁盘检查分区情况\n```shell\n[root@localhost ~]# partx -v -a /dev/sda\ndevice /dev/sda: start 0 size 104857600\ngpt: 0 slices\ndos: 4 slices\n# 1:      2048-  1026047 (  1024000 sectors,    524 MB)\n# 2:   1026048- 83886079 ( 82860032 sectors,  42424 MB)\n# 3:  83886080-104856254 ( 20970175 sectors,  10736 MB)\n# 4:         0-       -1 (        0 sectors,      0 MB)\nBLKPG: Device or resource busy\nerror adding partition 1\nBLKPG: Device or resource busy\nerror adding partition 2\nadded partition 3\n```\n分区 1/2 的报错可以忽略，我们需要看到的是分区 3 已经添加成功，如果看不到分区 3 或者添加失败需要重启使之生效。\n\n创建新的 PV\n```shell\n[root@localhost ~]# pvcreate /dev/sda3\n  Writing physical volume data to disk \"/dev/sda3\"\n  Physical volume \"/dev/sda3\" successfully created\n```\n\n找到当前系统所使用的卷组名\n```shell\n[root@localhost ~]# vgdisplay\n  --- Volume group ---\n  VG Name               VolGroup\n  System ID\n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               39.51 GiB\n  PE Size               4.00 MiB\n  Total PE              10114\n  Alloc PE / Size       10114 / 39.51 GiB\n  Free  PE / Size       0 / 0\n  VG UUID               2JrSeG-4Is7-ocIQ-zVrN-eha1-gYJQ-L1UnPn\n\n  /etc/lvm/archive/.lvm_localhost.localdomain_15862_675165963: write error failed: No space left on device\n  Volume group \"VolGroup\" metadata archive failed.\n  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device\n  Backup of volume group VolGroup metadata failed.\n```\n**VolGroup** 就是它了！\n\n接下来 **vgextend** 扩容VG：\n```shell\n[root@localhost ~]# vgextend VolGroup /dev/sda3\n  /etc/lvm/archive/.lvm_localhost.localdomain_17322_173527374: write error failed: No space left on device\n  Volume group \"VolGroup\" metadata archive failed.\n  Internal error: Attempt to unlock unlocked VG #orphans.\n```\n结果因为剩余空间为零扩容失败，囧， 删除掉一些文件再试。\n\n```shell\n[root@localhost ~]# vgextend VolGroup /dev/sda3\n  Volume group \"VolGroup\" successfully extended\n```\n\n用 **pvscan** 来查看 PV 空间使用情况来决定谁给谁加以及加多少空间。\n```shell\n[root@localhost ~]# pvscan\n  PV /dev/sda2   VG VolGroup   lvm2 [39.51 GiB / 0    free]\n  PV /dev/sda3   VG VolGroup   lvm2 [10.00 GiB / 10.00 GiB free]\n  Total: 2 [49.50 GiB] / in use: 2 [49.50 GiB] / in no VG: 0 [0   ]\n```\n\n在本文例子中我们需要增加 / 根分区的空间，用 **df** 命令来查看根分区所挂载的逻辑卷。\n```shell\n[root@localhost ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/VolGroup-lv_root\n                       38G  8.3G   28G  23% /\ntmpfs                 246M     0  246M   0% /dev/shm\n/dev/sda1             485M   32M  428M   7% /boot\n```\n\n所以我们可以看到 / 根分区是挂载在 **VolGroup-lv_root** 卷组下面的 **root** 逻辑卷\n\n扩容 root 逻辑卷\n```shell\n[root@localhost ~]# lvextend -L+10G /dev/mapper/VolGroup-lv_root  /dev/sda3\n  Extending logical volume lv_root to 48.54 GiB\n  Insufficient free space: 2560 extents needed, but only 2559 available\n\n[root@localhost ~]# lvextend -L+9.99G /dev/mapper/VolGroup-lv_root  /dev/sda3\n  Rounding size to boundary between physical extents: 9.99 GiB\n  Extending logical volume lv_root to 48.53 GiB\n  Logical volume lv_root successfully resized\n```\n\n文件系统扩容:\n```shell\n[root@localhost ~]# resize2fs /dev/mapper/VolGroup-lv_root\nresize2fs 1.41.12 (17-May-2010)\nFilesystem at /dev/mapper/VolGroup-lv_root is mounted on /; on-line resizing required\nold desc_blocks = 3, new_desc_blocks = 4\nPerforming an on-line resize of /dev/mapper/VolGroup-lv_root to 12722176 (4k) blocks.\nThe filesystem on /dev/mapper/VolGroup-lv_root is now 12722176 blocks long.\n```\n扩容完毕！\n```shell\n[root@localhost ~]# df -h\nFilesystem            Size  Used Avail Use% Mounted on\n/dev/mapper/VolGroup-lv_root\n                       48G  8.4G   37G  19% /\ntmpfs                 246M     0  246M   0% /dev/shm\n/dev/sda1             485M   32M  428M   7% /boot\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"extending-lvm-root-partition-on-centos6-vm","published":1,"updated":"2019-03-07T09:38:17.330Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktf000uk84sgy12ao9i","content":"<html><head></head><body><p>环境介绍：</p>\n<ul>\n<li>VMware 5.5</li>\n<li>CentOS 6.3 64-bit</li>\n<li>/ 根分区为 LVM</li>\n<li>原磁盘大小 40GB</li>\n<li>扩容后磁盘大小： 50GB</li>\n</ul>\n<p>查看原来的磁盘文件系统空间状态， 根分区已经 100% 爆了！</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# df -h</span><br><span class=\"line\">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class=\"line\">/dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">                       38G   38G     0 100% /</span><br><span class=\"line\">tmpfs                 246M     0  246M   0% /dev/shm</span><br><span class=\"line\">/dev/sda1             485M   32M  428M   7% /boot</span><br></pre></td></tr></tbody></table></figure>\n\n<p>在 VMware 中对原磁盘扩容到 50GB, 查看磁盘 sda 已经扩展到 50GB<br><strong>安全起见，在扩容前，建议对数据进行备份。</strong></p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# fdisk /dev/sda -l</span><br><span class=\"line\"></span><br><span class=\"line\">Disk /dev/sda: 53.7 GB, 53687091200 bytes</span><br><span class=\"line\">255 heads, 63 sectors/track, 6527 cylinders</span><br><span class=\"line\">Units = cylinders of 16065 * 512 = 8225280 bytes</span><br><span class=\"line\">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class=\"line\">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class=\"line\">Disk identifier: 0x00026a39</span><br><span class=\"line\"></span><br><span class=\"line\">   Device Boot      Start         End      Blocks   Id  System</span><br><span class=\"line\">/dev/sda1   *           1          64      512000   83  Linux</span><br><span class=\"line\">Partition 1 does not end on cylinder boundary.</span><br><span class=\"line\">/dev/sda2              64        5222    41430016   8e  Linux LVM</span><br></pre></td></tr></tbody></table></figure>\n<p>在本文的例子中，磁盘 /dev/sda 已经扩展至 53.7 GB 而且当前只有两个主分区，所以我们后面就直接创建主分区 sda3 来帮助扩容。</p>\n<p>查看 PV, VG, LV 状态，大小还没有变化</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# pvs</span><br><span class=\"line\">  PV         VG       Fmt  Attr PSize  PFree</span><br><span class=\"line\">  /dev/sda2  VolGroup lvm2 a--  39.51g    0</span><br><span class=\"line\">[root@localhost ~]# vgs</span><br><span class=\"line\">  /etc/lvm/archive/.lvm_localhost.localdomain_18508_1413645104: write error failed: No space left on device</span><br><span class=\"line\">  Volume group \"VolGroup\" metadata archive failed.</span><br><span class=\"line\">  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device</span><br><span class=\"line\">  Backup of volume group VolGroup metadata failed.</span><br><span class=\"line\">  VG       #PV #LV #SN Attr   VSize  VFree</span><br><span class=\"line\">  VolGroup   1   2   0 wz--n- 39.51g    0</span><br><span class=\"line\">[root@localhost ~]# lvs</span><br><span class=\"line\">  LV      VG       Attr     LSize   Pool Origin Data%  Move Log Copy%  Convert</span><br><span class=\"line\">  lv_root VolGroup -wi-ao--  38.54g</span><br><span class=\"line\">  lv_swap VolGroup -wi-ao-- 992.00m</span><br></pre></td></tr></tbody></table></figure>\n\n<p>接下来我们需要将扩展出未曾使用的 10GB 空间创建一个新的主分区 <strong>sda3</strong> 来给逻辑卷扩容用。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# fdisk /dev/sda</span><br><span class=\"line\"></span><br><span class=\"line\">WARNING: DOS-compatible mode is deprecated. It's strongly recommended to</span><br><span class=\"line\">         switch off the mode (command 'c') and change display units to</span><br><span class=\"line\">         sectors (command 'u').</span><br><span class=\"line\"></span><br><span class=\"line\">Command (m for help): m</span><br><span class=\"line\">Command action</span><br><span class=\"line\">   a   toggle a bootable flag</span><br><span class=\"line\">   b   edit bsd disklabel</span><br><span class=\"line\">   c   toggle the dos compatibility flag</span><br><span class=\"line\">   d   delete a partition</span><br><span class=\"line\">   l   list known partition types</span><br><span class=\"line\">   m   print this menu</span><br><span class=\"line\">   n   add a new partition</span><br><span class=\"line\">   o   create a new empty DOS partition table</span><br><span class=\"line\">   p   print the partition table</span><br><span class=\"line\">   q   quit without saving changes</span><br><span class=\"line\">   s   create a new empty Sun disklabel</span><br><span class=\"line\">   t   change a partition's system id</span><br><span class=\"line\">   u   change display/entry units</span><br><span class=\"line\">   v   verify the partition table</span><br><span class=\"line\">   w   write table to disk and exit</span><br><span class=\"line\">   x   extra functionality (experts only)</span><br><span class=\"line\"></span><br><span class=\"line\">Command (m for help): n</span><br><span class=\"line\">Command action</span><br><span class=\"line\">   e   extended</span><br><span class=\"line\">   p   primary partition (1-4)</span><br><span class=\"line\">p</span><br><span class=\"line\">Partition number (1-4): 3</span><br><span class=\"line\">First cylinder (5222-6527, default 5222):</span><br><span class=\"line\">Using default value 5222</span><br><span class=\"line\">Last cylinder, +cylinders or +size{K,M,G} (5222-6527, default 6527):</span><br><span class=\"line\">Using default value 6527</span><br></pre></td></tr></tbody></table></figure>\n\n<p>然后修改分区类型为 8e 并写入分区表保存</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Command (m for help): t</span><br><span class=\"line\">Partition number (1-4): 3</span><br><span class=\"line\">Hex code (type L to list codes): 8e</span><br><span class=\"line\">Changed system type of partition 3 to 8e (Linux LVM)</span><br><span class=\"line\"></span><br><span class=\"line\">Command (m for help): w</span><br><span class=\"line\">The partition table has been altered!</span><br><span class=\"line\"></span><br><span class=\"line\">Calling ioctl() to re-read partition table.</span><br><span class=\"line\"></span><br><span class=\"line\">WARNING: Re-reading the partition table failed with error 16: Device or resource busy.</span><br><span class=\"line\">The kernel still uses the old table. The new table will be used at</span><br><span class=\"line\">the next reboot or after you run partprobe(8) or kpartx(8)</span><br><span class=\"line\">Syncing disks.</span><br></pre></td></tr></tbody></table></figure>\n\n<p>重新扫描磁盘检查分区情况</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# partx -v -a /dev/sda</span><br><span class=\"line\">device /dev/sda: start 0 size 104857600</span><br><span class=\"line\">gpt: 0 slices</span><br><span class=\"line\">dos: 4 slices</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">1:      2048-  1026047 (  1024000 sectors,    524 MB)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">2:   1026048- 83886079 ( 82860032 sectors,  42424 MB)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">3:  83886080-104856254 ( 20970175 sectors,  10736 MB)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">4:         0-       -1 (        0 sectors,      0 MB)</span></span><br><span class=\"line\">BLKPG: Device or resource busy</span><br><span class=\"line\">error adding partition 1</span><br><span class=\"line\">BLKPG: Device or resource busy</span><br><span class=\"line\">error adding partition 2</span><br><span class=\"line\">added partition 3</span><br></pre></td></tr></tbody></table></figure>\n<p>分区 1/2 的报错可以忽略，我们需要看到的是分区 3 已经添加成功，如果看不到分区 3 或者添加失败需要重启使之生效。</p>\n<p>创建新的 PV</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# pvcreate /dev/sda3</span><br><span class=\"line\">  Writing physical volume data to disk \"/dev/sda3\"</span><br><span class=\"line\">  Physical volume \"/dev/sda3\" successfully created</span><br></pre></td></tr></tbody></table></figure>\n\n<p>找到当前系统所使用的卷组名</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# vgdisplay</span><br><span class=\"line\">  --- Volume group ---</span><br><span class=\"line\">  VG Name               VolGroup</span><br><span class=\"line\">  System ID</span><br><span class=\"line\">  Format                lvm2</span><br><span class=\"line\">  Metadata Areas        1</span><br><span class=\"line\">  Metadata Sequence No  3</span><br><span class=\"line\">  VG Access             read/write</span><br><span class=\"line\">  VG Status             resizable</span><br><span class=\"line\">  MAX LV                0</span><br><span class=\"line\">  Cur LV                2</span><br><span class=\"line\">  Open LV               2</span><br><span class=\"line\">  Max PV                0</span><br><span class=\"line\">  Cur PV                1</span><br><span class=\"line\">  Act PV                1</span><br><span class=\"line\">  VG Size               39.51 GiB</span><br><span class=\"line\">  PE Size               4.00 MiB</span><br><span class=\"line\">  Total PE              10114</span><br><span class=\"line\">  Alloc PE / Size       10114 / 39.51 GiB</span><br><span class=\"line\">  Free  PE / Size       0 / 0</span><br><span class=\"line\">  VG UUID               2JrSeG-4Is7-ocIQ-zVrN-eha1-gYJQ-L1UnPn</span><br><span class=\"line\"></span><br><span class=\"line\">  /etc/lvm/archive/.lvm_localhost.localdomain_15862_675165963: write error failed: No space left on device</span><br><span class=\"line\">  Volume group \"VolGroup\" metadata archive failed.</span><br><span class=\"line\">  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device</span><br><span class=\"line\">  Backup of volume group VolGroup metadata failed.</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>VolGroup</strong> 就是它了！</p>\n<p>接下来 <strong>vgextend</strong> 扩容VG：</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# vgextend VolGroup /dev/sda3</span><br><span class=\"line\">  /etc/lvm/archive/.lvm_localhost.localdomain_17322_173527374: write error failed: No space left on device</span><br><span class=\"line\">  Volume group \"VolGroup\" metadata archive failed.</span><br><span class=\"line\">  Internal error: Attempt to unlock unlocked VG #orphans.</span><br></pre></td></tr></tbody></table></figure>\n<p>结果因为剩余空间为零扩容失败，囧， 删除掉一些文件再试。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# vgextend VolGroup /dev/sda3</span><br><span class=\"line\">  Volume group \"VolGroup\" successfully extended</span><br></pre></td></tr></tbody></table></figure>\n\n<p>用 <strong>pvscan</strong> 来查看 PV 空间使用情况来决定谁给谁加以及加多少空间。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# pvscan</span><br><span class=\"line\">  PV /dev/sda2   VG VolGroup   lvm2 [39.51 GiB / 0    free]</span><br><span class=\"line\">  PV /dev/sda3   VG VolGroup   lvm2 [10.00 GiB / 10.00 GiB free]</span><br><span class=\"line\">  Total: 2 [49.50 GiB] / in use: 2 [49.50 GiB] / in no VG: 0 [0   ]</span><br></pre></td></tr></tbody></table></figure>\n\n<p>在本文例子中我们需要增加 / 根分区的空间，用 <strong>df</strong> 命令来查看根分区所挂载的逻辑卷。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# df -h</span><br><span class=\"line\">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class=\"line\">/dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">                       38G  8.3G   28G  23% /</span><br><span class=\"line\">tmpfs                 246M     0  246M   0% /dev/shm</span><br><span class=\"line\">/dev/sda1             485M   32M  428M   7% /boot</span><br></pre></td></tr></tbody></table></figure>\n\n<p>所以我们可以看到 / 根分区是挂载在 <strong>VolGroup-lv_root</strong> 卷组下面的 <strong>root</strong> 逻辑卷</p>\n<p>扩容 root 逻辑卷</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# lvextend -L+10G /dev/mapper/VolGroup-lv_root  /dev/sda3</span><br><span class=\"line\">  Extending logical volume lv_root to 48.54 GiB</span><br><span class=\"line\">  Insufficient free space: 2560 extents needed, but only 2559 available</span><br><span class=\"line\"></span><br><span class=\"line\">[root@localhost ~]# lvextend -L+9.99G /dev/mapper/VolGroup-lv_root  /dev/sda3</span><br><span class=\"line\">  Rounding size to boundary between physical extents: 9.99 GiB</span><br><span class=\"line\">  Extending logical volume lv_root to 48.53 GiB</span><br><span class=\"line\">  Logical volume lv_root successfully resized</span><br></pre></td></tr></tbody></table></figure>\n\n<p>文件系统扩容:</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# resize2fs /dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">resize2fs 1.41.12 (17-May-2010)</span><br><span class=\"line\">Filesystem at /dev/mapper/VolGroup-lv_root is mounted on /; on-line resizing required</span><br><span class=\"line\">old desc_blocks = 3, new_desc_blocks = 4</span><br><span class=\"line\">Performing an on-line resize of /dev/mapper/VolGroup-lv_root to 12722176 (4k) blocks.</span><br><span class=\"line\">The filesystem on /dev/mapper/VolGroup-lv_root is now 12722176 blocks long.</span><br></pre></td></tr></tbody></table></figure>\n<p>扩容完毕！</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# df -h</span><br><span class=\"line\">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class=\"line\">/dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">                       48G  8.4G   37G  19% /</span><br><span class=\"line\">tmpfs                 246M     0  246M   0% /dev/shm</span><br><span class=\"line\">/dev/sda1             485M   32M  428M   7% /boot</span><br></pre></td></tr></tbody></table></figure>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>环境介绍：</p>\n<ul>\n<li>VMware 5.5</li>\n<li>CentOS 6.3 64-bit</li>\n<li>/ 根分区为 LVM</li>\n<li>原磁盘大小 40GB</li>\n<li>扩容后磁盘大小： 50GB</li>\n</ul>\n<p>查看原来的磁盘文件系统空间状态， 根分区已经 100% 爆了！</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# df -h</span><br><span class=\"line\">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class=\"line\">/dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">                       38G   38G     0 100% /</span><br><span class=\"line\">tmpfs                 246M     0  246M   0% /dev/shm</span><br><span class=\"line\">/dev/sda1             485M   32M  428M   7% /boot</span><br></pre></td></tr></tbody></table></figure>\n\n<p>在 VMware 中对原磁盘扩容到 50GB, 查看磁盘 sda 已经扩展到 50GB<br><strong>安全起见，在扩容前，建议对数据进行备份。</strong></p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# fdisk /dev/sda -l</span><br><span class=\"line\"></span><br><span class=\"line\">Disk /dev/sda: 53.7 GB, 53687091200 bytes</span><br><span class=\"line\">255 heads, 63 sectors/track, 6527 cylinders</span><br><span class=\"line\">Units = cylinders of 16065 * 512 = 8225280 bytes</span><br><span class=\"line\">Sector size (logical/physical): 512 bytes / 512 bytes</span><br><span class=\"line\">I/O size (minimum/optimal): 512 bytes / 512 bytes</span><br><span class=\"line\">Disk identifier: 0x00026a39</span><br><span class=\"line\"></span><br><span class=\"line\">   Device Boot      Start         End      Blocks   Id  System</span><br><span class=\"line\">/dev/sda1   *           1          64      512000   83  Linux</span><br><span class=\"line\">Partition 1 does not end on cylinder boundary.</span><br><span class=\"line\">/dev/sda2              64        5222    41430016   8e  Linux LVM</span><br></pre></td></tr></tbody></table></figure>\n<p>在本文的例子中，磁盘 /dev/sda 已经扩展至 53.7 GB 而且当前只有两个主分区，所以我们后面就直接创建主分区 sda3 来帮助扩容。</p>\n<p>查看 PV, VG, LV 状态，大小还没有变化</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# pvs</span><br><span class=\"line\">  PV         VG       Fmt  Attr PSize  PFree</span><br><span class=\"line\">  /dev/sda2  VolGroup lvm2 a--  39.51g    0</span><br><span class=\"line\">[root@localhost ~]# vgs</span><br><span class=\"line\">  /etc/lvm/archive/.lvm_localhost.localdomain_18508_1413645104: write error failed: No space left on device</span><br><span class=\"line\">  Volume group \"VolGroup\" metadata archive failed.</span><br><span class=\"line\">  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device</span><br><span class=\"line\">  Backup of volume group VolGroup metadata failed.</span><br><span class=\"line\">  VG       #PV #LV #SN Attr   VSize  VFree</span><br><span class=\"line\">  VolGroup   1   2   0 wz--n- 39.51g    0</span><br><span class=\"line\">[root@localhost ~]# lvs</span><br><span class=\"line\">  LV      VG       Attr     LSize   Pool Origin Data%  Move Log Copy%  Convert</span><br><span class=\"line\">  lv_root VolGroup -wi-ao--  38.54g</span><br><span class=\"line\">  lv_swap VolGroup -wi-ao-- 992.00m</span><br></pre></td></tr></tbody></table></figure>\n\n<p>接下来我们需要将扩展出未曾使用的 10GB 空间创建一个新的主分区 <strong>sda3</strong> 来给逻辑卷扩容用。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# fdisk /dev/sda</span><br><span class=\"line\"></span><br><span class=\"line\">WARNING: DOS-compatible mode is deprecated. It's strongly recommended to</span><br><span class=\"line\">         switch off the mode (command 'c') and change display units to</span><br><span class=\"line\">         sectors (command 'u').</span><br><span class=\"line\"></span><br><span class=\"line\">Command (m for help): m</span><br><span class=\"line\">Command action</span><br><span class=\"line\">   a   toggle a bootable flag</span><br><span class=\"line\">   b   edit bsd disklabel</span><br><span class=\"line\">   c   toggle the dos compatibility flag</span><br><span class=\"line\">   d   delete a partition</span><br><span class=\"line\">   l   list known partition types</span><br><span class=\"line\">   m   print this menu</span><br><span class=\"line\">   n   add a new partition</span><br><span class=\"line\">   o   create a new empty DOS partition table</span><br><span class=\"line\">   p   print the partition table</span><br><span class=\"line\">   q   quit without saving changes</span><br><span class=\"line\">   s   create a new empty Sun disklabel</span><br><span class=\"line\">   t   change a partition's system id</span><br><span class=\"line\">   u   change display/entry units</span><br><span class=\"line\">   v   verify the partition table</span><br><span class=\"line\">   w   write table to disk and exit</span><br><span class=\"line\">   x   extra functionality (experts only)</span><br><span class=\"line\"></span><br><span class=\"line\">Command (m for help): n</span><br><span class=\"line\">Command action</span><br><span class=\"line\">   e   extended</span><br><span class=\"line\">   p   primary partition (1-4)</span><br><span class=\"line\">p</span><br><span class=\"line\">Partition number (1-4): 3</span><br><span class=\"line\">First cylinder (5222-6527, default 5222):</span><br><span class=\"line\">Using default value 5222</span><br><span class=\"line\">Last cylinder, +cylinders or +size{K,M,G} (5222-6527, default 6527):</span><br><span class=\"line\">Using default value 6527</span><br></pre></td></tr></tbody></table></figure>\n\n<p>然后修改分区类型为 8e 并写入分区表保存</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Command (m for help): t</span><br><span class=\"line\">Partition number (1-4): 3</span><br><span class=\"line\">Hex code (type L to list codes): 8e</span><br><span class=\"line\">Changed system type of partition 3 to 8e (Linux LVM)</span><br><span class=\"line\"></span><br><span class=\"line\">Command (m for help): w</span><br><span class=\"line\">The partition table has been altered!</span><br><span class=\"line\"></span><br><span class=\"line\">Calling ioctl() to re-read partition table.</span><br><span class=\"line\"></span><br><span class=\"line\">WARNING: Re-reading the partition table failed with error 16: Device or resource busy.</span><br><span class=\"line\">The kernel still uses the old table. The new table will be used at</span><br><span class=\"line\">the next reboot or after you run partprobe(8) or kpartx(8)</span><br><span class=\"line\">Syncing disks.</span><br></pre></td></tr></tbody></table></figure>\n\n<p>重新扫描磁盘检查分区情况</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# partx -v -a /dev/sda</span><br><span class=\"line\">device /dev/sda: start 0 size 104857600</span><br><span class=\"line\">gpt: 0 slices</span><br><span class=\"line\">dos: 4 slices</span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">1:      2048-  1026047 (  1024000 sectors,    524 MB)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">2:   1026048- 83886079 ( 82860032 sectors,  42424 MB)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">3:  83886080-104856254 ( 20970175 sectors,  10736 MB)</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">4:         0-       -1 (        0 sectors,      0 MB)</span></span><br><span class=\"line\">BLKPG: Device or resource busy</span><br><span class=\"line\">error adding partition 1</span><br><span class=\"line\">BLKPG: Device or resource busy</span><br><span class=\"line\">error adding partition 2</span><br><span class=\"line\">added partition 3</span><br></pre></td></tr></tbody></table></figure>\n<p>分区 1/2 的报错可以忽略，我们需要看到的是分区 3 已经添加成功，如果看不到分区 3 或者添加失败需要重启使之生效。</p>\n<p>创建新的 PV</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# pvcreate /dev/sda3</span><br><span class=\"line\">  Writing physical volume data to disk \"/dev/sda3\"</span><br><span class=\"line\">  Physical volume \"/dev/sda3\" successfully created</span><br></pre></td></tr></tbody></table></figure>\n\n<p>找到当前系统所使用的卷组名</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# vgdisplay</span><br><span class=\"line\">  --- Volume group ---</span><br><span class=\"line\">  VG Name               VolGroup</span><br><span class=\"line\">  System ID</span><br><span class=\"line\">  Format                lvm2</span><br><span class=\"line\">  Metadata Areas        1</span><br><span class=\"line\">  Metadata Sequence No  3</span><br><span class=\"line\">  VG Access             read/write</span><br><span class=\"line\">  VG Status             resizable</span><br><span class=\"line\">  MAX LV                0</span><br><span class=\"line\">  Cur LV                2</span><br><span class=\"line\">  Open LV               2</span><br><span class=\"line\">  Max PV                0</span><br><span class=\"line\">  Cur PV                1</span><br><span class=\"line\">  Act PV                1</span><br><span class=\"line\">  VG Size               39.51 GiB</span><br><span class=\"line\">  PE Size               4.00 MiB</span><br><span class=\"line\">  Total PE              10114</span><br><span class=\"line\">  Alloc PE / Size       10114 / 39.51 GiB</span><br><span class=\"line\">  Free  PE / Size       0 / 0</span><br><span class=\"line\">  VG UUID               2JrSeG-4Is7-ocIQ-zVrN-eha1-gYJQ-L1UnPn</span><br><span class=\"line\"></span><br><span class=\"line\">  /etc/lvm/archive/.lvm_localhost.localdomain_15862_675165963: write error failed: No space left on device</span><br><span class=\"line\">  Volume group \"VolGroup\" metadata archive failed.</span><br><span class=\"line\">  /etc/lvm/backup/VolGroup.tmp: write error failed: No space left on device</span><br><span class=\"line\">  Backup of volume group VolGroup metadata failed.</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>VolGroup</strong> 就是它了！</p>\n<p>接下来 <strong>vgextend</strong> 扩容VG：</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# vgextend VolGroup /dev/sda3</span><br><span class=\"line\">  /etc/lvm/archive/.lvm_localhost.localdomain_17322_173527374: write error failed: No space left on device</span><br><span class=\"line\">  Volume group \"VolGroup\" metadata archive failed.</span><br><span class=\"line\">  Internal error: Attempt to unlock unlocked VG #orphans.</span><br></pre></td></tr></tbody></table></figure>\n<p>结果因为剩余空间为零扩容失败，囧， 删除掉一些文件再试。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# vgextend VolGroup /dev/sda3</span><br><span class=\"line\">  Volume group \"VolGroup\" successfully extended</span><br></pre></td></tr></tbody></table></figure>\n\n<p>用 <strong>pvscan</strong> 来查看 PV 空间使用情况来决定谁给谁加以及加多少空间。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# pvscan</span><br><span class=\"line\">  PV /dev/sda2   VG VolGroup   lvm2 [39.51 GiB / 0    free]</span><br><span class=\"line\">  PV /dev/sda3   VG VolGroup   lvm2 [10.00 GiB / 10.00 GiB free]</span><br><span class=\"line\">  Total: 2 [49.50 GiB] / in use: 2 [49.50 GiB] / in no VG: 0 [0   ]</span><br></pre></td></tr></tbody></table></figure>\n\n<p>在本文例子中我们需要增加 / 根分区的空间，用 <strong>df</strong> 命令来查看根分区所挂载的逻辑卷。</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# df -h</span><br><span class=\"line\">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class=\"line\">/dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">                       38G  8.3G   28G  23% /</span><br><span class=\"line\">tmpfs                 246M     0  246M   0% /dev/shm</span><br><span class=\"line\">/dev/sda1             485M   32M  428M   7% /boot</span><br></pre></td></tr></tbody></table></figure>\n\n<p>所以我们可以看到 / 根分区是挂载在 <strong>VolGroup-lv_root</strong> 卷组下面的 <strong>root</strong> 逻辑卷</p>\n<p>扩容 root 逻辑卷</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# lvextend -L+10G /dev/mapper/VolGroup-lv_root  /dev/sda3</span><br><span class=\"line\">  Extending logical volume lv_root to 48.54 GiB</span><br><span class=\"line\">  Insufficient free space: 2560 extents needed, but only 2559 available</span><br><span class=\"line\"></span><br><span class=\"line\">[root@localhost ~]# lvextend -L+9.99G /dev/mapper/VolGroup-lv_root  /dev/sda3</span><br><span class=\"line\">  Rounding size to boundary between physical extents: 9.99 GiB</span><br><span class=\"line\">  Extending logical volume lv_root to 48.53 GiB</span><br><span class=\"line\">  Logical volume lv_root successfully resized</span><br></pre></td></tr></tbody></table></figure>\n\n<p>文件系统扩容:</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# resize2fs /dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">resize2fs 1.41.12 (17-May-2010)</span><br><span class=\"line\">Filesystem at /dev/mapper/VolGroup-lv_root is mounted on /; on-line resizing required</span><br><span class=\"line\">old desc_blocks = 3, new_desc_blocks = 4</span><br><span class=\"line\">Performing an on-line resize of /dev/mapper/VolGroup-lv_root to 12722176 (4k) blocks.</span><br><span class=\"line\">The filesystem on /dev/mapper/VolGroup-lv_root is now 12722176 blocks long.</span><br></pre></td></tr></tbody></table></figure>\n<p>扩容完毕！</p>\n<figure class=\"highlight shell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@localhost ~]# df -h</span><br><span class=\"line\">Filesystem            Size  Used Avail Use% Mounted on</span><br><span class=\"line\">/dev/mapper/VolGroup-lv_root</span><br><span class=\"line\">                       48G  8.4G   37G  19% /</span><br><span class=\"line\">tmpfs                 246M     0  246M   0% /dev/shm</span><br><span class=\"line\">/dev/sda1             485M   32M  428M   7% /boot</span><br></pre></td></tr></tbody></table></figure>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n</body></html>"},{"title":"解决 Windows 下 Java8 的 1603 安装错误","id":"260","date":"2015-03-19T14:40:11.000Z","_content":"近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。\n![Java8u40 Install Error Code: 1603](fix-java8-install-1603-error/Java8_Error_1603.png)\n\n最后终于解决：\n1. 关闭 Java 安装程序;\n2. 在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 **javacpl.exe** 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）\n3. 在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；\n4. 重新尝试安装 Java8u40;\n5. 安装成功后再次运行 **javacpl.exe**，恢复勾选 `Enable Java content in browser`\n","source":"_posts/fix-java8-install-1603-error.md","raw":"---\ntitle: 解决 Windows 下 Java8 的 1603 安装错误\ntags:\n  - Java\n  - JRE\n  - MSI\nid: 260\ncategories:\n  - Microsoft\ndate: 2015-03-19 22:40:11\n---\n近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。\n![Java8u40 Install Error Code: 1603](fix-java8-install-1603-error/Java8_Error_1603.png)\n\n最后终于解决：\n1. 关闭 Java 安装程序;\n2. 在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 **javacpl.exe** 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）\n3. 在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；\n4. 重新尝试安装 Java8u40;\n5. 安装成功后再次运行 **javacpl.exe**，恢复勾选 `Enable Java content in browser`\n","slug":"fix-java8-install-1603-error","published":1,"updated":"2020-01-05T09:00:53.950Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktg000xk84s08k5861p","content":"<html><head></head><body><p>近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。<br><img src=\"/fix-java8-install-1603-error/Java8_Error_1603.png\" alt=\"Java8u40 Install Error Code: 1603\"></p>\n<p>最后终于解决：</p>\n<ol>\n<li>关闭 Java 安装程序;</li>\n<li>在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 <strong>javacpl.exe</strong> 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）</li>\n<li>在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；</li>\n<li>重新尝试安装 Java8u40;</li>\n<li>安装成功后再次运行 <strong>javacpl.exe</strong>，恢复勾选 <code>Enable Java content in browser</code></li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。<br><img src=\"/fix-java8-install-1603-error/Java8_Error_1603.png\" alt=\"Java8u40 Install Error Code: 1603\"></p>\n<p>最后终于解决：</p>\n<ol>\n<li>关闭 Java 安装程序;</li>\n<li>在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 <strong>javacpl.exe</strong> 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）</li>\n<li>在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；</li>\n<li>重新尝试安装 Java8u40;</li>\n<li>安装成功后再次运行 <strong>javacpl.exe</strong>，恢复勾选 <code>Enable Java content in browser</code></li>\n</ol>\n</body></html>"},{"title":"解决 VMWare ESXi 4.0 在 VC 中主机硬件状态无法监控的问题","date":"2010-06-15T07:15:52.000Z","_content":"\n最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现\n> Error Message: \"Hardware monitoring service not responding, the host is not powered on\"\n\n重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：\n在 VC 中删掉原来的主机再重新添加,问题就解决了。","source":"_posts/fix-vmware-esxi-40-vc-hardware-status-error.md","raw":"---\ntitle: 解决 VMWare ESXi 4.0 在 VC 中主机硬件状态无法监控的问题\ntags:\n  - Virtual Center\n  - VMware\ncategories:\n  - 虚拟化\ndate: 2010-06-15 15:15:52\n---\n\n最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现\n> Error Message: \"Hardware monitoring service not responding, the host is not powered on\"\n\n重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：\n在 VC 中删掉原来的主机再重新添加,问题就解决了。","slug":"fix-vmware-esxi-40-vc-hardware-status-error","published":1,"updated":"2020-01-05T09:00:53.951Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kth000yk84s473x848b","content":"<html><head></head><body><p>最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现</p>\n<blockquote>\n<p>Error Message: “Hardware monitoring service not responding, the host is not powered on”</p>\n</blockquote>\n<p>重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：<br>在 VC 中删掉原来的主机再重新添加,问题就解决了。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现</p>\n<blockquote>\n<p>Error Message: “Hardware monitoring service not responding, the host is not powered on”</p>\n</blockquote>\n<p>重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：<br>在 VC 中删掉原来的主机再重新添加,问题就解决了。</p>\n</body></html>"},{"title":"解决 WSUS 下载速度慢的问题","date":"2014-06-10T06:40:11.000Z","_content":"\n解决 WSUS 下载速度慢的问题:\n\n新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。\n\n出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。\n\n解决方案：\n\n1.  如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername%\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n\n2. 如果你使用 SQL 数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername% -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n最后重启WSUS服务生效。\n\n注：**BITS** (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。","source":"_posts/fix-wsus-slow-download-problem.md","raw":"---\ntitle: 解决 WSUS 下载速度慢的问题\ntags:\n  - BITS\n  - Microsoft\n  - WSUS\ncategories:\n  - Microsoft\ndate: 2014-06-10 14:40:11\n---\n\n解决 WSUS 下载速度慢的问题:\n\n新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。\n\n出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。\n\n解决方案：\n\n1.  如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername%\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n\n2. 如果你使用 SQL 数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername% -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n最后重启WSUS服务生效。\n\n注：**BITS** (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。","slug":"fix-wsus-slow-download-problem","published":1,"updated":"2020-01-05T09:00:53.951Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kti0012k84s6zmm67bo","content":"<html><head></head><body><p>解决 WSUS 下载速度慢的问题:</p>\n<p>新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。</p>\n<p>出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。</p>\n<p>解决方案：</p>\n<ol>\n<li><p>&nbsp;如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：</p>\n<figure class=\"highlight cmd\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span>\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>如果你使用 SQL 数据库：</p>\n<figure class=\"highlight cmd\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span> -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</span><br></pre></td></tr></tbody></table></figure>\n<p>最后重启WSUS服务生效。</p>\n</li>\n</ol>\n<p>注：<strong>BITS</strong> (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>解决 WSUS 下载速度慢的问题:</p>\n<p>新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。</p>\n<p>出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。</p>\n<p>解决方案：</p>\n<ol>\n<li><p>&nbsp;如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：</p>\n<figure class=\"highlight cmd\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span>\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</span><br></pre></td></tr></tbody></table></figure>\n</li>\n<li><p>如果你使用 SQL 数据库：</p>\n<figure class=\"highlight cmd\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span> -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</span><br></pre></td></tr></tbody></table></figure>\n<p>最后重启WSUS服务生效。</p>\n</li>\n</ol>\n<p>注：<strong>BITS</strong> (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。</p>\n</body></html>"},{"title":"Fixed: Please wait while Windows configures Microsoft Office Professional Plus 2010","date":"2014-04-28T04:02:35.000Z","_content":"\n上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：\n\n![Windows configures microsoft office ](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg)\n\nPlease wait while windows configures Microsoft Office Professional Plus 2010.\n\n而且是每次都会有，不厌其烦。微软官方也给出了解决方案：\n\n请参考KB2528748: [http://support.microsoft.com/kb/2528748](http://support.microsoft.com/kb/2528748 \"Microsoft Office 2010 Professional Plus configures each time you start\")\n\n运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：\n\n\n![EventID-1004](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg)\n\nThe resource 'HKEY_CLASSES_ROOT\\.aw\\' does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM 账号，然后赋予如下权限即可。\n\n![Permissions-aw](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg)\n\nBy the way, 这个方法适用于所有 Office 系列。\n","source":"_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010.md","raw":"---\ntitle: 'Fixed: Please wait while Windows configures Microsoft Office Professional Plus 2010'\ntags:\n  - Microsoft\n  - MSI\n  - Office\n  - Windows\ncategories:\n  - Microsoft\n  - Office\ndate: 2014-04-28 12:02:35\n---\n\n上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：\n\n![Windows configures microsoft office ](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg)\n\nPlease wait while windows configures Microsoft Office Professional Plus 2010.\n\n而且是每次都会有，不厌其烦。微软官方也给出了解决方案：\n\n请参考KB2528748: [http://support.microsoft.com/kb/2528748](http://support.microsoft.com/kb/2528748 \"Microsoft Office 2010 Professional Plus configures each time you start\")\n\n运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：\n\n\n![EventID-1004](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg)\n\nThe resource 'HKEY_CLASSES_ROOT\\.aw\\' does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM 账号，然后赋予如下权限即可。\n\n![Permissions-aw](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg)\n\nBy the way, 这个方法适用于所有 Office 系列。\n","slug":"fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010","published":1,"updated":"2020-01-05T09:00:53.951Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktj0015k84s28lvbk1k","content":"<html><head></head><body><p>上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：</p>\n<p><img src=\"/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg\" alt=\"Windows configures microsoft office \"></p>\n<p>Please wait while windows configures Microsoft Office Professional Plus 2010.</p>\n<p>而且是每次都会有，不厌其烦。微软官方也给出了解决方案：</p>\n<p>请参考KB2528748:&nbsp;<a href=\"http://support.microsoft.com/kb/2528748\" title=\"Microsoft Office 2010 Professional Plus configures each time you start\">http://support.microsoft.com/kb/2528748</a></p>\n<p>运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：</p>\n<p><img src=\"/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg\" alt=\"EventID-1004\"></p>\n<p>The resource ‘HKEY_CLASSES_ROOT.aw' does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM&nbsp;账号，然后赋予如下权限即可。</p>\n<p><img src=\"/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg\" alt=\"Permissions-aw\"></p>\n<p>By the way, 这个方法适用于所有 Office 系列。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：</p>\n<p><img src=\"/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg\" alt=\"Windows configures microsoft office \"></p>\n<p>Please wait while windows configures Microsoft Office Professional Plus 2010.</p>\n<p>而且是每次都会有，不厌其烦。微软官方也给出了解决方案：</p>\n<p>请参考KB2528748:&nbsp;<a href=\"http://support.microsoft.com/kb/2528748\" title=\"Microsoft Office 2010 Professional Plus configures each time you start\">http://support.microsoft.com/kb/2528748</a></p>\n<p>运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：</p>\n<p><img src=\"/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg\" alt=\"EventID-1004\"></p>\n<p>The resource ‘HKEY_CLASSES_ROOT.aw' does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM&nbsp;账号，然后赋予如下权限即可。</p>\n<p><img src=\"/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg\" alt=\"Permissions-aw\"></p>\n<p>By the way, 这个方法适用于所有 Office 系列。</p>\n</body></html>"},{"title":"修复安装于VMware上的CentOS启动时出现 piix4_smbus Host SMBus controller not enabled 的错误","date":"2013-05-01T15:45:49.000Z","_content":"\n如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：\n\n![piix4_smbus 0000:00:007.3: Host SMBus controller not enabled](fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg) \n\n**piix4_smbus 0000:00:007.3: Host SMBus controller not enabled**\n> \"The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it...\"\n\n从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：\n```bash\nvi /etc/modprobe.d/blacklist.conf\n#加入以下两行\n#intel piix4 driver\nblacklist i2c_piix4\n```","source":"_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware.md","raw":"---\ntitle: 修复安装于VMware上的CentOS启动时出现 piix4_smbus Host SMBus controller not enabled 的错误\ntags:\n  - CentOS\n  - VMware\ncategories:\n  - '*Nix'\ndate: 2013-05-01 23:45:49\n---\n\n如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：\n\n![piix4_smbus 0000:00:007.3: Host SMBus controller not enabled](fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg) \n\n**piix4_smbus 0000:00:007.3: Host SMBus controller not enabled**\n> \"The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it...\"\n\n从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：\n```bash\nvi /etc/modprobe.d/blacklist.conf\n#加入以下两行\n#intel piix4 driver\nblacklist i2c_piix4\n```","slug":"fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware","published":1,"updated":"2020-01-05T09:00:53.953Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktl001ak84scb3qc5gh","content":"<html><head></head><body><p>如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：</p>\n<p><img src=\"/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg\" alt=\"piix4_smbus 0000:00:007.3: Host SMBus controller not enabled\"> </p>\n<p><strong>piix4_smbus 0000:00:007.3: Host SMBus controller not enabled</strong></p>\n<blockquote>\n<p>“The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it…”</p>\n</blockquote>\n<p>从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/modprobe.d/blacklist.conf</span><br><span class=\"line\"><span class=\"comment\">#加入以下两行</span></span><br><span class=\"line\"><span class=\"comment\">#intel piix4 driver</span></span><br><span class=\"line\">blacklist i2c_piix4</span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：</p>\n<p><img src=\"/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg\" alt=\"piix4_smbus 0000:00:007.3: Host SMBus controller not enabled\"> </p>\n<p><strong>piix4_smbus 0000:00:007.3: Host SMBus controller not enabled</strong></p>\n<blockquote>\n<p>“The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it…”</p>\n</blockquote>\n<p>从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/modprobe.d/blacklist.conf</span><br><span class=\"line\"><span class=\"comment\">#加入以下两行</span></span><br><span class=\"line\"><span class=\"comment\">#intel piix4 driver</span></span><br><span class=\"line\">blacklist i2c_piix4</span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"HMC 4.0 Update Rollup 3 has been updated","date":"2010-03-02T11:46:14.000Z","_content":"\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.0\n\n[http://support.microsoft.com/kb/979702/en-us](http://support.microsoft.com/kb/979702/en-us)\n\nMicrosoft released an update rollup that is dated December 2009\\. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\n*   Hosted SharePoint 2007 Namespace\n*   Managed SharePoint 2007 Namespace\n*   Hosted SharePoint Web Service\n*   Managed SharePoint Web Service\n*   DNS Provider\n\n**This will enable HMC 4.0 to support Exchange 2007 SP2!**","source":"_posts/hmc-40-update-rollup-3-has-been-updated.md","raw":"---\ntitle: HMC 4.0 Update Rollup 3 has been updated\ntags:\n  - Exchange\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2010-03-02 19:46:14\n---\n\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.0\n\n[http://support.microsoft.com/kb/979702/en-us](http://support.microsoft.com/kb/979702/en-us)\n\nMicrosoft released an update rollup that is dated December 2009\\. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\n*   Hosted SharePoint 2007 Namespace\n*   Managed SharePoint 2007 Namespace\n*   Hosted SharePoint Web Service\n*   Managed SharePoint Web Service\n*   DNS Provider\n\n**This will enable HMC 4.0 to support Exchange 2007 SP2!**","slug":"hmc-40-update-rollup-3-has-been-updated","published":1,"updated":"2020-01-05T09:00:53.954Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktm001dk84salvl12uy","content":"<html><head></head><body><p>Description of Update Rollup 3 for Hosted Messaging and Collaboration 4.0</p>\n<p><a href=\"http://support.microsoft.com/kb/979702/en-us\">http://support.microsoft.com/kb/979702/en-us</a></p>\n<p>Microsoft released an update rollup that is dated December 2009. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:</p>\n<ul>\n<li>Exchange 2007 Resource Manager Namespace</li>\n<li>Exchange 2007 Resource Manager Web Services</li>\n<li>Hosted Email 2007 Namespace</li>\n<li>Hosted Email 2007 Web Services</li>\n<li>Managed Email 2007 Namespace</li>\n<li>Managed Email 2007 Web Services</li>\n<li>Exchange 2007 Mobility Provider</li>\n<li>Exchange 2007 Provider</li>\n<li>Unified Messaging 2007 Provider</li>\n<li>Hosted SharePoint 2007 Namespace</li>\n<li>Managed SharePoint 2007 Namespace</li>\n<li>Hosted SharePoint Web Service</li>\n<li>Managed SharePoint Web Service</li>\n<li>DNS Provider</li>\n</ul>\n<p><strong>This will enable HMC 4.0 to support Exchange 2007 SP2!</strong></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Description of Update Rollup 3 for Hosted Messaging and Collaboration 4.0</p>\n<p><a href=\"http://support.microsoft.com/kb/979702/en-us\">http://support.microsoft.com/kb/979702/en-us</a></p>\n<p>Microsoft released an update rollup that is dated December 2009. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:</p>\n<ul>\n<li>Exchange 2007 Resource Manager Namespace</li>\n<li>Exchange 2007 Resource Manager Web Services</li>\n<li>Hosted Email 2007 Namespace</li>\n<li>Hosted Email 2007 Web Services</li>\n<li>Managed Email 2007 Namespace</li>\n<li>Managed Email 2007 Web Services</li>\n<li>Exchange 2007 Mobility Provider</li>\n<li>Exchange 2007 Provider</li>\n<li>Unified Messaging 2007 Provider</li>\n<li>Hosted SharePoint 2007 Namespace</li>\n<li>Managed SharePoint 2007 Namespace</li>\n<li>Hosted SharePoint Web Service</li>\n<li>Managed SharePoint Web Service</li>\n<li>DNS Provider</li>\n</ul>\n<p><strong>This will enable HMC 4.0 to support Exchange 2007 SP2!</strong></p>\n</body></html>"},{"title":"HMC 4.0 Update Rollup 5 has been released","date":"2009-05-27T04:46:53.000Z","_content":"\nThis has been released a while ago but in case you missed this.\n\n[http://support.microsoft.com/?id=961991](http://support.microsoft.com/?id=961991)\n\nPlease take note that, this hotfix, although it is named as an rollup, it does not include RU4\\. Hence, you will need to first deploy RU4 before you deploy this hotfix.\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to **dynamic**, and if the mailstore that is selected has insufficient free space.\n*   OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.\n*   This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.\n*   The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.\n*   If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to **not provisionable** in Resource Manager. Only the complete server can be disabled.\n*   A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.\n*   When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.","source":"_posts/hmc-40-update-rollup-5-has-been-released.md","raw":"---\ntitle: HMC 4.0 Update Rollup 5 has been released\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-27 12:46:53\n---\n\nThis has been released a while ago but in case you missed this.\n\n[http://support.microsoft.com/?id=961991](http://support.microsoft.com/?id=961991)\n\nPlease take note that, this hotfix, although it is named as an rollup, it does not include RU4\\. Hence, you will need to first deploy RU4 before you deploy this hotfix.\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to **dynamic**, and if the mailstore that is selected has insufficient free space.\n*   OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.\n*   This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.\n*   The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.\n*   If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to **not provisionable** in Resource Manager. Only the complete server can be disabled.\n*   A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.\n*   When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.","slug":"hmc-40-update-rollup-5-has-been-released","published":1,"updated":"2020-01-05T09:00:53.954Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktn001ik84sf1ae55l3","content":"<html><head></head><body><p>This has been released a while ago but in case you missed this.</p>\n<p><a href=\"http://support.microsoft.com/?id=961991\">http://support.microsoft.com/?id=961991</a></p>\n<p>Please take note that, this hotfix, although it is named as&nbsp;an rollup, it&nbsp;does not include RU4. Hence, you will need to first deploy RU4 before you deploy this hotfix.</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to&nbsp;<strong>dynamic</strong>, and if the mailstore that is selected has insufficient free space.</li>\n<li>OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.</li>\n<li>This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.</li>\n<li>The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.</li>\n<li>If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to&nbsp;<strong>not provisionable</strong>&nbsp;in Resource Manager. Only the complete server can be disabled.</li>\n<li>A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.</li>\n<li>When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>This has been released a while ago but in case you missed this.</p>\n<p><a href=\"http://support.microsoft.com/?id=961991\">http://support.microsoft.com/?id=961991</a></p>\n<p>Please take note that, this hotfix, although it is named as&nbsp;an rollup, it&nbsp;does not include RU4. Hence, you will need to first deploy RU4 before you deploy this hotfix.</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to&nbsp;<strong>dynamic</strong>, and if the mailstore that is selected has insufficient free space.</li>\n<li>OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.</li>\n<li>This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.</li>\n<li>The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.</li>\n<li>If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to&nbsp;<strong>not provisionable</strong>&nbsp;in Resource Manager. Only the complete server can be disabled.</li>\n<li>A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.</li>\n<li>When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 1 - Overview and Active Directory","date":"2009-05-06T09:06:36.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nOne of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC) is this, \"What do you do to Exchange to make HMC work?\" So, here I will attempt to demystify this.\n\nHMC started long way back but the concept has not deviated much. I want to note that this specific blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.\n\nThere are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,\n\n*   Part #1: Overview and Active Directory\n*   Part #2: Address Lists Segregation\n*   Part #3: Offline Address Book generations\n*   Part #4: Internal and External Out of Office\n*   Part #5: Autodiscover in the Multi-tenancy environment\n*   Part #6: Conclusion\n\n**What does HMC mean to Exchange 2007?**\n\nLet me start by asking this, what exactly is HMC? Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about **Multi-tenant enablement**.\n\nYes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn't designed with that as the focus.\n\nWhat is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor's servers, serving multiple client organizations (tenants).\n\nThink of it like a condominium with hundreds of different individual units living in it, that's what multi-tenant is. Instead of having only one company _(note: I tend to use company and tenant interchangeably)_ to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)\n\nLet me continue with the condominium analogy. Now that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.\n\nSo what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,\n\n1.  **Active Directory Partitioning and Permission** - think of it like partitioning each floor to different unit. Every company will have their own separate 'space' and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.\n\n2.  **Address List Segregation** - access to the contact information in each company should only be limited to users in that company. Other tenants shouldn't know have access to that information.\n\n3.  **Outlook Experience **- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook, such as Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.\n\n4.  **Shared Components** - as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.\n\nNow that we have listed them down, it doesn't look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren't doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.\n\nThose who has been dealing with Exchange 2007 probably realize that we have a white paper that talks about the similar thing, which is [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"). I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.\n\nThe above white paper explained how you can come up with your homebrew version of hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.\n\n**Active Directory Partitioning and Permission**\n\nFirstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the Provisioning Deployment Tool that comes with the HMC Solution ISO file.\n\n(1) List Object Mode (**dsHeuristics**)\n\nThis is the first thing that the Deployment Tool will do. This is about controlling the object visibility. By default in Active Directory, we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.\n\nObviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,\n\n* Fabrikam.com (Windows Domain)\n    * Hosting (Hosting Container)\n        * ConsolidatedMessenger (Reseller)\n             * Company1\n                  * [User1@Company1]\n                  * [User2@Company1\n                  * [User3@Company1]\n             * Company2\n\t\t\t   * [User1@Company2]\n\t\t\t   * [User2@Company2]\n\t\t\t   * [User3@Company2]\n             * [User1@ConsolidatedMessenger]\n             * [User2@ConsolidatedMessenger]\n\nIf I grant [User1@Company1](mailto:User1@Company1) List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it stops someone looking at what lives under the object or container. However, granting it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing. This is where \"List Object\" mode comes in.\n\nIn this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.\n\nThe availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.\n\n(2) Active Directory Partitioning - Hosting Container\n\nNow, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,\n\n*   HMC does not support deployment in a child domain. While it is technically possible, it hasn't be well tested and hence it is not a supported model.\n*   By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in _Hosting Platform - Initialize Default Services - Initialize Active Directory_ for Hosting in the Deployment Tool.\n\nThat is only the creation of the master hosting container. You will then need to follow the Deployment Walkthrough in the Help File to create the Reseller container and also the Tenant container. From the Exchange perspective, you only need to know the following,\n\n*   **HMC Resellers** - Each Reseller is fully contained within its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is_ConsolidatedMessenger.com_. The Reseller OU will usually contain the following objects\n\n    *   HMC Tenants\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;Reseller&gt; group\n\n*   **HMC Tenants** - Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is _AlpineSkiHouse.com_. The Tenant OU will usually contain the following objects,\n\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin\n    *   Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)\n\n*   **HMC Users** - Users objects within AD are the security principal.\n*   **HMC Mailboxes** - An HMC mailbox is a user object that has been Exchange Mailbox Enabled.\nHere is an example of the Active Directory Hosting Container structure in HMC\n\n*   Fabrikam.com (Domain)\n\n    *   Hosting (Hosting OU)\n\n            *   _Private\n        *   ConsolidatedMessenger.com (HMC Reseller)\n\n                    *   _Private\n            *   [admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) (Admins group for HMC Reseller)\n            *   [administrator@ConsolidatedMessenger.com](mailto:administrator@ConsolidatedMessenger.com) (Administrator for the HMC Reseller)\n            *   AlpineSkiHouse.com (HMC Tenant)\n\n                            *   _Private\n                *   [admins@alpineskihouse.com](mailto:admins@alpineskihouse.com) (Admins group for HMC Tenant)\n                *   [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) (HMC Users/Mailboxes)\nObviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.) and properly assign the appropriate membership and permissions in different containers.\n\nPermission Inheritance is not blocked specifically. For example,[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.\n\nFor the purpose of this blog, I think that's all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)\n\n(3) User Logon\n\nI want to touch a little bit about User Logon here. Most of you who are familiar with Active Directory will know what a _samAccountName _is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.\n\nI can login to the environment using either username@domain or DOMAIN\\&lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.\n\nIn order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is [username@domain](mailto:username@domain) such as [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com). You will notice in HMC allows that by modifying the **upnSuffixes attribute **of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.\n\nWith that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can't have more than 20 characters, it will get truncated if it is more than 20 characters. For example,\n\n*   Logon Name: [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) will have the samAccountName of johnc_AlpineSkiHouse\n*   Logon Name: [bob@alpineskihouse.com](mailto:bob@alpineskihouse.com) will have the samAccountName of bob_AlpineSkiHouse.c\nSo, hopefully that will help to explain the naming convention of the user object.\n\n(4) Active Directory Attributes\n\nHMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn't. Instead, it uses what I would call the poor man's schema extension, the **otherWellknownObjects** attribute.\n\nFrom the Exchange standpoint, this attribute is not used but for the provisioning process (MPS) to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.\n\nHere is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.\n\n12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;**B:32:D22DFCC5B73645E99E16C9AD3D61F34F**:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:9E444526CB6F4D5C9A59C9A84E26B627**:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:89FB25B7DF784FC198A493E2E8A0EE7E**:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;\n\nAs you can see from above, we have a unique GUID number to identify a specific category of relationship.\n\n&lt;GUID name=\"GlobalAddressList\"&gt;**89FB25B7DF784FC198A493E2E8A0EE7E**&lt;/GUID&gt;\n&lt;GUID name=\"AddressList\"&gt;**9E444526CB6F4D5C9A59C9A84E26B627**&lt;/GUID&gt;\n&lt;GUID name=\"OfflineAddressList\"&gt;**D22DFCC5B73645E99E16C9AD3D61F34F**&lt;/GUID&gt;\n\nIn addition, here are some of the _Key attributes to Exchange:_\n\n*   **homeMDB**: DN of the users mailbox store - no customizations for HMC.\n*   **mailNickname**: This is the HMC Users mailbox alias. - no customizations for HMC.\n*   **msExchMailboxFolderSet**: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans. ** **\n*   **msExchQueryBaseDN**: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.\n*   **protocolSettings**: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans\n*   **showInAddressBook**: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL'd correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list. ** **\n*   **msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\nLet's briefly talk about the e-mail address stamping here too. In Exchange 2003, we have this process called Recipient Update Services. In Exchange 2007, this whole process has been embedded into the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the **EmailAddressPolicyEnabled** attribute to **False**. This means,\n\n*   It does not rely on the Email Address Policy at all. That's why you will see that HMC will not create any Email Address Policy at all.\n\n*   HMC will use its own mechanism to stamp the SMTP addresses.\nSo, that's it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.","source":"_posts/hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 1 - Overview and Active Directory\ntags:\n  - Exchange\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-06 17:06:36\n---\n\n转自 http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nOne of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC) is this, \"What do you do to Exchange to make HMC work?\" So, here I will attempt to demystify this.\n\nHMC started long way back but the concept has not deviated much. I want to note that this specific blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.\n\nThere are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,\n\n*   Part #1: Overview and Active Directory\n*   Part #2: Address Lists Segregation\n*   Part #3: Offline Address Book generations\n*   Part #4: Internal and External Out of Office\n*   Part #5: Autodiscover in the Multi-tenancy environment\n*   Part #6: Conclusion\n\n**What does HMC mean to Exchange 2007?**\n\nLet me start by asking this, what exactly is HMC? Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about **Multi-tenant enablement**.\n\nYes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn't designed with that as the focus.\n\nWhat is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor's servers, serving multiple client organizations (tenants).\n\nThink of it like a condominium with hundreds of different individual units living in it, that's what multi-tenant is. Instead of having only one company _(note: I tend to use company and tenant interchangeably)_ to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)\n\nLet me continue with the condominium analogy. Now that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.\n\nSo what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,\n\n1.  **Active Directory Partitioning and Permission** - think of it like partitioning each floor to different unit. Every company will have their own separate 'space' and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.\n\n2.  **Address List Segregation** - access to the contact information in each company should only be limited to users in that company. Other tenants shouldn't know have access to that information.\n\n3.  **Outlook Experience **- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook, such as Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.\n\n4.  **Shared Components** - as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.\n\nNow that we have listed them down, it doesn't look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren't doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.\n\nThose who has been dealing with Exchange 2007 probably realize that we have a white paper that talks about the similar thing, which is [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"). I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.\n\nThe above white paper explained how you can come up with your homebrew version of hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.\n\n**Active Directory Partitioning and Permission**\n\nFirstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the Provisioning Deployment Tool that comes with the HMC Solution ISO file.\n\n(1) List Object Mode (**dsHeuristics**)\n\nThis is the first thing that the Deployment Tool will do. This is about controlling the object visibility. By default in Active Directory, we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.\n\nObviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,\n\n* Fabrikam.com (Windows Domain)\n    * Hosting (Hosting Container)\n        * ConsolidatedMessenger (Reseller)\n             * Company1\n                  * [User1@Company1]\n                  * [User2@Company1\n                  * [User3@Company1]\n             * Company2\n\t\t\t   * [User1@Company2]\n\t\t\t   * [User2@Company2]\n\t\t\t   * [User3@Company2]\n             * [User1@ConsolidatedMessenger]\n             * [User2@ConsolidatedMessenger]\n\nIf I grant [User1@Company1](mailto:User1@Company1) List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it stops someone looking at what lives under the object or container. However, granting it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing. This is where \"List Object\" mode comes in.\n\nIn this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.\n\nThe availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.\n\n(2) Active Directory Partitioning - Hosting Container\n\nNow, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,\n\n*   HMC does not support deployment in a child domain. While it is technically possible, it hasn't be well tested and hence it is not a supported model.\n*   By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in _Hosting Platform - Initialize Default Services - Initialize Active Directory_ for Hosting in the Deployment Tool.\n\nThat is only the creation of the master hosting container. You will then need to follow the Deployment Walkthrough in the Help File to create the Reseller container and also the Tenant container. From the Exchange perspective, you only need to know the following,\n\n*   **HMC Resellers** - Each Reseller is fully contained within its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is_ConsolidatedMessenger.com_. The Reseller OU will usually contain the following objects\n\n    *   HMC Tenants\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;Reseller&gt; group\n\n*   **HMC Tenants** - Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is _AlpineSkiHouse.com_. The Tenant OU will usually contain the following objects,\n\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin\n    *   Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)\n\n*   **HMC Users** - Users objects within AD are the security principal.\n*   **HMC Mailboxes** - An HMC mailbox is a user object that has been Exchange Mailbox Enabled.\nHere is an example of the Active Directory Hosting Container structure in HMC\n\n*   Fabrikam.com (Domain)\n\n    *   Hosting (Hosting OU)\n\n            *   _Private\n        *   ConsolidatedMessenger.com (HMC Reseller)\n\n                    *   _Private\n            *   [admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) (Admins group for HMC Reseller)\n            *   [administrator@ConsolidatedMessenger.com](mailto:administrator@ConsolidatedMessenger.com) (Administrator for the HMC Reseller)\n            *   AlpineSkiHouse.com (HMC Tenant)\n\n                            *   _Private\n                *   [admins@alpineskihouse.com](mailto:admins@alpineskihouse.com) (Admins group for HMC Tenant)\n                *   [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) (HMC Users/Mailboxes)\nObviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.) and properly assign the appropriate membership and permissions in different containers.\n\nPermission Inheritance is not blocked specifically. For example,[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.\n\nFor the purpose of this blog, I think that's all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)\n\n(3) User Logon\n\nI want to touch a little bit about User Logon here. Most of you who are familiar with Active Directory will know what a _samAccountName _is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.\n\nI can login to the environment using either username@domain or DOMAIN\\&lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.\n\nIn order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is [username@domain](mailto:username@domain) such as [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com). You will notice in HMC allows that by modifying the **upnSuffixes attribute **of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.\n\nWith that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can't have more than 20 characters, it will get truncated if it is more than 20 characters. For example,\n\n*   Logon Name: [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) will have the samAccountName of johnc_AlpineSkiHouse\n*   Logon Name: [bob@alpineskihouse.com](mailto:bob@alpineskihouse.com) will have the samAccountName of bob_AlpineSkiHouse.c\nSo, hopefully that will help to explain the naming convention of the user object.\n\n(4) Active Directory Attributes\n\nHMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn't. Instead, it uses what I would call the poor man's schema extension, the **otherWellknownObjects** attribute.\n\nFrom the Exchange standpoint, this attribute is not used but for the provisioning process (MPS) to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.\n\nHere is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.\n\n12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;**B:32:D22DFCC5B73645E99E16C9AD3D61F34F**:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:9E444526CB6F4D5C9A59C9A84E26B627**:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:89FB25B7DF784FC198A493E2E8A0EE7E**:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;\n\nAs you can see from above, we have a unique GUID number to identify a specific category of relationship.\n\n&lt;GUID name=\"GlobalAddressList\"&gt;**89FB25B7DF784FC198A493E2E8A0EE7E**&lt;/GUID&gt;\n&lt;GUID name=\"AddressList\"&gt;**9E444526CB6F4D5C9A59C9A84E26B627**&lt;/GUID&gt;\n&lt;GUID name=\"OfflineAddressList\"&gt;**D22DFCC5B73645E99E16C9AD3D61F34F**&lt;/GUID&gt;\n\nIn addition, here are some of the _Key attributes to Exchange:_\n\n*   **homeMDB**: DN of the users mailbox store - no customizations for HMC.\n*   **mailNickname**: This is the HMC Users mailbox alias. - no customizations for HMC.\n*   **msExchMailboxFolderSet**: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans. ** **\n*   **msExchQueryBaseDN**: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.\n*   **protocolSettings**: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans\n*   **showInAddressBook**: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL'd correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list. ** **\n*   **msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\nLet's briefly talk about the e-mail address stamping here too. In Exchange 2003, we have this process called Recipient Update Services. In Exchange 2007, this whole process has been embedded into the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the **EmailAddressPolicyEnabled** attribute to **False**. This means,\n\n*   It does not rely on the Email Address Policy at all. That's why you will see that HMC will not create any Email Address Policy at all.\n\n*   HMC will use its own mechanism to stamp the SMTP addresses.\nSo, that's it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.","slug":"hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory","published":1,"updated":"2020-01-05T09:00:53.954Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktn001lk84s9zp0aemq","content":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx\">http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>One of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC)&nbsp;is this, “What do you do&nbsp;to Exchange&nbsp;to make&nbsp;HMC work?” So, here I will attempt to demystify this.</p>\n<p>HMC started long way back but the concept has not deviated much. I want to note that this specific&nbsp;blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.</p>\n<p>There are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,</p>\n<ul>\n<li>Part #1: Overview and Active Directory</li>\n<li>Part #2: Address Lists Segregation</li>\n<li>Part #3: Offline Address Book generations</li>\n<li>Part #4: Internal and External Out of Office</li>\n<li>Part #5: Autodiscover in the Multi-tenancy environment</li>\n<li>Part #6: Conclusion</li>\n</ul>\n<p><strong>What does HMC mean to Exchange 2007?</strong></p>\n<p>Let me start by asking this, what exactly is HMC?&nbsp;Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about&nbsp;<strong>Multi-tenant enablement</strong>.</p>\n<p>Yes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn’t designed with that as the focus.</p>\n<p>What is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor’s servers, serving multiple client organizations (tenants).</p>\n<p>Think of it like a condominium with hundreds of different individual units living in it, that’s what multi-tenant is.&nbsp;Instead of having only one company&nbsp;<em>(note: I tend to use company and tenant interchangeably)</em>&nbsp;to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)</p>\n<p>Let me continue with the condominium analogy. Now&nbsp;that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that&nbsp;the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.</p>\n<p>So what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,</p>\n<ol>\n<li><p><strong>Active Directory Partitioning and Permission</strong>&nbsp;- think of it like partitioning each floor to different unit. Every company will have their own separate ‘space’ and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.</p>\n</li>\n<li><p><strong>Address List Segregation</strong>&nbsp;- access to the contact information in each company should only be limited to users in that company. Other tenants shouldn’t know have access to that information.</p>\n</li>\n<li><p>**Outlook Experience&nbsp;**- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook,&nbsp;such as&nbsp;Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota&nbsp;and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.</p>\n</li>\n<li><p><strong>Shared Components</strong>&nbsp;- as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.</p>\n</li>\n</ol>\n<p>Now that we have listed them down, it doesn’t look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren’t doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.</p>\n<p>Those who has been dealing with Exchange 2007 probably realize that we have a white paper&nbsp;that talks about the similar thing, which is&nbsp;<a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007&nbsp;</a>. I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.</p>\n<p>The above white paper explained how you can come up with your homebrew version of&nbsp;hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and&nbsp;also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.</p>\n<p><strong>Active Directory Partitioning and Permission</strong></p>\n<p>Firstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the&nbsp;Provisioning Deployment Tool that comes with the HMC Solution ISO file.</p>\n<p>(1) List Object Mode (<strong>dsHeuristics</strong>)</p>\n<p>This is the first thing that the Deployment Tool will do. This is about controlling the object visibility.&nbsp;By default in Active Directory,&nbsp;we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.</p>\n<p>Obviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,</p>\n<ul>\n<li>Fabrikam.com (Windows Domain)<ul>\n<li>Hosting (Hosting Container)<ul>\n<li>ConsolidatedMessenger (Reseller)<ul>\n<li>Company1<ul>\n<li>[User1@Company1]</li>\n<li>[User2@Company1</li>\n<li>[User3@Company1]</li>\n</ul>\n</li>\n<li>Company2<ul>\n<li>[User1@Company2]</li>\n<li>[User2@Company2]</li>\n<li>[User3@Company2]</li>\n</ul>\n</li>\n<li>[User1@ConsolidatedMessenger]</li>\n<li>[User2@ConsolidatedMessenger]</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>If I grant&nbsp;<a href=\"mailto:User1@Company1\">User1@Company1</a>&nbsp;List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it&nbsp;stops someone looking at what lives under the object or container. However, granting&nbsp;it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing.&nbsp;This is where&nbsp;“List Object” mode comes in.</p>\n<p>In this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.</p>\n<p>The availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.</p>\n<p>(2) Active Directory Partitioning&nbsp;- Hosting Container</p>\n<p>Now, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,</p>\n<ul>\n<li>HMC does not support deployment&nbsp;in a child domain. While it is technically possible, it hasn’t be&nbsp;well tested and hence it is not a supported model.</li>\n<li>By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in&nbsp;<em>Hosting Platform - Initialize Default Services - Initialize Active Directory</em>&nbsp;for Hosting in the Deployment Tool.</li>\n</ul>\n<p>That is only the creation of the master hosting container. You will then need to follow the&nbsp;Deployment Walkthrough in the Help File to create&nbsp;the Reseller container and also the&nbsp;Tenant container. From the Exchange perspective, you only need to know the following,</p>\n<ul>\n<li><p><strong>HMC Resellers</strong>&nbsp;- Each Reseller is fully contained within&nbsp;its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is_ConsolidatedMessenger.com_. The Reseller OU will usually contain the following objects</p>\n<ul>\n<li>HMC Tenants</li>\n<li>HMC Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;Reseller&gt; group</li>\n</ul>\n</li>\n<li><p><strong>HMC Tenants</strong>&nbsp;- Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is&nbsp;<em>AlpineSkiHouse.com</em>. The Tenant OU will usually contain the following objects,</p>\n<ul>\n<li>HMC&nbsp;Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin</li>\n<li>Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)</li>\n</ul>\n</li>\n<li><p><strong>HMC Users</strong>&nbsp;- Users objects within AD are the security principal.</p>\n</li>\n<li><p><strong>HMC Mailboxes</strong>&nbsp;- An HMC mailbox is a user object that has been Exchange Mailbox Enabled.<br>Here is an example of the Active Directory Hosting Container structure in HMC</p>\n</li>\n<li><p>Fabrikam.com (Domain)</p>\n<ul>\n<li><p>Hosting (Hosting OU)</p>\n<pre><code>*   _Private\n</code></pre>\n<ul>\n<li><p>ConsolidatedMessenger.com (HMC Reseller)</p>\n<pre><code>    *   _Private\n</code></pre>\n<ul>\n<li><p><a href=\"mailto:admins@ConsolidatedMessenger.com\">admins@ConsolidatedMessenger.com</a>&nbsp;(Admins group for HMC Reseller)</p>\n</li>\n<li><p><a href=\"mailto:administrator@ConsolidatedMessenger.com\">administrator@ConsolidatedMessenger.com</a>&nbsp;(Administrator for the HMC Reseller)</p>\n</li>\n<li><p>AlpineSkiHouse.com (HMC Tenant)</p>\n<pre><code>        *   _Private\n</code></pre>\n<ul>\n<li><a href=\"mailto:admins@alpineskihouse.com\">admins@alpineskihouse.com</a>&nbsp;(Admins group for HMC Tenant)</li>\n<li><a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>&nbsp;(HMC Users/Mailboxes)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Obviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.)&nbsp;and properly assign the appropriate membership and permissions in different containers.</p>\n<p>Permission Inheritance is not blocked specifically. For example,<a href=\"mailto:admins@ConsolidatedMessenger.com\">admins@ConsolidatedMessenger.com</a>&nbsp;group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the<a href=\"mailto:admins@ConsolidatedMessenger.com\">admins@ConsolidatedMessenger.com</a>&nbsp;group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.</p>\n<p>For the purpose of this blog, I think that’s all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)</p>\n<p>(3)&nbsp;User Logon</p>\n<p>I want to touch a little bit about&nbsp;User Logon here.&nbsp;Most of you who are familiar with Active Directory will know&nbsp;what a&nbsp;_samAccountName&nbsp;_is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.</p>\n<p>I can login to the environment using&nbsp;either username@domain or DOMAIN&amp;lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.</p>\n<p>In order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is&nbsp;<a href=\"mailto:username@domain\">username@domain</a>&nbsp;such as&nbsp;<a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>. You will notice in HMC allows that by modifying the&nbsp;**upnSuffixes attribute&nbsp;**of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.</p>\n<p>With that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can’t have more than 20 characters, it will get truncated if it is more than 20 characters. For example,</p>\n<ul>\n<li>Logon Name:&nbsp;<a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>&nbsp;will have the samAccountName of johnc_AlpineSkiHouse</li>\n<li>Logon Name:&nbsp;<a href=\"mailto:bob@alpineskihouse.com\">bob@alpineskihouse.com</a>&nbsp;will have the samAccountName of bob_AlpineSkiHouse.c<br>So, hopefully that will help to explain the naming convention of the user object.</li>\n</ul>\n<p>(4) Active Directory Attributes</p>\n<p>HMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn’t. Instead, it uses what I would call the poor man’s schema extension, the&nbsp;<strong>otherWellknownObjects</strong>&nbsp;attribute.</p>\n<p>From the Exchange standpoint, this attribute is not used but for the provisioning process (MPS)&nbsp;to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.</p>\n<p>Here is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.</p>\n<p>12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;<strong>B:32:D22DFCC5B73645E99E16C9AD3D61F34F</strong>:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:9E444526CB6F4D5C9A59C9A84E26B627</strong>:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:89FB25B7DF784FC198A493E2E8A0EE7E</strong>:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;</p>\n<p>As you can see from above, we have a unique GUID number to identify a specific category of relationship.</p>\n<p>&lt;GUID name=”GlobalAddressList”&gt;<strong>89FB25B7DF784FC198A493E2E8A0EE7E</strong>&lt;/GUID&gt;<br>&lt;GUID name=”AddressList”&gt;<strong>9E444526CB6F4D5C9A59C9A84E26B627</strong>&lt;/GUID&gt;<br>&lt;GUID name=”OfflineAddressList”&gt;<strong>D22DFCC5B73645E99E16C9AD3D61F34F</strong>&lt;/GUID&gt;</p>\n<p>In addition, here are some of the&nbsp;<em>Key attributes to Exchange:</em></p>\n<ul>\n<li><p><strong>homeMDB</strong>: DN of the users mailbox store - no customizations for HMC.</p>\n</li>\n<li><p><strong>mailNickname</strong>: This is the HMC Users mailbox alias.&nbsp;- no customizations for HMC.</p>\n</li>\n<li><p><strong>msExchMailboxFolderSet</strong>: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans.&nbsp;**&nbsp;**</p>\n</li>\n<li><p><strong>msExchQueryBaseDN</strong>: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.</p>\n</li>\n<li><p><strong>protocolSettings</strong>: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans</p>\n</li>\n<li><p><strong>showInAddressBook</strong>: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL’d correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list.&nbsp;**&nbsp;**</p>\n</li>\n<li><p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.<br>Let’s briefly&nbsp;talk about the e-mail address stamping here too. In Exchange 2003, we have this&nbsp;process called&nbsp;Recipient Update Services. In Exchange 2007, this whole process has been embedded into&nbsp;the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the&nbsp;<strong>EmailAddressPolicyEnabled</strong>&nbsp;attribute to&nbsp;<strong>False</strong>. This means,</p>\n</li>\n<li><p>It does not rely on the Email Address Policy at all. That’s why you will see that HMC will not create any Email Address Policy at all.</p>\n</li>\n<li><p>HMC will use its own mechanism to stamp the SMTP addresses.<br>So, that’s it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.</p>\n</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx\">http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>One of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC)&nbsp;is this, “What do you do&nbsp;to Exchange&nbsp;to make&nbsp;HMC work?” So, here I will attempt to demystify this.</p>\n<p>HMC started long way back but the concept has not deviated much. I want to note that this specific&nbsp;blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.</p>\n<p>There are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,</p>\n<ul>\n<li>Part #1: Overview and Active Directory</li>\n<li>Part #2: Address Lists Segregation</li>\n<li>Part #3: Offline Address Book generations</li>\n<li>Part #4: Internal and External Out of Office</li>\n<li>Part #5: Autodiscover in the Multi-tenancy environment</li>\n<li>Part #6: Conclusion</li>\n</ul>\n<p><strong>What does HMC mean to Exchange 2007?</strong></p>\n<p>Let me start by asking this, what exactly is HMC?&nbsp;Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about&nbsp;<strong>Multi-tenant enablement</strong>.</p>\n<p>Yes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn’t designed with that as the focus.</p>\n<p>What is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor’s servers, serving multiple client organizations (tenants).</p>\n<p>Think of it like a condominium with hundreds of different individual units living in it, that’s what multi-tenant is.&nbsp;Instead of having only one company&nbsp;<em>(note: I tend to use company and tenant interchangeably)</em>&nbsp;to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)</p>\n<p>Let me continue with the condominium analogy. Now&nbsp;that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that&nbsp;the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.</p>\n<p>So what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,</p>\n<ol>\n<li><p><strong>Active Directory Partitioning and Permission</strong>&nbsp;- think of it like partitioning each floor to different unit. Every company will have their own separate ‘space’ and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.</p>\n</li>\n<li><p><strong>Address List Segregation</strong>&nbsp;- access to the contact information in each company should only be limited to users in that company. Other tenants shouldn’t know have access to that information.</p>\n</li>\n<li><p>**Outlook Experience&nbsp;**- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook,&nbsp;such as&nbsp;Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota&nbsp;and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.</p>\n</li>\n<li><p><strong>Shared Components</strong>&nbsp;- as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.</p>\n</li>\n</ol>\n<p>Now that we have listed them down, it doesn’t look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren’t doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.</p>\n<p>Those who has been dealing with Exchange 2007 probably realize that we have a white paper&nbsp;that talks about the similar thing, which is&nbsp;<a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007&nbsp;</a>. I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.</p>\n<p>The above white paper explained how you can come up with your homebrew version of&nbsp;hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and&nbsp;also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.</p>\n<p><strong>Active Directory Partitioning and Permission</strong></p>\n<p>Firstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the&nbsp;Provisioning Deployment Tool that comes with the HMC Solution ISO file.</p>\n<p>(1) List Object Mode (<strong>dsHeuristics</strong>)</p>\n<p>This is the first thing that the Deployment Tool will do. This is about controlling the object visibility.&nbsp;By default in Active Directory,&nbsp;we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.</p>\n<p>Obviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,</p>\n<ul>\n<li>Fabrikam.com (Windows Domain)<ul>\n<li>Hosting (Hosting Container)<ul>\n<li>ConsolidatedMessenger (Reseller)<ul>\n<li>Company1<ul>\n<li>[User1@Company1]</li>\n<li>[User2@Company1</li>\n<li>[User3@Company1]</li>\n</ul>\n</li>\n<li>Company2<ul>\n<li>[User1@Company2]</li>\n<li>[User2@Company2]</li>\n<li>[User3@Company2]</li>\n</ul>\n</li>\n<li>[User1@ConsolidatedMessenger]</li>\n<li>[User2@ConsolidatedMessenger]</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>If I grant&nbsp;<a href=\"mailto:User1@Company1\">User1@Company1</a>&nbsp;List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it&nbsp;stops someone looking at what lives under the object or container. However, granting&nbsp;it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing.&nbsp;This is where&nbsp;“List Object” mode comes in.</p>\n<p>In this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.</p>\n<p>The availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.</p>\n<p>(2) Active Directory Partitioning&nbsp;- Hosting Container</p>\n<p>Now, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,</p>\n<ul>\n<li>HMC does not support deployment&nbsp;in a child domain. While it is technically possible, it hasn’t be&nbsp;well tested and hence it is not a supported model.</li>\n<li>By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in&nbsp;<em>Hosting Platform - Initialize Default Services - Initialize Active Directory</em>&nbsp;for Hosting in the Deployment Tool.</li>\n</ul>\n<p>That is only the creation of the master hosting container. You will then need to follow the&nbsp;Deployment Walkthrough in the Help File to create&nbsp;the Reseller container and also the&nbsp;Tenant container. From the Exchange perspective, you only need to know the following,</p>\n<ul>\n<li><p><strong>HMC Resellers</strong>&nbsp;- Each Reseller is fully contained within&nbsp;its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is_ConsolidatedMessenger.com_. The Reseller OU will usually contain the following objects</p>\n<ul>\n<li>HMC Tenants</li>\n<li>HMC Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;Reseller&gt; group</li>\n</ul>\n</li>\n<li><p><strong>HMC Tenants</strong>&nbsp;- Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is&nbsp;<em>AlpineSkiHouse.com</em>. The Tenant OU will usually contain the following objects,</p>\n<ul>\n<li>HMC&nbsp;Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin</li>\n<li>Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)</li>\n</ul>\n</li>\n<li><p><strong>HMC Users</strong>&nbsp;- Users objects within AD are the security principal.</p>\n</li>\n<li><p><strong>HMC Mailboxes</strong>&nbsp;- An HMC mailbox is a user object that has been Exchange Mailbox Enabled.<br>Here is an example of the Active Directory Hosting Container structure in HMC</p>\n</li>\n<li><p>Fabrikam.com (Domain)</p>\n<ul>\n<li><p>Hosting (Hosting OU)</p>\n<pre><code>*   _Private\n</code></pre>\n<ul>\n<li><p>ConsolidatedMessenger.com (HMC Reseller)</p>\n<pre><code>    *   _Private\n</code></pre>\n<ul>\n<li><p><a href=\"mailto:admins@ConsolidatedMessenger.com\">admins@ConsolidatedMessenger.com</a>&nbsp;(Admins group for HMC Reseller)</p>\n</li>\n<li><p><a href=\"mailto:administrator@ConsolidatedMessenger.com\">administrator@ConsolidatedMessenger.com</a>&nbsp;(Administrator for the HMC Reseller)</p>\n</li>\n<li><p>AlpineSkiHouse.com (HMC Tenant)</p>\n<pre><code>        *   _Private\n</code></pre>\n<ul>\n<li><a href=\"mailto:admins@alpineskihouse.com\">admins@alpineskihouse.com</a>&nbsp;(Admins group for HMC Tenant)</li>\n<li><a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>&nbsp;(HMC Users/Mailboxes)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Obviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.)&nbsp;and properly assign the appropriate membership and permissions in different containers.</p>\n<p>Permission Inheritance is not blocked specifically. For example,<a href=\"mailto:admins@ConsolidatedMessenger.com\">admins@ConsolidatedMessenger.com</a>&nbsp;group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the<a href=\"mailto:admins@ConsolidatedMessenger.com\">admins@ConsolidatedMessenger.com</a>&nbsp;group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.</p>\n<p>For the purpose of this blog, I think that’s all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)</p>\n<p>(3)&nbsp;User Logon</p>\n<p>I want to touch a little bit about&nbsp;User Logon here.&nbsp;Most of you who are familiar with Active Directory will know&nbsp;what a&nbsp;_samAccountName&nbsp;_is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.</p>\n<p>I can login to the environment using&nbsp;either username@domain or DOMAIN&amp;lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.</p>\n<p>In order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is&nbsp;<a href=\"mailto:username@domain\">username@domain</a>&nbsp;such as&nbsp;<a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>. You will notice in HMC allows that by modifying the&nbsp;**upnSuffixes attribute&nbsp;**of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.</p>\n<p>With that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can’t have more than 20 characters, it will get truncated if it is more than 20 characters. For example,</p>\n<ul>\n<li>Logon Name:&nbsp;<a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>&nbsp;will have the samAccountName of johnc_AlpineSkiHouse</li>\n<li>Logon Name:&nbsp;<a href=\"mailto:bob@alpineskihouse.com\">bob@alpineskihouse.com</a>&nbsp;will have the samAccountName of bob_AlpineSkiHouse.c<br>So, hopefully that will help to explain the naming convention of the user object.</li>\n</ul>\n<p>(4) Active Directory Attributes</p>\n<p>HMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn’t. Instead, it uses what I would call the poor man’s schema extension, the&nbsp;<strong>otherWellknownObjects</strong>&nbsp;attribute.</p>\n<p>From the Exchange standpoint, this attribute is not used but for the provisioning process (MPS)&nbsp;to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.</p>\n<p>Here is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.</p>\n<p>12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;<strong>B:32:D22DFCC5B73645E99E16C9AD3D61F34F</strong>:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:9E444526CB6F4D5C9A59C9A84E26B627</strong>:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:89FB25B7DF784FC198A493E2E8A0EE7E</strong>:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;</p>\n<p>As you can see from above, we have a unique GUID number to identify a specific category of relationship.</p>\n<p>&lt;GUID name=”GlobalAddressList”&gt;<strong>89FB25B7DF784FC198A493E2E8A0EE7E</strong>&lt;/GUID&gt;<br>&lt;GUID name=”AddressList”&gt;<strong>9E444526CB6F4D5C9A59C9A84E26B627</strong>&lt;/GUID&gt;<br>&lt;GUID name=”OfflineAddressList”&gt;<strong>D22DFCC5B73645E99E16C9AD3D61F34F</strong>&lt;/GUID&gt;</p>\n<p>In addition, here are some of the&nbsp;<em>Key attributes to Exchange:</em></p>\n<ul>\n<li><p><strong>homeMDB</strong>: DN of the users mailbox store - no customizations for HMC.</p>\n</li>\n<li><p><strong>mailNickname</strong>: This is the HMC Users mailbox alias.&nbsp;- no customizations for HMC.</p>\n</li>\n<li><p><strong>msExchMailboxFolderSet</strong>: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans.&nbsp;**&nbsp;**</p>\n</li>\n<li><p><strong>msExchQueryBaseDN</strong>: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.</p>\n</li>\n<li><p><strong>protocolSettings</strong>: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans</p>\n</li>\n<li><p><strong>showInAddressBook</strong>: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL’d correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list.&nbsp;**&nbsp;**</p>\n</li>\n<li><p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.<br>Let’s briefly&nbsp;talk about the e-mail address stamping here too. In Exchange 2003, we have this&nbsp;process called&nbsp;Recipient Update Services. In Exchange 2007, this whole process has been embedded into&nbsp;the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the&nbsp;<strong>EmailAddressPolicyEnabled</strong>&nbsp;attribute to&nbsp;<strong>False</strong>. This means,</p>\n</li>\n<li><p>It does not rely on the Email Address Policy at all. That’s why you will see that HMC will not create any Email Address Policy at all.</p>\n</li>\n<li><p>HMC will use its own mechanism to stamp the SMTP addresses.<br>So, that’s it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.</p>\n</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 2 - Address Lists Segregation","date":"2009-05-07T09:32:58.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn part [#1](https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/), I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.\n\nSo far, there wasn't anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.\n\nLet's look at what address lists we need to segregate and why. Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,\n\n*   **Contacts folder** - this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don't use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.\n\n*   **Personal Address Book (PAB)** - Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact's name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.\n\n*   **Server-side Address Lists **- in Exchange 2007 environment, you have 2 types of address lists,\n\n    *   _Global Address List (GAL)_ - The GAL contains information for <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.\n\n*   _Other Address Lists _- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the **All Address Lists** group in the **Show Names from the** drop-down list in the Outlook Address Book.\n\nFrom the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are 'not shared' and are private by default.\n\nServer-side address lists however are slightly different. The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let's take a closer look at what HMC will change in order to segregate the address lists so that every company will only see what they are supposed to see.\n\nBefore that, I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That's not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.\n\n**What is HMC trying to do? **\n\nSo, let's look at what HMC intends to achieve here,\n\n*   **Global Address List** - By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources in the whole environment. That is not &nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.\n&nbsp;\n\n*   **Other Address List** - If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.\nSo, with the above objectives in mind, let's take a closer look.\n\n**Global Address List Segregation**\n\nOutlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.\n\nOnce we have different GALs for different companies, we need to address the following,\n\n<span style=\"text-decoration: underline;\">(1) What's the limitation of Global Address List?</span>\n\nThe default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the **MakeGalLinked** tool to extend this limit.\n\nThis is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.\n\n<span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span>\n\nIf you refer to the following article, [http://support.microsoft.com/kb/312287](http://support.microsoft.com/kb/312287), you will realize that Outlook displays the global address list that meets the following criteria:\n\n*   The user has permissions to access this global address list.\n*   The user is a member of this global address list.\n*   This global address list is the largest of all of the other global address lists.\nThe above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.\n\nBecause of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn't very different as compared to the steps documented in [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \").\n\nWith the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.\n\nWhat HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;) in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn't stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,\n\n_Get-ADPermission \"AlpineSkiHouse GAL\" | FL_\n\n<span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span>\n\nIn [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"), the article uses **customattribute1** and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.\n\nThis is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the **RecipientFilter** and **LdapRecipientFilter** attributes are empty.\n\nThese attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.\n\nSo, why does HMC not have any value on those attributes then? The answers are,\n\n*   HMC mechanism - HMC has its own mechanism to retrieve the company GAL and perform the membership stamping. How? Remember the otherWellKnownObjects attribute I talked about in part #1?\n*   It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.\nYou may ask, what about when I query this from Outlook? Does it use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership during mailbox creation.\n\nThere you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.\n\n**Address List Segregation**\n\nAddress List Segregation isn't very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.\n\nFirstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.\n\nNext, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don't really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can't even create an Outlook profile for that user.\n\nHowever, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).\n\nLike the GAL membership stamping process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.\n\n**Wait the minute, what about Outlook Web Access?**\n\nSo far, we have been discussing about the Outlook experience of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.\n\nThere is some permission that applies only to specific clients. For example, Outlook Web Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group's recipients, due to how OWA works. This is where attribute**msExchQueryBaseDN** comes in.\n\nIn order for us to control or restrict the search results to include only the members of the appropriate address list in Outlook Web Access, we must set the attribute**msExchQueryBaseDN** on each user object to the _distinguishedname_ (DN) of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.\n\n**What about LDAP? I have clients needing this access.**\n\nIf I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don't.\n\nHowever if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don't want to put your Active Directory server out and exposed them to the Internet just like that.\n\nAlso, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 ([http://support.microsoft.com/kb/943864/en-us](http://support.microsoft.com/kb/943864/en-us)), to properly lock it down before allow your users to use it.\n\n**What are some of the usual problems that you may face with Address Lists?**\n\n<span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span>\n\nThe most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the **RecipientFilter** and **LdapRecipientFilter** means that you can't run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.\n\nWhen an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.\n\nTo resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.\n\nHere is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;  and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.\n```xml\n<request>\n<data>\n<preferredDomainController>AD02.Fabrikam.Com</preferredDomainController>\n<user>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com </user>\n<alias>User1</alias>\n<emailAddresses>\n<value>User1@alpineskihouse.com </value>\n</emailAddresses>\n</data>\n<procedure>\n<execute namespace=\"Hosted Email 2007\" procedure=\"ModifyMailbox\" impersonate=\"1\" >\n<before source=\"data\" destination=\"executeData\" mode=\"merge\" />\n<after source=\"executeData\" destination=\"data\" mode=\"merge\" />\n</execute>\n</procedure>\n</request>\n```\nThis functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.","source":"_posts/hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 2 - Address Lists Segregation\ntags:\n  - Exchange\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 17:32:58\n---\n\n转自 http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn part [#1](https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/), I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.\n\nSo far, there wasn't anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.\n\nLet's look at what address lists we need to segregate and why. Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,\n\n*   **Contacts folder** - this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don't use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.\n\n*   **Personal Address Book (PAB)** - Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact's name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.\n\n*   **Server-side Address Lists **- in Exchange 2007 environment, you have 2 types of address lists,\n\n    *   _Global Address List (GAL)_ - The GAL contains information for <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.\n\n*   _Other Address Lists _- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the **All Address Lists** group in the **Show Names from the** drop-down list in the Outlook Address Book.\n\nFrom the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are 'not shared' and are private by default.\n\nServer-side address lists however are slightly different. The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let's take a closer look at what HMC will change in order to segregate the address lists so that every company will only see what they are supposed to see.\n\nBefore that, I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That's not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.\n\n**What is HMC trying to do? **\n\nSo, let's look at what HMC intends to achieve here,\n\n*   **Global Address List** - By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources in the whole environment. That is not &nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.\n&nbsp;\n\n*   **Other Address List** - If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.\nSo, with the above objectives in mind, let's take a closer look.\n\n**Global Address List Segregation**\n\nOutlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.\n\nOnce we have different GALs for different companies, we need to address the following,\n\n<span style=\"text-decoration: underline;\">(1) What's the limitation of Global Address List?</span>\n\nThe default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the **MakeGalLinked** tool to extend this limit.\n\nThis is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.\n\n<span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span>\n\nIf you refer to the following article, [http://support.microsoft.com/kb/312287](http://support.microsoft.com/kb/312287), you will realize that Outlook displays the global address list that meets the following criteria:\n\n*   The user has permissions to access this global address list.\n*   The user is a member of this global address list.\n*   This global address list is the largest of all of the other global address lists.\nThe above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.\n\nBecause of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn't very different as compared to the steps documented in [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \").\n\nWith the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.\n\nWhat HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;) in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn't stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,\n\n_Get-ADPermission \"AlpineSkiHouse GAL\" | FL_\n\n<span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span>\n\nIn [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"), the article uses **customattribute1** and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.\n\nThis is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the **RecipientFilter** and **LdapRecipientFilter** attributes are empty.\n\nThese attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.\n\nSo, why does HMC not have any value on those attributes then? The answers are,\n\n*   HMC mechanism - HMC has its own mechanism to retrieve the company GAL and perform the membership stamping. How? Remember the otherWellKnownObjects attribute I talked about in part #1?\n*   It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.\nYou may ask, what about when I query this from Outlook? Does it use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership during mailbox creation.\n\nThere you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.\n\n**Address List Segregation**\n\nAddress List Segregation isn't very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.\n\nFirstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.\n\nNext, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don't really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can't even create an Outlook profile for that user.\n\nHowever, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).\n\nLike the GAL membership stamping process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.\n\n**Wait the minute, what about Outlook Web Access?**\n\nSo far, we have been discussing about the Outlook experience of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.\n\nThere is some permission that applies only to specific clients. For example, Outlook Web Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group's recipients, due to how OWA works. This is where attribute**msExchQueryBaseDN** comes in.\n\nIn order for us to control or restrict the search results to include only the members of the appropriate address list in Outlook Web Access, we must set the attribute**msExchQueryBaseDN** on each user object to the _distinguishedname_ (DN) of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.\n\n**What about LDAP? I have clients needing this access.**\n\nIf I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don't.\n\nHowever if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don't want to put your Active Directory server out and exposed them to the Internet just like that.\n\nAlso, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 ([http://support.microsoft.com/kb/943864/en-us](http://support.microsoft.com/kb/943864/en-us)), to properly lock it down before allow your users to use it.\n\n**What are some of the usual problems that you may face with Address Lists?**\n\n<span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span>\n\nThe most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the **RecipientFilter** and **LdapRecipientFilter** means that you can't run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.\n\nWhen an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.\n\nTo resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.\n\nHere is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;  and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.\n```xml\n<request>\n<data>\n<preferredDomainController>AD02.Fabrikam.Com</preferredDomainController>\n<user>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com </user>\n<alias>User1</alias>\n<emailAddresses>\n<value>User1@alpineskihouse.com </value>\n</emailAddresses>\n</data>\n<procedure>\n<execute namespace=\"Hosted Email 2007\" procedure=\"ModifyMailbox\" impersonate=\"1\" >\n<before source=\"data\" destination=\"executeData\" mode=\"merge\" />\n<after source=\"executeData\" destination=\"data\" mode=\"merge\" />\n</execute>\n</procedure>\n</request>\n```\nThis functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.","slug":"hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation","published":1,"updated":"2020-01-05T09:00:53.955Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kto001pk84sdeleh3cl","content":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx\">http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In part <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/\">#1</a>, I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.</p>\n<p>So far, there wasn’t anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.</p>\n<p>Let’s look at what address lists we need to segregate and why.&nbsp;Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,</p>\n<ul>\n<li><p><strong>Contacts folder</strong>&nbsp;- this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don’t use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.</p>\n</li>\n<li><p><strong>Personal Address Book (PAB)</strong>&nbsp;- Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact’s name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.</p>\n</li>\n<li><p>**Server-side Address Lists&nbsp;**- in Exchange 2007 environment, you have 2 types of address lists,</p>\n<ul>\n<li><em>Global Address List (GAL)</em>&nbsp;- The GAL contains information for&nbsp;<span style=\"text-decoration: underline;\">all</span>&nbsp;email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.</li>\n</ul>\n</li>\n<li><p>_Other Address Lists&nbsp;_- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the&nbsp;<strong>All Address Lists</strong>&nbsp;group in the&nbsp;<strong>Show Names from the</strong>&nbsp;drop-down list in the Outlook Address Book.</p>\n</li>\n</ul>\n<p>From the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are ‘not shared’ and are private by default.</p>\n<p>Server-side address lists however&nbsp;are slightly different.&nbsp;The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let’s take a closer look at what HMC will change in order to&nbsp;segregate the address lists so that every company will only&nbsp;see what they are supposed to see.</p>\n<p>Before that,&nbsp;I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter&nbsp;that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That’s not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for&nbsp;the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.</p>\n<p>**What is HMC trying to do?&nbsp;**</p>\n<p>So, let’s look at what HMC intends to achieve here,</p>\n<ul>\n<li><p><strong>Global Address List</strong>&nbsp;- By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of&nbsp;<span style=\"text-decoration: underline;\">all</span>&nbsp;email users, distribution groups, and Exchange resources in the whole environment. That is not &amp;nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.<br>&amp;nbsp;</p>\n</li>\n<li><p><strong>Other Address List</strong>&nbsp;- If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.<br>So, with the above objectives in mind, let’s take a closer look.</p>\n</li>\n</ul>\n<p><strong>Global Address List Segregation</strong></p>\n<p>Outlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create&nbsp;different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.</p>\n<p>Once we have different GALs for different companies, we need to address the following,</p>\n<p><span style=\"text-decoration: underline;\">(1) What’s the limitation of Global Address List?</span></p>\n<p>The default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the&nbsp;<strong>MakeGalLinked</strong>&nbsp;tool to extend this limit.</p>\n<p>This is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.</p>\n<p><span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span></p>\n<p>If you refer to the following article,&nbsp;<a href=\"http://support.microsoft.com/kb/312287\">http://support.microsoft.com/kb/312287</a>, you will realize that Outlook displays the global address list that meets the following criteria:</p>\n<ul>\n<li>The user has permissions to access this global address list.</li>\n<li>The user is a member of this global address list.</li>\n<li>This global address list is the largest of all of the other global address lists.<br>The above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.</li>\n</ul>\n<p>Because of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn’t very different as compared to the steps documented in&nbsp;<a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007</a>.</p>\n<p>With the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.</p>\n<p>What HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;)&nbsp;in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn’t stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,</p>\n<p><em>Get-ADPermission “AlpineSkiHouse GAL” | FL</em></p>\n<p><span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span></p>\n<p>In&nbsp;<a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007&nbsp;</a>, the article uses&nbsp;<strong>customattribute1</strong>&nbsp;and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.</p>\n<p>This is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the&nbsp;<strong>RecipientFilter</strong>&nbsp;and&nbsp;<strong>LdapRecipientFilter</strong>&nbsp;attributes are empty.</p>\n<p>These attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.</p>\n<p>So, why does HMC not have any value on those attributes then? The answers are,</p>\n<ul>\n<li>HMC mechanism - HMC has its own mechanism to retrieve&nbsp;the&nbsp;company GAL and perform the membership stamping. How? Remember the&nbsp;otherWellKnownObjects attribute I talked about in part #1?</li>\n<li>It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.<br>You may ask, what about when I query this from&nbsp;Outlook? Does it&nbsp;use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on&nbsp;Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership&nbsp;during mailbox&nbsp;creation.</li>\n</ul>\n<p>There you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.</p>\n<p><strong>Address List Segregation</strong></p>\n<p>Address List Segregation isn’t very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.</p>\n<p>Firstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.</p>\n<p>Next, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don’t really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can’t even create an Outlook profile&nbsp;for that user.</p>\n<p>However, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).</p>\n<p>Like the GAL membership stamping&nbsp;process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.</p>\n<p><strong>Wait the minute, what about Outlook Web Access?</strong></p>\n<p>So far, we have been discussing about the Outlook&nbsp;experience&nbsp;of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.</p>\n<p>There is some permission that applies only to specific clients. For example, Outlook&nbsp;Web&nbsp;Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group’s recipients, due to how OWA works.&nbsp;This is where attribute<strong>msExchQueryBaseDN</strong>&nbsp;comes in.</p>\n<p>In order for us to control or&nbsp;restrict the search results to include only the members of the appropriate address list in Outlook&nbsp;Web&nbsp;Access,&nbsp;we must set the attribute<strong>msExchQueryBaseDN</strong>&nbsp;on each user object to the&nbsp;<em>distinguishedname</em>&nbsp;(DN)&nbsp;of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.</p>\n<p><strong>What about LDAP?&nbsp;I have clients needing this access.</strong></p>\n<p>If I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don’t.</p>\n<p>However if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don’t want to put your Active Directory server out and exposed them to the Internet just like that.</p>\n<p>Also, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 (<a href=\"http://support.microsoft.com/kb/943864/en-us\">http://support.microsoft.com/kb/943864/en-us</a>), to properly lock it down before allow your users to use it.</p>\n<p><strong>What are some of the usual problems that you may face with Address Lists?</strong></p>\n<p><span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span></p>\n<p>The most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the&nbsp;<strong>RecipientFilter</strong>&nbsp;and&nbsp;<strong>LdapRecipientFilter</strong>&nbsp;means that you can’t run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.</p>\n<p>When an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.</p>\n<p>To resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.</p>\n<p>Here is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;&nbsp; and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">data</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>AD02.Fabrikam.Com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com <span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">alias</span>&gt;</span>User1<span class=\"tag\">&lt;/<span class=\"name\">alias</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">emailAddresses</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>User1@alpineskihouse.com <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">emailAddresses</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">data</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">procedure</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Email 2007\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyMailbox\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span> &gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">after</span> <span class=\"attr\">source</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>This functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx\">http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In part <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/\">#1</a>, I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.</p>\n<p>So far, there wasn’t anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.</p>\n<p>Let’s look at what address lists we need to segregate and why.&nbsp;Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,</p>\n<ul>\n<li><p><strong>Contacts folder</strong>&nbsp;- this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don’t use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.</p>\n</li>\n<li><p><strong>Personal Address Book (PAB)</strong>&nbsp;- Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact’s name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.</p>\n</li>\n<li><p>**Server-side Address Lists&nbsp;**- in Exchange 2007 environment, you have 2 types of address lists,</p>\n<ul>\n<li><em>Global Address List (GAL)</em>&nbsp;- The GAL contains information for&nbsp;<span style=\"text-decoration: underline;\">all</span>&nbsp;email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.</li>\n</ul>\n</li>\n<li><p>_Other Address Lists&nbsp;_- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the&nbsp;<strong>All Address Lists</strong>&nbsp;group in the&nbsp;<strong>Show Names from the</strong>&nbsp;drop-down list in the Outlook Address Book.</p>\n</li>\n</ul>\n<p>From the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are ‘not shared’ and are private by default.</p>\n<p>Server-side address lists however&nbsp;are slightly different.&nbsp;The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let’s take a closer look at what HMC will change in order to&nbsp;segregate the address lists so that every company will only&nbsp;see what they are supposed to see.</p>\n<p>Before that,&nbsp;I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter&nbsp;that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That’s not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for&nbsp;the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.</p>\n<p>**What is HMC trying to do?&nbsp;**</p>\n<p>So, let’s look at what HMC intends to achieve here,</p>\n<ul>\n<li><p><strong>Global Address List</strong>&nbsp;- By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of&nbsp;<span style=\"text-decoration: underline;\">all</span>&nbsp;email users, distribution groups, and Exchange resources in the whole environment. That is not &amp;nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.<br>&amp;nbsp;</p>\n</li>\n<li><p><strong>Other Address List</strong>&nbsp;- If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.<br>So, with the above objectives in mind, let’s take a closer look.</p>\n</li>\n</ul>\n<p><strong>Global Address List Segregation</strong></p>\n<p>Outlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create&nbsp;different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.</p>\n<p>Once we have different GALs for different companies, we need to address the following,</p>\n<p><span style=\"text-decoration: underline;\">(1) What’s the limitation of Global Address List?</span></p>\n<p>The default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the&nbsp;<strong>MakeGalLinked</strong>&nbsp;tool to extend this limit.</p>\n<p>This is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.</p>\n<p><span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span></p>\n<p>If you refer to the following article,&nbsp;<a href=\"http://support.microsoft.com/kb/312287\">http://support.microsoft.com/kb/312287</a>, you will realize that Outlook displays the global address list that meets the following criteria:</p>\n<ul>\n<li>The user has permissions to access this global address list.</li>\n<li>The user is a member of this global address list.</li>\n<li>This global address list is the largest of all of the other global address lists.<br>The above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.</li>\n</ul>\n<p>Because of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn’t very different as compared to the steps documented in&nbsp;<a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007</a>.</p>\n<p>With the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.</p>\n<p>What HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;)&nbsp;in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn’t stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,</p>\n<p><em>Get-ADPermission “AlpineSkiHouse GAL” | FL</em></p>\n<p><span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span></p>\n<p>In&nbsp;<a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007&nbsp;</a>, the article uses&nbsp;<strong>customattribute1</strong>&nbsp;and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.</p>\n<p>This is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the&nbsp;<strong>RecipientFilter</strong>&nbsp;and&nbsp;<strong>LdapRecipientFilter</strong>&nbsp;attributes are empty.</p>\n<p>These attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.</p>\n<p>So, why does HMC not have any value on those attributes then? The answers are,</p>\n<ul>\n<li>HMC mechanism - HMC has its own mechanism to retrieve&nbsp;the&nbsp;company GAL and perform the membership stamping. How? Remember the&nbsp;otherWellKnownObjects attribute I talked about in part #1?</li>\n<li>It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.<br>You may ask, what about when I query this from&nbsp;Outlook? Does it&nbsp;use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on&nbsp;Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership&nbsp;during mailbox&nbsp;creation.</li>\n</ul>\n<p>There you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.</p>\n<p><strong>Address List Segregation</strong></p>\n<p>Address List Segregation isn’t very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.</p>\n<p>Firstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.</p>\n<p>Next, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don’t really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can’t even create an Outlook profile&nbsp;for that user.</p>\n<p>However, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).</p>\n<p>Like the GAL membership stamping&nbsp;process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.</p>\n<p><strong>Wait the minute, what about Outlook Web Access?</strong></p>\n<p>So far, we have been discussing about the Outlook&nbsp;experience&nbsp;of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.</p>\n<p>There is some permission that applies only to specific clients. For example, Outlook&nbsp;Web&nbsp;Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group’s recipients, due to how OWA works.&nbsp;This is where attribute<strong>msExchQueryBaseDN</strong>&nbsp;comes in.</p>\n<p>In order for us to control or&nbsp;restrict the search results to include only the members of the appropriate address list in Outlook&nbsp;Web&nbsp;Access,&nbsp;we must set the attribute<strong>msExchQueryBaseDN</strong>&nbsp;on each user object to the&nbsp;<em>distinguishedname</em>&nbsp;(DN)&nbsp;of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.</p>\n<p><strong>What about LDAP?&nbsp;I have clients needing this access.</strong></p>\n<p>If I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don’t.</p>\n<p>However if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don’t want to put your Active Directory server out and exposed them to the Internet just like that.</p>\n<p>Also, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 (<a href=\"http://support.microsoft.com/kb/943864/en-us\">http://support.microsoft.com/kb/943864/en-us</a>), to properly lock it down before allow your users to use it.</p>\n<p><strong>What are some of the usual problems that you may face with Address Lists?</strong></p>\n<p><span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span></p>\n<p>The most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the&nbsp;<strong>RecipientFilter</strong>&nbsp;and&nbsp;<strong>LdapRecipientFilter</strong>&nbsp;means that you can’t run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.</p>\n<p>When an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.</p>\n<p>To resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.</p>\n<p>Here is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;&nbsp; and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">data</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>AD02.Fabrikam.Com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com <span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">alias</span>&gt;</span>User1<span class=\"tag\">&lt;/<span class=\"name\">alias</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">emailAddresses</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>User1@alpineskihouse.com <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">emailAddresses</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">data</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">procedure</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Email 2007\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyMailbox\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span> &gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">after</span> <span class=\"attr\">source</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>This functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.</p>\n</body></html>"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 3 - Offline Address Book Generations","date":"2009-05-07T09:38:47.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment. It is my belief that if you understand that clearly, you have understood 70% of the Hosted Exchange concept in HMC. The rest will be just easy. :)\n\nIn this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don't intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman's web log has covered most of them ([http://blogs.msdn.com/dgoldman/default.aspx](http://blogs.msdn.com/dgoldman/default.aspx)). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn't changed much)\n\nOverview of the OABgen process\n[http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx)\n\nMy primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.\n\n**What has been introduced by HMC?**\n\nHMC does not change the OAB component in Exchange 2007 SP1 much. It does make a few changes in terms of how it works to make sure that things will run better in a service provider environment. So, let's take a closer look,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Process</span>\n\nThis is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.\n\nInstead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update will be called or triggered for that company.\n\nTo do that, HMC does the following,\n\n*   **No Schedule **- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.\n*   **HmOABUpdate** - HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).\nThis application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.\n\nThe application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.\n\nNow, for each Offline Address List object, there are a couple of interesting items to look at,\n\n*   The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).\n*   PublicFolderDistributionEnabled - Depending on the Organization Plan (&lt;features/ outlookClient&gt;) you use to create the company/tenant, this may be True or False.\n*   PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.\nIf all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.\n\n<span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span>\n\nThere are a few unique challenges that a Hosted Exchange environment like HMC may face that are generally not faced by a corporate environment.\n\n*   **High number of OABs**, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists ([http://technet.microsoft.com/en-us/library/cc539031.aspx](http://technet.microsoft.com/en-us/library/cc539031.aspx)).\n> In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.\n\n*   **Dedicated OAB Distribution Server**, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).\nIf you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn't mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).\n\n*   **Other behaviour that you should take note**, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.\n\n    *   OAB public folder expiration. This actually trace back to Exchange Server 2003, Update to modify the OAB public folder expiration in Exchange Server 2003 ([http://support.microsoft.com/kb/832761](http://support.microsoft.com/kb/832761)).\n> Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what's going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the \"OAL Folder Lifetime\" registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.\n> > \n> > HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters\n> > \n> > Value name: OAL Folder Lifetime (days)\n> > Value type: REG_DWORD\n> > Value data: 0\n\n*   OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent, [http://support.microsoft.com/?id=834315](http://support.microsoft.com/?id=834315). While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.\n\n<span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span>\n\nEven though HMC puts in tweaks here and there, creation of the Offline Address List is nothing more than calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight one thing,\n\n_SkipPublicFolderInitialization_ parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the_SkipPublicFolderInitialization_ parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the_SkipPublicFolderInitialization_ parameter. If you do not skip this initialization, it may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.\n\nSo, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.\n\n<span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span>\n\nNow that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs  should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,\n\n**msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\n\nThis attribute is populated when the mailbox user is created in HMC.\n\n<span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span>\n\nBy far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.\n\nHMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.\n\nIn order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.\n\nThe concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.\n\nThen when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That's why the specification of the CAS pool is on creating mailbox.\n\nEverything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called**UpdateOABProvision.exe**.\n\nThe **UpdateOABProvision.exe** tool is used to update all existing Offline Address Books (OAB's) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.\n\nFor example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB's associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB's associated with that pool should be updated so that the removed server is no longer set as a distribution point.\n\nThe command-line syntax for running the UpdateOABProvision.exe tool is:\n\n\n`UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError`\n\nI also like to highlight one thing here which is in HMC 4.5, it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128 servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we have when we are using Public Folder OAB distribution.\n\n**Troubleshooting OAB download Issues in HMC**\n\nProblem downloading OABs is one of the most common issues raised to us for newly setup HMC environment. Most of the time, the problems can be categorized into 2 types,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span>\n\nThis is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,\n\n*   Confirm that the company OAB root folder exists. If not, you need to find out,\n\n    *   If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server\n    *   If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.\n    *   If you can't find the root folder anywhere, you may want to find out how the OAB was created in the first place.\n\n*   If you can find the company OAB root folder, confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.\n*   HmOABUpdate application isn't working because it was not setup properly. This could be due to permission not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what's going on to get started.\n*   Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,[http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx). Turning up the Diagnostic logging will usually lead you to the source of the problem.\nIf you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.\n\n<span style=\"text-decoration: underline;\">(2) Locating OABs</span>\n\nI will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book\n[http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx](http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx)\n\nIn addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn't working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can't download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.\n\nI will also cover how Autodiscover work in the HMC environment in part #5.","source":"_posts/hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 3 - Offline Address Book Generations\ntags:\n  - HMC\n  - Exchange\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 17:38:47\n---\n\n转自 http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment. It is my belief that if you understand that clearly, you have understood 70% of the Hosted Exchange concept in HMC. The rest will be just easy. :)\n\nIn this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don't intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman's web log has covered most of them ([http://blogs.msdn.com/dgoldman/default.aspx](http://blogs.msdn.com/dgoldman/default.aspx)). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn't changed much)\n\nOverview of the OABgen process\n[http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx)\n\nMy primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.\n\n**What has been introduced by HMC?**\n\nHMC does not change the OAB component in Exchange 2007 SP1 much. It does make a few changes in terms of how it works to make sure that things will run better in a service provider environment. So, let's take a closer look,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Process</span>\n\nThis is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.\n\nInstead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update will be called or triggered for that company.\n\nTo do that, HMC does the following,\n\n*   **No Schedule **- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.\n*   **HmOABUpdate** - HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).\nThis application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.\n\nThe application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.\n\nNow, for each Offline Address List object, there are a couple of interesting items to look at,\n\n*   The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).\n*   PublicFolderDistributionEnabled - Depending on the Organization Plan (&lt;features/ outlookClient&gt;) you use to create the company/tenant, this may be True or False.\n*   PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.\nIf all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.\n\n<span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span>\n\nThere are a few unique challenges that a Hosted Exchange environment like HMC may face that are generally not faced by a corporate environment.\n\n*   **High number of OABs**, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists ([http://technet.microsoft.com/en-us/library/cc539031.aspx](http://technet.microsoft.com/en-us/library/cc539031.aspx)).\n> In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.\n\n*   **Dedicated OAB Distribution Server**, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).\nIf you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn't mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).\n\n*   **Other behaviour that you should take note**, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.\n\n    *   OAB public folder expiration. This actually trace back to Exchange Server 2003, Update to modify the OAB public folder expiration in Exchange Server 2003 ([http://support.microsoft.com/kb/832761](http://support.microsoft.com/kb/832761)).\n> Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what's going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the \"OAL Folder Lifetime\" registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.\n> > \n> > HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters\n> > \n> > Value name: OAL Folder Lifetime (days)\n> > Value type: REG_DWORD\n> > Value data: 0\n\n*   OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent, [http://support.microsoft.com/?id=834315](http://support.microsoft.com/?id=834315). While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.\n\n<span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span>\n\nEven though HMC puts in tweaks here and there, creation of the Offline Address List is nothing more than calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight one thing,\n\n_SkipPublicFolderInitialization_ parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the_SkipPublicFolderInitialization_ parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the_SkipPublicFolderInitialization_ parameter. If you do not skip this initialization, it may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.\n\nSo, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.\n\n<span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span>\n\nNow that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs  should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,\n\n**msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\n\nThis attribute is populated when the mailbox user is created in HMC.\n\n<span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span>\n\nBy far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.\n\nHMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.\n\nIn order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.\n\nThe concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.\n\nThen when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That's why the specification of the CAS pool is on creating mailbox.\n\nEverything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called**UpdateOABProvision.exe**.\n\nThe **UpdateOABProvision.exe** tool is used to update all existing Offline Address Books (OAB's) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.\n\nFor example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB's associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB's associated with that pool should be updated so that the removed server is no longer set as a distribution point.\n\nThe command-line syntax for running the UpdateOABProvision.exe tool is:\n\n\n`UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError`\n\nI also like to highlight one thing here which is in HMC 4.5, it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128 servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we have when we are using Public Folder OAB distribution.\n\n**Troubleshooting OAB download Issues in HMC**\n\nProblem downloading OABs is one of the most common issues raised to us for newly setup HMC environment. Most of the time, the problems can be categorized into 2 types,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span>\n\nThis is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,\n\n*   Confirm that the company OAB root folder exists. If not, you need to find out,\n\n    *   If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server\n    *   If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.\n    *   If you can't find the root folder anywhere, you may want to find out how the OAB was created in the first place.\n\n*   If you can find the company OAB root folder, confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.\n*   HmOABUpdate application isn't working because it was not setup properly. This could be due to permission not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what's going on to get started.\n*   Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,[http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx). Turning up the Diagnostic logging will usually lead you to the source of the problem.\nIf you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.\n\n<span style=\"text-decoration: underline;\">(2) Locating OABs</span>\n\nI will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book\n[http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx](http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx)\n\nIn addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn't working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can't download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.\n\nI will also cover how Autodiscover work in the HMC environment in part #5.","slug":"hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations","published":1,"updated":"2020-01-05T09:00:53.955Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktp001sk84s627affkl","content":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx\">http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment.&nbsp;It is my belief that if you understand that clearly, you have understood 70% of&nbsp;the Hosted Exchange concept in HMC. The rest will be just easy. :)</p>\n<p>In this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don’t intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman’s web log has covered most of them (<a href=\"http://blogs.msdn.com/dgoldman/default.aspx\">http://blogs.msdn.com/dgoldman/default.aspx</a>). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn’t changed much)</p>\n<p>Overview of the OABgen process<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx\">http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx</a></p>\n<p>My primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.</p>\n<p><strong>What has been introduced by HMC?</strong></p>\n<p>HMC does not change&nbsp;the OAB component in Exchange 2007 SP1 much.&nbsp;It does&nbsp;make a few changes in terms of how it works to make sure that&nbsp;things will run better in a service provider environment. So, let’s take a closer look,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Process</span></p>\n<p>This is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.</p>\n<p>Instead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by&nbsp;making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update&nbsp;will be called&nbsp;or triggered for that company.</p>\n<p>To do that, HMC does the following,</p>\n<ul>\n<li>**No Schedule&nbsp;**- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.</li>\n<li><strong>HmOABUpdate</strong>&nbsp;- HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).<br>This application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.</li>\n</ul>\n<p>The application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.</p>\n<p>Now, for each Offline Address List object, there are a couple of interesting items to look at,</p>\n<ul>\n<li>The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).</li>\n<li>PublicFolderDistributionEnabled -&nbsp;Depending on&nbsp;the&nbsp;Organization Plan (&lt;features/ outlookClient&gt;)&nbsp;you&nbsp;use to create the&nbsp;company/tenant, this may be True or False.</li>\n<li>PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.<br>If all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span></p>\n<p>There are a few unique challenges that a Hosted Exchange environment like HMC may face that&nbsp;are generally not faced by a corporate environment.</p>\n<ul>\n<li><p><strong>High number of OABs</strong>, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that&nbsp;each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists (<a href=\"http://technet.microsoft.com/en-us/library/cc539031.aspx\">http://technet.microsoft.com/en-us/library/cc539031.aspx</a>).</p>\n<blockquote>\n<p>In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.</p>\n</blockquote>\n</li>\n<li><p><strong>Dedicated OAB Distribution Server</strong>, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).<br>If you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn’t mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).</p>\n</li>\n<li><p><strong>Other behaviour that you should take note</strong>, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.</p>\n<ul>\n<li>OAB public folder expiration. This actually trace back to Exchange Server 2003,&nbsp;Update to modify the OAB public folder expiration in Exchange Server 2003 (<a href=\"http://support.microsoft.com/kb/832761\">http://support.microsoft.com/kb/832761</a>).</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what’s going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the “OAL Folder Lifetime”&nbsp;registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.</p>\n<blockquote>\n<p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters</p>\n<p>Value name: OAL Folder Lifetime (days)<br>Value type: REG_DWORD<br>Value data: 0</p>\n</blockquote>\n</blockquote>\n<ul>\n<li>OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent,&nbsp;<a href=\"http://support.microsoft.com/?id=834315\">http://support.microsoft.com/?id=834315</a>. While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span></p>\n<p>Even though HMC puts in&nbsp;tweaks here and there,&nbsp;creation of the Offline Address List is nothing more than&nbsp;calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight&nbsp;one thing,</p>\n<p><em>SkipPublicFolderInitialization</em>&nbsp;parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the_SkipPublicFolderInitialization_&nbsp;parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the_SkipPublicFolderInitialization_&nbsp;parameter.&nbsp;If you do not&nbsp;skip this initialization, it&nbsp;may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.</p>\n<p>So, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.</p>\n<p><span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span></p>\n<p>Now that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs&nbsp; should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,</p>\n<p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.</p>\n<p>This attribute is populated when the mailbox user is created in HMC.</p>\n<p><span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span></p>\n<p>By far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.</p>\n<p>HMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.</p>\n<p>In order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.</p>\n<p>The concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.</p>\n<p>Then when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That’s why the specification of the CAS pool is on creating mailbox.</p>\n<p>Everything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called<strong>UpdateOABProvision.exe</strong>.</p>\n<p>The&nbsp;<strong>UpdateOABProvision.exe</strong>&nbsp;tool is used to update all existing Offline Address Books (OAB’s) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.</p>\n<p>For example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB’s associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB’s associated with that pool should be updated so that the removed server is no longer set as a distribution point.</p>\n<p>The command-line syntax for running the UpdateOABProvision.exe tool is:</p>\n<p><code>UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError</code></p>\n<p>I also like to highlight one thing here which&nbsp;is in HMC 4.5,&nbsp;it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128&nbsp;servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we&nbsp;have when we are using Public Folder OAB distribution.</p>\n<p><strong>Troubleshooting OAB download Issues in HMC</strong></p>\n<p>Problem downloading OABs is one of the most common issues raised to us&nbsp;for newly setup HMC environment. Most of the time, the problems can be categorized into&nbsp;2 types,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span></p>\n<p>This is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,</p>\n<ul>\n<li><p>Confirm that the company OAB root folder exists. If not, you need to find out,</p>\n<ul>\n<li>If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server</li>\n<li>If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.</li>\n<li>If you can’t find the root folder anywhere, you may want to find out how the OAB was created in the first place.</li>\n</ul>\n</li>\n<li><p>If you can find the company OAB root folder,&nbsp;confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.</p>\n</li>\n<li><p>HmOABUpdate application isn’t working because it was not setup properly.&nbsp;This could be due to permission&nbsp;not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what’s going on to get started.</p>\n</li>\n<li><p>Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,<a href=\"http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx\">http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx</a>. Turning up the Diagnostic logging will usually lead you to the source of the problem.<br>If you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.</p>\n</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) Locating OABs</span></p>\n<p>I will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx\">http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx</a></p>\n<p>In addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn’t working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can’t download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.</p>\n<p>I will also cover how Autodiscover work in the HMC environment in part #5.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx\">http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment.&nbsp;It is my belief that if you understand that clearly, you have understood 70% of&nbsp;the Hosted Exchange concept in HMC. The rest will be just easy. :)</p>\n<p>In this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don’t intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman’s web log has covered most of them (<a href=\"http://blogs.msdn.com/dgoldman/default.aspx\">http://blogs.msdn.com/dgoldman/default.aspx</a>). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn’t changed much)</p>\n<p>Overview of the OABgen process<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx\">http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx</a></p>\n<p>My primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.</p>\n<p><strong>What has been introduced by HMC?</strong></p>\n<p>HMC does not change&nbsp;the OAB component in Exchange 2007 SP1 much.&nbsp;It does&nbsp;make a few changes in terms of how it works to make sure that&nbsp;things will run better in a service provider environment. So, let’s take a closer look,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Process</span></p>\n<p>This is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.</p>\n<p>Instead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by&nbsp;making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update&nbsp;will be called&nbsp;or triggered for that company.</p>\n<p>To do that, HMC does the following,</p>\n<ul>\n<li>**No Schedule&nbsp;**- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.</li>\n<li><strong>HmOABUpdate</strong>&nbsp;- HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).<br>This application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.</li>\n</ul>\n<p>The application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.</p>\n<p>Now, for each Offline Address List object, there are a couple of interesting items to look at,</p>\n<ul>\n<li>The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).</li>\n<li>PublicFolderDistributionEnabled -&nbsp;Depending on&nbsp;the&nbsp;Organization Plan (&lt;features/ outlookClient&gt;)&nbsp;you&nbsp;use to create the&nbsp;company/tenant, this may be True or False.</li>\n<li>PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.<br>If all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span></p>\n<p>There are a few unique challenges that a Hosted Exchange environment like HMC may face that&nbsp;are generally not faced by a corporate environment.</p>\n<ul>\n<li><p><strong>High number of OABs</strong>, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that&nbsp;each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists (<a href=\"http://technet.microsoft.com/en-us/library/cc539031.aspx\">http://technet.microsoft.com/en-us/library/cc539031.aspx</a>).</p>\n<blockquote>\n<p>In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.</p>\n</blockquote>\n</li>\n<li><p><strong>Dedicated OAB Distribution Server</strong>, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).<br>If you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn’t mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).</p>\n</li>\n<li><p><strong>Other behaviour that you should take note</strong>, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.</p>\n<ul>\n<li>OAB public folder expiration. This actually trace back to Exchange Server 2003,&nbsp;Update to modify the OAB public folder expiration in Exchange Server 2003 (<a href=\"http://support.microsoft.com/kb/832761\">http://support.microsoft.com/kb/832761</a>).</li>\n</ul>\n</li>\n</ul>\n<blockquote>\n<p>Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what’s going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the “OAL Folder Lifetime”&nbsp;registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.</p>\n<blockquote>\n<p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters</p>\n<p>Value name: OAL Folder Lifetime (days)<br>Value type: REG_DWORD<br>Value data: 0</p>\n</blockquote>\n</blockquote>\n<ul>\n<li>OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent,&nbsp;<a href=\"http://support.microsoft.com/?id=834315\">http://support.microsoft.com/?id=834315</a>. While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span></p>\n<p>Even though HMC puts in&nbsp;tweaks here and there,&nbsp;creation of the Offline Address List is nothing more than&nbsp;calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight&nbsp;one thing,</p>\n<p><em>SkipPublicFolderInitialization</em>&nbsp;parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the_SkipPublicFolderInitialization_&nbsp;parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the_SkipPublicFolderInitialization_&nbsp;parameter.&nbsp;If you do not&nbsp;skip this initialization, it&nbsp;may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.</p>\n<p>So, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.</p>\n<p><span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span></p>\n<p>Now that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs&nbsp; should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,</p>\n<p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.</p>\n<p>This attribute is populated when the mailbox user is created in HMC.</p>\n<p><span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span></p>\n<p>By far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.</p>\n<p>HMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.</p>\n<p>In order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.</p>\n<p>The concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.</p>\n<p>Then when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That’s why the specification of the CAS pool is on creating mailbox.</p>\n<p>Everything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called<strong>UpdateOABProvision.exe</strong>.</p>\n<p>The&nbsp;<strong>UpdateOABProvision.exe</strong>&nbsp;tool is used to update all existing Offline Address Books (OAB’s) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.</p>\n<p>For example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB’s associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB’s associated with that pool should be updated so that the removed server is no longer set as a distribution point.</p>\n<p>The command-line syntax for running the UpdateOABProvision.exe tool is:</p>\n<p><code>UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError</code></p>\n<p>I also like to highlight one thing here which&nbsp;is in HMC 4.5,&nbsp;it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128&nbsp;servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we&nbsp;have when we are using Public Folder OAB distribution.</p>\n<p><strong>Troubleshooting OAB download Issues in HMC</strong></p>\n<p>Problem downloading OABs is one of the most common issues raised to us&nbsp;for newly setup HMC environment. Most of the time, the problems can be categorized into&nbsp;2 types,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span></p>\n<p>This is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,</p>\n<ul>\n<li><p>Confirm that the company OAB root folder exists. If not, you need to find out,</p>\n<ul>\n<li>If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server</li>\n<li>If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.</li>\n<li>If you can’t find the root folder anywhere, you may want to find out how the OAB was created in the first place.</li>\n</ul>\n</li>\n<li><p>If you can find the company OAB root folder,&nbsp;confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.</p>\n</li>\n<li><p>HmOABUpdate application isn’t working because it was not setup properly.&nbsp;This could be due to permission&nbsp;not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what’s going on to get started.</p>\n</li>\n<li><p>Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,<a href=\"http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx\">http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx</a>. Turning up the Diagnostic logging will usually lead you to the source of the problem.<br>If you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.</p>\n</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) Locating OABs</span></p>\n<p>I will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx\">http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx</a></p>\n<p>In addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn’t working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can’t download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.</p>\n<p>I will also cover how Autodiscover work in the HMC environment in part #5.</p>\n</body></html>"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 4 Internal and External Out of Office","date":"2009-05-07T10:50:18.000Z","_content":"\n转自 https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/ 很好的文章,贴过来收藏,hehe.\n\n***\n\n**Internal and External OOF in HMC Environment**\n\nSo, the 4th main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, \"The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.\" Now, I don't intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.\n\nHere, I want to briefly explain how Exchange 2007 OOF, out of the box isn't really working complete in a HMC environment and how we make it work.\n\n**What's not working, really?**\n\nExchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn't packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.\n\nIf a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007 believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.\n\nFor example,\n\n1.  Hoster A has a HMC environment that hosts both company A and company B.\n2.  John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.\n3.  Alice from company B sends an e-mail to John from company A. Instead of getting John's external OOF, she got his internal OOF.\n**How do we make it work then?**\n\nTo support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here ([http://technet.microsoft.com/en-us/library/cc545931.aspx](http://technet.microsoft.com/en-us/library/cc545931.aspx)), the OOF agent includes two utilities:\n\n*   **Categorizer Override Agent**: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.\n\n*   **SMTP Domain Cache Task**: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.\nSo, how do these utilities work? It is quite simple as a matter of fact. Let's talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent. The agent checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and <span style=\"text-decoration: underline;\">bypass</span> suppression of the external OOF message for external and inter-company recipients.\n\nNext it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.\n\nFor performance reason, that's where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.\n\nThis file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.\n\nSo, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.\n\nThe OOF agent was first introduced in HMC 4.5 and Microsoft has also back ported this agent to HMC 4.0 environment, ([http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx](http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx))\n**What are some of the usual problems that you may face while installing this OOF agent?**\n\nThe installation of the OOF agent is clearly documented [here](http://technet.microsoft.com/en-us/library/cc545931.aspx \"Install OOF Aent\"). However, there are a few areas that you may encounter issues,\n\nThe OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented, C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.\n\nAnother thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService must have permission to it.\n\nAlso, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.\n\nAnother common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a '&amp;' may result in failure with strange error.\n\n**More about OOF?**\n\nIn case you want to know more about the working of OOF, here are 2 articles that you may want to read,\n\nExchange Server 2007 Out of Office (OOF)\n[http://msexchangeteam.com/archive/2006/10/06/429115.aspx](http://msexchangeteam.com/archive/2006/10/06/429115.aspx)\n\nLegacy client and Out of Office (OOF) interoperability\n[http://msexchangeteam.com/archive/2007/04/04/437544.aspx](http://msexchangeteam.com/archive/2007/04/04/437544.aspx)","source":"_posts/hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 4 Internal and External Out of Office\ntags:\n  - Exchange\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 18:50:18\n---\n\n转自 https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/ 很好的文章,贴过来收藏,hehe.\n\n***\n\n**Internal and External OOF in HMC Environment**\n\nSo, the 4th main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, \"The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.\" Now, I don't intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.\n\nHere, I want to briefly explain how Exchange 2007 OOF, out of the box isn't really working complete in a HMC environment and how we make it work.\n\n**What's not working, really?**\n\nExchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn't packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.\n\nIf a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007 believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.\n\nFor example,\n\n1.  Hoster A has a HMC environment that hosts both company A and company B.\n2.  John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.\n3.  Alice from company B sends an e-mail to John from company A. Instead of getting John's external OOF, she got his internal OOF.\n**How do we make it work then?**\n\nTo support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here ([http://technet.microsoft.com/en-us/library/cc545931.aspx](http://technet.microsoft.com/en-us/library/cc545931.aspx)), the OOF agent includes two utilities:\n\n*   **Categorizer Override Agent**: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.\n\n*   **SMTP Domain Cache Task**: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.\nSo, how do these utilities work? It is quite simple as a matter of fact. Let's talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent. The agent checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and <span style=\"text-decoration: underline;\">bypass</span> suppression of the external OOF message for external and inter-company recipients.\n\nNext it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.\n\nFor performance reason, that's where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.\n\nThis file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.\n\nSo, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.\n\nThe OOF agent was first introduced in HMC 4.5 and Microsoft has also back ported this agent to HMC 4.0 environment, ([http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx](http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx))\n**What are some of the usual problems that you may face while installing this OOF agent?**\n\nThe installation of the OOF agent is clearly documented [here](http://technet.microsoft.com/en-us/library/cc545931.aspx \"Install OOF Aent\"). However, there are a few areas that you may encounter issues,\n\nThe OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented, C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.\n\nAnother thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService must have permission to it.\n\nAlso, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.\n\nAnother common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a '&amp;' may result in failure with strange error.\n\n**More about OOF?**\n\nIn case you want to know more about the working of OOF, here are 2 articles that you may want to read,\n\nExchange Server 2007 Out of Office (OOF)\n[http://msexchangeteam.com/archive/2006/10/06/429115.aspx](http://msexchangeteam.com/archive/2006/10/06/429115.aspx)\n\nLegacy client and Out of Office (OOF) interoperability\n[http://msexchangeteam.com/archive/2007/04/04/437544.aspx](http://msexchangeteam.com/archive/2007/04/04/437544.aspx)","slug":"hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office","published":1,"updated":"2020-01-05T09:00:53.955Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktq001vk84scrt94yuv","content":"<html><head></head><body><p>转自 <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/\">https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/</a> 很好的文章,贴过来收藏,hehe.</p>\n<hr>\n<p><strong>Internal and External OOF in HMC Environment</strong></p>\n<p>So, the&nbsp;4th&nbsp;main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, “The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.”&nbsp;Now, I don’t intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.</p>\n<p>Here, I want to briefly explain how Exchange 2007 OOF, out of the box isn’t really working complete in a HMC environment and how we make it work.</p>\n<p><strong>What’s not working, really?</strong></p>\n<p>Exchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn’t packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.</p>\n<p>If a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007&nbsp;believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.</p>\n<p>For example,</p>\n<ol>\n<li>Hoster A has a HMC environment that hosts both company A and company B.</li>\n<li>John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.</li>\n<li>Alice from company B sends&nbsp;an e-mail to John from company A. Instead of getting John’s external OOF, she got his internal OOF.</li>\n</ol>\n<p><strong>How do we make it work then?</strong></p>\n<p>To support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here (<a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\">http://technet.microsoft.com/en-us/library/cc545931.aspx</a>), the OOF agent includes two utilities:</p>\n<ul>\n<li><p><strong>Categorizer Override Agent</strong>: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.</p>\n</li>\n<li><p><strong>SMTP Domain Cache Task</strong>: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.<br>So, how do these utilities work?&nbsp;It is quite simple as a matter of fact. Let’s talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent.&nbsp;The agent&nbsp;checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and&nbsp;<span style=\"text-decoration: underline;\">bypass</span>&nbsp;suppression of the external OOF message for external and inter-company recipients.</p>\n</li>\n</ul>\n<p>Next it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.</p>\n<p>For performance reason, that’s where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.</p>\n<p>This file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.</p>\n<p>So, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.</p>\n<p>The OOF agent was first introduced in HMC 4.5 and Microsoft has also back&nbsp;ported this agent to HMC 4.0&nbsp;environment, (<a href=\"http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx\">http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx</a>)<br><strong>What are some of the usual problems that you may face while installing this OOF agent?</strong></p>\n<p>The installation of the OOF agent is clearly documented&nbsp;<a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\" title=\"Install OOF Aent\">here</a>. However, there are a few areas that you may encounter issues,</p>\n<p>The OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented,&nbsp;C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.</p>\n<p>Another thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService&nbsp;account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService&nbsp;must have permission to it.</p>\n<p>Also, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.</p>\n<p>Another common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a ‘&amp;’ may result in failure with strange error.</p>\n<p><strong>More about OOF?</strong></p>\n<p>In case you want to know more about the working of OOF, here are 2 articles that you may want to read,</p>\n<p>Exchange Server 2007 Out of Office (OOF)<br><a href=\"http://msexchangeteam.com/archive/2006/10/06/429115.aspx\">http://msexchangeteam.com/archive/2006/10/06/429115.aspx</a></p>\n<p>Legacy client and Out of Office (OOF) interoperability<br><a href=\"http://msexchangeteam.com/archive/2007/04/04/437544.aspx\">http://msexchangeteam.com/archive/2007/04/04/437544.aspx</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>转自 <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/\">https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/</a> 很好的文章,贴过来收藏,hehe.</p>\n<hr>\n<p><strong>Internal and External OOF in HMC Environment</strong></p>\n<p>So, the&nbsp;4th&nbsp;main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, “The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.”&nbsp;Now, I don’t intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.</p>\n<p>Here, I want to briefly explain how Exchange 2007 OOF, out of the box isn’t really working complete in a HMC environment and how we make it work.</p>\n<p><strong>What’s not working, really?</strong></p>\n<p>Exchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn’t packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.</p>\n<p>If a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007&nbsp;believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.</p>\n<p>For example,</p>\n<ol>\n<li>Hoster A has a HMC environment that hosts both company A and company B.</li>\n<li>John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.</li>\n<li>Alice from company B sends&nbsp;an e-mail to John from company A. Instead of getting John’s external OOF, she got his internal OOF.</li>\n</ol>\n<p><strong>How do we make it work then?</strong></p>\n<p>To support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here (<a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\">http://technet.microsoft.com/en-us/library/cc545931.aspx</a>), the OOF agent includes two utilities:</p>\n<ul>\n<li><p><strong>Categorizer Override Agent</strong>: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.</p>\n</li>\n<li><p><strong>SMTP Domain Cache Task</strong>: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.<br>So, how do these utilities work?&nbsp;It is quite simple as a matter of fact. Let’s talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent.&nbsp;The agent&nbsp;checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and&nbsp;<span style=\"text-decoration: underline;\">bypass</span>&nbsp;suppression of the external OOF message for external and inter-company recipients.</p>\n</li>\n</ul>\n<p>Next it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.</p>\n<p>For performance reason, that’s where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.</p>\n<p>This file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.</p>\n<p>So, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.</p>\n<p>The OOF agent was first introduced in HMC 4.5 and Microsoft has also back&nbsp;ported this agent to HMC 4.0&nbsp;environment, (<a href=\"http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx\">http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx</a>)<br><strong>What are some of the usual problems that you may face while installing this OOF agent?</strong></p>\n<p>The installation of the OOF agent is clearly documented&nbsp;<a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\" title=\"Install OOF Aent\">here</a>. However, there are a few areas that you may encounter issues,</p>\n<p>The OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented,&nbsp;C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.</p>\n<p>Another thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService&nbsp;account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService&nbsp;must have permission to it.</p>\n<p>Also, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.</p>\n<p>Another common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a ‘&amp;’ may result in failure with strange error.</p>\n<p><strong>More about OOF?</strong></p>\n<p>In case you want to know more about the working of OOF, here are 2 articles that you may want to read,</p>\n<p>Exchange Server 2007 Out of Office (OOF)<br><a href=\"http://msexchangeteam.com/archive/2006/10/06/429115.aspx\">http://msexchangeteam.com/archive/2006/10/06/429115.aspx</a></p>\n<p>Legacy client and Out of Office (OOF) interoperability<br><a href=\"http://msexchangeteam.com/archive/2007/04/04/437544.aspx\">http://msexchangeteam.com/archive/2007/04/04/437544.aspx</a></p>\n</body></html>"},{"title":"HMC4.5 is out!","date":"2008-06-15T05:38:45.000Z","_content":"\nFinally released!! Waiting so long...\nHere is the link for the docs and sample code etc\n\n[Solution for Hosted Messaging and Collaboration v4.5](https://technet.microsoft.com/en-us/library/cc526352.aspx)\n\nHere is the ~~[link](http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en)~~ for the updated SDK doc.\n\n**Use HMC 4.5 to address several critical customer scenarios, including:**\n\nMessaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.\n\nDirect, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way--for example, by instant messaging, a phone call, or a video conference.\n\nSecure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer's preferred avenue for effective teamwork and content exchange.\n\nThe table below highlights the advantages of the key elements of HMC 4.5.\n","source":"_posts/hmc-45-is-out.md","raw":"---\ntitle: HMC4.5 is out!\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-06-15 13:38:45\n---\n\nFinally released!! Waiting so long...\nHere is the link for the docs and sample code etc\n\n[Solution for Hosted Messaging and Collaboration v4.5](https://technet.microsoft.com/en-us/library/cc526352.aspx)\n\nHere is the ~~[link](http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en)~~ for the updated SDK doc.\n\n**Use HMC 4.5 to address several critical customer scenarios, including:**\n\nMessaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.\n\nDirect, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way--for example, by instant messaging, a phone call, or a video conference.\n\nSecure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer's preferred avenue for effective teamwork and content exchange.\n\nThe table below highlights the advantages of the key elements of HMC 4.5.\n","slug":"hmc-45-is-out","published":1,"updated":"2020-01-05T09:00:53.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktr001yk84s13hrgado","content":"<html><head></head><body><p>Finally released!! Waiting so long…<br>Here is the link for the docs and sample code etc</p>\n<p><a href=\"https://technet.microsoft.com/en-us/library/cc526352.aspx\">Solution for Hosted Messaging and Collaboration v4.5</a></p>\n<p>Here is the <del><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en\">link</a></del> for the updated SDK doc.</p>\n<p><strong>Use HMC 4.5 to address several critical customer scenarios, including:</strong></p>\n<p>Messaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.</p>\n<p>Direct, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way–for example, by instant messaging, a phone call, or a video conference.</p>\n<p>Secure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer’s preferred avenue for effective teamwork and content exchange.</p>\n<p>The table below highlights the advantages of the key elements of HMC 4.5.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Finally released!! Waiting so long…<br>Here is the link for the docs and sample code etc</p>\n<p><a href=\"https://technet.microsoft.com/en-us/library/cc526352.aspx\">Solution for Hosted Messaging and Collaboration v4.5</a></p>\n<p>Here is the <del><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en\">link</a></del> for the updated SDK doc.</p>\n<p><strong>Use HMC 4.5 to address several critical customer scenarios, including:</strong></p>\n<p>Messaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.</p>\n<p>Direct, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way–for example, by instant messaging, a phone call, or a video conference.</p>\n<p>Secure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer’s preferred avenue for effective teamwork and content exchange.</p>\n<p>The table below highlights the advantages of the key elements of HMC 4.5.</p>\n</body></html>"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 5 - Autodiscover in the Multi-tenancy environment","date":"2009-05-07T10:52:04.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nSo, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn't work completely out of the box in a hosted Exchange environment and what HMC has introduced to make it work better.\n\nSo, what's next?\n\n**Shared Infrastructure in HMC?**\n\nNow that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.\n\nFor Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some 'legacy' parameter that cause the configuration of Outlook more complicated than desired.\n\nFor example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That's not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.\n\nIf that doesn't sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to know more URLs or configurations to access those services.\n\nNow, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?\n\nWhile the above sounded complicated, we do have some good news for you.\n\n*   Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the shared infrastructure) and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).\n*   Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.\nThe not good news is this, Autodiscover doesn't just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.\n\n<span style=\"text-decoration: underline;\">(1) Outlook 2003</span>\n\nOutlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven't changed much. It looks almost the same since the birth of Outlook.\n\nThe Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn't need to access any other URLs (such as Availability Services, Web Distribution OABs and etc.).\n\nThe Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.\n\nSolutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with all the information they need to configure their Outlook.\n\n<span style=\"text-decoration: underline;\">(2) Outlook 2007</span>\n\nOutlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.\n\nAutodiscover has changed things quite a fair bit and for those are interested to know more, you can read this [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx) as I don't intend to spend much time talking about the working which has been well covered by this white paper.\n\nIn a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren't part of the HMC Windows domain and also they are accessing the service from the Internet.\n\nFor Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user johnc@alpineskihouse.com, Outlook 2007 will automatically try to connect to the following URLs in turn:\n\n*   [https://alpineskihouse.com/autodiscover/autodiscover.xml](https://alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service [http://support.microsoft.com/kb/940881](http://support.microsoft.com/kb/940881)\nThe logic to form the URLs above is built into Outlook 2007, we can't really change that and it has to go according to that sequence. Now, obviously that can present a problem in a HMC environment. Why?\n\nThe first 2 URLs are SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.\n\nThis is where the 3rd URL, which is only a HTTP redirection, comes in. It redirects the Outlook to another HTTPS Autodiscover URL. That's the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.\n\nThere are some customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be properly validated. A redirection is a must.\n\nIn order for Outlook to go to[http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml) and get redirected, you must do 2 things,\n\n*   **DNS** - Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.\n*   **Autodiscover.xml** - your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.\nOf course, you can also do the SRV record. The only concerns for this is that the Outlook 2007 has to be properly updated before it can enjoy this new features and also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.\n\nOne thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.\n\n<span style=\"text-decoration: underline;\">(3) Other Clients</span>\n\nWhat about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.\n\n**Troubleshooting tips for Autodiscover in Multi-tenancy environment**\n\nI find that most of the Autodiscover problems in HMC can be categorized into the following,\n\n*   Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.\n*   Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services. Currently, the best reference is this, [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx)\n*   DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.\n*   Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.","source":"_posts/hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 5 - Autodiscover in the Multi-tenancy environment\ntags:\n  - Autodiscover\n  - Exchange\n  - HMC\n  - MultiTenancy\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 18:52:04\n---\n\n转自 http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nSo, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn't work completely out of the box in a hosted Exchange environment and what HMC has introduced to make it work better.\n\nSo, what's next?\n\n**Shared Infrastructure in HMC?**\n\nNow that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.\n\nFor Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some 'legacy' parameter that cause the configuration of Outlook more complicated than desired.\n\nFor example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That's not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.\n\nIf that doesn't sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to know more URLs or configurations to access those services.\n\nNow, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?\n\nWhile the above sounded complicated, we do have some good news for you.\n\n*   Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the shared infrastructure) and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).\n*   Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.\nThe not good news is this, Autodiscover doesn't just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.\n\n<span style=\"text-decoration: underline;\">(1) Outlook 2003</span>\n\nOutlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven't changed much. It looks almost the same since the birth of Outlook.\n\nThe Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn't need to access any other URLs (such as Availability Services, Web Distribution OABs and etc.).\n\nThe Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.\n\nSolutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with all the information they need to configure their Outlook.\n\n<span style=\"text-decoration: underline;\">(2) Outlook 2007</span>\n\nOutlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.\n\nAutodiscover has changed things quite a fair bit and for those are interested to know more, you can read this [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx) as I don't intend to spend much time talking about the working which has been well covered by this white paper.\n\nIn a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren't part of the HMC Windows domain and also they are accessing the service from the Internet.\n\nFor Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user johnc@alpineskihouse.com, Outlook 2007 will automatically try to connect to the following URLs in turn:\n\n*   [https://alpineskihouse.com/autodiscover/autodiscover.xml](https://alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service [http://support.microsoft.com/kb/940881](http://support.microsoft.com/kb/940881)\nThe logic to form the URLs above is built into Outlook 2007, we can't really change that and it has to go according to that sequence. Now, obviously that can present a problem in a HMC environment. Why?\n\nThe first 2 URLs are SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.\n\nThis is where the 3rd URL, which is only a HTTP redirection, comes in. It redirects the Outlook to another HTTPS Autodiscover URL. That's the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.\n\nThere are some customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be properly validated. A redirection is a must.\n\nIn order for Outlook to go to[http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml) and get redirected, you must do 2 things,\n\n*   **DNS** - Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.\n*   **Autodiscover.xml** - your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.\nOf course, you can also do the SRV record. The only concerns for this is that the Outlook 2007 has to be properly updated before it can enjoy this new features and also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.\n\nOne thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.\n\n<span style=\"text-decoration: underline;\">(3) Other Clients</span>\n\nWhat about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.\n\n**Troubleshooting tips for Autodiscover in Multi-tenancy environment**\n\nI find that most of the Autodiscover problems in HMC can be categorized into the following,\n\n*   Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.\n*   Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services. Currently, the best reference is this, [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx)\n*   DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.\n*   Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.","slug":"hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment","published":1,"updated":"2020-01-05T09:00:53.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktr0020k84s82h5dcoy","content":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx\">http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>So, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn’t work completely out of the box in a&nbsp;hosted&nbsp;Exchange environment&nbsp;and what HMC has introduced to make it work better.</p>\n<p>So, what’s next?</p>\n<p><strong>Shared Infrastructure in HMC?</strong></p>\n<p>Now that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.</p>\n<p>For Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some ‘legacy’ parameter that cause the configuration of Outlook more complicated than desired.</p>\n<p>For example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That’s not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.</p>\n<p>If that doesn’t sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to&nbsp;know more&nbsp;URLs or configurations to access those services.</p>\n<p>Now, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?</p>\n<p>While the above sounded complicated, we do have some good news for you.</p>\n<ul>\n<li>Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the&nbsp;shared infrastructure)&nbsp;and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).</li>\n<li>Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.<br>The not good news is this, Autodiscover doesn’t just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(1) Outlook 2003</span></p>\n<p>Outlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven’t changed much. It looks almost the same since the birth of Outlook.</p>\n<p>The Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn’t need to access any other URLs (such as Availability Services, Web Distribution OABs&nbsp;and etc.).</p>\n<p>The Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.</p>\n<p>Solutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with&nbsp;all the information they need&nbsp;to configure their Outlook.</p>\n<p><span style=\"text-decoration: underline;\">(2) Outlook 2007</span></p>\n<p>Outlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.</p>\n<p>Autodiscover has changed things quite a fair bit and for those are interested to know more,&nbsp;you can read this&nbsp;<a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\">White Paper: Exchange 2007 Autodiscover Service</a>&nbsp;as I don’t intend to spend much time talking about the working which has been well covered by this white paper.</p>\n<p>In a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren’t part of the HMC Windows domain and also they are accessing the service from the Internet.</p>\n<p>For Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user <a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>, Outlook 2007 will automatically try to connect to the following URLs in turn:</p>\n<ul>\n<li><a href=\"https://alpineskihouse.com/autodiscover/autodiscover.xml\">https://alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\">https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li>And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service&nbsp;<a href=\"http://support.microsoft.com/kb/940881\">http://support.microsoft.com/kb/940881</a><br>The logic to form the URLs above is built into&nbsp;Outlook 2007, we can’t really change that and it has to go according to that sequence. Now, obviously that can&nbsp;present a&nbsp;problem in a HMC environment.&nbsp;Why?</li>\n</ul>\n<p>The first 2 URLs are&nbsp;SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.</p>\n<p>This is where the 3rd URL, which is only a HTTP redirection, comes in.&nbsp;It redirects&nbsp;the Outlook&nbsp;to another HTTPS Autodiscover URL. That’s the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.</p>\n<p>There are&nbsp;some&nbsp;customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be&nbsp;properly validated. A redirection is a must.</p>\n<p>In order for Outlook to go to<a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a>&nbsp;and get redirected, you must do 2 things,</p>\n<ul>\n<li><strong>DNS</strong>&nbsp;- Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.</li>\n<li><strong>Autodiscover.xml</strong>&nbsp;- your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.<br>Of course, you&nbsp;can also do the SRV record. The only concerns&nbsp;for this&nbsp;is that&nbsp;the Outlook 2007 has to be properly updated before it can enjoy this new features and&nbsp;also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that&nbsp;in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.</li>\n</ul>\n<p>One thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.</p>\n<p><span style=\"text-decoration: underline;\">(3) Other Clients</span></p>\n<p>What about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.</p>\n<p><strong>Troubleshooting tips for Autodiscover in Multi-tenancy environment</strong></p>\n<p>I find that most of the Autodiscover problems in HMC can be categorized into the following,</p>\n<ul>\n<li>Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.</li>\n<li>Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services.&nbsp;Currently, the best reference is this,&nbsp;<a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\">White Paper: Exchange 2007 Autodiscover Service</a></li>\n<li>DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.</li>\n<li>Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx\">http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>So, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn’t work completely out of the box in a&nbsp;hosted&nbsp;Exchange environment&nbsp;and what HMC has introduced to make it work better.</p>\n<p>So, what’s next?</p>\n<p><strong>Shared Infrastructure in HMC?</strong></p>\n<p>Now that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.</p>\n<p>For Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some ‘legacy’ parameter that cause the configuration of Outlook more complicated than desired.</p>\n<p>For example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That’s not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.</p>\n<p>If that doesn’t sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to&nbsp;know more&nbsp;URLs or configurations to access those services.</p>\n<p>Now, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?</p>\n<p>While the above sounded complicated, we do have some good news for you.</p>\n<ul>\n<li>Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the&nbsp;shared infrastructure)&nbsp;and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).</li>\n<li>Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.<br>The not good news is this, Autodiscover doesn’t just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(1) Outlook 2003</span></p>\n<p>Outlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven’t changed much. It looks almost the same since the birth of Outlook.</p>\n<p>The Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn’t need to access any other URLs (such as Availability Services, Web Distribution OABs&nbsp;and etc.).</p>\n<p>The Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.</p>\n<p>Solutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with&nbsp;all the information they need&nbsp;to configure their Outlook.</p>\n<p><span style=\"text-decoration: underline;\">(2) Outlook 2007</span></p>\n<p>Outlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.</p>\n<p>Autodiscover has changed things quite a fair bit and for those are interested to know more,&nbsp;you can read this&nbsp;<a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\">White Paper: Exchange 2007 Autodiscover Service</a>&nbsp;as I don’t intend to spend much time talking about the working which has been well covered by this white paper.</p>\n<p>In a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren’t part of the HMC Windows domain and also they are accessing the service from the Internet.</p>\n<p>For Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user <a href=\"mailto:johnc@alpineskihouse.com\">johnc@alpineskihouse.com</a>, Outlook 2007 will automatically try to connect to the following URLs in turn:</p>\n<ul>\n<li><a href=\"https://alpineskihouse.com/autodiscover/autodiscover.xml\">https://alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\">https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li>And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service&nbsp;<a href=\"http://support.microsoft.com/kb/940881\">http://support.microsoft.com/kb/940881</a><br>The logic to form the URLs above is built into&nbsp;Outlook 2007, we can’t really change that and it has to go according to that sequence. Now, obviously that can&nbsp;present a&nbsp;problem in a HMC environment.&nbsp;Why?</li>\n</ul>\n<p>The first 2 URLs are&nbsp;SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.</p>\n<p>This is where the 3rd URL, which is only a HTTP redirection, comes in.&nbsp;It redirects&nbsp;the Outlook&nbsp;to another HTTPS Autodiscover URL. That’s the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.</p>\n<p>There are&nbsp;some&nbsp;customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be&nbsp;properly validated. A redirection is a must.</p>\n<p>In order for Outlook to go to<a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a>&nbsp;and get redirected, you must do 2 things,</p>\n<ul>\n<li><strong>DNS</strong>&nbsp;- Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.</li>\n<li><strong>Autodiscover.xml</strong>&nbsp;- your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.<br>Of course, you&nbsp;can also do the SRV record. The only concerns&nbsp;for this&nbsp;is that&nbsp;the Outlook 2007 has to be properly updated before it can enjoy this new features and&nbsp;also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that&nbsp;in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.</li>\n</ul>\n<p>One thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.</p>\n<p><span style=\"text-decoration: underline;\">(3) Other Clients</span></p>\n<p>What about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.</p>\n<p><strong>Troubleshooting tips for Autodiscover in Multi-tenancy environment</strong></p>\n<p>I find that most of the Autodiscover problems in HMC can be categorized into the following,</p>\n<ul>\n<li>Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.</li>\n<li>Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services.&nbsp;Currently, the best reference is this,&nbsp;<a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\">White Paper: Exchange 2007 Autodiscover Service</a></li>\n<li>DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.</li>\n<li>Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 Rollup 1","date":"2008-11-20T13:31:10.000Z","_content":"\n[http://support.microsoft.com/kb/957583](http://support.microsoft.com/kb/957583)\n\nMicrosoft has released an update that is dated October 8, 2008\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   ActiveDirectoryProvider.msi\n*   Exchange2007Provider.msi\n*   DNSProvider.msi\n*   HostedActiveDirectoryNS.msi\n*   HostedActiveDirectoryWS.msi\n*   RPCHttpConfigTool.msi\n*   pwdb40ssis.msi\n*   DNSClient.msi\n\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   CategorizerOverrideAgent-x64.msi\n*   SmtpDomainCacheTask-x64.msi\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.\n*   An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a **Get-AcceptedDomain** command.\n*   Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.\n*   When you run an \"Import Data from PlanManager to PWDB40\" SQL agent job, some error messages are logged on the Log File viewer.\n*   When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the **DescriptiveText** property that is required to create a Microsoft DNS_TXT Type..\n*   The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.\n*   A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.","source":"_posts/hmc-45-rollup-1.md","raw":"---\ntitle: HMC 4.5 Rollup 1\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-11-20 21:31:10\n---\n\n[http://support.microsoft.com/kb/957583](http://support.microsoft.com/kb/957583)\n\nMicrosoft has released an update that is dated October 8, 2008\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   ActiveDirectoryProvider.msi\n*   Exchange2007Provider.msi\n*   DNSProvider.msi\n*   HostedActiveDirectoryNS.msi\n*   HostedActiveDirectoryWS.msi\n*   RPCHttpConfigTool.msi\n*   pwdb40ssis.msi\n*   DNSClient.msi\n\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   CategorizerOverrideAgent-x64.msi\n*   SmtpDomainCacheTask-x64.msi\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.\n*   An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a **Get-AcceptedDomain** command.\n*   Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.\n*   When you run an \"Import Data from PlanManager to PWDB40\" SQL agent job, some error messages are logged on the Log File viewer.\n*   When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the **DescriptiveText** property that is required to create a Microsoft DNS_TXT Type..\n*   The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.\n*   A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.","slug":"hmc-45-rollup-1","published":1,"updated":"2020-01-05T09:00:53.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kts0024k84scty28lr8","content":"<html><head></head><body><p><a href=\"http://support.microsoft.com/kb/957583\">http://support.microsoft.com/kb/957583</a></p>\n<p>Microsoft has released an update that is dated October 8, 2008. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li>ActiveDirectoryProvider.msi</li>\n<li>Exchange2007Provider.msi</li>\n<li>DNSProvider.msi</li>\n<li>HostedActiveDirectoryNS.msi</li>\n<li>HostedActiveDirectoryWS.msi</li>\n<li>RPCHttpConfigTool.msi</li>\n<li>pwdb40ssis.msi</li>\n<li>DNSClient.msi</li>\n</ul>\n<p>Additionally, this update also includes native 64-bit versions of the following components:</p>\n<ul>\n<li>CategorizerOverrideAgent-x64.msi</li>\n<li>SmtpDomainCacheTask-x64.msi</li>\n</ul>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.</li>\n<li>An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a&nbsp;<strong>Get-AcceptedDomain</strong>&nbsp;command.</li>\n<li>Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.</li>\n<li>When you run an “Import Data from PlanManager to PWDB40” SQL agent job, some error messages are logged on the Log File viewer.</li>\n<li>When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the&nbsp;<strong>DescriptiveText</strong>&nbsp;property that is required to create a Microsoft DNS_TXT Type..</li>\n<li>The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.</li>\n<li>A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p><a href=\"http://support.microsoft.com/kb/957583\">http://support.microsoft.com/kb/957583</a></p>\n<p>Microsoft has released an update that is dated October 8, 2008. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li>ActiveDirectoryProvider.msi</li>\n<li>Exchange2007Provider.msi</li>\n<li>DNSProvider.msi</li>\n<li>HostedActiveDirectoryNS.msi</li>\n<li>HostedActiveDirectoryWS.msi</li>\n<li>RPCHttpConfigTool.msi</li>\n<li>pwdb40ssis.msi</li>\n<li>DNSClient.msi</li>\n</ul>\n<p>Additionally, this update also includes native 64-bit versions of the following components:</p>\n<ul>\n<li>CategorizerOverrideAgent-x64.msi</li>\n<li>SmtpDomainCacheTask-x64.msi</li>\n</ul>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.</li>\n<li>An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a&nbsp;<strong>Get-AcceptedDomain</strong>&nbsp;command.</li>\n<li>Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.</li>\n<li>When you run an “Import Data from PlanManager to PWDB40” SQL agent job, some error messages are logged on the Log File viewer.</li>\n<li>When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the&nbsp;<strong>DescriptiveText</strong>&nbsp;property that is required to create a Microsoft DNS_TXT Type..</li>\n<li>The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.</li>\n<li>A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 Update Rollup 3 has been released","date":"2009-05-27T04:49:43.000Z","_content":"\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/?id=969820](http://support.microsoft.com/?id=969820)\n\nHere is a brief description on what is included in this Rollup 3. This isn't a big update. It consists of,\n\n*   All the updates in HMC 4.5 Rollup 2 and,\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.\n*   Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5","source":"_posts/hmc-45-update-rollup-3-has-been-released.md","raw":"---\ntitle: HMC 4.5 Update Rollup 3 has been released\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-27 12:49:43\n---\n\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/?id=969820](http://support.microsoft.com/?id=969820)\n\nHere is a brief description on what is included in this Rollup 3. This isn't a big update. It consists of,\n\n*   All the updates in HMC 4.5 Rollup 2 and,\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.\n*   Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5","slug":"hmc-45-update-rollup-3-has-been-released","published":1,"updated":"2020-01-05T09:00:53.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktt0026k84sg6kg5q9w","content":"<html><head></head><body><p>Description of Update Rollup&nbsp;3 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/?id=969820\">http://support.microsoft.com/?id=969820</a></p>\n<p>Here is a brief description on what is included in this Rollup 3. This isn’t a big update. It consists of,</p>\n<ul>\n<li><p>All the updates in HMC 4.5 Rollup 2 and,<br>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n</li>\n<li><p>When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.</p>\n</li>\n<li><p>Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5</p>\n</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Description of Update Rollup&nbsp;3 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/?id=969820\">http://support.microsoft.com/?id=969820</a></p>\n<p>Here is a brief description on what is included in this Rollup 3. This isn’t a big update. It consists of,</p>\n<ul>\n<li><p>All the updates in HMC 4.5 Rollup 2 and,<br>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n</li>\n<li><p>When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.</p>\n</li>\n<li><p>Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5</p>\n</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 Update Rollup 5 has been released","date":"2010-03-02T11:06:18.000Z","_content":"\nDescription of Update Rollup 5 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/977174/en-us](http://support.microsoft.com/kb/977174/en-us)\n\nMicrosoft has released an update that is dated October 30, 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.\n\n*   ResourceManageDatabase.msi\n*   Exchange2007ResourceManagerWS.msi\n*   HostedSharePoint2007WS.msi\n*   Exchange2007ResourceManagerNS.msi\n*   HostedSharePoint2007NS.msi\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.\n*   The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.\n*   The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.\n*   The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.\n*   The CreateUser procedure in the Hosted Active Directory namespace may return the error \" there is no such object on the server\" if the Organization is renamed.\n*   Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.\n*   SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.\n*   Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.\n*   Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.\n*   Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the 'level' algorithm for 'not shared' mail stores.\n*   Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter 'shared.'","source":"_posts/hmc-45-update-rollup-5-has-been-released.md","raw":"---\ntitle: HMC 4.5 Update Rollup 5 has been released\ntags:\n  - Exchange\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2010-03-02 19:06:18\n---\n\nDescription of Update Rollup 5 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/977174/en-us](http://support.microsoft.com/kb/977174/en-us)\n\nMicrosoft has released an update that is dated October 30, 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.\n\n*   ResourceManageDatabase.msi\n*   Exchange2007ResourceManagerWS.msi\n*   HostedSharePoint2007WS.msi\n*   Exchange2007ResourceManagerNS.msi\n*   HostedSharePoint2007NS.msi\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.\n*   The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.\n*   The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.\n*   The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.\n*   The CreateUser procedure in the Hosted Active Directory namespace may return the error \" there is no such object on the server\" if the Organization is renamed.\n*   Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.\n*   SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.\n*   Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.\n*   Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.\n*   Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the 'level' algorithm for 'not shared' mail stores.\n*   Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter 'shared.'","slug":"hmc-45-update-rollup-5-has-been-released","published":1,"updated":"2020-01-05T09:00:53.956Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktu002bk84sa8wfb44c","content":"<html><head></head><body><p>Description of Update Rollup 5 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/977174/en-us\">http://support.microsoft.com/kb/977174/en-us</a></p>\n<p>Microsoft has released an update that is dated October 30, 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.</p>\n<ul>\n<li>ResourceManageDatabase.msi</li>\n<li>Exchange2007ResourceManagerWS.msi</li>\n<li>HostedSharePoint2007WS.msi</li>\n<li>Exchange2007ResourceManagerNS.msi</li>\n<li>HostedSharePoint2007NS.msi</li>\n</ul>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.</li>\n<li>The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.</li>\n<li>The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.</li>\n<li>The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.</li>\n<li>The CreateUser procedure in the Hosted Active Directory namespace may return the error “ there is no such object on the server” if the Organization is renamed.</li>\n<li>Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.</li>\n<li>SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.</li>\n<li>Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.</li>\n<li>Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.</li>\n<li>Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the ‘level’ algorithm for ‘not shared’ mail stores.</li>\n<li>Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter ‘shared.’</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Description of Update Rollup 5 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/977174/en-us\">http://support.microsoft.com/kb/977174/en-us</a></p>\n<p>Microsoft has released an update that is dated October 30, 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.</p>\n<ul>\n<li>ResourceManageDatabase.msi</li>\n<li>Exchange2007ResourceManagerWS.msi</li>\n<li>HostedSharePoint2007WS.msi</li>\n<li>Exchange2007ResourceManagerNS.msi</li>\n<li>HostedSharePoint2007NS.msi</li>\n</ul>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.</li>\n<li>The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.</li>\n<li>The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.</li>\n<li>The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.</li>\n<li>The CreateUser procedure in the Hosted Active Directory namespace may return the error “ there is no such object on the server” if the Organization is renamed.</li>\n<li>Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.</li>\n<li>SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.</li>\n<li>Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.</li>\n<li>Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.</li>\n<li>Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the ‘level’ algorithm for ‘not shared’ mail stores.</li>\n<li>Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter ‘shared.’</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 Update Rollup 6 has been released","date":"2010-03-02T11:10:50.000Z","_content":"\nDescription of Update Rollup 6 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/979704](http://support.microsoft.com/kb/979704)\n\nMicrosoft has released an update that is dated December 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   Exchange 2007 Mobility Provider\n**In order to get Exchange 2007 SP2 supported, do install this UR.**\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.\n*   When a public folder is created by using the \"-StorageQuota\" and \"-postStorageQuota\", the operation fail.This is because the two parameters was replaced by the parameters \"-IssueWarningQuota\" and \"-ProhibitPostQuota\" in the Exchange SP2.\n*   An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.\n*   If an organization allocated a \"not shared\" mailstore, it cannot reallocate on the same mailstore.\n\n#### Prerequisites\n\n*   Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.\n*   The logon user should be a member of the Domain Admins Group.\n*   The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.\n*   **Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.**\nHotfix replacement information\nThis rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.","source":"_posts/hmc-45-update-rollup-6-has-been-released.md","raw":"---\ntitle: HMC 4.5 Update Rollup 6 has been released\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2010-03-02 19:10:50\n---\n\nDescription of Update Rollup 6 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/979704](http://support.microsoft.com/kb/979704)\n\nMicrosoft has released an update that is dated December 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   Exchange 2007 Mobility Provider\n**In order to get Exchange 2007 SP2 supported, do install this UR.**\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.\n*   When a public folder is created by using the \"-StorageQuota\" and \"-postStorageQuota\", the operation fail.This is because the two parameters was replaced by the parameters \"-IssueWarningQuota\" and \"-ProhibitPostQuota\" in the Exchange SP2.\n*   An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.\n*   If an organization allocated a \"not shared\" mailstore, it cannot reallocate on the same mailstore.\n\n#### Prerequisites\n\n*   Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.\n*   The logon user should be a member of the Domain Admins Group.\n*   The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.\n*   **Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.**\nHotfix replacement information\nThis rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.","slug":"hmc-45-update-rollup-6-has-been-released","published":1,"updated":"2020-01-05T09:00:53.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktu002ek84sf4f56swa","content":"<html><head></head><body><p>Description of Update Rollup 6 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/979704\">http://support.microsoft.com/kb/979704</a></p>\n<p>Microsoft has released an update that is dated December 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li><p>Exchange 2007 Resource Manager Namespace</p>\n</li>\n<li><p>Exchange 2007 Resource Manager Web Services</p>\n</li>\n<li><p>Hosted Email 2007 Namespace</p>\n</li>\n<li><p>Hosted Email 2007 Web Services</p>\n</li>\n<li><p>Managed Email 2007 Namespace</p>\n</li>\n<li><p>Managed Email 2007 Web Services</p>\n</li>\n<li><p>Exchange 2007 Mobility Provider</p>\n</li>\n<li><p>Exchange 2007 Provider</p>\n</li>\n<li><p>Unified Messaging 2007 Provider<br>Additionally, this update also includes native 64-bit versions of the following components:</p>\n</li>\n<li><p>Exchange 2007 Mobility Provider</p>\n</li>\n</ul>\n<p><strong>In order to get Exchange 2007 SP2 supported, do install this UR.</strong></p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.</li>\n<li>When a public folder is created by using the “-StorageQuota” and “-postStorageQuota”, the operation fail.This is because the two parameters was replaced by the parameters “-IssueWarningQuota” and “-ProhibitPostQuota” in the Exchange SP2.</li>\n<li>An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.</li>\n<li>If an organization allocated a “not shared” mailstore, it cannot reallocate on the same mailstore.</li>\n</ul>\n<h4 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h4><ul>\n<li>Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.</li>\n<li>The logon user should be a member of the Domain Admins Group.</li>\n<li>The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.</li>\n<li><strong>Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.</strong><br>Hotfix replacement information<br>This rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Description of Update Rollup 6 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/979704\">http://support.microsoft.com/kb/979704</a></p>\n<p>Microsoft has released an update that is dated December 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li><p>Exchange 2007 Resource Manager Namespace</p>\n</li>\n<li><p>Exchange 2007 Resource Manager Web Services</p>\n</li>\n<li><p>Hosted Email 2007 Namespace</p>\n</li>\n<li><p>Hosted Email 2007 Web Services</p>\n</li>\n<li><p>Managed Email 2007 Namespace</p>\n</li>\n<li><p>Managed Email 2007 Web Services</p>\n</li>\n<li><p>Exchange 2007 Mobility Provider</p>\n</li>\n<li><p>Exchange 2007 Provider</p>\n</li>\n<li><p>Unified Messaging 2007 Provider<br>Additionally, this update also includes native 64-bit versions of the following components:</p>\n</li>\n<li><p>Exchange 2007 Mobility Provider</p>\n</li>\n</ul>\n<p><strong>In order to get Exchange 2007 SP2 supported, do install this UR.</strong></p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.</li>\n<li>When a public folder is created by using the “-StorageQuota” and “-postStorageQuota”, the operation fail.This is because the two parameters was replaced by the parameters “-IssueWarningQuota” and “-ProhibitPostQuota” in the Exchange SP2.</li>\n<li>An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.</li>\n<li>If an organization allocated a “not shared” mailstore, it cannot reallocate on the same mailstore.</li>\n</ul>\n<h4 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h4><ul>\n<li>Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.</li>\n<li>The logon user should be a member of the Domain Admins Group.</li>\n<li>The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.</li>\n<li><strong>Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.</strong><br>Hotfix replacement information<br>This rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.</li>\n</ul>\n</body></html>"},{"title":"HMC 4.5 UR 2 has been released.","date":"2009-02-18T14:53:47.000Z","_content":"\n**Description of Update Rollup 2 for Hosted Messaging and Collaboration 4.5**\n\n[http://support.microsoft.com/?id=957584](http://support.microsoft.com/?id=957584)\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues:\n\n[957583](http://support.microsoft.com/kb/957583/) Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5\n\n[957003 ](http://support.microsoft.com/kb/957003/) The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0\n\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   You receive the following failure exception when you attempt to create a Resource Mailbox:\n* The recipient '&lt;UPN of Recipient&gt;' does not have access permission to the specified resource mailbox.\n*   The ChangeOrganizationPlan\n*   Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\nUnable to create 'cn=FolderAdmins@Hostedorg...', object already exists\n\nThis error may occur if the hosted organization uses Public Folders.\n*   The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\n\n`E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND`\n\n*   The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the **NumberOfDigitsInExtension** parameter to the range of 3 to 7\\. The correct range is 1 to 20.\n*   A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.\n*   The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.\n*   Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.\n*   The health of a server may not be accurately updated by the Hosted Service Monitor procedures.","source":"_posts/hmc-45-ur-2-has-been-released.md","raw":"---\ntitle: HMC 4.5 UR 2 has been released.\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-02-18 22:53:47\n---\n\n**Description of Update Rollup 2 for Hosted Messaging and Collaboration 4.5**\n\n[http://support.microsoft.com/?id=957584](http://support.microsoft.com/?id=957584)\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues:\n\n[957583](http://support.microsoft.com/kb/957583/) Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5\n\n[957003 ](http://support.microsoft.com/kb/957003/) The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0\n\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   You receive the following failure exception when you attempt to create a Resource Mailbox:\n* The recipient '&lt;UPN of Recipient&gt;' does not have access permission to the specified resource mailbox.\n*   The ChangeOrganizationPlan\n*   Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\nUnable to create 'cn=FolderAdmins@Hostedorg...', object already exists\n\nThis error may occur if the hosted organization uses Public Folders.\n*   The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\n\n`E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND`\n\n*   The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the **NumberOfDigitsInExtension** parameter to the range of 3 to 7\\. The correct range is 1 to 20.\n*   A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.\n*   The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.\n*   Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.\n*   The health of a server may not be accurately updated by the Hosted Service Monitor procedures.","slug":"hmc-45-ur-2-has-been-released","published":1,"updated":"2020-01-05T09:00:53.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktv002hk84s88yr987w","content":"<html><head></head><body><p><strong>Description of Update Rollup&nbsp;2 for Hosted Messaging and Collaboration 4.5</strong></p>\n<p><a href=\"http://support.microsoft.com/?id=957584\">http://support.microsoft.com/?id=957584</a></p>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues:</p>\n<p><a href=\"http://support.microsoft.com/kb/957583/\">957583</a>&nbsp;Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/957003/\">957003&nbsp;</a>&nbsp;The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>You receive the following failure exception when you attempt to create a Resource Mailbox:</li>\n<li>The recipient ‘&lt;UPN of Recipient&gt;’ does not have access permission to the specified resource mailbox.</li>\n<li>The ChangeOrganizationPlan</li>\n<li>Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:<br>Unable to create ‘cn=FolderAdmins@Hostedorg…’, object already exists</li>\n</ul>\n<p>This error may occur if the hosted organization uses Public Folders.</p>\n<ul>\n<li>The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:</li>\n</ul>\n<p><code>E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND</code></p>\n<ul>\n<li>The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the&nbsp;<strong>NumberOfDigitsInExtension</strong>&nbsp;parameter to the range of 3 to 7. The correct range is 1 to 20.</li>\n<li>A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.</li>\n<li>The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.</li>\n<li>Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.</li>\n<li>The health of a server may not be accurately updated by the Hosted Service Monitor procedures.</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p><strong>Description of Update Rollup&nbsp;2 for Hosted Messaging and Collaboration 4.5</strong></p>\n<p><a href=\"http://support.microsoft.com/?id=957584\">http://support.microsoft.com/?id=957584</a></p>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues:</p>\n<p><a href=\"http://support.microsoft.com/kb/957583/\">957583</a>&nbsp;Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/957003/\">957003&nbsp;</a>&nbsp;The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>You receive the following failure exception when you attempt to create a Resource Mailbox:</li>\n<li>The recipient ‘&lt;UPN of Recipient&gt;’ does not have access permission to the specified resource mailbox.</li>\n<li>The ChangeOrganizationPlan</li>\n<li>Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:<br>Unable to create ‘cn=FolderAdmins@Hostedorg…’, object already exists</li>\n</ul>\n<p>This error may occur if the hosted organization uses Public Folders.</p>\n<ul>\n<li>The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:</li>\n</ul>\n<p><code>E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND</code></p>\n<ul>\n<li>The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the&nbsp;<strong>NumberOfDigitsInExtension</strong>&nbsp;parameter to the range of 3 to 7. The correct range is 1 to 20.</li>\n<li>A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.</li>\n<li>The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.</li>\n<li>Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.</li>\n<li>The health of a server may not be accurately updated by the Hosted Service Monitor procedures.</li>\n</ul>\n</body></html>"},{"title":"HMC Resource Management - Part 1 - PlanManager and ResourceManager - Overall Concept","date":"2009-10-25T04:07:28.000Z","_content":"\nThis article was original posted by Kip.Ng on http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\n\nI believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.\n\nSince then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,\n\n1. PlanManager and ResourceManager - Overall Concept\n2. HMC Resource Management and Active Directory\n3. HMC Resource Management and Exchange\n4. HMC Resource Management and Windows SharePoint Services\n5.  HMC Resource Management and Office Communication Servers\n\nThe aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.\n\nMy objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.\n\nLet's get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.\n\nWhen you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.\n\nThe first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.\n\nFor now, we will discuss about the last 2 databases, PlanManager and ResourceManager.\n\n**PlanManager Database**\n\nPlanManager used to be called HeCustomerDB in HMC 3.5\\. While, the concept hasn't changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.\n\nPlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,\n\n1.  Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.\n2. Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.\n3. Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.\n4. Plan Assignment. It also consists of what plans are those organizations assigned to.\n \nI think it should also be noted that you can further 'extend' the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.\n\n**ResourceManager Database**\n\nResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.\n\nAs I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.\n\nResourceManager, on a high level has the following,\n\n1. Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.\n2. Public Folder Stores and their sizes.\n3. OAB Servers.\n4. Public Folder allocation for each organization.\n5. Organization's OAB assignment\n6. Organizations and their allocated size.\n7. Organizations and their assigned mail stores.\n8. Individual mailbox and the mailbox size assigned to them.\n\nNow, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month ([http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)](http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)\n\nThere you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.  I believe once you understand what's in the databases, you will find that it isn't that bad at all.","source":"_posts/hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept.md","raw":"---\ntitle: HMC Resource Management - Part 1 - PlanManager and ResourceManager - Overall Concept\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-10-25 12:07:28\n---\n\nThis article was original posted by Kip.Ng on http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\n\nI believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.\n\nSince then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,\n\n1. PlanManager and ResourceManager - Overall Concept\n2. HMC Resource Management and Active Directory\n3. HMC Resource Management and Exchange\n4. HMC Resource Management and Windows SharePoint Services\n5.  HMC Resource Management and Office Communication Servers\n\nThe aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.\n\nMy objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.\n\nLet's get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.\n\nWhen you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.\n\nThe first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.\n\nFor now, we will discuss about the last 2 databases, PlanManager and ResourceManager.\n\n**PlanManager Database**\n\nPlanManager used to be called HeCustomerDB in HMC 3.5\\. While, the concept hasn't changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.\n\nPlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,\n\n1.  Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.\n2. Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.\n3. Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.\n4. Plan Assignment. It also consists of what plans are those organizations assigned to.\n \nI think it should also be noted that you can further 'extend' the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.\n\n**ResourceManager Database**\n\nResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.\n\nAs I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.\n\nResourceManager, on a high level has the following,\n\n1. Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.\n2. Public Folder Stores and their sizes.\n3. OAB Servers.\n4. Public Folder allocation for each organization.\n5. Organization's OAB assignment\n6. Organizations and their allocated size.\n7. Organizations and their assigned mail stores.\n8. Individual mailbox and the mailbox size assigned to them.\n\nNow, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month ([http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)](http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)\n\nThere you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.  I believe once you understand what's in the databases, you will find that it isn't that bad at all.","slug":"hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept","published":1,"updated":"2020-01-05T09:00:53.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktw002lk84s2yhb9pz8","content":"<html><head></head><body><p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a></p>\n<p>I believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.</p>\n<p>Since then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,</p>\n<ol>\n<li>PlanManager and ResourceManager - Overall Concept</li>\n<li>HMC Resource Management and Active Directory</li>\n<li>HMC Resource Management and Exchange</li>\n<li>HMC Resource Management and Windows SharePoint Services</li>\n<li>HMC Resource Management and Office Communication Servers</li>\n</ol>\n<p>The aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.</p>\n<p>My objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.</p>\n<p>Let’s get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.</p>\n<p>When you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.</p>\n<p>The first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.</p>\n<p>For now, we will discuss about the last 2 databases, PlanManager and ResourceManager.</p>\n<p><strong>PlanManager Database</strong></p>\n<p>PlanManager used to be called HeCustomerDB in HMC 3.5. While, the concept hasn’t changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.</p>\n<p>PlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,</p>\n<ol>\n<li>Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.</li>\n<li>Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.</li>\n<li>Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.</li>\n<li>Plan Assignment. It also consists of what plans are those organizations assigned to.</li>\n</ol>\n<p>I think it should also be noted that you can further ‘extend’ the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.</p>\n<p><strong>ResourceManager Database</strong></p>\n<p>ResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.</p>\n<p>As I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.</p>\n<p>ResourceManager, on a high level has the following,</p>\n<ol>\n<li>Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.</li>\n<li>Public Folder Stores and their sizes.</li>\n<li>OAB Servers.</li>\n<li>Public Folder allocation for each organization.</li>\n<li>Organization’s OAB assignment</li>\n<li>Organizations and their allocated size.</li>\n<li>Organizations and their assigned mail stores.</li>\n<li>Individual mailbox and the mailbox size assigned to them.</li>\n</ol>\n<p>Now, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month (<a href=\"http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx\">http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)</a></p>\n<p>There you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.&nbsp;&nbsp;I believe once you understand what’s in the databases, you will find that it isn’t that bad at all.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a></p>\n<p>I believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.</p>\n<p>Since then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,</p>\n<ol>\n<li>PlanManager and ResourceManager - Overall Concept</li>\n<li>HMC Resource Management and Active Directory</li>\n<li>HMC Resource Management and Exchange</li>\n<li>HMC Resource Management and Windows SharePoint Services</li>\n<li>HMC Resource Management and Office Communication Servers</li>\n</ol>\n<p>The aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.</p>\n<p>My objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.</p>\n<p>Let’s get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.</p>\n<p>When you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.</p>\n<p>The first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.</p>\n<p>For now, we will discuss about the last 2 databases, PlanManager and ResourceManager.</p>\n<p><strong>PlanManager Database</strong></p>\n<p>PlanManager used to be called HeCustomerDB in HMC 3.5. While, the concept hasn’t changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.</p>\n<p>PlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,</p>\n<ol>\n<li>Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.</li>\n<li>Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.</li>\n<li>Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.</li>\n<li>Plan Assignment. It also consists of what plans are those organizations assigned to.</li>\n</ol>\n<p>I think it should also be noted that you can further ‘extend’ the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.</p>\n<p><strong>ResourceManager Database</strong></p>\n<p>ResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.</p>\n<p>As I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.</p>\n<p>ResourceManager, on a high level has the following,</p>\n<ol>\n<li>Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.</li>\n<li>Public Folder Stores and their sizes.</li>\n<li>OAB Servers.</li>\n<li>Public Folder allocation for each organization.</li>\n<li>Organization’s OAB assignment</li>\n<li>Organizations and their allocated size.</li>\n<li>Organizations and their assigned mail stores.</li>\n<li>Individual mailbox and the mailbox size assigned to them.</li>\n</ol>\n<p>Now, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month (<a href=\"http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx\">http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)</a></p>\n<p>There you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.&nbsp;&nbsp;I believe once you understand what’s in the databases, you will find that it isn’t that bad at all.</p>\n</body></html>"},{"title":"HMC Resource Management - Part 2 - HMC Resource Management and Active Directory","date":"2009-10-25T04:37:24.000Z","_content":"\nThings have been busy for me and i haven't had the time to complete this series in a timely fashion. In part #1](http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx), we briefly talked about what's in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.\n\nBefore we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn't the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.\n\nThis article was original posted by Kip.Ng on [http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx](http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx)\n\nThe best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.\n\nAs you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).\n\nSo, let's take a closer look and see what is being inserted into the database. Note:\n\n**Creating Organization**\n\nProcedure: To create an organization, you called Hosted Active Directory::CreateOrganization.\n\n  1.  What is created in Active Directory? When this procedure is called,\n     * It creates the Organization OU container in the Hosting container.\n     * it will also create some of the system container and objects such as,\n       -  _Private<\n           * Allusers@&lt;org&gt;\n       - Admins@<org>\n       - CSRAdmins@<org>\n\n * AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.\n\n  2. What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to 'extend' the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.\n> Note: You should know that however Allusers@&lt;org&gt; are not 'linked' in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.\n\n  3. What is in the database then? There aren't many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won't any record of those admins account in the database.\n\nPlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,\n```sql\nSELECT * FROM [PlanManager].[dbo].[Customers] WHERE CommonName = 'TestOrg'\n```\nYou will one record being retrieved showing you the following fields,\n\nCustomerID -&gt; This will match it to the objectGUID of the OU container or the object.\n\nParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU\n\nStatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.\n\nCustomerTypeCode -&gt; This will tell you the type of Object is this. For example,\n   - BU is business user\n   - BZ is business organization\n   - CT is contact object\n   - GP is group object\n   - CU is consumer user\n   - RO is Reseller organization\n   - IR is Information Worker\n  \nCommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.\n> Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.\n\nAlso, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.\n\nThe above doesn't cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.\n\nIn short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won't touch ResourceManager database at all.\n\n**Creating a User**\n\n  1.  What is created in Active Directory? When this procedure is called,\n      - It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n      - It doesn't create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n      - It will then perform the appropriate permissions hardening.\n\n  2. What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Group**\n\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n    - It will create a group object in the Active Directory.\n    - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Contact**\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n     - It doesn't create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n     - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.\n\nSo, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS's PlanManager database.","source":"_posts/hmc-resource-management-part2-hmc-resource-management-and-active-directory.md","raw":"---\ntitle: HMC Resource Management - Part 2 - HMC Resource Management and Active Directory\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-10-25 12:37:24\n---\n\nThings have been busy for me and i haven't had the time to complete this series in a timely fashion. In part #1](http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx), we briefly talked about what's in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.\n\nBefore we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn't the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.\n\nThis article was original posted by Kip.Ng on [http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx](http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx)\n\nThe best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.\n\nAs you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).\n\nSo, let's take a closer look and see what is being inserted into the database. Note:\n\n**Creating Organization**\n\nProcedure: To create an organization, you called Hosted Active Directory::CreateOrganization.\n\n  1.  What is created in Active Directory? When this procedure is called,\n     * It creates the Organization OU container in the Hosting container.\n     * it will also create some of the system container and objects such as,\n       -  _Private<\n           * Allusers@&lt;org&gt;\n       - Admins@<org>\n       - CSRAdmins@<org>\n\n * AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.\n\n  2. What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to 'extend' the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.\n> Note: You should know that however Allusers@&lt;org&gt; are not 'linked' in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.\n\n  3. What is in the database then? There aren't many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won't any record of those admins account in the database.\n\nPlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,\n```sql\nSELECT * FROM [PlanManager].[dbo].[Customers] WHERE CommonName = 'TestOrg'\n```\nYou will one record being retrieved showing you the following fields,\n\nCustomerID -&gt; This will match it to the objectGUID of the OU container or the object.\n\nParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU\n\nStatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.\n\nCustomerTypeCode -&gt; This will tell you the type of Object is this. For example,\n   - BU is business user\n   - BZ is business organization\n   - CT is contact object\n   - GP is group object\n   - CU is consumer user\n   - RO is Reseller organization\n   - IR is Information Worker\n  \nCommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.\n> Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.\n\nAlso, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.\n\nThe above doesn't cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.\n\nIn short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won't touch ResourceManager database at all.\n\n**Creating a User**\n\n  1.  What is created in Active Directory? When this procedure is called,\n      - It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n      - It doesn't create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n      - It will then perform the appropriate permissions hardening.\n\n  2. What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Group**\n\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n    - It will create a group object in the Active Directory.\n    - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Contact**\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n     - It doesn't create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n     - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.\n\nSo, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS's PlanManager database.","slug":"hmc-resource-management-part2-hmc-resource-management-and-active-directory","published":1,"updated":"2020-01-05T09:00:53.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktw002pk84sc6wb4q3n","content":"<html><head></head><body><p>Things have been busy for me and i haven’t had the time to complete this series in a timely fashion. In&nbsp;part #1](<a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a>), we briefly talked about what’s in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.</p>\n<p>Before we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn’t the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.</p>\n<p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx\">http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx</a></p>\n<p>The best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.</p>\n<p>As you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).</p>\n<p>So, let’s take a closer look and see what is being inserted into the database. Note:</p>\n<p><strong>Creating Organization</strong></p>\n<p>Procedure: To create an organization, you called Hosted Active Directory::CreateOrganization.</p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<br> * It creates the Organization OU container in the Hosting container.<br> * it will also create some of the system container and objects such as,<ul>\n<li>_Private&lt;<ul>\n<li>Allusers@&lt;org&gt;</li>\n</ul>\n</li>\n<li>Admins@<org></org></li>\n<li>CSRAdmins@<org></org></li>\n</ul>\n</li>\n</ol>\n<ul>\n<li>AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.</li>\n</ul>\n<ol start=\"2\">\n<li><p>What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to ‘extend’ the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.</p>\n<blockquote>\n<p>Note: You should know that however Allusers@&lt;org&gt; are not ‘linked’ in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.</p>\n</blockquote>\n</li>\n<li><p>What is in the database then? There aren’t many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won’t any record of those admins account in the database.</p>\n</li>\n</ol>\n<p>PlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> [PlanManager].[dbo].[Customers] <span class=\"keyword\">WHERE</span> CommonName <span class=\"operator\">=</span> <span class=\"string\">'TestOrg'</span></span><br></pre></td></tr></tbody></table></figure>\n<p>You will one record being retrieved showing you the following fields,</p>\n<p>CustomerID -&gt; This will match it to the objectGUID of the OU container or the object.</p>\n<p>ParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU</p>\n<p>StatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.</p>\n<p>CustomerTypeCode -&gt; This will tell you the type of Object is this. For example,<br>&nbsp;&nbsp;&nbsp;- BU is business user<br>  &nbsp;- BZ is business organization</p>\n<ul>\n<li>CT is contact object<br>  &nbsp;- GP is group object</li>\n<li>CU is consumer user</li>\n<li>RO is Reseller organization<br>&nbsp;&nbsp;&nbsp;- IR is Information Worker</li>\n</ul>\n<p>&nbsp;&nbsp;<br>CommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.</p>\n<blockquote>\n<p>Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.</p>\n</blockquote>\n<p>Also, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.</p>\n<p>The above doesn’t cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.</p>\n<p>In short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won’t touch ResourceManager database at all.</p>\n<p><strong>Creating a User</strong></p>\n<ol>\n<li><p>What is created in Active Directory? When this procedure is called,</p>\n<ul>\n<li>It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It doesn’t create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li><p>What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.</p>\n</li>\n</ol>\n<p><strong>Creating a Group</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<br>- It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.<br>- It will create a group object in the Active Directory.<br>- It will then perform the appropriate permissions hardening.</li>\n<li>What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p><strong>Creating a Contact</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<br>- It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.<ul>\n<li>It doesn’t create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li>What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p>So, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS’s PlanManager database.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Things have been busy for me and i haven’t had the time to complete this series in a timely fashion. In&nbsp;part #1](<a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a>), we briefly talked about what’s in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.</p>\n<p>Before we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn’t the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.</p>\n<p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx\">http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx</a></p>\n<p>The best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.</p>\n<p>As you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).</p>\n<p>So, let’s take a closer look and see what is being inserted into the database. Note:</p>\n<p><strong>Creating Organization</strong></p>\n<p>Procedure: To create an organization, you called Hosted Active Directory::CreateOrganization.</p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<br> * It creates the Organization OU container in the Hosting container.<br> * it will also create some of the system container and objects such as,<ul>\n<li>_Private&lt;<ul>\n<li>Allusers@&lt;org&gt;</li>\n</ul>\n</li>\n<li>Admins@<org></org></li>\n<li>CSRAdmins@<org></org></li>\n</ul>\n</li>\n</ol>\n<ul>\n<li>AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.</li>\n</ul>\n<ol start=\"2\">\n<li><p>What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to ‘extend’ the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.</p>\n<blockquote>\n<p>Note: You should know that however Allusers@&lt;org&gt; are not ‘linked’ in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.</p>\n</blockquote>\n</li>\n<li><p>What is in the database then? There aren’t many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won’t any record of those admins account in the database.</p>\n</li>\n</ol>\n<p>PlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"operator\">*</span> <span class=\"keyword\">FROM</span> [PlanManager].[dbo].[Customers] <span class=\"keyword\">WHERE</span> CommonName <span class=\"operator\">=</span> <span class=\"string\">'TestOrg'</span></span><br></pre></td></tr></tbody></table></figure>\n<p>You will one record being retrieved showing you the following fields,</p>\n<p>CustomerID -&gt; This will match it to the objectGUID of the OU container or the object.</p>\n<p>ParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU</p>\n<p>StatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.</p>\n<p>CustomerTypeCode -&gt; This will tell you the type of Object is this. For example,<br>&nbsp;&nbsp;&nbsp;- BU is business user<br>  &nbsp;- BZ is business organization</p>\n<ul>\n<li>CT is contact object<br>  &nbsp;- GP is group object</li>\n<li>CU is consumer user</li>\n<li>RO is Reseller organization<br>&nbsp;&nbsp;&nbsp;- IR is Information Worker</li>\n</ul>\n<p>&nbsp;&nbsp;<br>CommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.</p>\n<blockquote>\n<p>Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.</p>\n</blockquote>\n<p>Also, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.</p>\n<p>The above doesn’t cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.</p>\n<p>In short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won’t touch ResourceManager database at all.</p>\n<p><strong>Creating a User</strong></p>\n<ol>\n<li><p>What is created in Active Directory? When this procedure is called,</p>\n<ul>\n<li>It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It doesn’t create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li><p>What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.</p>\n</li>\n</ol>\n<p><strong>Creating a Group</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<br>- It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.<br>- It will create a group object in the Active Directory.<br>- It will then perform the appropriate permissions hardening.</li>\n<li>What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p><strong>Creating a Contact</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<br>- It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.<ul>\n<li>It doesn’t create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li>What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p>So, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS’s PlanManager database.</p>\n</body></html>"},{"title":"How to add Send On Behalf permission to users with MPS","date":"2008-11-25T17:11:10.000Z","_content":"\nUsing **Hosted Active Directory::ModifyUser** to set **publicDelegates **property can do this.  \nSample:\n```xml\n<request xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><procedure xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>\n<execute namespace=\"Hosted Active Directory\" procedure=\n\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<path>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</path>\n<properties>\n<property name=\"publicDelegates\">\n<value>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</value>\n</property>\n</properties>\n<preferredDomainController>ad01.fabrikam.com</preferredDomainController>\n</executeData>\n</execute>\n</procedure>\n</request>\n```","source":"_posts/how-to-add-send-on-behalf-permission-to-users-with-mps.md","raw":"---\ntitle: How to add Send On Behalf permission to users with MPS\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-11-26 01:11:10\n---\n\nUsing **Hosted Active Directory::ModifyUser** to set **publicDelegates **property can do this.  \nSample:\n```xml\n<request xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><procedure xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>\n<execute namespace=\"Hosted Active Directory\" procedure=\n\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<path>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</path>\n<properties>\n<property name=\"publicDelegates\">\n<value>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</value>\n</property>\n</properties>\n<preferredDomainController>ad01.fabrikam.com</preferredDomainController>\n</executeData>\n</execute>\n</procedure>\n</request>\n```","slug":"how-to-add-send-on-behalf-permission-to-users-with-mps","published":1,"updated":"2020-01-05T09:00:53.957Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktx002tk84s8sga0r3a","content":"<html><head></head><body><p>Using&nbsp;<strong>Hosted Active Directory::ModifyUser</strong>&nbsp;to set&nbsp;**publicDelegates&nbsp;**property can do this. &nbsp;<br>Sample:</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">\"http://www.w3.org/1999/XSL/Transform\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">procedure</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">'http://www.w3.org/1999/XSL/Transform'</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Active Directory\"</span> <span class=\"attr\">procedure</span>=</span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">path</span>&gt;</span>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">path</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"publicDelegates\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>ad01.fabrikam.com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Using&nbsp;<strong>Hosted Active Directory::ModifyUser</strong>&nbsp;to set&nbsp;**publicDelegates&nbsp;**property can do this. &nbsp;<br>Sample:</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">\"http://www.w3.org/1999/XSL/Transform\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">procedure</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">'http://www.w3.org/1999/XSL/Transform'</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Active Directory\"</span> <span class=\"attr\">procedure</span>=</span></span><br><span class=\"line\"><span class=\"tag\"><span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">path</span>&gt;</span>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">path</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"publicDelegates\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>ad01.fabrikam.com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"如何从Maxmind的CSV数据源生成 GeoIP 的二进制数据库","date":"2015-06-25T02:40:09.000Z","_content":"\n所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。\n\n网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)\n\n#### 1. 环境准备\n\n我们需要一台 Linux, 这里我们使用 Ubuntu\n\n然后再安装基本的编译工具\n\n`apt-get install build-essential zip`\n\n#### 2. 下载最新的 GeoIP 数据库并将其解压缩\n```bash\nwget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip\nunzip GeoIPCountryCSV.zip\n```\n#### 3. 下载 gcsv2bin 的转换工具\n```bash\nwget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz\ntar xzvf gcsv2bin.tar.gz\n```\n\n#### 4. 修改源码，编译工具\n\n```bash\ncd gcsvbin\nnano gcsvbin.c #找到 COUNTRYCOUNT，将其改到 275或者更大\nmake\n```\n![Change_Countrycount](how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg)\n\n#### 5. 生成 geoipdb.bin 和geoipdb.bin\n```bash\n./gcsv2bin ../GeoIPCountryWhois.csv\n```","source":"_posts/how-to-build-geoip-database-from-maxmind-csv-format.md","raw":"---\ntitle: 如何从Maxmind的CSV数据源生成 GeoIP 的二进制数据库\ntags:\n  - GeoIP\n  - MaxMind\ncategories:\n  - '*Nix'\ndate: 2015-06-25 10:40:09\n---\n\n所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。\n\n网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)\n\n#### 1. 环境准备\n\n我们需要一台 Linux, 这里我们使用 Ubuntu\n\n然后再安装基本的编译工具\n\n`apt-get install build-essential zip`\n\n#### 2. 下载最新的 GeoIP 数据库并将其解压缩\n```bash\nwget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip\nunzip GeoIPCountryCSV.zip\n```\n#### 3. 下载 gcsv2bin 的转换工具\n```bash\nwget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz\ntar xzvf gcsv2bin.tar.gz\n```\n\n#### 4. 修改源码，编译工具\n\n```bash\ncd gcsvbin\nnano gcsvbin.c #找到 COUNTRYCOUNT，将其改到 275或者更大\nmake\n```\n![Change_Countrycount](how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg)\n\n#### 5. 生成 geoipdb.bin 和geoipdb.bin\n```bash\n./gcsv2bin ../GeoIPCountryWhois.csv\n```","slug":"how-to-build-geoip-database-from-maxmind-csv-format","published":1,"updated":"2020-01-05T09:00:53.958Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktx002wk84s2ixjdx7s","content":"<html><head></head><body><p>所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。</p>\n<p>网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)</p>\n<h4 id=\"1-环境准备\"><a href=\"#1-环境准备\" class=\"headerlink\" title=\"1. 环境准备\"></a>1. 环境准备</h4><p>我们需要一台 Linux, 这里我们使用 Ubuntu</p>\n<p>然后再安装基本的编译工具</p>\n<p><code>apt-get install build-essential zip</code></p>\n<h4 id=\"2-下载最新的-GeoIP-数据库并将其解压缩\"><a href=\"#2-下载最新的-GeoIP-数据库并将其解压缩\" class=\"headerlink\" title=\"2. 下载最新的&nbsp;GeoIP 数据库并将其解压缩\"></a>2. 下载最新的&nbsp;GeoIP 数据库并将其解压缩</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip</span><br><span class=\"line\">unzip&nbsp;GeoIPCountryCSV.zip</span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"3-下载-gcsv2bin-的转换工具\"><a href=\"#3-下载-gcsv2bin-的转换工具\" class=\"headerlink\" title=\"3. 下载 gcsv2bin 的转换工具\"></a>3. 下载 gcsv2bin 的转换工具</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz</span><br><span class=\"line\">tar xzvf&nbsp;gcsv2bin.tar.gz</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"4-修改源码，编译工具\"><a href=\"#4-修改源码，编译工具\" class=\"headerlink\" title=\"4. 修改源码，编译工具\"></a>4. 修改源码，编译工具</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> gcsvbin</span><br><span class=\"line\">nano gcsvbin.c <span class=\"comment\">#找到 COUNTRYCOUNT，将其改到 275或者更大</span></span><br><span class=\"line\">make</span><br></pre></td></tr></tbody></table></figure>\n<p><img src=\"/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg\" alt=\"Change_Countrycount\"></p>\n<h4 id=\"5-生成-geoipdb-bin-和geoipdb-bin\"><a href=\"#5-生成-geoipdb-bin-和geoipdb-bin\" class=\"headerlink\" title=\"5. 生成&nbsp;geoipdb.bin 和geoipdb.bin\"></a>5. 生成&nbsp;geoipdb.bin 和geoipdb.bin</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./gcsv2bin ../GeoIPCountryWhois.csv</span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。</p>\n<p>网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)</p>\n<h4 id=\"1-环境准备\"><a href=\"#1-环境准备\" class=\"headerlink\" title=\"1. 环境准备\"></a>1. 环境准备</h4><p>我们需要一台 Linux, 这里我们使用 Ubuntu</p>\n<p>然后再安装基本的编译工具</p>\n<p><code>apt-get install build-essential zip</code></p>\n<h4 id=\"2-下载最新的-GeoIP-数据库并将其解压缩\"><a href=\"#2-下载最新的-GeoIP-数据库并将其解压缩\" class=\"headerlink\" title=\"2. 下载最新的&nbsp;GeoIP 数据库并将其解压缩\"></a>2. 下载最新的&nbsp;GeoIP 数据库并将其解压缩</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip</span><br><span class=\"line\">unzip&nbsp;GeoIPCountryCSV.zip</span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"3-下载-gcsv2bin-的转换工具\"><a href=\"#3-下载-gcsv2bin-的转换工具\" class=\"headerlink\" title=\"3. 下载 gcsv2bin 的转换工具\"></a>3. 下载 gcsv2bin 的转换工具</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz</span><br><span class=\"line\">tar xzvf&nbsp;gcsv2bin.tar.gz</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"4-修改源码，编译工具\"><a href=\"#4-修改源码，编译工具\" class=\"headerlink\" title=\"4. 修改源码，编译工具\"></a>4. 修改源码，编译工具</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">cd</span> gcsvbin</span><br><span class=\"line\">nano gcsvbin.c <span class=\"comment\">#找到 COUNTRYCOUNT，将其改到 275或者更大</span></span><br><span class=\"line\">make</span><br></pre></td></tr></tbody></table></figure>\n<p><img src=\"/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg\" alt=\"Change_Countrycount\"></p>\n<h4 id=\"5-生成-geoipdb-bin-和geoipdb-bin\"><a href=\"#5-生成-geoipdb-bin-和geoipdb-bin\" class=\"headerlink\" title=\"5. 生成&nbsp;geoipdb.bin 和geoipdb.bin\"></a>5. 生成&nbsp;geoipdb.bin 和geoipdb.bin</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./gcsv2bin ../GeoIPCountryWhois.csv</span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"配置OCS XMPP网关以支持OC和Gmail联系人的通讯","date":"2010-06-23T08:15:45.000Z","_content":"\n是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。\n\n微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步[http://communicationsserverteam.com/archive/2009/10/01/599.aspx](http://communicationsserverteam.com/archive/2009/10/01/599.aspx) 查看。\n\n另外本文也参考了MVP- [Jeff Schertz](http://blogs.pointbridge.com/Blogs/schertz_jeff) 的博文\n\n[http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91](http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91)\n\n基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。\n\n下面我也说说我自己的经验和步骤:\n\n**一、拓扑图**\n\n我们先来看看微软官方文档中的一幅图：\n\n![Fig_1](how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg)\n\n*   **Gmail**\n> Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。\n*   xmpp-server.l.google.com,  74.125.45.125\n*   xmpp-server1.l.google.com, 74.125.155.125\n*   xmpp-server2.l.google.com, 74.125.47.125\n*   xmpp-server3.l.google.com, 74.125.45.125\n*   xmpp-server4.l.google.com, 74.125.45.125\n\n*   **OCS边缘服务器**\n> 一台运行良好的 OCS 2007 R2 Edge 服务器\n\n*   **XMPP 网关**\n> 一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。\n> 支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。\n好了，说了这么久，那你也许会问，什么是 XMPP 呢？\n\n**XMPP **是 E**x**tensible **M**essaging and **P**resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是 **Jabber**。**XMPP **经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。\n\nJabber / XMPP 历史\n\nJeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。\n\nJabber Logo\n\n标准化的Jabber已经由IETF XMPP协议（RFC3920）。\nJabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。\n\n2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。\n2007年的 Jabber 软件基金会已经成为XMPP标准基金会。\n\n而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。\n\n**二、XMPP 网关服务器安装**\n\n系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。\n\n软件需求：\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td valign=\"top\" width=\"242\">.NET Framework</td>\n<td valign=\"top\" width=\"254\">3.5</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">操作系统</td>\n<td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">MMC控制台</td>\n<td valign=\"top\" width=\"254\">3.0</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td>\n<td valign=\"top\" width=\"254\"></td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td>\n<td valign=\"top\" width=\"254\">安装补丁**<span style=\"color: #ff0000;\">KB968802</span>**</td>\n</tr>\n</tbody>\n</table>\n* 微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，**<span style=\"color: #ff0000;\">2008 R2</span>**是支持的\n\n支持的服务端\n\n· Microsoft Office Communications Server 2007 R2\n\n· Microsoft Office Communications Server 2007\n\n· Jabber XCP Server version 5.4\n\n· Google Talk\n\n支持的客户端\n\n· Microsoft Office Communicator 2007 R2\n\n· Microsoft Office Communicator 2007\n\n· Microsoft Office Communicator 2005\n\n· Jabber MomentIM Client version 5.2.1\n\n· Google Talk\n\n下载地址：\n\n1. Microsoft Office Communications Server 2007 R2 XMPP Gateway\n\n[http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4)\n\n2. Hotfix\n\n[http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en)\n\n安装过程，典型的 Next to Next，不过这还只是解压：\n\n![Fig_2](how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg) ![Fig_3](how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg) ![Fig_4](how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg) ![Fig_5](how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg)\n\n这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe\n\n![Fig_6](how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg)\n\n点 Install 进行安装，完毕后我们开始配置。\n\n**需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：**\n\n**http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp**\n\n![Fig_7](how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg)\n\n\n**三、XMPP 网关配置**\n\n**A. 要使 XMPP 网关能正常和 Gtalk 通讯，得满足下面四个条件：**\n\n1. 你的环境中的 OCS 2007 R2 运行良好。\n\n2. 你的 OCS 有安装边缘 Edge 角色。\n\n3. 一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。\n\n4. 需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。\n\n接下来我们再来详细看看 Gmail 和 OCS 的通讯过程\n\n![Fig_8](how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg)\n\n\n看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:\n\n1. GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录 **__xmpp-server._tcp.contoso.com_**_。_ 这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如 **_xmpp.contoso.com_**_。_\n\n2. 得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和 **_xmpp.contoso.com_**的**5269 **端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。\n\n3. 在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP **5269** 端口映射给 **XMPP**。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。\n\n4. 当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (_sip.contoso.com_)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。\n\n5. 在与边缘访问的 Edge 服务器的联盟监听端口 **5061 **建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。\n\n6. OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是**_xmpp.jds.local_**\n\n这里有几个重点要注意下:\n\n第一，在 XMPP 网关上的证书一定要安装配置好。\n* 该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。\n* 证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。\n\n第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。\n\n* 因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如 **jds.local**。\n* XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是**真实的**** FQDN ****名称**，并且要保持**一致**。\n\n最后, 防火墙规则的设定:\n* XMPP 网关的 TCP **5061**，需要和 Edge 的 TCP **5061** 端口进行双向通信\n* XMPP 网关的 TCP **5269**，需要接受来自外部的 Google Talk 的请求\n\n**B.  DNS 记录的创建**\n* 创建 A 记录：**xmpp.contoso.com** - 12.34.56.78\n* 创建 SRV 记录：**__xmpp-server._tcp.contoso.com_** - **xmpp.contoso.com，Port 5269**\n\n参照微软的图\n\n![Fig_9](how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg)\n\n\n**C.说了很多，下面开始配置 XMPP :**\n\n· 修改 **TGWConsoleGUI.dll.config** 文件\n\n默认位置在 **C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway** 下面，这里需要改到的部分是 _SipIP_ 和 _XmppIP _两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!\n\n![Fig_10](how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg)\n\n###### SIP 配置\n\n在 XMPP Gateway 的配置界面中点击 SIP Configuration:\n\n1. **Domain** 标签卡, Domain 一栏指定你的域名，本例中我们用 **litwareinc.com**。\n2. **Host Name** 一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用**srv.litewareinc.com **。\n![Fig_11](how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg)\n3. **TLS Certificate**，选择之前通过自建 CA 申请的内部证书\n![Fig_12](how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg)\n4. **Validate Connection** 在下拉列表中选择 **litwareinc.com**，验证是否配置正确。\n\n##### XMPP 配置\n\n选择 **XMPP Configuration** 节点\n\n1. 在 **Allow List** 标签卡中, 点击 **Add **添加。\n\n2. 在弹出的 **Federated XMPP Domain names** 对话框中,  **Domain Name** 一栏填_gmail.com__，_选择 **TCP Dialback** (required)，其它留空，确定保存。\n\n![Fig_13](how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg)\n\n3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。\n\n4. 验证 Gmail。\n\n##### 启动XMPP 服务\n\n![Fig_14](how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg)\n\n**D. Edge 服务器的配置**\n\n这里非常简单，就是把 gmail.com 作为联盟域添加:\n\n1. 打开 OCS Edge 的属性配置对话框。\n\n![Fig_15](how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg)\n\n\n2. 转到 **Allow** 标签页, 点击 **Add**, 按图中所示添加。\n\nFederated partner domain name - **_gmail.com_**,\n\nFederated partner Access Edge Server - **srv_xmpp.litewareinc.com**\n\n3. 为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如\n\n**192.168.1.20 srv_xmpp.litwareinc.com**\n\n**四、添加 Gmail 用户并验证**\n\n添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟\n\n![Fig_16](how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg)\n\n成功!\n\n![Fig_17](how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg)![Fig_18](how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg)","source":"_posts/how-to-configure-ocsr2-xmpp-to-gmail.md","raw":"---\ntitle: 配置OCS XMPP网关以支持OC和Gmail联系人的通讯\ntags:\n  - XMPP\n  - Gmail\ncategories:\n  - 沟通协作\ndate: 2010-06-23 16:15:45\n---\n\n是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。\n\n微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步[http://communicationsserverteam.com/archive/2009/10/01/599.aspx](http://communicationsserverteam.com/archive/2009/10/01/599.aspx) 查看。\n\n另外本文也参考了MVP- [Jeff Schertz](http://blogs.pointbridge.com/Blogs/schertz_jeff) 的博文\n\n[http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91](http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91)\n\n基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。\n\n下面我也说说我自己的经验和步骤:\n\n**一、拓扑图**\n\n我们先来看看微软官方文档中的一幅图：\n\n![Fig_1](how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg)\n\n*   **Gmail**\n> Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。\n*   xmpp-server.l.google.com,  74.125.45.125\n*   xmpp-server1.l.google.com, 74.125.155.125\n*   xmpp-server2.l.google.com, 74.125.47.125\n*   xmpp-server3.l.google.com, 74.125.45.125\n*   xmpp-server4.l.google.com, 74.125.45.125\n\n*   **OCS边缘服务器**\n> 一台运行良好的 OCS 2007 R2 Edge 服务器\n\n*   **XMPP 网关**\n> 一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。\n> 支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。\n好了，说了这么久，那你也许会问，什么是 XMPP 呢？\n\n**XMPP **是 E**x**tensible **M**essaging and **P**resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是 **Jabber**。**XMPP **经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。\n\nJabber / XMPP 历史\n\nJeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。\n\nJabber Logo\n\n标准化的Jabber已经由IETF XMPP协议（RFC3920）。\nJabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。\n\n2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。\n2007年的 Jabber 软件基金会已经成为XMPP标准基金会。\n\n而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。\n\n**二、XMPP 网关服务器安装**\n\n系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。\n\n软件需求：\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td valign=\"top\" width=\"242\">.NET Framework</td>\n<td valign=\"top\" width=\"254\">3.5</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">操作系统</td>\n<td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">MMC控制台</td>\n<td valign=\"top\" width=\"254\">3.0</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td>\n<td valign=\"top\" width=\"254\"></td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td>\n<td valign=\"top\" width=\"254\">安装补丁**<span style=\"color: #ff0000;\">KB968802</span>**</td>\n</tr>\n</tbody>\n</table>\n* 微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，**<span style=\"color: #ff0000;\">2008 R2</span>**是支持的\n\n支持的服务端\n\n· Microsoft Office Communications Server 2007 R2\n\n· Microsoft Office Communications Server 2007\n\n· Jabber XCP Server version 5.4\n\n· Google Talk\n\n支持的客户端\n\n· Microsoft Office Communicator 2007 R2\n\n· Microsoft Office Communicator 2007\n\n· Microsoft Office Communicator 2005\n\n· Jabber MomentIM Client version 5.2.1\n\n· Google Talk\n\n下载地址：\n\n1. Microsoft Office Communications Server 2007 R2 XMPP Gateway\n\n[http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4)\n\n2. Hotfix\n\n[http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en)\n\n安装过程，典型的 Next to Next，不过这还只是解压：\n\n![Fig_2](how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg) ![Fig_3](how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg) ![Fig_4](how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg) ![Fig_5](how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg)\n\n这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe\n\n![Fig_6](how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg)\n\n点 Install 进行安装，完毕后我们开始配置。\n\n**需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：**\n\n**http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp**\n\n![Fig_7](how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg)\n\n\n**三、XMPP 网关配置**\n\n**A. 要使 XMPP 网关能正常和 Gtalk 通讯，得满足下面四个条件：**\n\n1. 你的环境中的 OCS 2007 R2 运行良好。\n\n2. 你的 OCS 有安装边缘 Edge 角色。\n\n3. 一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。\n\n4. 需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。\n\n接下来我们再来详细看看 Gmail 和 OCS 的通讯过程\n\n![Fig_8](how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg)\n\n\n看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:\n\n1. GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录 **__xmpp-server._tcp.contoso.com_**_。_ 这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如 **_xmpp.contoso.com_**_。_\n\n2. 得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和 **_xmpp.contoso.com_**的**5269 **端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。\n\n3. 在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP **5269** 端口映射给 **XMPP**。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。\n\n4. 当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (_sip.contoso.com_)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。\n\n5. 在与边缘访问的 Edge 服务器的联盟监听端口 **5061 **建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。\n\n6. OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是**_xmpp.jds.local_**\n\n这里有几个重点要注意下:\n\n第一，在 XMPP 网关上的证书一定要安装配置好。\n* 该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。\n* 证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。\n\n第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。\n\n* 因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如 **jds.local**。\n* XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是**真实的**** FQDN ****名称**，并且要保持**一致**。\n\n最后, 防火墙规则的设定:\n* XMPP 网关的 TCP **5061**，需要和 Edge 的 TCP **5061** 端口进行双向通信\n* XMPP 网关的 TCP **5269**，需要接受来自外部的 Google Talk 的请求\n\n**B.  DNS 记录的创建**\n* 创建 A 记录：**xmpp.contoso.com** - 12.34.56.78\n* 创建 SRV 记录：**__xmpp-server._tcp.contoso.com_** - **xmpp.contoso.com，Port 5269**\n\n参照微软的图\n\n![Fig_9](how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg)\n\n\n**C.说了很多，下面开始配置 XMPP :**\n\n· 修改 **TGWConsoleGUI.dll.config** 文件\n\n默认位置在 **C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway** 下面，这里需要改到的部分是 _SipIP_ 和 _XmppIP _两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!\n\n![Fig_10](how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg)\n\n###### SIP 配置\n\n在 XMPP Gateway 的配置界面中点击 SIP Configuration:\n\n1. **Domain** 标签卡, Domain 一栏指定你的域名，本例中我们用 **litwareinc.com**。\n2. **Host Name** 一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用**srv.litewareinc.com **。\n![Fig_11](how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg)\n3. **TLS Certificate**，选择之前通过自建 CA 申请的内部证书\n![Fig_12](how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg)\n4. **Validate Connection** 在下拉列表中选择 **litwareinc.com**，验证是否配置正确。\n\n##### XMPP 配置\n\n选择 **XMPP Configuration** 节点\n\n1. 在 **Allow List** 标签卡中, 点击 **Add **添加。\n\n2. 在弹出的 **Federated XMPP Domain names** 对话框中,  **Domain Name** 一栏填_gmail.com__，_选择 **TCP Dialback** (required)，其它留空，确定保存。\n\n![Fig_13](how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg)\n\n3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。\n\n4. 验证 Gmail。\n\n##### 启动XMPP 服务\n\n![Fig_14](how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg)\n\n**D. Edge 服务器的配置**\n\n这里非常简单，就是把 gmail.com 作为联盟域添加:\n\n1. 打开 OCS Edge 的属性配置对话框。\n\n![Fig_15](how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg)\n\n\n2. 转到 **Allow** 标签页, 点击 **Add**, 按图中所示添加。\n\nFederated partner domain name - **_gmail.com_**,\n\nFederated partner Access Edge Server - **srv_xmpp.litewareinc.com**\n\n3. 为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如\n\n**192.168.1.20 srv_xmpp.litwareinc.com**\n\n**四、添加 Gmail 用户并验证**\n\n添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟\n\n![Fig_16](how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg)\n\n成功!\n\n![Fig_17](how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg)![Fig_18](how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg)","slug":"how-to-configure-ocsr2-xmpp-to-gmail","published":1,"updated":"2020-01-05T09:00:53.958Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kty002zk84sdqs75hph","content":"<html><head></head><body><p>是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。</p>\n<p>微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步<a href=\"http://communicationsserverteam.com/archive/2009/10/01/599.aspx\">http://communicationsserverteam.com/archive/2009/10/01/599.aspx</a>&nbsp;查看。</p>\n<p>另外本文也参考了MVP-&nbsp;<a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff\">Jeff Schertz</a>&nbsp;的博文</p>\n<p><a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91\">http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91</a></p>\n<p>基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。</p>\n<p>下面我也说说我自己的经验和步骤:</p>\n<p><strong>一、拓扑图</strong></p>\n<p>我们先来看看微软官方文档中的一幅图：</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg\" alt=\"Fig_1\"></p>\n<ul>\n<li><p><strong>Gmail</strong></p>\n<blockquote>\n<p>Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。</p>\n</blockquote>\n</li>\n<li><p>xmpp-server.l.google.com,&nbsp; 74.125.45.125</p>\n</li>\n<li><p>xmpp-server1.l.google.com, 74.125.155.125</p>\n</li>\n<li><p>xmpp-server2.l.google.com, 74.125.47.125</p>\n</li>\n<li><p>xmpp-server3.l.google.com, 74.125.45.125</p>\n</li>\n<li><p>xmpp-server4.l.google.com, 74.125.45.125</p>\n</li>\n<li><p><strong>OCS边缘服务器</strong></p>\n<blockquote>\n<p>一台运行良好的 OCS 2007 R2 Edge 服务器</p>\n</blockquote>\n</li>\n<li><p><strong>XMPP 网关</strong></p>\n<blockquote>\n<p>一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。<br>支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。<br>好了，说了这么久，那你也许会问，什么是 XMPP 呢？</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>XMPP&nbsp;<strong>是 E</strong>x</strong>tensible&nbsp;<strong>M</strong>essaging and&nbsp;<strong>P</strong>resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是&nbsp;<strong>Jabber</strong>。**XMPP&nbsp;**经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。</p>\n<p>Jabber / XMPP 历史</p>\n<p>Jeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。</p>\n<p>Jabber Logo</p>\n<p>标准化的Jabber已经由IETF XMPP协议（RFC3920）。<br>Jabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。</p>\n<p>2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。<br>2007年的 Jabber 软件基金会已经成为XMPP标准基金会。</p>\n<p>而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。</p>\n<p><strong>二、XMPP&nbsp;网关服务器安装</strong></p>\n<p>系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。</p>\n<p>软件需求：</p>\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td valign=\"top\" width=\"242\">.NET Framework</td>\n<td valign=\"top\" width=\"254\">3.5</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">操作系统</td>\n<td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">MMC控制台</td>\n<td valign=\"top\" width=\"254\">3.0</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td>\n<td valign=\"top\" width=\"254\"></td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td>\n<td valign=\"top\" width=\"254\">安装补丁**<span style=\"color: #ff0000;\">KB968802</span>**</td>\n</tr>\n</tbody>\n</table>\n* 微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，**<span style=\"color: #ff0000;\">2008 R2</span>**是支持的\n\n<p>支持的服务端</p>\n<p>· Microsoft Office Communications Server 2007 R2</p>\n<p>· Microsoft Office Communications Server 2007</p>\n<p>· Jabber XCP Server version 5.4</p>\n<p>· Google Talk</p>\n<p>支持的客户端</p>\n<p>· Microsoft Office Communicator 2007 R2</p>\n<p>· Microsoft Office Communicator 2007</p>\n<p>· Microsoft Office Communicator 2005</p>\n<p>· Jabber MomentIM Client version 5.2.1</p>\n<p>· Google Talk</p>\n<p>下载地址：</p>\n<ol>\n<li>Microsoft Office Communications Server 2007 R2 XMPP Gateway</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4\">http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4</a></p>\n<ol start=\"2\">\n<li>Hotfix</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en\">http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en</a></p>\n<p>安装过程，典型的 Next to Next，不过这还只是解压：</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg\" alt=\"Fig_2\"> <img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg\" alt=\"Fig_3\"> <img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg\" alt=\"Fig_4\"> <img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg\" alt=\"Fig_5\"></p>\n<p>这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg\" alt=\"Fig_6\"></p>\n<p>点 Install 进行安装，完毕后我们开始配置。</p>\n<p><strong>需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：</strong></p>\n<p><strong><a href=\"http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp\">http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp</a></strong></p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg\" alt=\"Fig_7\"></p>\n<p><strong>三、XMPP&nbsp;网关配置</strong></p>\n<p><strong>A.&nbsp;要使&nbsp;XMPP&nbsp;网关能正常和 Gtalk 通讯，得满足下面四个条件：</strong></p>\n<ol>\n<li><p>你的环境中的 OCS 2007 R2 运行良好。</p>\n</li>\n<li><p>你的 OCS 有安装边缘 Edge 角色。</p>\n</li>\n<li><p>一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。</p>\n</li>\n<li><p>需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。</p>\n</li>\n</ol>\n<p>接下来我们再来详细看看 Gmail 和 OCS 的通讯过程</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg\" alt=\"Fig_8\"></p>\n<p>看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:</p>\n<ol>\n<li><p>GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录&nbsp;<strong>__xmpp-server.<em>tcp.contoso.com</em></strong><em>。</em>&nbsp;这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如&nbsp;<strong><em>xmpp.contoso.com</em></strong><em>。</em></p>\n</li>\n<li><p>得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和&nbsp;**<em>xmpp.contoso.com</em><strong>的</strong>5269&nbsp;**端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。</p>\n</li>\n<li><p>在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP&nbsp;<strong>5269</strong>&nbsp;端口映射给&nbsp;<strong>XMPP</strong>。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。</p>\n</li>\n<li><p>当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (<em>sip.contoso.com</em>)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。</p>\n</li>\n<li><p>在与边缘访问的 Edge 服务器的联盟监听端口&nbsp;**5061&nbsp;**建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。</p>\n</li>\n<li><p>OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是**<em>xmpp.jds.local</em>**</p>\n</li>\n</ol>\n<p>这里有几个重点要注意下:</p>\n<p>第一，在 XMPP 网关上的证书一定要安装配置好。</p>\n<ul>\n<li>该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。</li>\n<li>证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。</li>\n</ul>\n<p>第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。</p>\n<ul>\n<li>因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如&nbsp;<strong>jds.local</strong>。</li>\n<li>XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是<strong>真实的</strong>**&nbsp;FQDN&nbsp;*<em><strong>名称</strong>，并且要保持</em>*一致**。</li>\n</ul>\n<p>最后, 防火墙规则的设定:</p>\n<ul>\n<li>XMPP 网关的 TCP&nbsp;<strong>5061</strong>，需要和 Edge 的 TCP&nbsp;<strong>5061</strong>&nbsp;端口进行双向通信</li>\n<li>XMPP 网关的 TCP&nbsp;<strong>5269</strong>，需要接受来自外部的 Google Talk 的请求</li>\n</ul>\n<p><strong>B.&nbsp; DNS&nbsp;记录的创建</strong></p>\n<ul>\n<li>创建 A 记录：<strong>xmpp.contoso.com</strong>&nbsp;- 12.34.56.78</li>\n<li>创建 SRV 记录：**__xmpp-server.<em>tcp.contoso.com</em>**&nbsp;-&nbsp;<strong>xmpp.contoso.com，Port 5269</strong></li>\n</ul>\n<p>参照微软的图</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg\" alt=\"Fig_9\"></p>\n<p><strong>C.说了很多，下面开始配置&nbsp;XMPP :</strong></p>\n<p>· 修改&nbsp;<strong>TGWConsoleGUI.dll.config</strong>&nbsp;文件</p>\n<p>默认位置在&nbsp;<strong>C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway</strong>&nbsp;下面，这里需要改到的部分是&nbsp;<em>SipIP</em>&nbsp;和&nbsp;_XmppIP&nbsp;_两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg\" alt=\"Fig_10\"></p>\n<h6 id=\"SIP-配置\"><a href=\"#SIP-配置\" class=\"headerlink\" title=\"SIP 配置\"></a>SIP 配置</h6><p>在 XMPP Gateway 的配置界面中点击 SIP Configuration:</p>\n<ol>\n<li><strong>Domain</strong>&nbsp;标签卡, Domain 一栏指定你的域名，本例中我们用&nbsp;<strong>litwareinc.com</strong>。</li>\n<li><strong>Host Name</strong>&nbsp;一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用**srv.litewareinc.com&nbsp;**。<br><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg\" alt=\"Fig_11\"></li>\n<li><strong>TLS Certificate</strong>，选择之前通过自建 CA 申请的内部证书<br><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg\" alt=\"Fig_12\"></li>\n</ol>\n<p>4.&nbsp;<strong>Validate Connection</strong>&nbsp;在下拉列表中选择&nbsp;<strong>litwareinc.com</strong>，验证是否配置正确。</p>\n<h5 id=\"XMPP-配置\"><a href=\"#XMPP-配置\" class=\"headerlink\" title=\"XMPP 配置\"></a>XMPP 配置</h5><p>选择&nbsp;<strong>XMPP Configuration</strong>&nbsp;节点</p>\n<ol>\n<li><p>在&nbsp;<strong>Allow List</strong>&nbsp;标签卡中, 点击&nbsp;**Add&nbsp;**添加。</p>\n</li>\n<li><p>在弹出的&nbsp;<strong>Federated XMPP Domain names</strong>&nbsp;对话框中,&nbsp;&nbsp;<strong>Domain Name</strong>&nbsp;一栏填_gmail.com__，_选择&nbsp;<strong>TCP Dialback</strong>&nbsp;(required)，其它留空，确定保存。</p>\n</li>\n</ol>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg\" alt=\"Fig_13\"></p>\n<p>3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。</p>\n<ol start=\"4\">\n<li>验证 Gmail。</li>\n</ol>\n<h5 id=\"启动XMPP-服务\"><a href=\"#启动XMPP-服务\" class=\"headerlink\" title=\"启动XMPP 服务\"></a>启动XMPP 服务</h5><p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg\" alt=\"Fig_14\"></p>\n<p><strong>D. Edge&nbsp;服务器的配置</strong></p>\n<p>这里非常简单，就是把 gmail.com 作为联盟域添加:</p>\n<ol>\n<li>打开 OCS Edge 的属性配置对话框。</li>\n</ol>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg\" alt=\"Fig_15\"></p>\n<ol start=\"2\">\n<li>转到&nbsp;<strong>Allow</strong>&nbsp;标签页, 点击&nbsp;<strong>Add</strong>, 按图中所示添加。</li>\n</ol>\n<p>Federated partner domain name -&nbsp;<strong><em>gmail.com</em></strong>,</p>\n<p>Federated partner Access Edge Server -&nbsp;<strong>srv_xmpp.litewareinc.com</strong></p>\n<ol start=\"3\">\n<li>为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如</li>\n</ol>\n<p><strong>192.168.1.20 srv_xmpp.litwareinc.com</strong></p>\n<p><strong>四、添加 Gmail 用户并验证</strong></p>\n<p>添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg\" alt=\"Fig_16\"></p>\n<p>成功!</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg\" alt=\"Fig_17\"><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg\" alt=\"Fig_18\"></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。</p>\n<p>微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步<a href=\"http://communicationsserverteam.com/archive/2009/10/01/599.aspx\">http://communicationsserverteam.com/archive/2009/10/01/599.aspx</a>&nbsp;查看。</p>\n<p>另外本文也参考了MVP-&nbsp;<a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff\">Jeff Schertz</a>&nbsp;的博文</p>\n<p><a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91\">http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91</a></p>\n<p>基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。</p>\n<p>下面我也说说我自己的经验和步骤:</p>\n<p><strong>一、拓扑图</strong></p>\n<p>我们先来看看微软官方文档中的一幅图：</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg\" alt=\"Fig_1\"></p>\n<ul>\n<li><p><strong>Gmail</strong></p>\n<blockquote>\n<p>Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。</p>\n</blockquote>\n</li>\n<li><p>xmpp-server.l.google.com,&nbsp; 74.125.45.125</p>\n</li>\n<li><p>xmpp-server1.l.google.com, 74.125.155.125</p>\n</li>\n<li><p>xmpp-server2.l.google.com, 74.125.47.125</p>\n</li>\n<li><p>xmpp-server3.l.google.com, 74.125.45.125</p>\n</li>\n<li><p>xmpp-server4.l.google.com, 74.125.45.125</p>\n</li>\n<li><p><strong>OCS边缘服务器</strong></p>\n<blockquote>\n<p>一台运行良好的 OCS 2007 R2 Edge 服务器</p>\n</blockquote>\n</li>\n<li><p><strong>XMPP 网关</strong></p>\n<blockquote>\n<p>一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。<br>支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。<br>好了，说了这么久，那你也许会问，什么是 XMPP 呢？</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>XMPP&nbsp;<strong>是 E</strong>x</strong>tensible&nbsp;<strong>M</strong>essaging and&nbsp;<strong>P</strong>resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是&nbsp;<strong>Jabber</strong>。**XMPP&nbsp;**经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。</p>\n<p>Jabber / XMPP 历史</p>\n<p>Jeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。</p>\n<p>Jabber Logo</p>\n<p>标准化的Jabber已经由IETF XMPP协议（RFC3920）。<br>Jabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。</p>\n<p>2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。<br>2007年的 Jabber 软件基金会已经成为XMPP标准基金会。</p>\n<p>而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。</p>\n<p><strong>二、XMPP&nbsp;网关服务器安装</strong></p>\n<p>系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。</p>\n<p>软件需求：</p>\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td valign=\"top\" width=\"242\">.NET Framework</td>\n<td valign=\"top\" width=\"254\">3.5</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">操作系统</td>\n<td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">MMC控制台</td>\n<td valign=\"top\" width=\"254\">3.0</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td>\n<td valign=\"top\" width=\"254\"></td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td>\n<td valign=\"top\" width=\"254\">安装补丁**<span style=\"color: #ff0000;\">KB968802</span>**</td>\n</tr>\n</tbody>\n</table>\n* 微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，**<span style=\"color: #ff0000;\">2008 R2</span>**是支持的\n\n<p>支持的服务端</p>\n<p>· Microsoft Office Communications Server 2007 R2</p>\n<p>· Microsoft Office Communications Server 2007</p>\n<p>· Jabber XCP Server version 5.4</p>\n<p>· Google Talk</p>\n<p>支持的客户端</p>\n<p>· Microsoft Office Communicator 2007 R2</p>\n<p>· Microsoft Office Communicator 2007</p>\n<p>· Microsoft Office Communicator 2005</p>\n<p>· Jabber MomentIM Client version 5.2.1</p>\n<p>· Google Talk</p>\n<p>下载地址：</p>\n<ol>\n<li>Microsoft Office Communications Server 2007 R2 XMPP Gateway</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4\">http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4</a></p>\n<ol start=\"2\">\n<li>Hotfix</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en\">http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en</a></p>\n<p>安装过程，典型的 Next to Next，不过这还只是解压：</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg\" alt=\"Fig_2\"> <img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg\" alt=\"Fig_3\"> <img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg\" alt=\"Fig_4\"> <img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg\" alt=\"Fig_5\"></p>\n<p>这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg\" alt=\"Fig_6\"></p>\n<p>点 Install 进行安装，完毕后我们开始配置。</p>\n<p><strong>需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：</strong></p>\n<p><strong><a href=\"http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp\">http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp</a></strong></p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg\" alt=\"Fig_7\"></p>\n<p><strong>三、XMPP&nbsp;网关配置</strong></p>\n<p><strong>A.&nbsp;要使&nbsp;XMPP&nbsp;网关能正常和 Gtalk 通讯，得满足下面四个条件：</strong></p>\n<ol>\n<li><p>你的环境中的 OCS 2007 R2 运行良好。</p>\n</li>\n<li><p>你的 OCS 有安装边缘 Edge 角色。</p>\n</li>\n<li><p>一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。</p>\n</li>\n<li><p>需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。</p>\n</li>\n</ol>\n<p>接下来我们再来详细看看 Gmail 和 OCS 的通讯过程</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg\" alt=\"Fig_8\"></p>\n<p>看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:</p>\n<ol>\n<li><p>GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录&nbsp;<strong>__xmpp-server.<em>tcp.contoso.com</em></strong><em>。</em>&nbsp;这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如&nbsp;<strong><em>xmpp.contoso.com</em></strong><em>。</em></p>\n</li>\n<li><p>得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和&nbsp;**<em>xmpp.contoso.com</em><strong>的</strong>5269&nbsp;**端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。</p>\n</li>\n<li><p>在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP&nbsp;<strong>5269</strong>&nbsp;端口映射给&nbsp;<strong>XMPP</strong>。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。</p>\n</li>\n<li><p>当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (<em>sip.contoso.com</em>)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。</p>\n</li>\n<li><p>在与边缘访问的 Edge 服务器的联盟监听端口&nbsp;**5061&nbsp;**建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。</p>\n</li>\n<li><p>OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是**<em>xmpp.jds.local</em>**</p>\n</li>\n</ol>\n<p>这里有几个重点要注意下:</p>\n<p>第一，在 XMPP 网关上的证书一定要安装配置好。</p>\n<ul>\n<li>该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。</li>\n<li>证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。</li>\n</ul>\n<p>第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。</p>\n<ul>\n<li>因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如&nbsp;<strong>jds.local</strong>。</li>\n<li>XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是<strong>真实的</strong>**&nbsp;FQDN&nbsp;*<em><strong>名称</strong>，并且要保持</em>*一致**。</li>\n</ul>\n<p>最后, 防火墙规则的设定:</p>\n<ul>\n<li>XMPP 网关的 TCP&nbsp;<strong>5061</strong>，需要和 Edge 的 TCP&nbsp;<strong>5061</strong>&nbsp;端口进行双向通信</li>\n<li>XMPP 网关的 TCP&nbsp;<strong>5269</strong>，需要接受来自外部的 Google Talk 的请求</li>\n</ul>\n<p><strong>B.&nbsp; DNS&nbsp;记录的创建</strong></p>\n<ul>\n<li>创建 A 记录：<strong>xmpp.contoso.com</strong>&nbsp;- 12.34.56.78</li>\n<li>创建 SRV 记录：**__xmpp-server.<em>tcp.contoso.com</em>**&nbsp;-&nbsp;<strong>xmpp.contoso.com，Port 5269</strong></li>\n</ul>\n<p>参照微软的图</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg\" alt=\"Fig_9\"></p>\n<p><strong>C.说了很多，下面开始配置&nbsp;XMPP :</strong></p>\n<p>· 修改&nbsp;<strong>TGWConsoleGUI.dll.config</strong>&nbsp;文件</p>\n<p>默认位置在&nbsp;<strong>C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway</strong>&nbsp;下面，这里需要改到的部分是&nbsp;<em>SipIP</em>&nbsp;和&nbsp;_XmppIP&nbsp;_两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg\" alt=\"Fig_10\"></p>\n<h6 id=\"SIP-配置\"><a href=\"#SIP-配置\" class=\"headerlink\" title=\"SIP 配置\"></a>SIP 配置</h6><p>在 XMPP Gateway 的配置界面中点击 SIP Configuration:</p>\n<ol>\n<li><strong>Domain</strong>&nbsp;标签卡, Domain 一栏指定你的域名，本例中我们用&nbsp;<strong>litwareinc.com</strong>。</li>\n<li><strong>Host Name</strong>&nbsp;一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用**srv.litewareinc.com&nbsp;**。<br><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg\" alt=\"Fig_11\"></li>\n<li><strong>TLS Certificate</strong>，选择之前通过自建 CA 申请的内部证书<br><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg\" alt=\"Fig_12\"></li>\n</ol>\n<p>4.&nbsp;<strong>Validate Connection</strong>&nbsp;在下拉列表中选择&nbsp;<strong>litwareinc.com</strong>，验证是否配置正确。</p>\n<h5 id=\"XMPP-配置\"><a href=\"#XMPP-配置\" class=\"headerlink\" title=\"XMPP 配置\"></a>XMPP 配置</h5><p>选择&nbsp;<strong>XMPP Configuration</strong>&nbsp;节点</p>\n<ol>\n<li><p>在&nbsp;<strong>Allow List</strong>&nbsp;标签卡中, 点击&nbsp;**Add&nbsp;**添加。</p>\n</li>\n<li><p>在弹出的&nbsp;<strong>Federated XMPP Domain names</strong>&nbsp;对话框中,&nbsp;&nbsp;<strong>Domain Name</strong>&nbsp;一栏填_gmail.com__，_选择&nbsp;<strong>TCP Dialback</strong>&nbsp;(required)，其它留空，确定保存。</p>\n</li>\n</ol>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg\" alt=\"Fig_13\"></p>\n<p>3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。</p>\n<ol start=\"4\">\n<li>验证 Gmail。</li>\n</ol>\n<h5 id=\"启动XMPP-服务\"><a href=\"#启动XMPP-服务\" class=\"headerlink\" title=\"启动XMPP 服务\"></a>启动XMPP 服务</h5><p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg\" alt=\"Fig_14\"></p>\n<p><strong>D. Edge&nbsp;服务器的配置</strong></p>\n<p>这里非常简单，就是把 gmail.com 作为联盟域添加:</p>\n<ol>\n<li>打开 OCS Edge 的属性配置对话框。</li>\n</ol>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg\" alt=\"Fig_15\"></p>\n<ol start=\"2\">\n<li>转到&nbsp;<strong>Allow</strong>&nbsp;标签页, 点击&nbsp;<strong>Add</strong>, 按图中所示添加。</li>\n</ol>\n<p>Federated partner domain name -&nbsp;<strong><em>gmail.com</em></strong>,</p>\n<p>Federated partner Access Edge Server -&nbsp;<strong>srv_xmpp.litewareinc.com</strong></p>\n<ol start=\"3\">\n<li>为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如</li>\n</ol>\n<p><strong>192.168.1.20 srv_xmpp.litwareinc.com</strong></p>\n<p><strong>四、添加 Gmail 用户并验证</strong></p>\n<p>添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg\" alt=\"Fig_16\"></p>\n<p>成功!</p>\n<p><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg\" alt=\"Fig_17\"><img src=\"/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg\" alt=\"Fig_18\"></p>\n</body></html>"},{"title":"CentOS 下解包 RPM","date":"2013-04-30T03:45:46.000Z","_content":"\n一句话记录\n```bash\nrpm2cpio rpm包名.rpm|cpio -id\n```","source":"_posts/how-to-extract-rpm-package-on-centos.md","raw":"---\ntitle: CentOS 下解包 RPM\ntags:\n  - CentOS\ncategories:\n  - '*Nix'\ndate: 2013-04-30 11:45:46\n---\n\n一句话记录\n```bash\nrpm2cpio rpm包名.rpm|cpio -id\n```","slug":"how-to-extract-rpm-package-on-centos","published":1,"updated":"2020-01-05T09:00:53.967Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktz0032k84shna61yuc","content":"<html><head></head><body><p>一句话记录</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm2cpio rpm包名.rpm|cpio -<span class=\"built_in\">id</span></span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>一句话记录</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rpm2cpio rpm包名.rpm|cpio -<span class=\"built_in\">id</span></span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"Ubuntu 的 Vi 编辑器方向键变 ABCD 以及退格键无法使用的解决办法","date":"2017-11-14T07:14:23.000Z","keywords":"Ubuntu, Linux，ABCD，Vi","description":"Ubuntu 中的 Vi 编辑器在编辑模式下，使用上下左右方向键会变成 A B C D 字符并换行，而且退格键也无法删除前面的字符，非常不方便。","_content":"\n### 问题描述\nUbuntu 中的 Vi 编辑器在编辑模式下，使用上下左右方向键会变成 A B C D 字符并换行，而且退格键也无法删除前面的字符，非常不方便。\n这个问题时不时都有人会提，困扰人类十几年了（笑），我好多年前也碰到过，这里再重新记录下。\n解决方案有很多种，这里介绍两种常用的：\n\n#### 1. 安装 vim\n\n`$ sudo apt-get install vim`\n\n#### 2. 编辑 Vi 配置文件 /etc/vim/vimrc.tiny\n\n由于这个文件的所有者是 root 用户，所以要在 root 的权限下对这个文件进行修改：\n\n`$ sudo vi /etc/vim/vimrc.tiny`\n\n![vimrc.tiny](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg)\n\n找到 set compatible，将 \"compatible\" 改成 \"nocompatible\" 非兼容模式就可以解决方向键变 ABCD 以及退格键的问题了。\n这个修改适用于所有用户，如果只想对当前用户生效，需要在用户 Home 目录下面新建 .vimrc 文件，然后加入 set nocompatible 一行再保存修改即可。\n\n在某些系统下面，可能会出现退格键还是无法使用的现象，那这个时候得在 set nocompatible 后面再加一行：\n\n`set backspace=2` 或者\n`set backspace=indent,eol,start`\n\n以上两行二选一，效果一样。\n\n### 结论:\n#### 方向键：\n产生这个问题的原因是由于 Ubuntu 预安装的是 **vim-tiny** 版本，缺省设置是 vim.tiny 以兼容 Vi 模式运行，意味着更接近纯 Vi，不能使用小键盘和方向键，在编辑模式下，只能使用 h j k l 来移动光标。所以要么安装 vim 完整版，要么禁用兼容模式。在终端窗口输入 vi 回车，如果 vim 跑在兼容模式，你可以看到如下图所示\n\n![Vim Help](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg)\n\n#### 退格键：\n退格键在编辑模式无法使用其实是 Vi 的一个保护性行为，防止误删除或者一次性删除大量内容，并不是 bug，设置 backspace (bs) 可以让退格键重新“工作”起来，默认设置为空 set backspace=\"\"，意即使用 Vi 兼容的退格方式，也就是向左移动一个字符 (等同于 h)\n\n值 | 效果\n--- | ---\nindent | 允许在自动缩进上退格\neol | 允许在换行符上退格 (连接行)\nstart | 允许在插入开始的位置上退格；CTRL-W 和 CTRL-U 到达插入开始的位置时停留一次。\n\n所以在配置文件里面加上 **set backspace=2** 或者 **set backspace=indent,eol,start** 就可以啦。\n\n### 引申:\n那么为什么 Vi 默认不使用方向键来移动光标？\n1. 可以装 X；\n2. 兼容性问题；\n一般键的 ascii 码直接发就行，而方向键之类的特殊键就要转义成 ESC 序列 ([escape sequence](https://en.wikipedia.org/wiki/Escape_sequence)) 发送，比如上键会被转义成 ESC [ A 编码，某些终端类型不支持，再有就是早期的终端连接速度都很慢，如果在终端接收到 ESC 和 A 之间的时间太长，你可能会听到警告声或者导致指令无法送达，而普通的 hjkl 键就没有这个问题；\n3. 键盘没有方向键（图片来自网络）；\n![ADM-3a Keyboard](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg)\n4. 习惯问题。\n\n你如果很习惯用 Vi 了，你完全可以弃用方向键的，不过 Vi 的学习曲线还是挺陡的，所以，挑个你习惯的编辑器就好，不必要强求用 Vi。\n\n最后附上一张 Vi/Vim 的键盘快捷方式图镇楼吧。\n![Vi/Vim Cheat Sheet](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif)\n","source":"_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu.md","raw":"---\ntitle: Ubuntu 的 Vi 编辑器方向键变 ABCD 以及退格键无法使用的解决办法\ntags:\n  - Ubuntu\n  - Linux\ncategories:\n  - Ubuntu\ndate: 2017-11-14 15:14:23\nkeywords: Ubuntu, Linux，ABCD，Vi\ndescription: Ubuntu 中的 Vi 编辑器在编辑模式下，使用上下左右方向键会变成 A B C D 字符并换行，而且退格键也无法删除前面的字符，非常不方便。\n---\n\n### 问题描述\nUbuntu 中的 Vi 编辑器在编辑模式下，使用上下左右方向键会变成 A B C D 字符并换行，而且退格键也无法删除前面的字符，非常不方便。\n这个问题时不时都有人会提，困扰人类十几年了（笑），我好多年前也碰到过，这里再重新记录下。\n解决方案有很多种，这里介绍两种常用的：\n\n#### 1. 安装 vim\n\n`$ sudo apt-get install vim`\n\n#### 2. 编辑 Vi 配置文件 /etc/vim/vimrc.tiny\n\n由于这个文件的所有者是 root 用户，所以要在 root 的权限下对这个文件进行修改：\n\n`$ sudo vi /etc/vim/vimrc.tiny`\n\n![vimrc.tiny](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg)\n\n找到 set compatible，将 \"compatible\" 改成 \"nocompatible\" 非兼容模式就可以解决方向键变 ABCD 以及退格键的问题了。\n这个修改适用于所有用户，如果只想对当前用户生效，需要在用户 Home 目录下面新建 .vimrc 文件，然后加入 set nocompatible 一行再保存修改即可。\n\n在某些系统下面，可能会出现退格键还是无法使用的现象，那这个时候得在 set nocompatible 后面再加一行：\n\n`set backspace=2` 或者\n`set backspace=indent,eol,start`\n\n以上两行二选一，效果一样。\n\n### 结论:\n#### 方向键：\n产生这个问题的原因是由于 Ubuntu 预安装的是 **vim-tiny** 版本，缺省设置是 vim.tiny 以兼容 Vi 模式运行，意味着更接近纯 Vi，不能使用小键盘和方向键，在编辑模式下，只能使用 h j k l 来移动光标。所以要么安装 vim 完整版，要么禁用兼容模式。在终端窗口输入 vi 回车，如果 vim 跑在兼容模式，你可以看到如下图所示\n\n![Vim Help](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg)\n\n#### 退格键：\n退格键在编辑模式无法使用其实是 Vi 的一个保护性行为，防止误删除或者一次性删除大量内容，并不是 bug，设置 backspace (bs) 可以让退格键重新“工作”起来，默认设置为空 set backspace=\"\"，意即使用 Vi 兼容的退格方式，也就是向左移动一个字符 (等同于 h)\n\n值 | 效果\n--- | ---\nindent | 允许在自动缩进上退格\neol | 允许在换行符上退格 (连接行)\nstart | 允许在插入开始的位置上退格；CTRL-W 和 CTRL-U 到达插入开始的位置时停留一次。\n\n所以在配置文件里面加上 **set backspace=2** 或者 **set backspace=indent,eol,start** 就可以啦。\n\n### 引申:\n那么为什么 Vi 默认不使用方向键来移动光标？\n1. 可以装 X；\n2. 兼容性问题；\n一般键的 ascii 码直接发就行，而方向键之类的特殊键就要转义成 ESC 序列 ([escape sequence](https://en.wikipedia.org/wiki/Escape_sequence)) 发送，比如上键会被转义成 ESC [ A 编码，某些终端类型不支持，再有就是早期的终端连接速度都很慢，如果在终端接收到 ESC 和 A 之间的时间太长，你可能会听到警告声或者导致指令无法送达，而普通的 hjkl 键就没有这个问题；\n3. 键盘没有方向键（图片来自网络）；\n![ADM-3a Keyboard](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg)\n4. 习惯问题。\n\n你如果很习惯用 Vi 了，你完全可以弃用方向键的，不过 Vi 的学习曲线还是挺陡的，所以，挑个你习惯的编辑器就好，不必要强求用 Vi。\n\n最后附上一张 Vi/Vim 的键盘快捷方式图镇楼吧。\n![Vi/Vim Cheat Sheet](how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif)\n","slug":"how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu","published":1,"updated":"2020-01-05T09:00:53.968Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ktz0034k84sgivv7m3t","content":"<html><head></head><body><h3 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h3><p>Ubuntu 中的 Vi 编辑器在编辑模式下，使用上下左右方向键会变成 A B C D 字符并换行，而且退格键也无法删除前面的字符，非常不方便。<br>这个问题时不时都有人会提，困扰人类十几年了（笑），我好多年前也碰到过，这里再重新记录下。<br>解决方案有很多种，这里介绍两种常用的：</p>\n<h4 id=\"1-安装-vim\"><a href=\"#1-安装-vim\" class=\"headerlink\" title=\"1. 安装 vim\"></a>1. 安装 vim</h4><p><code>$ sudo apt-get install vim</code></p>\n<h4 id=\"2-编辑-Vi-配置文件-x2F-etc-x2F-vim-x2F-vimrc-tiny\"><a href=\"#2-编辑-Vi-配置文件-x2F-etc-x2F-vim-x2F-vimrc-tiny\" class=\"headerlink\" title=\"2. 编辑 Vi 配置文件 /etc/vim/vimrc.tiny\"></a>2. 编辑 Vi 配置文件 /etc/vim/vimrc.tiny</h4><p>由于这个文件的所有者是 root 用户，所以要在 root 的权限下对这个文件进行修改：</p>\n<p><code>$ sudo vi /etc/vim/vimrc.tiny</code></p>\n<p><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg\" alt=\"vimrc.tiny\"></p>\n<p>找到 set compatible，将 “compatible” 改成 “nocompatible” 非兼容模式就可以解决方向键变 ABCD 以及退格键的问题了。<br>这个修改适用于所有用户，如果只想对当前用户生效，需要在用户 Home 目录下面新建 .vimrc 文件，然后加入 set nocompatible 一行再保存修改即可。</p>\n<p>在某些系统下面，可能会出现退格键还是无法使用的现象，那这个时候得在 set nocompatible 后面再加一行：</p>\n<p><code>set backspace=2</code> 或者<br><code>set backspace=indent,eol,start</code></p>\n<p>以上两行二选一，效果一样。</p>\n<h3 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论:\"></a>结论:</h3><h4 id=\"方向键：\"><a href=\"#方向键：\" class=\"headerlink\" title=\"方向键：\"></a>方向键：</h4><p>产生这个问题的原因是由于 Ubuntu 预安装的是 <strong>vim-tiny</strong> 版本，缺省设置是 vim.tiny 以兼容 Vi 模式运行，意味着更接近纯 Vi，不能使用小键盘和方向键，在编辑模式下，只能使用 h j k l 来移动光标。所以要么安装 vim 完整版，要么禁用兼容模式。在终端窗口输入 vi 回车，如果 vim 跑在兼容模式，你可以看到如下图所示</p>\n<p><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg\" alt=\"Vim Help\"></p>\n<h4 id=\"退格键：\"><a href=\"#退格键：\" class=\"headerlink\" title=\"退格键：\"></a>退格键：</h4><p>退格键在编辑模式无法使用其实是 Vi 的一个保护性行为，防止误删除或者一次性删除大量内容，并不是 bug，设置 backspace (bs) 可以让退格键重新“工作”起来，默认设置为空 set backspace=””，意即使用 Vi 兼容的退格方式，也就是向左移动一个字符 (等同于 h)</p>\n<table>\n<thead>\n<tr>\n<th>值</th>\n<th>效果</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>indent</td>\n<td>允许在自动缩进上退格</td>\n</tr>\n<tr>\n<td>eol</td>\n<td>允许在换行符上退格 (连接行)</td>\n</tr>\n<tr>\n<td>start</td>\n<td>允许在插入开始的位置上退格；CTRL-W 和 CTRL-U 到达插入开始的位置时停留一次。</td>\n</tr>\n</tbody></table>\n<p>所以在配置文件里面加上 <strong>set backspace=2</strong> 或者 <strong>set backspace=indent,eol,start</strong> 就可以啦。</p>\n<h3 id=\"引申\"><a href=\"#引申\" class=\"headerlink\" title=\"引申:\"></a>引申:</h3><p>那么为什么 Vi 默认不使用方向键来移动光标？</p>\n<ol>\n<li>可以装 X；</li>\n<li>兼容性问题；<br>一般键的 ascii 码直接发就行，而方向键之类的特殊键就要转义成 ESC 序列 (<a href=\"https://en.wikipedia.org/wiki/Escape_sequence\">escape sequence</a>) 发送，比如上键会被转义成 ESC [ A 编码，某些终端类型不支持，再有就是早期的终端连接速度都很慢，如果在终端接收到 ESC 和 A 之间的时间太长，你可能会听到警告声或者导致指令无法送达，而普通的 hjkl 键就没有这个问题；</li>\n<li>键盘没有方向键（图片来自网络）；<br><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg\" alt=\"ADM-3a Keyboard\"></li>\n<li>习惯问题。</li>\n</ol>\n<p>你如果很习惯用 Vi 了，你完全可以弃用方向键的，不过 Vi 的学习曲线还是挺陡的，所以，挑个你习惯的编辑器就好，不必要强求用 Vi。</p>\n<p>最后附上一张 Vi/Vim 的键盘快捷方式图镇楼吧。<br><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif\" alt=\"Vi/Vim Cheat Sheet\"></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h3 id=\"问题描述\"><a href=\"#问题描述\" class=\"headerlink\" title=\"问题描述\"></a>问题描述</h3><p>Ubuntu 中的 Vi 编辑器在编辑模式下，使用上下左右方向键会变成 A B C D 字符并换行，而且退格键也无法删除前面的字符，非常不方便。<br>这个问题时不时都有人会提，困扰人类十几年了（笑），我好多年前也碰到过，这里再重新记录下。<br>解决方案有很多种，这里介绍两种常用的：</p>\n<h4 id=\"1-安装-vim\"><a href=\"#1-安装-vim\" class=\"headerlink\" title=\"1. 安装 vim\"></a>1. 安装 vim</h4><p><code>$ sudo apt-get install vim</code></p>\n<h4 id=\"2-编辑-Vi-配置文件-x2F-etc-x2F-vim-x2F-vimrc-tiny\"><a href=\"#2-编辑-Vi-配置文件-x2F-etc-x2F-vim-x2F-vimrc-tiny\" class=\"headerlink\" title=\"2. 编辑 Vi 配置文件 /etc/vim/vimrc.tiny\"></a>2. 编辑 Vi 配置文件 /etc/vim/vimrc.tiny</h4><p>由于这个文件的所有者是 root 用户，所以要在 root 的权限下对这个文件进行修改：</p>\n<p><code>$ sudo vi /etc/vim/vimrc.tiny</code></p>\n<p><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg\" alt=\"vimrc.tiny\"></p>\n<p>找到 set compatible，将 “compatible” 改成 “nocompatible” 非兼容模式就可以解决方向键变 ABCD 以及退格键的问题了。<br>这个修改适用于所有用户，如果只想对当前用户生效，需要在用户 Home 目录下面新建 .vimrc 文件，然后加入 set nocompatible 一行再保存修改即可。</p>\n<p>在某些系统下面，可能会出现退格键还是无法使用的现象，那这个时候得在 set nocompatible 后面再加一行：</p>\n<p><code>set backspace=2</code> 或者<br><code>set backspace=indent,eol,start</code></p>\n<p>以上两行二选一，效果一样。</p>\n<h3 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论:\"></a>结论:</h3><h4 id=\"方向键：\"><a href=\"#方向键：\" class=\"headerlink\" title=\"方向键：\"></a>方向键：</h4><p>产生这个问题的原因是由于 Ubuntu 预安装的是 <strong>vim-tiny</strong> 版本，缺省设置是 vim.tiny 以兼容 Vi 模式运行，意味着更接近纯 Vi，不能使用小键盘和方向键，在编辑模式下，只能使用 h j k l 来移动光标。所以要么安装 vim 完整版，要么禁用兼容模式。在终端窗口输入 vi 回车，如果 vim 跑在兼容模式，你可以看到如下图所示</p>\n<p><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg\" alt=\"Vim Help\"></p>\n<h4 id=\"退格键：\"><a href=\"#退格键：\" class=\"headerlink\" title=\"退格键：\"></a>退格键：</h4><p>退格键在编辑模式无法使用其实是 Vi 的一个保护性行为，防止误删除或者一次性删除大量内容，并不是 bug，设置 backspace (bs) 可以让退格键重新“工作”起来，默认设置为空 set backspace=””，意即使用 Vi 兼容的退格方式，也就是向左移动一个字符 (等同于 h)</p>\n<table>\n<thead>\n<tr>\n<th>值</th>\n<th>效果</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>indent</td>\n<td>允许在自动缩进上退格</td>\n</tr>\n<tr>\n<td>eol</td>\n<td>允许在换行符上退格 (连接行)</td>\n</tr>\n<tr>\n<td>start</td>\n<td>允许在插入开始的位置上退格；CTRL-W 和 CTRL-U 到达插入开始的位置时停留一次。</td>\n</tr>\n</tbody></table>\n<p>所以在配置文件里面加上 <strong>set backspace=2</strong> 或者 <strong>set backspace=indent,eol,start</strong> 就可以啦。</p>\n<h3 id=\"引申\"><a href=\"#引申\" class=\"headerlink\" title=\"引申:\"></a>引申:</h3><p>那么为什么 Vi 默认不使用方向键来移动光标？</p>\n<ol>\n<li>可以装 X；</li>\n<li>兼容性问题；<br>一般键的 ascii 码直接发就行，而方向键之类的特殊键就要转义成 ESC 序列 (<a href=\"https://en.wikipedia.org/wiki/Escape_sequence\">escape sequence</a>) 发送，比如上键会被转义成 ESC [ A 编码，某些终端类型不支持，再有就是早期的终端连接速度都很慢，如果在终端接收到 ESC 和 A 之间的时间太长，你可能会听到警告声或者导致指令无法送达，而普通的 hjkl 键就没有这个问题；</li>\n<li>键盘没有方向键（图片来自网络）；<br><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg\" alt=\"ADM-3a Keyboard\"></li>\n<li>习惯问题。</li>\n</ol>\n<p>你如果很习惯用 Vi 了，你完全可以弃用方向键的，不过 Vi 的学习曲线还是挺陡的，所以，挑个你习惯的编辑器就好，不必要强求用 Vi。</p>\n<p>最后附上一张 Vi/Vim 的键盘快捷方式图镇楼吧。<br><img src=\"/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif\" alt=\"Vi/Vim Cheat Sheet\"></p>\n</body></html>"},{"title":"解决 Windows 下文件名或者路径太长无法复制的问题","date":"2017-11-29T03:44:23.000Z","keywords":"Windows, Unicode，robocopy，xcopy, fastcopy","description":"众所周知，微软的文件系统经历了 FAT->FAT32->NTFS 的技术变革。且不论安全和文件组织方式上的革新，单就文件名而言，已经从古老的 DOS 8.3 文件格式（仅支持最长 8 个字符的文件名和 3 个字符的扩展名）转变为可以支持长达 255 个字符的文件名。而对于路径长度，NTFS 也已经支持长达 32768 个字符的路径名。","_content":"\n### 前言\n众所周知，微软的文件系统经历了 FAT->FAT32->NTFS 的技术变革。且不论安全和文件组织方式上的革新，单就文件名而言，已经从古老的 DOS 8.3 文件格式（仅支持最长 8 个字符的文件名和 3 个字符的扩展名）转变为可以支持长达 255 个字符的文件名。而对于路径长度，NTFS 也已经支持长达 32768 个字符的路径名。\n\n然而，Windows 操作系统并没有完全放开路径名长度的限制，在 windef.h 中，可以找到如下的宏：\n\n#define MAX_PATH 260\n\n更多信息可以参考微软的知识库：\n[Naming Files, Paths, and Namespaces](https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx)\n\n事实上，所有的 Windows API (ANSI) 都遵循这个限制。因此，每当我们试图更改某一文件的文件名时，当输入的文件名长度 ( 全路径 ) 到达一定限度时，\n虽然文件名本身还未达到 255 个字符的限制，但是任何输入将不再被接受，这其实正是由于操作系统不允许 260 个字符（byte）的文件全路径。\n\n\n### 实测\n实际测试中，当你一层一层创建文件夹或者创建文件名的时候，资源管理器是有感知的，当到达 MAX_PATH 的限制的时候，其实已经无法再创建超过限制的文件或者文件名，当你在最深一层打算创建一个文件或者文件夹并因此超过限制的时候，你会收到如下警告：\n![Create Folder Warning](how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg)\n\n重命名也是有报错\n![Rename Warning](how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg)\n\n但如果你往上返回一层，重命名上层目录，这个时候你可以创建出一个总长度超过 MAX_PATH 的长文件名。不过问题也随之来了，当你想要复制包含这个长文件名的整个文件夹的时候，你会发现复制失败，提示文件或者路径太长。\n\n那么使用 xcopy 命令行不行呢？很遗憾，xcopy 是个使用标准 Win32 ANSI API 的程序，没法支持。\n![xcopy failed](how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg)\n\n### 解决\n解决方案有很多种，比如将长文件夹/文件名字改短，将长路径映射为一个逻辑磁盘用来缩短路径的长度等等，我们这里使用 robocopy 这个自带的命令和第三\n方工具 fastcopy 来解决这个问题。\n\n#### Robocopy\nRobocopy 全名是 Robust File Copy，是个 Unicode 的程序，所以可以支持超过 MAX_PATH 的限制，最长可以到 32767，Windows 7 以及之后的操作系统内的是 XP027, 而 Windows Server 2003 Resource Kit Tools 里面的是 XP010，另外，微软为命令行苦手发布了一个 [Robocopy GUI](https://technet.microsoft.com/en-us/library/2006.11.utilityspotlight.aspx) 的图形界面版 robocopy，里面集成的是 XP026，具体的区别可以查看这个[网页](https://ss64.com/nt/robocopy.html)。\n![robocopy](how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg)\n\n> 注意：微软还发布了一个 [RichCopy](\nhttps://technet.microsoft.com/en-us/library/2009.04.utilityspotlight.aspx\n)，实测这个并不能支持长路径名。\n\n#### FastCopy\n[FastCopy](https://ipmsg.org/tools/fastcopy.html)是由  SHIROUZU Hiroaki 开发的免费工具，非常好用。官方的介绍里面也提到了支持 Unicode 和突破 MAX_PATH 260 字符的限制。\n![fastcopy about](how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg)\n\n实测结果也验证了这一点。\n![fastcopy](how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg)\n\n#### Win10\n从 Windows 10 1607起，你可以解除 MAX_PATH 的限制，具体可以参考这个[文章](https://blogs.msdn.microsoft.com/jeremykuhne/2016/07/30/net-4-6-2-and-long-paths-on-windows-10/)。\n","source":"_posts/how-to-fix-file-path-too-long-on-windows-when-copying.md","raw":"---\ntitle: 解决 Windows 下文件名或者路径太长无法复制的问题\ntags:\n  - Windows\ncategories:\n  - Windows\ndate: 2017-11-29 11:44:23\nkeywords: Windows, Unicode，robocopy，xcopy, fastcopy\ndescription: 众所周知，微软的文件系统经历了 FAT->FAT32->NTFS 的技术变革。且不论安全和文件组织方式上的革新，单就文件名而言，已经从古老的 DOS 8.3 文件格式（仅支持最长 8 个字符的文件名和 3 个字符的扩展名）转变为可以支持长达 255 个字符的文件名。而对于路径长度，NTFS 也已经支持长达 32768 个字符的路径名。\n---\n\n### 前言\n众所周知，微软的文件系统经历了 FAT->FAT32->NTFS 的技术变革。且不论安全和文件组织方式上的革新，单就文件名而言，已经从古老的 DOS 8.3 文件格式（仅支持最长 8 个字符的文件名和 3 个字符的扩展名）转变为可以支持长达 255 个字符的文件名。而对于路径长度，NTFS 也已经支持长达 32768 个字符的路径名。\n\n然而，Windows 操作系统并没有完全放开路径名长度的限制，在 windef.h 中，可以找到如下的宏：\n\n#define MAX_PATH 260\n\n更多信息可以参考微软的知识库：\n[Naming Files, Paths, and Namespaces](https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx)\n\n事实上，所有的 Windows API (ANSI) 都遵循这个限制。因此，每当我们试图更改某一文件的文件名时，当输入的文件名长度 ( 全路径 ) 到达一定限度时，\n虽然文件名本身还未达到 255 个字符的限制，但是任何输入将不再被接受，这其实正是由于操作系统不允许 260 个字符（byte）的文件全路径。\n\n\n### 实测\n实际测试中，当你一层一层创建文件夹或者创建文件名的时候，资源管理器是有感知的，当到达 MAX_PATH 的限制的时候，其实已经无法再创建超过限制的文件或者文件名，当你在最深一层打算创建一个文件或者文件夹并因此超过限制的时候，你会收到如下警告：\n![Create Folder Warning](how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg)\n\n重命名也是有报错\n![Rename Warning](how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg)\n\n但如果你往上返回一层，重命名上层目录，这个时候你可以创建出一个总长度超过 MAX_PATH 的长文件名。不过问题也随之来了，当你想要复制包含这个长文件名的整个文件夹的时候，你会发现复制失败，提示文件或者路径太长。\n\n那么使用 xcopy 命令行不行呢？很遗憾，xcopy 是个使用标准 Win32 ANSI API 的程序，没法支持。\n![xcopy failed](how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg)\n\n### 解决\n解决方案有很多种，比如将长文件夹/文件名字改短，将长路径映射为一个逻辑磁盘用来缩短路径的长度等等，我们这里使用 robocopy 这个自带的命令和第三\n方工具 fastcopy 来解决这个问题。\n\n#### Robocopy\nRobocopy 全名是 Robust File Copy，是个 Unicode 的程序，所以可以支持超过 MAX_PATH 的限制，最长可以到 32767，Windows 7 以及之后的操作系统内的是 XP027, 而 Windows Server 2003 Resource Kit Tools 里面的是 XP010，另外，微软为命令行苦手发布了一个 [Robocopy GUI](https://technet.microsoft.com/en-us/library/2006.11.utilityspotlight.aspx) 的图形界面版 robocopy，里面集成的是 XP026，具体的区别可以查看这个[网页](https://ss64.com/nt/robocopy.html)。\n![robocopy](how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg)\n\n> 注意：微软还发布了一个 [RichCopy](\nhttps://technet.microsoft.com/en-us/library/2009.04.utilityspotlight.aspx\n)，实测这个并不能支持长路径名。\n\n#### FastCopy\n[FastCopy](https://ipmsg.org/tools/fastcopy.html)是由  SHIROUZU Hiroaki 开发的免费工具，非常好用。官方的介绍里面也提到了支持 Unicode 和突破 MAX_PATH 260 字符的限制。\n![fastcopy about](how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg)\n\n实测结果也验证了这一点。\n![fastcopy](how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg)\n\n#### Win10\n从 Windows 10 1607起，你可以解除 MAX_PATH 的限制，具体可以参考这个[文章](https://blogs.msdn.microsoft.com/jeremykuhne/2016/07/30/net-4-6-2-and-long-paths-on-windows-10/)。\n","slug":"how-to-fix-file-path-too-long-on-windows-when-copying","published":1,"updated":"2020-01-05T09:00:53.971Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku00038k84sauteay1z","content":"<html><head></head><body><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>众所周知，微软的文件系统经历了 FAT-&gt;FAT32-&gt;NTFS 的技术变革。且不论安全和文件组织方式上的革新，单就文件名而言，已经从古老的 DOS 8.3 文件格式（仅支持最长 8 个字符的文件名和 3 个字符的扩展名）转变为可以支持长达 255 个字符的文件名。而对于路径长度，NTFS 也已经支持长达 32768 个字符的路径名。</p>\n<p>然而，Windows 操作系统并没有完全放开路径名长度的限制，在 windef.h 中，可以找到如下的宏：</p>\n<p>#define MAX_PATH 260</p>\n<p>更多信息可以参考微软的知识库：<br><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx\">Naming Files, Paths, and Namespaces</a></p>\n<p>事实上，所有的 Windows API (ANSI) 都遵循这个限制。因此，每当我们试图更改某一文件的文件名时，当输入的文件名长度 ( 全路径 ) 到达一定限度时，<br>虽然文件名本身还未达到 255 个字符的限制，但是任何输入将不再被接受，这其实正是由于操作系统不允许 260 个字符（byte）的文件全路径。</p>\n<h3 id=\"实测\"><a href=\"#实测\" class=\"headerlink\" title=\"实测\"></a>实测</h3><p>实际测试中，当你一层一层创建文件夹或者创建文件名的时候，资源管理器是有感知的，当到达 MAX_PATH 的限制的时候，其实已经无法再创建超过限制的文件或者文件名，当你在最深一层打算创建一个文件或者文件夹并因此超过限制的时候，你会收到如下警告：<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg\" alt=\"Create Folder Warning\"></p>\n<p>重命名也是有报错<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg\" alt=\"Rename Warning\"></p>\n<p>但如果你往上返回一层，重命名上层目录，这个时候你可以创建出一个总长度超过 MAX_PATH 的长文件名。不过问题也随之来了，当你想要复制包含这个长文件名的整个文件夹的时候，你会发现复制失败，提示文件或者路径太长。</p>\n<p>那么使用 xcopy 命令行不行呢？很遗憾，xcopy 是个使用标准 Win32 ANSI API 的程序，没法支持。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg\" alt=\"xcopy failed\"></p>\n<h3 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h3><p>解决方案有很多种，比如将长文件夹/文件名字改短，将长路径映射为一个逻辑磁盘用来缩短路径的长度等等，我们这里使用 robocopy 这个自带的命令和第三<br>方工具 fastcopy 来解决这个问题。</p>\n<h4 id=\"Robocopy\"><a href=\"#Robocopy\" class=\"headerlink\" title=\"Robocopy\"></a>Robocopy</h4><p>Robocopy 全名是 Robust File Copy，是个 Unicode 的程序，所以可以支持超过 MAX_PATH 的限制，最长可以到 32767，Windows 7 以及之后的操作系统内的是 XP027, 而 Windows Server 2003 Resource Kit Tools 里面的是 XP010，另外，微软为命令行苦手发布了一个 <a href=\"https://technet.microsoft.com/en-us/library/2006.11.utilityspotlight.aspx\">Robocopy GUI</a> 的图形界面版 robocopy，里面集成的是 XP026，具体的区别可以查看这个<a href=\"https://ss64.com/nt/robocopy.html\">网页</a>。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg\" alt=\"robocopy\"></p>\n<blockquote>\n<p>注意：微软还发布了一个 <a href=\"https://technet.microsoft.com/en-us/library/2009.04.utilityspotlight.aspx\">RichCopy</a>，实测这个并不能支持长路径名。</p>\n</blockquote>\n<h4 id=\"FastCopy\"><a href=\"#FastCopy\" class=\"headerlink\" title=\"FastCopy\"></a>FastCopy</h4><p><a href=\"https://ipmsg.org/tools/fastcopy.html\">FastCopy</a>是由  SHIROUZU Hiroaki 开发的免费工具，非常好用。官方的介绍里面也提到了支持 Unicode 和突破 MAX_PATH 260 字符的限制。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg\" alt=\"fastcopy about\"></p>\n<p>实测结果也验证了这一点。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg\" alt=\"fastcopy\"></p>\n<h4 id=\"Win10\"><a href=\"#Win10\" class=\"headerlink\" title=\"Win10\"></a>Win10</h4><p>从 Windows 10 1607起，你可以解除 MAX_PATH 的限制，具体可以参考这个<a href=\"https://blogs.msdn.microsoft.com/jeremykuhne/2016/07/30/net-4-6-2-and-long-paths-on-windows-10/\">文章</a>。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>众所周知，微软的文件系统经历了 FAT-&gt;FAT32-&gt;NTFS 的技术变革。且不论安全和文件组织方式上的革新，单就文件名而言，已经从古老的 DOS 8.3 文件格式（仅支持最长 8 个字符的文件名和 3 个字符的扩展名）转变为可以支持长达 255 个字符的文件名。而对于路径长度，NTFS 也已经支持长达 32768 个字符的路径名。</p>\n<p>然而，Windows 操作系统并没有完全放开路径名长度的限制，在 windef.h 中，可以找到如下的宏：</p>\n<p>#define MAX_PATH 260</p>\n<p>更多信息可以参考微软的知识库：<br><a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365247%28v=vs.85%29.aspx\">Naming Files, Paths, and Namespaces</a></p>\n<p>事实上，所有的 Windows API (ANSI) 都遵循这个限制。因此，每当我们试图更改某一文件的文件名时，当输入的文件名长度 ( 全路径 ) 到达一定限度时，<br>虽然文件名本身还未达到 255 个字符的限制，但是任何输入将不再被接受，这其实正是由于操作系统不允许 260 个字符（byte）的文件全路径。</p>\n<h3 id=\"实测\"><a href=\"#实测\" class=\"headerlink\" title=\"实测\"></a>实测</h3><p>实际测试中，当你一层一层创建文件夹或者创建文件名的时候，资源管理器是有感知的，当到达 MAX_PATH 的限制的时候，其实已经无法再创建超过限制的文件或者文件名，当你在最深一层打算创建一个文件或者文件夹并因此超过限制的时候，你会收到如下警告：<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg\" alt=\"Create Folder Warning\"></p>\n<p>重命名也是有报错<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg\" alt=\"Rename Warning\"></p>\n<p>但如果你往上返回一层，重命名上层目录，这个时候你可以创建出一个总长度超过 MAX_PATH 的长文件名。不过问题也随之来了，当你想要复制包含这个长文件名的整个文件夹的时候，你会发现复制失败，提示文件或者路径太长。</p>\n<p>那么使用 xcopy 命令行不行呢？很遗憾，xcopy 是个使用标准 Win32 ANSI API 的程序，没法支持。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg\" alt=\"xcopy failed\"></p>\n<h3 id=\"解决\"><a href=\"#解决\" class=\"headerlink\" title=\"解决\"></a>解决</h3><p>解决方案有很多种，比如将长文件夹/文件名字改短，将长路径映射为一个逻辑磁盘用来缩短路径的长度等等，我们这里使用 robocopy 这个自带的命令和第三<br>方工具 fastcopy 来解决这个问题。</p>\n<h4 id=\"Robocopy\"><a href=\"#Robocopy\" class=\"headerlink\" title=\"Robocopy\"></a>Robocopy</h4><p>Robocopy 全名是 Robust File Copy，是个 Unicode 的程序，所以可以支持超过 MAX_PATH 的限制，最长可以到 32767，Windows 7 以及之后的操作系统内的是 XP027, 而 Windows Server 2003 Resource Kit Tools 里面的是 XP010，另外，微软为命令行苦手发布了一个 <a href=\"https://technet.microsoft.com/en-us/library/2006.11.utilityspotlight.aspx\">Robocopy GUI</a> 的图形界面版 robocopy，里面集成的是 XP026，具体的区别可以查看这个<a href=\"https://ss64.com/nt/robocopy.html\">网页</a>。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg\" alt=\"robocopy\"></p>\n<blockquote>\n<p>注意：微软还发布了一个 <a href=\"https://technet.microsoft.com/en-us/library/2009.04.utilityspotlight.aspx\">RichCopy</a>，实测这个并不能支持长路径名。</p>\n</blockquote>\n<h4 id=\"FastCopy\"><a href=\"#FastCopy\" class=\"headerlink\" title=\"FastCopy\"></a>FastCopy</h4><p><a href=\"https://ipmsg.org/tools/fastcopy.html\">FastCopy</a>是由  SHIROUZU Hiroaki 开发的免费工具，非常好用。官方的介绍里面也提到了支持 Unicode 和突破 MAX_PATH 260 字符的限制。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg\" alt=\"fastcopy about\"></p>\n<p>实测结果也验证了这一点。<br><img src=\"/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg\" alt=\"fastcopy\"></p>\n<h4 id=\"Win10\"><a href=\"#Win10\" class=\"headerlink\" title=\"Win10\"></a>Win10</h4><p>从 Windows 10 1607起，你可以解除 MAX_PATH 的限制，具体可以参考这个<a href=\"https://blogs.msdn.microsoft.com/jeremykuhne/2016/07/30/net-4-6-2-and-long-paths-on-windows-10/\">文章</a>。</p>\n</body></html>"},{"title":"How to Fix “Mojave application is damaged, and can’t be used to install macOS” Errors","date":"2019-11-28T07:28:23.000Z","keywords":"Hackintosh, macOS, Mojave","description":"如果你还保留旧的 macOS 安装镜像， 那么很遗憾的告诉你这些镜像会在 2019-10-25 之后停止工作。这主要是由于大多数安装镜像中的证书会过期，从而导致这些镜像无法使用。","_content":"\n### 起因\n如果你还保留旧的 macOS 安装镜像， 那么很遗憾的告诉你这些镜像会在 2019-10-25 之后停止工作。这主要是由于大多数安装镜像中的证书会过期，从而导致这些镜像无法使用。\n错误提示如下：\n![damaged-copy](how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png)\n\n\n通过检查 Mojave 的安装镜像，你会发现里面包含的证书已经过期;\n![expired-cert](how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png)\n\n\n### Fix：\n两个解决方法，任选其一：\n\n第一种，重新从苹果官方下载更新过的 Mojave 安装镜像，里面的证书已经更新：\n![validcert](how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png)\n\n\n第二种，修改当前系统的时间去到 **2019-10-24** 日之前，使安装镜像的证书还在有效期内：\n- 断开网络。\n- 打开 **Terminal** 终端工具，输入 `sudo date -u 0924150019`，修改时间为 2019年9月24日15时，再进行安装即可。\n\n","source":"_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors.md","raw":"---\ntitle: How to Fix “Mojave application is damaged, and can’t be used to install macOS” Errors\ntags:\n  - Hackintosh, macOS, Mojave\ncategories:\n  - Hackintosh\ndate: 2019-11-28 15:28:23\nkeywords: Hackintosh, macOS, Mojave\ndescription: 如果你还保留旧的 macOS 安装镜像， 那么很遗憾的告诉你这些镜像会在 2019-10-25 之后停止工作。这主要是由于大多数安装镜像中的证书会过期，从而导致这些镜像无法使用。\n---\n\n### 起因\n如果你还保留旧的 macOS 安装镜像， 那么很遗憾的告诉你这些镜像会在 2019-10-25 之后停止工作。这主要是由于大多数安装镜像中的证书会过期，从而导致这些镜像无法使用。\n错误提示如下：\n![damaged-copy](how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png)\n\n\n通过检查 Mojave 的安装镜像，你会发现里面包含的证书已经过期;\n![expired-cert](how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png)\n\n\n### Fix：\n两个解决方法，任选其一：\n\n第一种，重新从苹果官方下载更新过的 Mojave 安装镜像，里面的证书已经更新：\n![validcert](how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png)\n\n\n第二种，修改当前系统的时间去到 **2019-10-24** 日之前，使安装镜像的证书还在有效期内：\n- 断开网络。\n- 打开 **Terminal** 终端工具，输入 `sudo date -u 0924150019`，修改时间为 2019年9月24日15时，再进行安装即可。\n\n","slug":"how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors","published":1,"updated":"2020-01-07T16:45:37.589Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku0003ck84sbfkefzpc","content":"<html><head></head><body><h3 id=\"起因\"><a href=\"#起因\" class=\"headerlink\" title=\"起因\"></a>起因</h3><p>如果你还保留旧的 macOS 安装镜像， 那么很遗憾的告诉你这些镜像会在 2019-10-25 之后停止工作。这主要是由于大多数安装镜像中的证书会过期，从而导致这些镜像无法使用。<br>错误提示如下：<br><img src=\"/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png\" alt=\"damaged-copy\"></p>\n<p>通过检查 Mojave 的安装镜像，你会发现里面包含的证书已经过期;<br><img src=\"/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png\" alt=\"expired-cert\"></p>\n<h3 id=\"Fix：\"><a href=\"#Fix：\" class=\"headerlink\" title=\"Fix：\"></a>Fix：</h3><p>两个解决方法，任选其一：</p>\n<p>第一种，重新从苹果官方下载更新过的 Mojave 安装镜像，里面的证书已经更新：<br><img src=\"/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png\" alt=\"validcert\"></p>\n<p>第二种，修改当前系统的时间去到 <strong>2019-10-24</strong> 日之前，使安装镜像的证书还在有效期内：</p>\n<ul>\n<li>断开网络。</li>\n<li>打开 <strong>Terminal</strong> 终端工具，输入 <code>sudo date -u 0924150019</code>，修改时间为 2019年9月24日15时，再进行安装即可。</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h3 id=\"起因\"><a href=\"#起因\" class=\"headerlink\" title=\"起因\"></a>起因</h3><p>如果你还保留旧的 macOS 安装镜像， 那么很遗憾的告诉你这些镜像会在 2019-10-25 之后停止工作。这主要是由于大多数安装镜像中的证书会过期，从而导致这些镜像无法使用。<br>错误提示如下：<br><img src=\"/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png\" alt=\"damaged-copy\"></p>\n<p>通过检查 Mojave 的安装镜像，你会发现里面包含的证书已经过期;<br><img src=\"/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png\" alt=\"expired-cert\"></p>\n<h3 id=\"Fix：\"><a href=\"#Fix：\" class=\"headerlink\" title=\"Fix：\"></a>Fix：</h3><p>两个解决方法，任选其一：</p>\n<p>第一种，重新从苹果官方下载更新过的 Mojave 安装镜像，里面的证书已经更新：<br><img src=\"/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png\" alt=\"validcert\"></p>\n<p>第二种，修改当前系统的时间去到 <strong>2019-10-24</strong> 日之前，使安装镜像的证书还在有效期内：</p>\n<ul>\n<li>断开网络。</li>\n<li>打开 <strong>Terminal</strong> 终端工具，输入 <code>sudo date -u 0924150019</code>，修改时间为 2019年9月24日15时，再进行安装即可。</li>\n</ul>\n</body></html>"},{"title":"解决 SQL 2008 Reporting Service 的 TeraData 扩展错误","date":"2010-07-02T08:29:24.000Z","_content":"\n新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：\n> Log Name:      Application\n> Source:        Report Server (MSSQLSERVER)\n> Date:          7/2/2010 12:48:21 AM\n> Event ID:      108\n> Task Category: Extension\n> Level:         Error\n> Keywords:      Classic\n> User:          N/A\n> Computer:      M2AHKCRMWEB01.mail2any.local\n> Description:\n> Report Server (MSSQLSERVER) cannot load the TERADATA extension.\n\n发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。\n\n##### 解决方案：\n大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service  所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。\n比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件\n```xml\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /> -->\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\">\n<Configuration>\n<EnableMathOpCasting>True</EnableMathOpCasting>\n<ReplaceFunctionName>oREPLACE</ReplaceFunctionName>\n</Configuration>\n</Extension> -->\n```\n\n第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx","source":"_posts/how-to-fix-sql2008-ssrs-teradata-extension-load-error.md","raw":"---\ntitle: 解决 SQL 2008 Reporting Service 的 TeraData 扩展错误\ntags:\n  - MSSQL\n  - SSRS\n  - TeraData\ncategories:\n  - Microsoft\n  - MSSQL\ndate: 2010-07-02 16:29:24\n---\n\n新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：\n> Log Name:      Application\n> Source:        Report Server (MSSQLSERVER)\n> Date:          7/2/2010 12:48:21 AM\n> Event ID:      108\n> Task Category: Extension\n> Level:         Error\n> Keywords:      Classic\n> User:          N/A\n> Computer:      M2AHKCRMWEB01.mail2any.local\n> Description:\n> Report Server (MSSQLSERVER) cannot load the TERADATA extension.\n\n发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。\n\n##### 解决方案：\n大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service  所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。\n比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件\n```xml\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /> -->\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\">\n<Configuration>\n<EnableMathOpCasting>True</EnableMathOpCasting>\n<ReplaceFunctionName>oREPLACE</ReplaceFunctionName>\n</Configuration>\n</Extension> -->\n```\n\n第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx","slug":"how-to-fix-sql2008-ssrs-teradata-extension-load-error","published":1,"updated":"2020-01-05T09:00:53.975Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku1003gk84sewo26aqc","content":"<html><head></head><body><p>新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：</p>\n<blockquote>\n<p>Log Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application<br>Source:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Report Server (MSSQLSERVER)<br>Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7/2/2010 12:48:21 AM<br>Event ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 108<br>Task Category: Extension<br>Level:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error<br>Keywords:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Classic<br>User:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N/A<br>Computer:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; M2AHKCRMWEB01.mail2any.local<br>Description:<br>Report Server (MSSQLSERVER) cannot load the TERADATA extension.</p>\n</blockquote>\n<p>发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。</p>\n<h5 id=\"解决方案：\"><a href=\"#解决方案：\" class=\"headerlink\" title=\"解决方案：\"></a>解决方案：</h5><p>大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service&nbsp; 所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。<br>比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /&gt; --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\"&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;Configuration&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;EnableMathOpCasting&gt;True&lt;/EnableMathOpCasting&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;ReplaceFunctionName&gt;oREPLACE&lt;/ReplaceFunctionName&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;/Configuration&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;/Extension&gt; --&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 <a href=\"http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx\">http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：</p>\n<blockquote>\n<p>Log Name:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Application<br>Source:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Report Server (MSSQLSERVER)<br>Date:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7/2/2010 12:48:21 AM<br>Event ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 108<br>Task Category: Extension<br>Level:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Error<br>Keywords:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Classic<br>User:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; N/A<br>Computer:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; M2AHKCRMWEB01.mail2any.local<br>Description:<br>Report Server (MSSQLSERVER) cannot load the TERADATA extension.</p>\n</blockquote>\n<p>发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。</p>\n<h5 id=\"解决方案：\"><a href=\"#解决方案：\" class=\"headerlink\" title=\"解决方案：\"></a>解决方案：</h5><p>大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service&nbsp; 所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。<br>比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /&gt; --&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\"&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;Configuration&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;EnableMathOpCasting&gt;True&lt;/EnableMathOpCasting&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;ReplaceFunctionName&gt;oREPLACE&lt;/ReplaceFunctionName&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;/Configuration&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;/Extension&gt; --&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 <a href=\"http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx\">http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx</a></p>\n</body></html>"},{"title":"WordPress后台无法登录，显示空白的解决方法","date":"2013-04-10T10:08:25.000Z","_content":"\n我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。\n\n整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 `wp-config.php` 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。\n\nGoogle了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了`wp-config.php` 文件的编码上面，官方源文件是 **“UTF-8 without BOM”**，现在我的成了 **“UTF-8格式编码”**，使用 NotePad++ 转换编码后另存上传覆盖解决。","source":"_posts/how-to-fix-wordpress-admin-blank-white-screen.md","raw":"---\ntitle: WordPress后台无法登录，显示空白的解决方法\ntags:\n  - WordPress\ncategories:\n  - 网站相关\ndate: 2013-04-10 18:08:25\n---\n\n我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。\n\n整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 `wp-config.php` 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。\n\nGoogle了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了`wp-config.php` 文件的编码上面，官方源文件是 **“UTF-8 without BOM”**，现在我的成了 **“UTF-8格式编码”**，使用 NotePad++ 转换编码后另存上传覆盖解决。","slug":"how-to-fix-wordpress-admin-blank-white-screen","published":1,"updated":"2020-01-05T09:00:53.975Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku2003jk84sa1zn171y","content":"<html><head></head><body><p>我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。</p>\n<p>整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 <code>wp-config.php</code> 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。</p>\n<p>Google了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了<code>wp-config.php</code> 文件的编码上面，官方源文件是 <strong>“UTF-8 without BOM”</strong>，现在我的成了 <strong>“UTF-8格式编码”</strong>，使用 NotePad++ 转换编码后另存上传覆盖解决。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。</p>\n<p>整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 <code>wp-config.php</code> 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。</p>\n<p>Google了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了<code>wp-config.php</code> 文件的编码上面，官方源文件是 <strong>“UTF-8 without BOM”</strong>，现在我的成了 <strong>“UTF-8格式编码”</strong>，使用 NotePad++ 转换编码后另存上传覆盖解决。</p>\n</body></html>"},{"title":"如何在 Win10 中安装 SQL Server 2005","date":"2015-11-20T14:50:50.000Z","_content":"\n正常情况下，在 Windows 10 是没有办法安装 SQL2005 的，参见微软的这个文章：\n[Using SQL Server in Windows 8 and later versions of Windows operating system](https://support.microsoft.com/en-us/help/2681562/using-sql-server-in-windows-8-and-later-versions-of-windows-operating)\n\n> Microsoft SQL Server 2005 (the release version and service packs) and earlier versions of SQL Server are not supported on Windows 10, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 8.1, or Windows 8. You will receive a warning in the Action Center if Windows 10, Windows 8.1, or Windows 8 detects an instance of SQL Server 2005.\n\n其实，办法还是有的，不过因为并不是官方推荐做法或者解决方案，所以微软不会在这种场景下为你提供技术支持。\n\n1. 找一台已经安装好 SQL Server 2005 并且打上 SP4 补丁的机器 （Windows Server 2003/Windows7 等都行），从上面拷贝 **sqlservr.exe** 和 **sqlos.dll** 两个文件 （默认应该在 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）到临时目录，需要注意的是这个机器上面的 SQL 版本应该和你在 Win10 上面要装的版本一致 (x86/x64，中文/英文等等)；\n2. 在 Win10 上面安装 SQL Server 2005 RTM；\n3. 安装到一半会报个错，SQL Server 服务无法启动，见下图；\n![安装错误](how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg)\n此时先不要关掉这个界面，从临时目录复制 **sqlservr.exe** 和 **sqlos.dll** 到 Win10 的 SQL 安装路径 （同样是 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）下面替换原来的 RTM 的文件；\n\n替换前的文件信息\n![替换前的文件](how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg)\n\n替换后的文件信息\n![替换后的文件](how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg)\n**注意 SP4 文件的修改时间应该是 2010年12月10日**\n4. 回到 SQL Server 的安装界面，点击 \"**Retry**\" 重试，安装得以继续进行；\n![安装继续](how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg)\n5. 安装完成之后，马上打上 SP4 的补丁，确保所有应该被更新的文件都更新到了 SP4。\n![安装完成](how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg)\n\n另：SQL Server 2005 的 Management Studio 在 Win10 下面会有些小问题，比如连接的时候看不到实例，如果需要可以安装 SQL Server 2008 R2 之后的版本。\n\n以上测试环境为\nWindows 10 LTSB 10240 Pro 64-bit\nSQL Server 2005 std 64-bit RTM + SP4\n\n","source":"_posts/how-to-install-sql2005-on-win10.md","raw":"---\ntitle: 如何在 Win10 中安装 SQL Server 2005\ntags:\n  - MSSQL\ncategories:\n  - Microsoft\n  - SQL数据库\ndate: 2015-11-20 22:50:50\n---\n\n正常情况下，在 Windows 10 是没有办法安装 SQL2005 的，参见微软的这个文章：\n[Using SQL Server in Windows 8 and later versions of Windows operating system](https://support.microsoft.com/en-us/help/2681562/using-sql-server-in-windows-8-and-later-versions-of-windows-operating)\n\n> Microsoft SQL Server 2005 (the release version and service packs) and earlier versions of SQL Server are not supported on Windows 10, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 8.1, or Windows 8. You will receive a warning in the Action Center if Windows 10, Windows 8.1, or Windows 8 detects an instance of SQL Server 2005.\n\n其实，办法还是有的，不过因为并不是官方推荐做法或者解决方案，所以微软不会在这种场景下为你提供技术支持。\n\n1. 找一台已经安装好 SQL Server 2005 并且打上 SP4 补丁的机器 （Windows Server 2003/Windows7 等都行），从上面拷贝 **sqlservr.exe** 和 **sqlos.dll** 两个文件 （默认应该在 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）到临时目录，需要注意的是这个机器上面的 SQL 版本应该和你在 Win10 上面要装的版本一致 (x86/x64，中文/英文等等)；\n2. 在 Win10 上面安装 SQL Server 2005 RTM；\n3. 安装到一半会报个错，SQL Server 服务无法启动，见下图；\n![安装错误](how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg)\n此时先不要关掉这个界面，从临时目录复制 **sqlservr.exe** 和 **sqlos.dll** 到 Win10 的 SQL 安装路径 （同样是 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）下面替换原来的 RTM 的文件；\n\n替换前的文件信息\n![替换前的文件](how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg)\n\n替换后的文件信息\n![替换后的文件](how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg)\n**注意 SP4 文件的修改时间应该是 2010年12月10日**\n4. 回到 SQL Server 的安装界面，点击 \"**Retry**\" 重试，安装得以继续进行；\n![安装继续](how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg)\n5. 安装完成之后，马上打上 SP4 的补丁，确保所有应该被更新的文件都更新到了 SP4。\n![安装完成](how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg)\n\n另：SQL Server 2005 的 Management Studio 在 Win10 下面会有些小问题，比如连接的时候看不到实例，如果需要可以安装 SQL Server 2008 R2 之后的版本。\n\n以上测试环境为\nWindows 10 LTSB 10240 Pro 64-bit\nSQL Server 2005 std 64-bit RTM + SP4\n\n","slug":"how-to-install-sql2005-on-win10","published":1,"updated":"2020-01-05T09:00:53.976Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku2003nk84sborchjb0","content":"<html><head></head><body><p>正常情况下，在 Windows 10 是没有办法安装 SQL2005 的，参见微软的这个文章：<br><a href=\"https://support.microsoft.com/en-us/help/2681562/using-sql-server-in-windows-8-and-later-versions-of-windows-operating\">Using SQL Server in Windows 8 and later versions of Windows operating system</a></p>\n<blockquote>\n<p>Microsoft SQL Server 2005 (the release version and service packs) and earlier versions of SQL Server are not supported on Windows 10, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 8.1, or Windows 8. You will receive a warning in the Action Center if Windows 10, Windows 8.1, or Windows 8 detects an instance of SQL Server 2005.</p>\n</blockquote>\n<p>其实，办法还是有的，不过因为并不是官方推荐做法或者解决方案，所以微软不会在这种场景下为你提供技术支持。</p>\n<ol>\n<li>找一台已经安装好 SQL Server 2005 并且打上 SP4 补丁的机器 （Windows Server 2003/Windows7 等都行），从上面拷贝 <strong>sqlservr.exe</strong> 和 <strong>sqlos.dll</strong> 两个文件 （默认应该在 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）到临时目录，需要注意的是这个机器上面的 SQL 版本应该和你在 Win10 上面要装的版本一致 (x86/x64，中文/英文等等)；</li>\n<li>在 Win10 上面安装 SQL Server 2005 RTM；</li>\n<li>安装到一半会报个错，SQL Server 服务无法启动，见下图；<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg\" alt=\"安装错误\"><br>此时先不要关掉这个界面，从临时目录复制 <strong>sqlservr.exe</strong> 和 <strong>sqlos.dll</strong> 到 Win10 的 SQL 安装路径 （同样是 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）下面替换原来的 RTM 的文件；</li>\n</ol>\n<p>替换前的文件信息<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg\" alt=\"替换前的文件\"></p>\n<p>替换后的文件信息<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg\" alt=\"替换后的文件\"><br><strong>注意 SP4 文件的修改时间应该是 2010年12月10日</strong><br>4. 回到 SQL Server 的安装界面，点击 “<strong>Retry</strong>“ 重试，安装得以继续进行；<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg\" alt=\"安装继续\"><br>5. 安装完成之后，马上打上 SP4 的补丁，确保所有应该被更新的文件都更新到了 SP4。<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg\" alt=\"安装完成\"></p>\n<p>另：SQL Server 2005 的 Management Studio 在 Win10 下面会有些小问题，比如连接的时候看不到实例，如果需要可以安装 SQL Server 2008 R2 之后的版本。</p>\n<p>以上测试环境为<br>Windows 10 LTSB 10240 Pro 64-bit<br>SQL Server 2005 std 64-bit RTM + SP4</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>正常情况下，在 Windows 10 是没有办法安装 SQL2005 的，参见微软的这个文章：<br><a href=\"https://support.microsoft.com/en-us/help/2681562/using-sql-server-in-windows-8-and-later-versions-of-windows-operating\">Using SQL Server in Windows 8 and later versions of Windows operating system</a></p>\n<blockquote>\n<p>Microsoft SQL Server 2005 (the release version and service packs) and earlier versions of SQL Server are not supported on Windows 10, Windows Server 2016, Windows Server 2012 R2, Windows Server 2012, Windows 8.1, or Windows 8. You will receive a warning in the Action Center if Windows 10, Windows 8.1, or Windows 8 detects an instance of SQL Server 2005.</p>\n</blockquote>\n<p>其实，办法还是有的，不过因为并不是官方推荐做法或者解决方案，所以微软不会在这种场景下为你提供技术支持。</p>\n<ol>\n<li>找一台已经安装好 SQL Server 2005 并且打上 SP4 补丁的机器 （Windows Server 2003/Windows7 等都行），从上面拷贝 <strong>sqlservr.exe</strong> 和 <strong>sqlos.dll</strong> 两个文件 （默认应该在 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）到临时目录，需要注意的是这个机器上面的 SQL 版本应该和你在 Win10 上面要装的版本一致 (x86/x64，中文/英文等等)；</li>\n<li>在 Win10 上面安装 SQL Server 2005 RTM；</li>\n<li>安装到一半会报个错，SQL Server 服务无法启动，见下图；<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg\" alt=\"安装错误\"><br>此时先不要关掉这个界面，从临时目录复制 <strong>sqlservr.exe</strong> 和 <strong>sqlos.dll</strong> 到 Win10 的 SQL 安装路径 （同样是 C:\\Program Files\\Microsoft SQL Server\\MSSQL.1\\MSSQL\\Binn）下面替换原来的 RTM 的文件；</li>\n</ol>\n<p>替换前的文件信息<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg\" alt=\"替换前的文件\"></p>\n<p>替换后的文件信息<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg\" alt=\"替换后的文件\"><br><strong>注意 SP4 文件的修改时间应该是 2010年12月10日</strong><br>4. 回到 SQL Server 的安装界面，点击 “<strong>Retry</strong>“ 重试，安装得以继续进行；<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg\" alt=\"安装继续\"><br>5. 安装完成之后，马上打上 SP4 的补丁，确保所有应该被更新的文件都更新到了 SP4。<br><img src=\"/how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg\" alt=\"安装完成\"></p>\n<p>另：SQL Server 2005 的 Management Studio 在 Win10 下面会有些小问题，比如连接的时候看不到实例，如果需要可以安装 SQL Server 2008 R2 之后的版本。</p>\n<p>以上测试环境为<br>Windows 10 LTSB 10240 Pro 64-bit<br>SQL Server 2005 std 64-bit RTM + SP4</p>\n</body></html>"},{"title":"How to remember your OC and Outlook password","date":"2010-10-13T07:12:44.000Z","_content":"\nHow to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)\n\n我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连\"保存密码\"的复选框都看不到，怎么办？\n\n#### A. Outlook 2007 (同样适用于 Outlook 2003/2010)\n1. 退出 Outlook（如果在运行的话）。\n2. 控制面板 -&gt; 邮件 -&gt; 邮件账户..., 点击 \"更改...\"。\n![ol_step_1](how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg)\n3. 在 \"更改电子邮件账户\" 对话框, 点击 \"更多设置\"。![ol_step_2](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n4. 转到 \"连接\" 标签卡, 点击 \"Exchange 代理设置\"。\n![ol_step_3](how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg)\n5. 在代理认证这里，将认证方式从基本认证改为 NTLM 认证。\n![ol_step_4](how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg)\n6. 点击 \"OK\" 两次确认。\n7. 接着点击下一步和完成按钮。\n8. 重新打开 Outlook , 你就能看到那 \"记住密码\" 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。\n9. 这一步是关键！点击开始-&gt; 运行, 输入 `control Keymgr.dll`\n![ol_step_5](how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg)\n10. 确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 \"属性\"。\n![ol_step_6](how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg)\n![ol_step_7](how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg)\n11. 将服务器属性从 \"EXMBX01.company.local\" 改成 \"\\*.company.local\", 点击 **OK** 确定。\n![ol_step_8](how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg)\n\n#### B. Communicator\n1. 打开注册表，找到 `HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator`，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 \n2. 关闭并完全退出 communicator ， 然后重新打开, 你会看到 \"保存我的密码\", 选中后点击登入。\n![ol_step_9](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n\n注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。","source":"_posts/how-to-remember-your-oc-and-outlook-password.md","raw":"---\ntitle: How to remember your OC and Outlook password\ntags:\n  - XMPP\n  - Communicator\ncategories:\n  - 沟通协作\ndate: 2010-10-13 15:12:44\n---\n\nHow to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)\n\n我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连\"保存密码\"的复选框都看不到，怎么办？\n\n#### A. Outlook 2007 (同样适用于 Outlook 2003/2010)\n1. 退出 Outlook（如果在运行的话）。\n2. 控制面板 -&gt; 邮件 -&gt; 邮件账户..., 点击 \"更改...\"。\n![ol_step_1](how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg)\n3. 在 \"更改电子邮件账户\" 对话框, 点击 \"更多设置\"。![ol_step_2](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n4. 转到 \"连接\" 标签卡, 点击 \"Exchange 代理设置\"。\n![ol_step_3](how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg)\n5. 在代理认证这里，将认证方式从基本认证改为 NTLM 认证。\n![ol_step_4](how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg)\n6. 点击 \"OK\" 两次确认。\n7. 接着点击下一步和完成按钮。\n8. 重新打开 Outlook , 你就能看到那 \"记住密码\" 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。\n9. 这一步是关键！点击开始-&gt; 运行, 输入 `control Keymgr.dll`\n![ol_step_5](how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg)\n10. 确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 \"属性\"。\n![ol_step_6](how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg)\n![ol_step_7](how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg)\n11. 将服务器属性从 \"EXMBX01.company.local\" 改成 \"\\*.company.local\", 点击 **OK** 确定。\n![ol_step_8](how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg)\n\n#### B. Communicator\n1. 打开注册表，找到 `HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator`，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 \n2. 关闭并完全退出 communicator ， 然后重新打开, 你会看到 \"保存我的密码\", 选中后点击登入。\n![ol_step_9](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n\n注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。","slug":"how-to-remember-your-oc-and-outlook-password","published":1,"updated":"2020-01-05T09:00:53.980Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku3003pk84s3thabcqr","content":"<html><head></head><body><p>How to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)</p>\n<p>我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连”保存密码”的复选框都看不到，怎么办？</p>\n<h4 id=\"A-Outlook-2007-同样适用于-Outlook-2003-x2F-2010\"><a href=\"#A-Outlook-2007-同样适用于-Outlook-2003-x2F-2010\" class=\"headerlink\" title=\"A. Outlook 2007&nbsp;(同样适用于 Outlook 2003/2010)\"></a>A. Outlook 2007&nbsp;(同样适用于 Outlook 2003/2010)</h4><p>1.&nbsp;退出 Outlook（如果在运行的话）。<br>2.&nbsp;控制面板 -&gt; 邮件 -&gt; 邮件账户…, 点击 “更改…”。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg\" alt=\"ol_step_1\"><br>3.&nbsp;在 “更改电子邮件账户” 对话框, 点击 “更多设置”。<img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_2\"><br>4.&nbsp;转到 “连接” 标签卡, 点击 “Exchange 代理设置”。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg\" alt=\"ol_step_3\"><br>5.&nbsp;在代理认证这里，将认证方式从基本认证改为 NTLM 认证。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg\" alt=\"ol_step_4\"><br>6.&nbsp;点击 “OK” 两次确认。<br>7.&nbsp;接着点击下一步和完成按钮。<br>8.&nbsp;重新打开 Outlook , 你就能看到那 “记住密码” 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。<br>9.&nbsp;这一步是关键！点击开始-&gt; 运行, 输入 <code>control Keymgr.dll</code><br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg\" alt=\"ol_step_5\"><br>10.&nbsp;确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 “属性”。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg\" alt=\"ol_step_6\"><br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg\" alt=\"ol_step_7\"><br>11.&nbsp;将服务器属性从 “EXMBX01.company.local” 改成 “*.company.local”, 点击 <strong>OK</strong> 确定。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg\" alt=\"ol_step_8\"></p>\n<h4 id=\"B-Communicator\"><a href=\"#B-Communicator\" class=\"headerlink\" title=\"B. Communicator\"></a>B. Communicator</h4><ol>\n<li>打开注册表，找到 <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator</code>，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 </li>\n<li>关闭并完全退出 communicator ， 然后重新打开, 你会看到 “保存我的密码”, 选中后点击登入。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_9\"></li>\n</ol>\n<p>注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>How to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)</p>\n<p>我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连”保存密码”的复选框都看不到，怎么办？</p>\n<h4 id=\"A-Outlook-2007-同样适用于-Outlook-2003-x2F-2010\"><a href=\"#A-Outlook-2007-同样适用于-Outlook-2003-x2F-2010\" class=\"headerlink\" title=\"A. Outlook 2007&nbsp;(同样适用于 Outlook 2003/2010)\"></a>A. Outlook 2007&nbsp;(同样适用于 Outlook 2003/2010)</h4><p>1.&nbsp;退出 Outlook（如果在运行的话）。<br>2.&nbsp;控制面板 -&gt; 邮件 -&gt; 邮件账户…, 点击 “更改…”。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg\" alt=\"ol_step_1\"><br>3.&nbsp;在 “更改电子邮件账户” 对话框, 点击 “更多设置”。<img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_2\"><br>4.&nbsp;转到 “连接” 标签卡, 点击 “Exchange 代理设置”。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg\" alt=\"ol_step_3\"><br>5.&nbsp;在代理认证这里，将认证方式从基本认证改为 NTLM 认证。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg\" alt=\"ol_step_4\"><br>6.&nbsp;点击 “OK” 两次确认。<br>7.&nbsp;接着点击下一步和完成按钮。<br>8.&nbsp;重新打开 Outlook , 你就能看到那 “记住密码” 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。<br>9.&nbsp;这一步是关键！点击开始-&gt; 运行, 输入 <code>control Keymgr.dll</code><br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg\" alt=\"ol_step_5\"><br>10.&nbsp;确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 “属性”。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg\" alt=\"ol_step_6\"><br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg\" alt=\"ol_step_7\"><br>11.&nbsp;将服务器属性从 “EXMBX01.company.local” 改成 “*.company.local”, 点击 <strong>OK</strong> 确定。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg\" alt=\"ol_step_8\"></p>\n<h4 id=\"B-Communicator\"><a href=\"#B-Communicator\" class=\"headerlink\" title=\"B. Communicator\"></a>B. Communicator</h4><ol>\n<li>打开注册表，找到 <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator</code>，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 </li>\n<li>关闭并完全退出 communicator ， 然后重新打开, 你会看到 “保存我的密码”, 选中后点击登入。<br><img src=\"/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_9\"></li>\n</ol>\n<p>注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。</p>\n</body></html>"},{"title":"How to remove a VMHost from SCVMM 2008 R2 forcefully","id":"107","date":"2010-04-13T14:17:03.000Z","_content":"\n这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：\n> Error (801)\n> \n> VMM cannot find ISO object .\n> \n> Recommended Action\n> \n> Ensure the library object is valid, and then try the operation again.\n\n移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:\nGet-VMHost -Computername Hostname | Remove-VMHost -Force\n一样的提示。\n一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。\n\n##### 步骤：\n1. 停止 VMMService 服务；\n2. 用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:**MICROSOFT$VMM$**，数据库名称是 **VirtualManagerDB**)，保险起见，先备份；\n3. 查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 `'68899616-fdc8-4f85-a702-979a4251f766'`；\n4. 打开查询窗口，执行以下 SQL 语句:\n```sql\nDELETE FROM tbl_ADHC_HostNetworkAdapter WHERE (HostID='68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_VirtualNetwork WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostVolume WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostDisk WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_PhysicalObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_VObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_Host WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\n```\n5. 再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除\n\n6. 如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录\n```sql\nDELETE FROM tbl_ADHC_ClusterDisk WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\nDELETE FROM tbl_ADHC_HostCluster WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\n```\n\nPS. 用下面这条命令可以重置 Failed Job 状态\n```sql\nUPDATE tbl_TR_TaskTrail SET IsVisible = 0 WHERE TaskState = 'Failed'\n```","source":"_posts/how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully.md","raw":"---\ntitle: How to remove a VMHost from SCVMM 2008 R2 forcefully\ntags:\n  - SCVMM\n  - VMHost\nid: 107\ncategories:\n  - 虚拟化\ndate: 2010-04-13 22:17:03\n---\n\n这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：\n> Error (801)\n> \n> VMM cannot find ISO object .\n> \n> Recommended Action\n> \n> Ensure the library object is valid, and then try the operation again.\n\n移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:\nGet-VMHost -Computername Hostname | Remove-VMHost -Force\n一样的提示。\n一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。\n\n##### 步骤：\n1. 停止 VMMService 服务；\n2. 用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:**MICROSOFT$VMM$**，数据库名称是 **VirtualManagerDB**)，保险起见，先备份；\n3. 查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 `'68899616-fdc8-4f85-a702-979a4251f766'`；\n4. 打开查询窗口，执行以下 SQL 语句:\n```sql\nDELETE FROM tbl_ADHC_HostNetworkAdapter WHERE (HostID='68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_VirtualNetwork WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostVolume WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostDisk WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_PhysicalObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_VObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_Host WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\n```\n5. 再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除\n\n6. 如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录\n```sql\nDELETE FROM tbl_ADHC_ClusterDisk WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\nDELETE FROM tbl_ADHC_HostCluster WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\n```\n\nPS. 用下面这条命令可以重置 Failed Job 状态\n```sql\nUPDATE tbl_TR_TaskTrail SET IsVisible = 0 WHERE TaskState = 'Failed'\n```","slug":"how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully","published":1,"updated":"2020-01-05T09:00:53.985Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku4003tk84s70bf0mbc","content":"<html><head></head><body><p>这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：</p>\n<blockquote>\n<p>Error (801)</p>\n<p>VMM cannot find ISO object .</p>\n<p>Recommended Action</p>\n<p>Ensure the library object is valid, and then try the operation again.</p>\n</blockquote>\n<p>移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:<br>Get-VMHost -Computername Hostname | Remove-VMHost -Force<br>一样的提示。<br>一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。</p>\n<h5 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h5><ol>\n<li><p>停止 VMMService 服务；</p>\n</li>\n<li><p>用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:**MICROSOFT$VMM$**，数据库名称是&nbsp;<strong>VirtualManagerDB</strong>)，保险起见，先备份；</p>\n</li>\n<li><p>查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 <code>'68899616-fdc8-4f85-a702-979a4251f766'</code>；</p>\n</li>\n<li><p>打开查询窗口，执行以下 SQL 语句:</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostNetworkAdapter <span class=\"keyword\">WHERE</span> (HostID<span class=\"operator\">=</span><span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_VirtualNetwork <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostVolume <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostDisk <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_PhysicalObject <span class=\"keyword\">WHERE</span> (HostId <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_VObject <span class=\"keyword\">WHERE</span> (HostId <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_Host <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br></pre></td></tr></tbody></table></figure></li>\n<li><p>再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除</p>\n</li>\n<li><p>如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_ClusterDisk <span class=\"keyword\">WHERE</span> (ClusterID <span class=\"operator\">=</span> <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostCluster <span class=\"keyword\">WHERE</span> (ClusterID <span class=\"operator\">=</span> <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<p>PS. 用下面这条命令可以重置 Failed Job 状态</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">UPDATE</span> tbl_TR_TaskTrail <span class=\"keyword\">SET</span> IsVisible <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"keyword\">WHERE</span> TaskState <span class=\"operator\">=</span> <span class=\"string\">'Failed'</span></span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：</p>\n<blockquote>\n<p>Error (801)</p>\n<p>VMM cannot find ISO object .</p>\n<p>Recommended Action</p>\n<p>Ensure the library object is valid, and then try the operation again.</p>\n</blockquote>\n<p>移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:<br>Get-VMHost -Computername Hostname | Remove-VMHost -Force<br>一样的提示。<br>一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。</p>\n<h5 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h5><ol>\n<li><p>停止 VMMService 服务；</p>\n</li>\n<li><p>用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:**MICROSOFT$VMM$**，数据库名称是&nbsp;<strong>VirtualManagerDB</strong>)，保险起见，先备份；</p>\n</li>\n<li><p>查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 <code>'68899616-fdc8-4f85-a702-979a4251f766'</code>；</p>\n</li>\n<li><p>打开查询窗口，执行以下 SQL 语句:</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostNetworkAdapter <span class=\"keyword\">WHERE</span> (HostID<span class=\"operator\">=</span><span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_VirtualNetwork <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostVolume <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostDisk <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_PhysicalObject <span class=\"keyword\">WHERE</span> (HostId <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_VObject <span class=\"keyword\">WHERE</span> (HostId <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_Host <span class=\"keyword\">WHERE</span> (HostID <span class=\"operator\">=</span> <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</span><br></pre></td></tr></tbody></table></figure></li>\n<li><p>再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除</p>\n</li>\n<li><p>如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_ClusterDisk <span class=\"keyword\">WHERE</span> (ClusterID <span class=\"operator\">=</span> <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</span><br><span class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostCluster <span class=\"keyword\">WHERE</span> (ClusterID <span class=\"operator\">=</span> <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<p>PS. 用下面这条命令可以重置 Failed Job 状态</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">UPDATE</span> tbl_TR_TaskTrail <span class=\"keyword\">SET</span> IsVisible <span class=\"operator\">=</span> <span class=\"number\">0</span> <span class=\"keyword\">WHERE</span> TaskState <span class=\"operator\">=</span> <span class=\"string\">'Failed'</span></span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"解除 Win10 LTSB 简体中文版 IE11 首页保护锁定方法","date":"2017-09-11T03:14:23.000Z","keywords":"Microsoft, 微软，IE11, Internet Explorer, 百度，锁定，首页","description":"不过最近有部分使用 IE11 的用户发现，启动浏览器会发现默认主页被重定向到了百度带尾巴的首页 https://www.baidu.com/?tn=80035161_1_dg，而默认的搜索引擎也被改成了百度，而且更过分的是，你还无法修改默认主页，一旦修改就会出现“由于主页设置已损坏， Internet Explorer 重置了你的主页。你是否要将主页改为……”","_content":"\n> 北京时间2015年9月24日，美国华盛顿州雷德蒙德，百度与微软正式宣布战略合作，百度将成为中国市场上Windows 10 Microsoft Edge浏览器的默认主页和搜索引擎，带给用户更加便捷的搜索服务。同时，百度也将通过“Windows 10直通车”提供Windows 10下载升级服务。\n\n#### 前言\n以上是来自微软官方消息，不过最近有部分使用 IE11 的用户发现，启动浏览器会发现默认主页被重定向到了百度带尾巴的首页 [https://www.baidu.com/?tn=80035161_1_dg，](https://www.baidu.com/?tn=80035161_1_dg) 而默认的搜索引擎也被改成了百度，而且更过分的是，你还无法修改默认主页，一旦修改就会出现“由于主页设置已损坏， Internet Explorer 重置了你的主页。你是否要将主页改为……”，每次打开 IE 都会出现这样的提示，甚至重装系统依然如此。\n\n![主页设置已损坏](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg)\n\n这既不是 DNS 劫持，也不是啥恶意软件，这个微软官方推行的浏览器保护机制，只不过落地在国内，默认主页和搜索引擎提供者变成了百度，谁让 Bing 不争气啊。\n\n<!--more-->\n\n#### 分析\n这些受影响的 IE11 在启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新部分设置，如下图：\n![Fiddler抓包-IE启动](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg)\n\n在更改默认主页的时候，也同样有去访问 ieonline.microsoft.com \n![Fiddler抓包-更改IE主页](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg)\n\n#### 解决方案\n通过 Fiddler 抓包和 ProcMon 分析，找到以下解决方法：\n1. 首先编辑本机hosts文件，在其中添加**127.0.0.1 ieonline.microsoft.com**\n2. 打开注册表编辑器，找到 **[HKEY_CURRENT_USER\\\\SOFTWARE\\Microsoft\\\\Internet Explorer]**，删除**EUPP**项\n3. 打开注册表编辑器，找到 **[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\Main\\\\FeatureControl]**，在下面新建项**FEATURE_EUPP_GLOBAL_FORCE_DISABLE**，然后在这个项下面新建一个 **DWORD32** 值，键值名称为 **iexplorer.exe** ，键值改成1\n注册表文件如下：\n``` plain\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_EUPP_GLOBAL_FORCE_DISABLE]\n\"iexplorer.exe\"=dword:00000001\n```\n4. 之后再去修改 IE 默认主页就可以了\n5. 这样修改之后，实际上在注册表中 HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer 下面还是会创建 EUPP 项，不过会少了一些东西，只剩下一个 叫 RId 的字符串值，暂时不知道有没有别的啥影响，强迫症患者可以用这个注册表文件还原成原始值\n``` plain\nWindows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP]\n\"RId\"=\"{0E742E0E-7B2B-4372-84A0-507D6539A665}\"\n\"ChangeNotice\"=dword:00000002\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP\\DSP]\n\"ChangeNotice\"=dword:00000002\n```\n#### 结论:\n产生这个问题的原因是 IE 启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新 EUPP 键值内容，其中最关键的是 BackupHomePage 和子项 DSP 下面的 BackupDefaultSearchScope 的这两个二进制值锁定主页和搜索提供程序的 URL，新安装的系统里面，BackupHomePage和 BackupDefaultSearchScope 键值还没有被创建。之后一旦可以联网，IE 会更新注册表，从而锁定主页和搜索提供程序，而且这些二进制值是加密的，有兴趣的可以参考这篇文章：http://bbs.pediy.com/thread-196517.htm\n\n所以和 Windows 10 的版本或者 IE 补丁程序无关，此方法在 Win10 LTSB 中文 64 位 1607 版本上测试通过。\n\n#### 2017年9月14日更新：\n**貌似这两天微软已经把 EUPP 的 webservice 做了更新，不再强制修改成百度了，所以即使你不应用上面的注册表和 hosts 文件修改，也可以像以前一样任意修改默认主页了。**\n另1：如果是单单通过 hosts 文件屏蔽 ieonline.microsoft.com 的，要取消这个屏蔽，否则你的IE默认主页会锁定在屏蔽ieonline.microsoft.com之前的设定，无法修改成新的。\n![修改hosts文件后更改IE主页](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg)\n另2：从 ieonline.microsoft.com 拿到的 ChangeNotice 的值在9月14日之后也有了变化，以前会被重置成2，现在是0,从名字猜测来看应该是提示主页设置被更改的旗标 (flag) 设置。\n\n最后放上各个阶段的注册表 EUPP 项导出文件供参考 {% asset_link ie11-eupp-registry.zip IE11 EUPP Registry Settings Export %}\n","source":"_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb.md","raw":"---\ntitle: 解除 Win10 LTSB 简体中文版 IE11 首页保护锁定方法\ntags:\n  - Internet Explorer\n  - Microsoft\n  - Fiddler\ncategories:\n  - Microsoft\ndate: 2017-09-11 11:14:23\nkeywords: Microsoft, 微软，IE11, Internet Explorer, 百度，锁定，首页\ndescription: 不过最近有部分使用 IE11 的用户发现，启动浏览器会发现默认主页被重定向到了百度带尾巴的首页 https://www.baidu.com/?tn=80035161_1_dg，而默认的搜索引擎也被改成了百度，而且更过分的是，你还无法修改默认主页，一旦修改就会出现“由于主页设置已损坏， Internet Explorer 重置了你的主页。你是否要将主页改为……”\n---\n\n> 北京时间2015年9月24日，美国华盛顿州雷德蒙德，百度与微软正式宣布战略合作，百度将成为中国市场上Windows 10 Microsoft Edge浏览器的默认主页和搜索引擎，带给用户更加便捷的搜索服务。同时，百度也将通过“Windows 10直通车”提供Windows 10下载升级服务。\n\n#### 前言\n以上是来自微软官方消息，不过最近有部分使用 IE11 的用户发现，启动浏览器会发现默认主页被重定向到了百度带尾巴的首页 [https://www.baidu.com/?tn=80035161_1_dg，](https://www.baidu.com/?tn=80035161_1_dg) 而默认的搜索引擎也被改成了百度，而且更过分的是，你还无法修改默认主页，一旦修改就会出现“由于主页设置已损坏， Internet Explorer 重置了你的主页。你是否要将主页改为……”，每次打开 IE 都会出现这样的提示，甚至重装系统依然如此。\n\n![主页设置已损坏](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg)\n\n这既不是 DNS 劫持，也不是啥恶意软件，这个微软官方推行的浏览器保护机制，只不过落地在国内，默认主页和搜索引擎提供者变成了百度，谁让 Bing 不争气啊。\n\n<!--more-->\n\n#### 分析\n这些受影响的 IE11 在启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新部分设置，如下图：\n![Fiddler抓包-IE启动](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg)\n\n在更改默认主页的时候，也同样有去访问 ieonline.microsoft.com \n![Fiddler抓包-更改IE主页](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg)\n\n#### 解决方案\n通过 Fiddler 抓包和 ProcMon 分析，找到以下解决方法：\n1. 首先编辑本机hosts文件，在其中添加**127.0.0.1 ieonline.microsoft.com**\n2. 打开注册表编辑器，找到 **[HKEY_CURRENT_USER\\\\SOFTWARE\\Microsoft\\\\Internet Explorer]**，删除**EUPP**项\n3. 打开注册表编辑器，找到 **[HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Internet Explorer\\Main\\\\FeatureControl]**，在下面新建项**FEATURE_EUPP_GLOBAL_FORCE_DISABLE**，然后在这个项下面新建一个 **DWORD32** 值，键值名称为 **iexplorer.exe** ，键值改成1\n注册表文件如下：\n``` plain\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_EUPP_GLOBAL_FORCE_DISABLE]\n\"iexplorer.exe\"=dword:00000001\n```\n4. 之后再去修改 IE 默认主页就可以了\n5. 这样修改之后，实际上在注册表中 HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer 下面还是会创建 EUPP 项，不过会少了一些东西，只剩下一个 叫 RId 的字符串值，暂时不知道有没有别的啥影响，强迫症患者可以用这个注册表文件还原成原始值\n``` plain\nWindows Registry Editor Version 5.00\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP]\n\"RId\"=\"{0E742E0E-7B2B-4372-84A0-507D6539A665}\"\n\"ChangeNotice\"=dword:00000002\n\n[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP\\DSP]\n\"ChangeNotice\"=dword:00000002\n```\n#### 结论:\n产生这个问题的原因是 IE 启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新 EUPP 键值内容，其中最关键的是 BackupHomePage 和子项 DSP 下面的 BackupDefaultSearchScope 的这两个二进制值锁定主页和搜索提供程序的 URL，新安装的系统里面，BackupHomePage和 BackupDefaultSearchScope 键值还没有被创建。之后一旦可以联网，IE 会更新注册表，从而锁定主页和搜索提供程序，而且这些二进制值是加密的，有兴趣的可以参考这篇文章：http://bbs.pediy.com/thread-196517.htm\n\n所以和 Windows 10 的版本或者 IE 补丁程序无关，此方法在 Win10 LTSB 中文 64 位 1607 版本上测试通过。\n\n#### 2017年9月14日更新：\n**貌似这两天微软已经把 EUPP 的 webservice 做了更新，不再强制修改成百度了，所以即使你不应用上面的注册表和 hosts 文件修改，也可以像以前一样任意修改默认主页了。**\n另1：如果是单单通过 hosts 文件屏蔽 ieonline.microsoft.com 的，要取消这个屏蔽，否则你的IE默认主页会锁定在屏蔽ieonline.microsoft.com之前的设定，无法修改成新的。\n![修改hosts文件后更改IE主页](how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg)\n另2：从 ieonline.microsoft.com 拿到的 ChangeNotice 的值在9月14日之后也有了变化，以前会被重置成2，现在是0,从名字猜测来看应该是提示主页设置被更改的旗标 (flag) 设置。\n\n最后放上各个阶段的注册表 EUPP 项导出文件供参考 {% asset_link ie11-eupp-registry.zip IE11 EUPP Registry Settings Export %}\n","slug":"how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb","published":1,"updated":"2020-01-05T09:00:53.986Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku4003wk84sfhpjfou2","content":"<html><head></head><body><blockquote>\n<p>北京时间2015年9月24日，美国华盛顿州雷德蒙德，百度与微软正式宣布战略合作，百度将成为中国市场上Windows 10 Microsoft Edge浏览器的默认主页和搜索引擎，带给用户更加便捷的搜索服务。同时，百度也将通过“Windows 10直通车”提供Windows 10下载升级服务。</p>\n</blockquote>\n<h4 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h4><p>以上是来自微软官方消息，不过最近有部分使用 IE11 的用户发现，启动浏览器会发现默认主页被重定向到了百度带尾巴的首页 <a href=\"https://www.baidu.com/?tn=80035161_1_dg\">https://www.baidu.com/?tn=80035161_1_dg，</a> 而默认的搜索引擎也被改成了百度，而且更过分的是，你还无法修改默认主页，一旦修改就会出现“由于主页设置已损坏， Internet Explorer 重置了你的主页。你是否要将主页改为……”，每次打开 IE 都会出现这样的提示，甚至重装系统依然如此。</p>\n<p><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg\" alt=\"主页设置已损坏\"></p>\n<p>这既不是 DNS 劫持，也不是啥恶意软件，这个微软官方推行的浏览器保护机制，只不过落地在国内，默认主页和搜索引擎提供者变成了百度，谁让 Bing 不争气啊。</p>\n<span id=\"more\"></span>\n\n<h4 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h4><p>这些受影响的 IE11 在启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新部分设置，如下图：<br><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg\" alt=\"Fiddler抓包-IE启动\"></p>\n<p>在更改默认主页的时候，也同样有去访问 ieonline.microsoft.com<br><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg\" alt=\"Fiddler抓包-更改IE主页\"></p>\n<h4 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h4><p>通过 Fiddler 抓包和 ProcMon 分析，找到以下解决方法：</p>\n<ol>\n<li>首先编辑本机hosts文件，在其中添加<strong>127.0.0.1 ieonline.microsoft.com</strong></li>\n<li>打开注册表编辑器，找到 <strong>[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer]<strong>，删除</strong>EUPP</strong>项</li>\n<li>打开注册表编辑器，找到 <strong>[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl]<strong>，在下面新建项</strong>FEATURE_EUPP_GLOBAL_FORCE_DISABLE</strong>，然后在这个项下面新建一个 <strong>DWORD32</strong> 值，键值名称为 <strong>iexplorer.exe</strong> ，键值改成1<br>注册表文件如下：<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windows Registry Editor Version 5.00</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_EUPP_GLOBAL_FORCE_DISABLE]</span><br><span class=\"line\">\"iexplorer.exe\"=dword:00000001</span><br></pre></td></tr></tbody></table></figure></li>\n<li>之后再去修改 IE 默认主页就可以了</li>\n<li>这样修改之后，实际上在注册表中 HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer 下面还是会创建 EUPP 项，不过会少了一些东西，只剩下一个 叫 RId 的字符串值，暂时不知道有没有别的啥影响，强迫症患者可以用这个注册表文件还原成原始值<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windows Registry Editor Version 5.00</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP]</span><br><span class=\"line\">\"RId\"=\"{0E742E0E-7B2B-4372-84A0-507D6539A665}\"</span><br><span class=\"line\">\"ChangeNotice\"=dword:00000002</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP\\DSP]</span><br><span class=\"line\">\"ChangeNotice\"=dword:00000002</span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论:\"></a>结论:</h4>产生这个问题的原因是 IE 启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新 EUPP 键值内容，其中最关键的是 BackupHomePage 和子项 DSP 下面的 BackupDefaultSearchScope 的这两个二进制值锁定主页和搜索提供程序的 URL，新安装的系统里面，BackupHomePage和 BackupDefaultSearchScope 键值还没有被创建。之后一旦可以联网，IE 会更新注册表，从而锁定主页和搜索提供程序，而且这些二进制值是加密的，有兴趣的可以参考这篇文章：<a href=\"http://bbs.pediy.com/thread-196517.htm\">http://bbs.pediy.com/thread-196517.htm</a></li>\n</ol>\n<p>所以和 Windows 10 的版本或者 IE 补丁程序无关，此方法在 Win10 LTSB 中文 64 位 1607 版本上测试通过。</p>\n<h4 id=\"2017年9月14日更新：\"><a href=\"#2017年9月14日更新：\" class=\"headerlink\" title=\"2017年9月14日更新：\"></a>2017年9月14日更新：</h4><p><strong>貌似这两天微软已经把 EUPP 的 webservice 做了更新，不再强制修改成百度了，所以即使你不应用上面的注册表和 hosts 文件修改，也可以像以前一样任意修改默认主页了。</strong><br>另1：如果是单单通过 hosts 文件屏蔽 ieonline.microsoft.com 的，要取消这个屏蔽，否则你的IE默认主页会锁定在屏蔽ieonline.microsoft.com之前的设定，无法修改成新的。<br><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg\" alt=\"修改hosts文件后更改IE主页\"><br>另2：从 ieonline.microsoft.com 拿到的 ChangeNotice 的值在9月14日之后也有了变化，以前会被重置成2，现在是0,从名字猜测来看应该是提示主页设置被更改的旗标 (flag) 设置。</p>\n<p>最后放上各个阶段的注册表 EUPP 项导出文件供参考 <a href=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie11-eupp-registry.zip\" title=\"IE11 EUPP Registry Settings Export\">IE11 EUPP Registry Settings Export</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><blockquote>\n<p>北京时间2015年9月24日，美国华盛顿州雷德蒙德，百度与微软正式宣布战略合作，百度将成为中国市场上Windows 10 Microsoft Edge浏览器的默认主页和搜索引擎，带给用户更加便捷的搜索服务。同时，百度也将通过“Windows 10直通车”提供Windows 10下载升级服务。</p>\n</blockquote>\n<h4 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h4><p>以上是来自微软官方消息，不过最近有部分使用 IE11 的用户发现，启动浏览器会发现默认主页被重定向到了百度带尾巴的首页 <a href=\"https://www.baidu.com/?tn=80035161_1_dg\">https://www.baidu.com/?tn=80035161_1_dg，</a> 而默认的搜索引擎也被改成了百度，而且更过分的是，你还无法修改默认主页，一旦修改就会出现“由于主页设置已损坏， Internet Explorer 重置了你的主页。你是否要将主页改为……”，每次打开 IE 都会出现这样的提示，甚至重装系统依然如此。</p>\n<p><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg\" alt=\"主页设置已损坏\"></p>\n<p>这既不是 DNS 劫持，也不是啥恶意软件，这个微软官方推行的浏览器保护机制，只不过落地在国内，默认主页和搜索引擎提供者变成了百度，谁让 Bing 不争气啊。</p></body></html>","more":"<html><head></head><body><h4 id=\"分析\"><a href=\"#分析\" class=\"headerlink\" title=\"分析\"></a>分析</h4><p>这些受影响的 IE11 在启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新部分设置，如下图：<br><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg\" alt=\"Fiddler抓包-IE启动\"></p>\n<p>在更改默认主页的时候，也同样有去访问 ieonline.microsoft.com<br><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg\" alt=\"Fiddler抓包-更改IE主页\"></p>\n<h4 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h4><p>通过 Fiddler 抓包和 ProcMon 分析，找到以下解决方法：</p>\n<ol>\n<li>首先编辑本机hosts文件，在其中添加<strong>127.0.0.1 ieonline.microsoft.com</strong></li>\n<li>打开注册表编辑器，找到 <strong>[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer]<strong>，删除</strong>EUPP</strong>项</li>\n<li>打开注册表编辑器，找到 <strong>[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl]<strong>，在下面新建项</strong>FEATURE_EUPP_GLOBAL_FORCE_DISABLE</strong>，然后在这个项下面新建一个 <strong>DWORD32</strong> 值，键值名称为 <strong>iexplorer.exe</strong> ，键值改成1<br>注册表文件如下：<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windows Registry Editor Version 5.00</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_EUPP_GLOBAL_FORCE_DISABLE]</span><br><span class=\"line\">\"iexplorer.exe\"=dword:00000001</span><br></pre></td></tr></tbody></table></figure></li>\n<li>之后再去修改 IE 默认主页就可以了</li>\n<li>这样修改之后，实际上在注册表中 HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer 下面还是会创建 EUPP 项，不过会少了一些东西，只剩下一个 叫 RId 的字符串值，暂时不知道有没有别的啥影响，强迫症患者可以用这个注册表文件还原成原始值<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Windows Registry Editor Version 5.00</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP]</span><br><span class=\"line\">\"RId\"=\"{0E742E0E-7B2B-4372-84A0-507D6539A665}\"</span><br><span class=\"line\">\"ChangeNotice\"=dword:00000002</span><br><span class=\"line\"></span><br><span class=\"line\">[HKEY_CURRENT_USER\\SOFTWARE\\Microsoft\\Internet Explorer\\EUPP\\DSP]</span><br><span class=\"line\">\"ChangeNotice\"=dword:00000002</span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"结论\"><a href=\"#结论\" class=\"headerlink\" title=\"结论:\"></a>结论:</h4>产生这个问题的原因是 IE 启动的时候，会通过 ieonline.microsoft.com 上的 webservice 更新 EUPP 键值内容，其中最关键的是 BackupHomePage 和子项 DSP 下面的 BackupDefaultSearchScope 的这两个二进制值锁定主页和搜索提供程序的 URL，新安装的系统里面，BackupHomePage和 BackupDefaultSearchScope 键值还没有被创建。之后一旦可以联网，IE 会更新注册表，从而锁定主页和搜索提供程序，而且这些二进制值是加密的，有兴趣的可以参考这篇文章：<a href=\"http://bbs.pediy.com/thread-196517.htm\">http://bbs.pediy.com/thread-196517.htm</a></li>\n</ol>\n<p>所以和 Windows 10 的版本或者 IE 补丁程序无关，此方法在 Win10 LTSB 中文 64 位 1607 版本上测试通过。</p>\n<h4 id=\"2017年9月14日更新：\"><a href=\"#2017年9月14日更新：\" class=\"headerlink\" title=\"2017年9月14日更新：\"></a>2017年9月14日更新：</h4><p><strong>貌似这两天微软已经把 EUPP 的 webservice 做了更新，不再强制修改成百度了，所以即使你不应用上面的注册表和 hosts 文件修改，也可以像以前一样任意修改默认主页了。</strong><br>另1：如果是单单通过 hosts 文件屏蔽 ieonline.microsoft.com 的，要取消这个屏蔽，否则你的IE默认主页会锁定在屏蔽ieonline.microsoft.com之前的设定，无法修改成新的。<br><img src=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg\" alt=\"修改hosts文件后更改IE主页\"><br>另2：从 ieonline.microsoft.com 拿到的 ChangeNotice 的值在9月14日之后也有了变化，以前会被重置成2，现在是0,从名字猜测来看应该是提示主页设置被更改的旗标 (flag) 设置。</p>\n<p>最后放上各个阶段的注册表 EUPP 项导出文件供参考 <a href=\"/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie11-eupp-registry.zip\" title=\"IE11 EUPP Registry Settings Export\">IE11 EUPP Registry Settings Export</a></p></body></html>"},{"title":"如何从命令行获取电脑的序列号","date":"2018-09-20T07:10:11.000Z","keywords":"Windows, SerialNumber，WMIC，Command","description":"序列号获取的方式有很多种，最直接的当然是直接在电脑的外观标签上查找，也可以在 BIOS 中查询，或者利用品牌机官方的工具来查询。不过，在某些特殊的场景下，也许你也想使用命令行来获得机器的序列号信息。","_content":"\n序列号获取的方式有很多种，最直接的当然是直接在电脑的外观标签上查找，也可以在 BIOS 中查询，或者利用品牌机官方的工具来查询。不过，在某些特殊的场景下，也许你也想使用命令行来获得机器的序列号信息。\n\n那么，以下这些也许可以帮到你：\n\n#### Windows\n`wmic bios get serialnumber`\n\n#### Mac OS X\n`ioreg -l | grep IOPlatformSerialNumber`\n\n#### Linux\n`sudo dmidecode -t system | grep Serial`\n\n##### 补充说明\n这条命令可以查到电脑的型号：\n`wmic csproduct get name`\n\n或者你也可以这样来查询电脑型号以及序列号\n`wmic csproduct get identifyingnumber,name`\n\n以上命令并不适用于所有的电脑，有时你也可见到这样的返回值：\n\n- SerialNumber\nTo Be Filled By O.E.M.\n\n- SerialNumber\n0\n\n这些都是因为制造商没有将信息录入正确造成的。\n\n##### 一些有用的 WMIC 查询\n| Name | Queries | \n| - | - |\n| baseboard | get Manufacturer, Model, Name, PartNumber, slotlayout, serialnumber, poweredon |\n| bios | get name, version, serialnumber |\n| bootconfig | get BootDirectory, Caption, TempDirectory, Lastdrive |\n| cdrom | get Name, Drive, Volumename |\n| computersystem | get Name, domain, Manufacturer, Model, NumberofProcessors, PrimaryOwnerName,Username, Roles, totalphysicalmemory /format:list |\n| cpu | get Name, Caption, MaxClockSpeed, DeviceID, Status |\n| datafile | where name=’c:\\boot.ini’ get Archive, FileSize, FileType, InstallDate, Readable, Writeable, System, Version |\n| dcomapp | get Name, AppID /format:list |\n| desktop | get Name, ScreenSaverExecutable, ScreenSaverActive, Wallpaper /format:list |\n| desktopmonitor | get screenheight, screenwidth |\n| diskdrive | get Name, Manufacturer, Model, InterfaceType, MediaLoaded, MediaType |\n| diskquota | get User, Warninglimit, DiskSpaceUsed, QuotaVolume |\n| environment | get Description, VariableValue |\n| fsdir | where name=’c:\\windows’ get Archive, CreationDate, LastModified, Readable, Writeable, System, Hidden, Status |\n| group | get Caption, InstallDate, LocalAccount, Domain, SID, Status |\n| idecontroller | get Name, Manufacturer, DeviceID, Status |\n| irq | get Name, Status |\n| job | get Name, Owner, DaysOfMonth, DaysOfWeek, ElapsedTime, JobStatus, StartTime, Status |\n| loadorder | get Name, DriverEnabled, GroupOrder, Status |\n| logicaldisk | get Name, Compressed, Description, DriveType, FileSystem, FreeSpace, SupportsDiskQuotas, VolumeDirty, VolumeName |\n| memcache | get Name, BlockSize, Purpose, MaxCacheSize, Status |\n| memlogical | get AvailableVirtualMemory, TotalPageFileSpace, TotalPhysicalMemory, TotalVirtualMemory |\n| memphysical | get Manufacturer, Model, SerialNumber, MaxCapacity, MemoryDevices |\n| netclient | get Caption, Name, Manufacturer, Status |\n| netlogin | get Name, Fullname, ScriptPath, Profile, UserID, NumberOfLogons, PasswordAge, LogonServer, HomeDirectory, PrimaryGroupID |\n| netprotocol | get Caption, Description, GuaranteesSequencing, SupportsBroadcasting, SupportsEncryption, Status |\n| netuse | get Caption, DisplayType, LocalName, Name, ProviderName, Status |\n| nic | get AdapterType, AutoSense, Name, Installed, MACAddress, PNPDeviceID,PowerManagementSupported, Speed, StatusInfo |\n| nicconfig | get MACAddress, DefaultIPGateway, IPAddress, IPSubnet, DNSHostName, DNSDomain |\n| nicconfig | get MACAddress, IPAddress, DHCPEnabled, DHCPLeaseExpires, DHCPLeaseObtained, DHCPServer |\n| nicconfig | get MACAddress, IPAddress, DNSHostName, DNSDomain, DNSDomainSuffixSearchOrder, DNSEnabledForWINSResolution, DNSServerSearchOrder |\n| nicconfig | get MACAddress, IPAddress, WINSPrimaryServer, WINSSecondaryServer, WINSEnableLMHostsLookup, WINSHostLookupFile |\n| ntdomain | get Caption, ClientSiteName, DomainControllerAddress, DomainControllerName, Roles, Status |\n| ntevent | where (LogFile=’system’ and SourceName=’W32Time’) get Message, TimeGenerated |\n| ntevent | where (LogFile=’system’ and SourceName=’W32Time’ and Message like ‘%timesource%’) get Message, TimeGenerated |\n| ntevent | where (LogFile=’system’ and SourceName=’W32Time’ and EventCode!=’29’) get TimeGenerated, EventCode, Message |\n| onboarddevice | get Description, DeviceType, Enabled, Status |\n| os | get Version, Caption, CountryCode, CSName, Description, InstallDate, SerialNumber, ServicePackMajorVersion, WindowsDirectory /format:list |\n| os | get CurrentTimeZone, FreePhysicalMemory, FreeVirtualMemory, LastBootUpTime, NumberofProcesses, NumberofUsers, Organization, RegisteredUser, Status |\n| pagefile | get Caption, CurrentUsage, Status, TempPageFile |\n| pagefileset | get Name, InitialSize, MaximumSize |\n| partition | get Caption, Size, PrimaryPartition, Status, Type |\n| printer | get DeviceID, DriverName, Hidden, Name, PortName, PowerManagementSupported, PrintJobDataType, VerticalResolution, Horizontalresolution |\n| printjob | get Description, Document, ElapsedTime, HostPrintQueue, JobID, JobStatus, Name, Notify, Owner, TimeSubmitted, TotalPages |\n| process | get Caption, CommandLine, Handle, HandleCount, PageFaults, PageFileUsage, PArentProcessId, ProcessId, ThreadCount |\n| product | get Description, InstallDate, Name, Vendor, Version |\n| qfe | get description, FixComments, HotFixID, InstalledBy, InstalledOn, ServicePackInEffect |\n| quotasetting | get Caption, DefaultLimit, Description, DefaultWarningLimit, SettingID, State |\n|recoveros | get AutoReboot, DebugFilePath, WriteDebugInfo, WriteToSystemLog |\n| Registry | get CurrentSize, MaximumSize, ProposedSize, Status |\n| scsicontroller | get Caption, DeviceID, Manufacturer, PNPDeviceID |\n| server | get ErrorsAccessPermissions, ErrorsGrantedAccess, ErrorsLogon, ErrorsSystem, FilesOpen, FileDirectorySearches |\n| service | get Name, Caption, State, ServiceType, StartMode, pathname |\n| share | get name, path, Status |\n| sounddev | get Caption, DeviceID, PNPDeviceID, Manufacturer, Status |\n| startup | get Caption, Location, Command |\n| sysaccount | get Caption, Domain, Name, SID, SIDType, Status |\n| sysdriver | get Caption, Name, PathName, ServiceType, State, Status |\n| systemenclosure | get Caption, Height, Depth, Manufacturer, Model, SMBIOSAssetTag, AudibleAlarm, SecurityStatus, SecurityBreach, PoweredOn, NumberOfPowerCords |\n| systemslot | get Number, SlotDesignation, Status, SupportsHotPlug, Version, CurrentUsage, ConnectorPinout |\n| tapedrive | get Name, Capabilities, Compression, Description, MediaType, NeedsCleaning, Status, StatusInfo |\n| timezone | get Caption, Bias, DaylightBias, DaylightName, StandardName |\n| useraccount | get AccountType, Description, Domain, Disabled, LocalAccount, Lockout, PasswordChangeable, PasswordExpires, PasswordRequired, SID |\n| memorychip | get BankLabel, Capacity, Caption, CreationClassName, DataWidth, Description, Devicelocator, FormFactor, HotSwappable, InstallDate, InterleaveDataDepth, InterleavePosition, Manufacturer, MemoryType, Model, Name, OtherIdentifyingInfo, PartNumber, PositionInRow, PoweredOn, Removable, Replaceable, SerialNumber, SKU, Speed, Status, Tag, TotalWidth, TypeDetail, Version |\n","source":"_posts/how-to-retrieve-computer-serial-number-from-command-line.md","raw":"---\ntitle: 如何从命令行获取电脑的序列号\ntags:\n  - Windows\n  - WMIC\ncategories:\n  - Microsoft\n  - Windows\ndate: 2018-09-20 15:10:11\nkeywords: Windows, SerialNumber，WMIC，Command\ndescription: 序列号获取的方式有很多种，最直接的当然是直接在电脑的外观标签上查找，也可以在 BIOS 中查询，或者利用品牌机官方的工具来查询。不过，在某些特殊的场景下，也许你也想使用命令行来获得机器的序列号信息。\n---\n\n序列号获取的方式有很多种，最直接的当然是直接在电脑的外观标签上查找，也可以在 BIOS 中查询，或者利用品牌机官方的工具来查询。不过，在某些特殊的场景下，也许你也想使用命令行来获得机器的序列号信息。\n\n那么，以下这些也许可以帮到你：\n\n#### Windows\n`wmic bios get serialnumber`\n\n#### Mac OS X\n`ioreg -l | grep IOPlatformSerialNumber`\n\n#### Linux\n`sudo dmidecode -t system | grep Serial`\n\n##### 补充说明\n这条命令可以查到电脑的型号：\n`wmic csproduct get name`\n\n或者你也可以这样来查询电脑型号以及序列号\n`wmic csproduct get identifyingnumber,name`\n\n以上命令并不适用于所有的电脑，有时你也可见到这样的返回值：\n\n- SerialNumber\nTo Be Filled By O.E.M.\n\n- SerialNumber\n0\n\n这些都是因为制造商没有将信息录入正确造成的。\n\n##### 一些有用的 WMIC 查询\n| Name | Queries | \n| - | - |\n| baseboard | get Manufacturer, Model, Name, PartNumber, slotlayout, serialnumber, poweredon |\n| bios | get name, version, serialnumber |\n| bootconfig | get BootDirectory, Caption, TempDirectory, Lastdrive |\n| cdrom | get Name, Drive, Volumename |\n| computersystem | get Name, domain, Manufacturer, Model, NumberofProcessors, PrimaryOwnerName,Username, Roles, totalphysicalmemory /format:list |\n| cpu | get Name, Caption, MaxClockSpeed, DeviceID, Status |\n| datafile | where name=’c:\\boot.ini’ get Archive, FileSize, FileType, InstallDate, Readable, Writeable, System, Version |\n| dcomapp | get Name, AppID /format:list |\n| desktop | get Name, ScreenSaverExecutable, ScreenSaverActive, Wallpaper /format:list |\n| desktopmonitor | get screenheight, screenwidth |\n| diskdrive | get Name, Manufacturer, Model, InterfaceType, MediaLoaded, MediaType |\n| diskquota | get User, Warninglimit, DiskSpaceUsed, QuotaVolume |\n| environment | get Description, VariableValue |\n| fsdir | where name=’c:\\windows’ get Archive, CreationDate, LastModified, Readable, Writeable, System, Hidden, Status |\n| group | get Caption, InstallDate, LocalAccount, Domain, SID, Status |\n| idecontroller | get Name, Manufacturer, DeviceID, Status |\n| irq | get Name, Status |\n| job | get Name, Owner, DaysOfMonth, DaysOfWeek, ElapsedTime, JobStatus, StartTime, Status |\n| loadorder | get Name, DriverEnabled, GroupOrder, Status |\n| logicaldisk | get Name, Compressed, Description, DriveType, FileSystem, FreeSpace, SupportsDiskQuotas, VolumeDirty, VolumeName |\n| memcache | get Name, BlockSize, Purpose, MaxCacheSize, Status |\n| memlogical | get AvailableVirtualMemory, TotalPageFileSpace, TotalPhysicalMemory, TotalVirtualMemory |\n| memphysical | get Manufacturer, Model, SerialNumber, MaxCapacity, MemoryDevices |\n| netclient | get Caption, Name, Manufacturer, Status |\n| netlogin | get Name, Fullname, ScriptPath, Profile, UserID, NumberOfLogons, PasswordAge, LogonServer, HomeDirectory, PrimaryGroupID |\n| netprotocol | get Caption, Description, GuaranteesSequencing, SupportsBroadcasting, SupportsEncryption, Status |\n| netuse | get Caption, DisplayType, LocalName, Name, ProviderName, Status |\n| nic | get AdapterType, AutoSense, Name, Installed, MACAddress, PNPDeviceID,PowerManagementSupported, Speed, StatusInfo |\n| nicconfig | get MACAddress, DefaultIPGateway, IPAddress, IPSubnet, DNSHostName, DNSDomain |\n| nicconfig | get MACAddress, IPAddress, DHCPEnabled, DHCPLeaseExpires, DHCPLeaseObtained, DHCPServer |\n| nicconfig | get MACAddress, IPAddress, DNSHostName, DNSDomain, DNSDomainSuffixSearchOrder, DNSEnabledForWINSResolution, DNSServerSearchOrder |\n| nicconfig | get MACAddress, IPAddress, WINSPrimaryServer, WINSSecondaryServer, WINSEnableLMHostsLookup, WINSHostLookupFile |\n| ntdomain | get Caption, ClientSiteName, DomainControllerAddress, DomainControllerName, Roles, Status |\n| ntevent | where (LogFile=’system’ and SourceName=’W32Time’) get Message, TimeGenerated |\n| ntevent | where (LogFile=’system’ and SourceName=’W32Time’ and Message like ‘%timesource%’) get Message, TimeGenerated |\n| ntevent | where (LogFile=’system’ and SourceName=’W32Time’ and EventCode!=’29’) get TimeGenerated, EventCode, Message |\n| onboarddevice | get Description, DeviceType, Enabled, Status |\n| os | get Version, Caption, CountryCode, CSName, Description, InstallDate, SerialNumber, ServicePackMajorVersion, WindowsDirectory /format:list |\n| os | get CurrentTimeZone, FreePhysicalMemory, FreeVirtualMemory, LastBootUpTime, NumberofProcesses, NumberofUsers, Organization, RegisteredUser, Status |\n| pagefile | get Caption, CurrentUsage, Status, TempPageFile |\n| pagefileset | get Name, InitialSize, MaximumSize |\n| partition | get Caption, Size, PrimaryPartition, Status, Type |\n| printer | get DeviceID, DriverName, Hidden, Name, PortName, PowerManagementSupported, PrintJobDataType, VerticalResolution, Horizontalresolution |\n| printjob | get Description, Document, ElapsedTime, HostPrintQueue, JobID, JobStatus, Name, Notify, Owner, TimeSubmitted, TotalPages |\n| process | get Caption, CommandLine, Handle, HandleCount, PageFaults, PageFileUsage, PArentProcessId, ProcessId, ThreadCount |\n| product | get Description, InstallDate, Name, Vendor, Version |\n| qfe | get description, FixComments, HotFixID, InstalledBy, InstalledOn, ServicePackInEffect |\n| quotasetting | get Caption, DefaultLimit, Description, DefaultWarningLimit, SettingID, State |\n|recoveros | get AutoReboot, DebugFilePath, WriteDebugInfo, WriteToSystemLog |\n| Registry | get CurrentSize, MaximumSize, ProposedSize, Status |\n| scsicontroller | get Caption, DeviceID, Manufacturer, PNPDeviceID |\n| server | get ErrorsAccessPermissions, ErrorsGrantedAccess, ErrorsLogon, ErrorsSystem, FilesOpen, FileDirectorySearches |\n| service | get Name, Caption, State, ServiceType, StartMode, pathname |\n| share | get name, path, Status |\n| sounddev | get Caption, DeviceID, PNPDeviceID, Manufacturer, Status |\n| startup | get Caption, Location, Command |\n| sysaccount | get Caption, Domain, Name, SID, SIDType, Status |\n| sysdriver | get Caption, Name, PathName, ServiceType, State, Status |\n| systemenclosure | get Caption, Height, Depth, Manufacturer, Model, SMBIOSAssetTag, AudibleAlarm, SecurityStatus, SecurityBreach, PoweredOn, NumberOfPowerCords |\n| systemslot | get Number, SlotDesignation, Status, SupportsHotPlug, Version, CurrentUsage, ConnectorPinout |\n| tapedrive | get Name, Capabilities, Compression, Description, MediaType, NeedsCleaning, Status, StatusInfo |\n| timezone | get Caption, Bias, DaylightBias, DaylightName, StandardName |\n| useraccount | get AccountType, Description, Domain, Disabled, LocalAccount, Lockout, PasswordChangeable, PasswordExpires, PasswordRequired, SID |\n| memorychip | get BankLabel, Capacity, Caption, CreationClassName, DataWidth, Description, Devicelocator, FormFactor, HotSwappable, InstallDate, InterleaveDataDepth, InterleavePosition, Manufacturer, MemoryType, Model, Name, OtherIdentifyingInfo, PartNumber, PositionInRow, PoweredOn, Removable, Replaceable, SerialNumber, SKU, Speed, Status, Tag, TotalWidth, TypeDetail, Version |\n","slug":"how-to-retrieve-computer-serial-number-from-command-line","published":1,"updated":"2018-09-29T08:07:22.212Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku50041k84s8jd00cri","content":"<html><head></head><body><p>序列号获取的方式有很多种，最直接的当然是直接在电脑的外观标签上查找，也可以在 BIOS 中查询，或者利用品牌机官方的工具来查询。不过，在某些特殊的场景下，也许你也想使用命令行来获得机器的序列号信息。</p>\n<p>那么，以下这些也许可以帮到你：</p>\n<h4 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h4><p><code>wmic bios get serialnumber</code></p>\n<h4 id=\"Mac-OS-X\"><a href=\"#Mac-OS-X\" class=\"headerlink\" title=\"Mac OS X\"></a>Mac OS X</h4><p><code>ioreg -l | grep IOPlatformSerialNumber</code></p>\n<h4 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h4><p><code>sudo dmidecode -t system | grep Serial</code></p>\n<h5 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h5><p>这条命令可以查到电脑的型号：<br><code>wmic csproduct get name</code></p>\n<p>或者你也可以这样来查询电脑型号以及序列号<br><code>wmic csproduct get identifyingnumber,name</code></p>\n<p>以上命令并不适用于所有的电脑，有时你也可见到这样的返回值：</p>\n<ul>\n<li><p>SerialNumber<br>To Be Filled By O.E.M.</p>\n</li>\n<li><p>SerialNumber<br>0</p>\n</li>\n</ul>\n<p>这些都是因为制造商没有将信息录入正确造成的。</p>\n<h5 id=\"一些有用的-WMIC-查询\"><a href=\"#一些有用的-WMIC-查询\" class=\"headerlink\" title=\"一些有用的 WMIC 查询\"></a>一些有用的 WMIC 查询</h5><table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Queries</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>baseboard</td>\n<td>get Manufacturer, Model, Name, PartNumber, slotlayout, serialnumber, poweredon</td>\n</tr>\n<tr>\n<td>bios</td>\n<td>get name, version, serialnumber</td>\n</tr>\n<tr>\n<td>bootconfig</td>\n<td>get BootDirectory, Caption, TempDirectory, Lastdrive</td>\n</tr>\n<tr>\n<td>cdrom</td>\n<td>get Name, Drive, Volumename</td>\n</tr>\n<tr>\n<td>computersystem</td>\n<td>get Name, domain, Manufacturer, Model, NumberofProcessors, PrimaryOwnerName,Username, Roles, totalphysicalmemory /format:list</td>\n</tr>\n<tr>\n<td>cpu</td>\n<td>get Name, Caption, MaxClockSpeed, DeviceID, Status</td>\n</tr>\n<tr>\n<td>datafile</td>\n<td>where name=’c:\\boot.ini’ get Archive, FileSize, FileType, InstallDate, Readable, Writeable, System, Version</td>\n</tr>\n<tr>\n<td>dcomapp</td>\n<td>get Name, AppID /format:list</td>\n</tr>\n<tr>\n<td>desktop</td>\n<td>get Name, ScreenSaverExecutable, ScreenSaverActive, Wallpaper /format:list</td>\n</tr>\n<tr>\n<td>desktopmonitor</td>\n<td>get screenheight, screenwidth</td>\n</tr>\n<tr>\n<td>diskdrive</td>\n<td>get Name, Manufacturer, Model, InterfaceType, MediaLoaded, MediaType</td>\n</tr>\n<tr>\n<td>diskquota</td>\n<td>get User, Warninglimit, DiskSpaceUsed, QuotaVolume</td>\n</tr>\n<tr>\n<td>environment</td>\n<td>get Description, VariableValue</td>\n</tr>\n<tr>\n<td>fsdir</td>\n<td>where name=’c:\\windows’ get Archive, CreationDate, LastModified, Readable, Writeable, System, Hidden, Status</td>\n</tr>\n<tr>\n<td>group</td>\n<td>get Caption, InstallDate, LocalAccount, Domain, SID, Status</td>\n</tr>\n<tr>\n<td>idecontroller</td>\n<td>get Name, Manufacturer, DeviceID, Status</td>\n</tr>\n<tr>\n<td>irq</td>\n<td>get Name, Status</td>\n</tr>\n<tr>\n<td>job</td>\n<td>get Name, Owner, DaysOfMonth, DaysOfWeek, ElapsedTime, JobStatus, StartTime, Status</td>\n</tr>\n<tr>\n<td>loadorder</td>\n<td>get Name, DriverEnabled, GroupOrder, Status</td>\n</tr>\n<tr>\n<td>logicaldisk</td>\n<td>get Name, Compressed, Description, DriveType, FileSystem, FreeSpace, SupportsDiskQuotas, VolumeDirty, VolumeName</td>\n</tr>\n<tr>\n<td>memcache</td>\n<td>get Name, BlockSize, Purpose, MaxCacheSize, Status</td>\n</tr>\n<tr>\n<td>memlogical</td>\n<td>get AvailableVirtualMemory, TotalPageFileSpace, TotalPhysicalMemory, TotalVirtualMemory</td>\n</tr>\n<tr>\n<td>memphysical</td>\n<td>get Manufacturer, Model, SerialNumber, MaxCapacity, MemoryDevices</td>\n</tr>\n<tr>\n<td>netclient</td>\n<td>get Caption, Name, Manufacturer, Status</td>\n</tr>\n<tr>\n<td>netlogin</td>\n<td>get Name, Fullname, ScriptPath, Profile, UserID, NumberOfLogons, PasswordAge, LogonServer, HomeDirectory, PrimaryGroupID</td>\n</tr>\n<tr>\n<td>netprotocol</td>\n<td>get Caption, Description, GuaranteesSequencing, SupportsBroadcasting, SupportsEncryption, Status</td>\n</tr>\n<tr>\n<td>netuse</td>\n<td>get Caption, DisplayType, LocalName, Name, ProviderName, Status</td>\n</tr>\n<tr>\n<td>nic</td>\n<td>get AdapterType, AutoSense, Name, Installed, MACAddress, PNPDeviceID,PowerManagementSupported, Speed, StatusInfo</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, DefaultIPGateway, IPAddress, IPSubnet, DNSHostName, DNSDomain</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, IPAddress, DHCPEnabled, DHCPLeaseExpires, DHCPLeaseObtained, DHCPServer</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, IPAddress, DNSHostName, DNSDomain, DNSDomainSuffixSearchOrder, DNSEnabledForWINSResolution, DNSServerSearchOrder</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, IPAddress, WINSPrimaryServer, WINSSecondaryServer, WINSEnableLMHostsLookup, WINSHostLookupFile</td>\n</tr>\n<tr>\n<td>ntdomain</td>\n<td>get Caption, ClientSiteName, DomainControllerAddress, DomainControllerName, Roles, Status</td>\n</tr>\n<tr>\n<td>ntevent</td>\n<td>where (LogFile=’system’ and SourceName=’W32Time’) get Message, TimeGenerated</td>\n</tr>\n<tr>\n<td>ntevent</td>\n<td>where (LogFile=’system’ and SourceName=’W32Time’ and Message like ‘%timesource%’) get Message, TimeGenerated</td>\n</tr>\n<tr>\n<td>ntevent</td>\n<td>where (LogFile=’system’ and SourceName=’W32Time’ and EventCode!=’29’) get TimeGenerated, EventCode, Message</td>\n</tr>\n<tr>\n<td>onboarddevice</td>\n<td>get Description, DeviceType, Enabled, Status</td>\n</tr>\n<tr>\n<td>os</td>\n<td>get Version, Caption, CountryCode, CSName, Description, InstallDate, SerialNumber, ServicePackMajorVersion, WindowsDirectory /format:list</td>\n</tr>\n<tr>\n<td>os</td>\n<td>get CurrentTimeZone, FreePhysicalMemory, FreeVirtualMemory, LastBootUpTime, NumberofProcesses, NumberofUsers, Organization, RegisteredUser, Status</td>\n</tr>\n<tr>\n<td>pagefile</td>\n<td>get Caption, CurrentUsage, Status, TempPageFile</td>\n</tr>\n<tr>\n<td>pagefileset</td>\n<td>get Name, InitialSize, MaximumSize</td>\n</tr>\n<tr>\n<td>partition</td>\n<td>get Caption, Size, PrimaryPartition, Status, Type</td>\n</tr>\n<tr>\n<td>printer</td>\n<td>get DeviceID, DriverName, Hidden, Name, PortName, PowerManagementSupported, PrintJobDataType, VerticalResolution, Horizontalresolution</td>\n</tr>\n<tr>\n<td>printjob</td>\n<td>get Description, Document, ElapsedTime, HostPrintQueue, JobID, JobStatus, Name, Notify, Owner, TimeSubmitted, TotalPages</td>\n</tr>\n<tr>\n<td>process</td>\n<td>get Caption, CommandLine, Handle, HandleCount, PageFaults, PageFileUsage, PArentProcessId, ProcessId, ThreadCount</td>\n</tr>\n<tr>\n<td>product</td>\n<td>get Description, InstallDate, Name, Vendor, Version</td>\n</tr>\n<tr>\n<td>qfe</td>\n<td>get description, FixComments, HotFixID, InstalledBy, InstalledOn, ServicePackInEffect</td>\n</tr>\n<tr>\n<td>quotasetting</td>\n<td>get Caption, DefaultLimit, Description, DefaultWarningLimit, SettingID, State</td>\n</tr>\n<tr>\n<td>recoveros</td>\n<td>get AutoReboot, DebugFilePath, WriteDebugInfo, WriteToSystemLog</td>\n</tr>\n<tr>\n<td>Registry</td>\n<td>get CurrentSize, MaximumSize, ProposedSize, Status</td>\n</tr>\n<tr>\n<td>scsicontroller</td>\n<td>get Caption, DeviceID, Manufacturer, PNPDeviceID</td>\n</tr>\n<tr>\n<td>server</td>\n<td>get ErrorsAccessPermissions, ErrorsGrantedAccess, ErrorsLogon, ErrorsSystem, FilesOpen, FileDirectorySearches</td>\n</tr>\n<tr>\n<td>service</td>\n<td>get Name, Caption, State, ServiceType, StartMode, pathname</td>\n</tr>\n<tr>\n<td>share</td>\n<td>get name, path, Status</td>\n</tr>\n<tr>\n<td>sounddev</td>\n<td>get Caption, DeviceID, PNPDeviceID, Manufacturer, Status</td>\n</tr>\n<tr>\n<td>startup</td>\n<td>get Caption, Location, Command</td>\n</tr>\n<tr>\n<td>sysaccount</td>\n<td>get Caption, Domain, Name, SID, SIDType, Status</td>\n</tr>\n<tr>\n<td>sysdriver</td>\n<td>get Caption, Name, PathName, ServiceType, State, Status</td>\n</tr>\n<tr>\n<td>systemenclosure</td>\n<td>get Caption, Height, Depth, Manufacturer, Model, SMBIOSAssetTag, AudibleAlarm, SecurityStatus, SecurityBreach, PoweredOn, NumberOfPowerCords</td>\n</tr>\n<tr>\n<td>systemslot</td>\n<td>get Number, SlotDesignation, Status, SupportsHotPlug, Version, CurrentUsage, ConnectorPinout</td>\n</tr>\n<tr>\n<td>tapedrive</td>\n<td>get Name, Capabilities, Compression, Description, MediaType, NeedsCleaning, Status, StatusInfo</td>\n</tr>\n<tr>\n<td>timezone</td>\n<td>get Caption, Bias, DaylightBias, DaylightName, StandardName</td>\n</tr>\n<tr>\n<td>useraccount</td>\n<td>get AccountType, Description, Domain, Disabled, LocalAccount, Lockout, PasswordChangeable, PasswordExpires, PasswordRequired, SID</td>\n</tr>\n<tr>\n<td>memorychip</td>\n<td>get BankLabel, Capacity, Caption, CreationClassName, DataWidth, Description, Devicelocator, FormFactor, HotSwappable, InstallDate, InterleaveDataDepth, InterleavePosition, Manufacturer, MemoryType, Model, Name, OtherIdentifyingInfo, PartNumber, PositionInRow, PoweredOn, Removable, Replaceable, SerialNumber, SKU, Speed, Status, Tag, TotalWidth, TypeDetail, Version</td>\n</tr>\n</tbody></table>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>序列号获取的方式有很多种，最直接的当然是直接在电脑的外观标签上查找，也可以在 BIOS 中查询，或者利用品牌机官方的工具来查询。不过，在某些特殊的场景下，也许你也想使用命令行来获得机器的序列号信息。</p>\n<p>那么，以下这些也许可以帮到你：</p>\n<h4 id=\"Windows\"><a href=\"#Windows\" class=\"headerlink\" title=\"Windows\"></a>Windows</h4><p><code>wmic bios get serialnumber</code></p>\n<h4 id=\"Mac-OS-X\"><a href=\"#Mac-OS-X\" class=\"headerlink\" title=\"Mac OS X\"></a>Mac OS X</h4><p><code>ioreg -l | grep IOPlatformSerialNumber</code></p>\n<h4 id=\"Linux\"><a href=\"#Linux\" class=\"headerlink\" title=\"Linux\"></a>Linux</h4><p><code>sudo dmidecode -t system | grep Serial</code></p>\n<h5 id=\"补充说明\"><a href=\"#补充说明\" class=\"headerlink\" title=\"补充说明\"></a>补充说明</h5><p>这条命令可以查到电脑的型号：<br><code>wmic csproduct get name</code></p>\n<p>或者你也可以这样来查询电脑型号以及序列号<br><code>wmic csproduct get identifyingnumber,name</code></p>\n<p>以上命令并不适用于所有的电脑，有时你也可见到这样的返回值：</p>\n<ul>\n<li><p>SerialNumber<br>To Be Filled By O.E.M.</p>\n</li>\n<li><p>SerialNumber<br>0</p>\n</li>\n</ul>\n<p>这些都是因为制造商没有将信息录入正确造成的。</p>\n<h5 id=\"一些有用的-WMIC-查询\"><a href=\"#一些有用的-WMIC-查询\" class=\"headerlink\" title=\"一些有用的 WMIC 查询\"></a>一些有用的 WMIC 查询</h5><table>\n<thead>\n<tr>\n<th>Name</th>\n<th>Queries</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>baseboard</td>\n<td>get Manufacturer, Model, Name, PartNumber, slotlayout, serialnumber, poweredon</td>\n</tr>\n<tr>\n<td>bios</td>\n<td>get name, version, serialnumber</td>\n</tr>\n<tr>\n<td>bootconfig</td>\n<td>get BootDirectory, Caption, TempDirectory, Lastdrive</td>\n</tr>\n<tr>\n<td>cdrom</td>\n<td>get Name, Drive, Volumename</td>\n</tr>\n<tr>\n<td>computersystem</td>\n<td>get Name, domain, Manufacturer, Model, NumberofProcessors, PrimaryOwnerName,Username, Roles, totalphysicalmemory /format:list</td>\n</tr>\n<tr>\n<td>cpu</td>\n<td>get Name, Caption, MaxClockSpeed, DeviceID, Status</td>\n</tr>\n<tr>\n<td>datafile</td>\n<td>where name=’c:\\boot.ini’ get Archive, FileSize, FileType, InstallDate, Readable, Writeable, System, Version</td>\n</tr>\n<tr>\n<td>dcomapp</td>\n<td>get Name, AppID /format:list</td>\n</tr>\n<tr>\n<td>desktop</td>\n<td>get Name, ScreenSaverExecutable, ScreenSaverActive, Wallpaper /format:list</td>\n</tr>\n<tr>\n<td>desktopmonitor</td>\n<td>get screenheight, screenwidth</td>\n</tr>\n<tr>\n<td>diskdrive</td>\n<td>get Name, Manufacturer, Model, InterfaceType, MediaLoaded, MediaType</td>\n</tr>\n<tr>\n<td>diskquota</td>\n<td>get User, Warninglimit, DiskSpaceUsed, QuotaVolume</td>\n</tr>\n<tr>\n<td>environment</td>\n<td>get Description, VariableValue</td>\n</tr>\n<tr>\n<td>fsdir</td>\n<td>where name=’c:\\windows’ get Archive, CreationDate, LastModified, Readable, Writeable, System, Hidden, Status</td>\n</tr>\n<tr>\n<td>group</td>\n<td>get Caption, InstallDate, LocalAccount, Domain, SID, Status</td>\n</tr>\n<tr>\n<td>idecontroller</td>\n<td>get Name, Manufacturer, DeviceID, Status</td>\n</tr>\n<tr>\n<td>irq</td>\n<td>get Name, Status</td>\n</tr>\n<tr>\n<td>job</td>\n<td>get Name, Owner, DaysOfMonth, DaysOfWeek, ElapsedTime, JobStatus, StartTime, Status</td>\n</tr>\n<tr>\n<td>loadorder</td>\n<td>get Name, DriverEnabled, GroupOrder, Status</td>\n</tr>\n<tr>\n<td>logicaldisk</td>\n<td>get Name, Compressed, Description, DriveType, FileSystem, FreeSpace, SupportsDiskQuotas, VolumeDirty, VolumeName</td>\n</tr>\n<tr>\n<td>memcache</td>\n<td>get Name, BlockSize, Purpose, MaxCacheSize, Status</td>\n</tr>\n<tr>\n<td>memlogical</td>\n<td>get AvailableVirtualMemory, TotalPageFileSpace, TotalPhysicalMemory, TotalVirtualMemory</td>\n</tr>\n<tr>\n<td>memphysical</td>\n<td>get Manufacturer, Model, SerialNumber, MaxCapacity, MemoryDevices</td>\n</tr>\n<tr>\n<td>netclient</td>\n<td>get Caption, Name, Manufacturer, Status</td>\n</tr>\n<tr>\n<td>netlogin</td>\n<td>get Name, Fullname, ScriptPath, Profile, UserID, NumberOfLogons, PasswordAge, LogonServer, HomeDirectory, PrimaryGroupID</td>\n</tr>\n<tr>\n<td>netprotocol</td>\n<td>get Caption, Description, GuaranteesSequencing, SupportsBroadcasting, SupportsEncryption, Status</td>\n</tr>\n<tr>\n<td>netuse</td>\n<td>get Caption, DisplayType, LocalName, Name, ProviderName, Status</td>\n</tr>\n<tr>\n<td>nic</td>\n<td>get AdapterType, AutoSense, Name, Installed, MACAddress, PNPDeviceID,PowerManagementSupported, Speed, StatusInfo</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, DefaultIPGateway, IPAddress, IPSubnet, DNSHostName, DNSDomain</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, IPAddress, DHCPEnabled, DHCPLeaseExpires, DHCPLeaseObtained, DHCPServer</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, IPAddress, DNSHostName, DNSDomain, DNSDomainSuffixSearchOrder, DNSEnabledForWINSResolution, DNSServerSearchOrder</td>\n</tr>\n<tr>\n<td>nicconfig</td>\n<td>get MACAddress, IPAddress, WINSPrimaryServer, WINSSecondaryServer, WINSEnableLMHostsLookup, WINSHostLookupFile</td>\n</tr>\n<tr>\n<td>ntdomain</td>\n<td>get Caption, ClientSiteName, DomainControllerAddress, DomainControllerName, Roles, Status</td>\n</tr>\n<tr>\n<td>ntevent</td>\n<td>where (LogFile=’system’ and SourceName=’W32Time’) get Message, TimeGenerated</td>\n</tr>\n<tr>\n<td>ntevent</td>\n<td>where (LogFile=’system’ and SourceName=’W32Time’ and Message like ‘%timesource%’) get Message, TimeGenerated</td>\n</tr>\n<tr>\n<td>ntevent</td>\n<td>where (LogFile=’system’ and SourceName=’W32Time’ and EventCode!=’29’) get TimeGenerated, EventCode, Message</td>\n</tr>\n<tr>\n<td>onboarddevice</td>\n<td>get Description, DeviceType, Enabled, Status</td>\n</tr>\n<tr>\n<td>os</td>\n<td>get Version, Caption, CountryCode, CSName, Description, InstallDate, SerialNumber, ServicePackMajorVersion, WindowsDirectory /format:list</td>\n</tr>\n<tr>\n<td>os</td>\n<td>get CurrentTimeZone, FreePhysicalMemory, FreeVirtualMemory, LastBootUpTime, NumberofProcesses, NumberofUsers, Organization, RegisteredUser, Status</td>\n</tr>\n<tr>\n<td>pagefile</td>\n<td>get Caption, CurrentUsage, Status, TempPageFile</td>\n</tr>\n<tr>\n<td>pagefileset</td>\n<td>get Name, InitialSize, MaximumSize</td>\n</tr>\n<tr>\n<td>partition</td>\n<td>get Caption, Size, PrimaryPartition, Status, Type</td>\n</tr>\n<tr>\n<td>printer</td>\n<td>get DeviceID, DriverName, Hidden, Name, PortName, PowerManagementSupported, PrintJobDataType, VerticalResolution, Horizontalresolution</td>\n</tr>\n<tr>\n<td>printjob</td>\n<td>get Description, Document, ElapsedTime, HostPrintQueue, JobID, JobStatus, Name, Notify, Owner, TimeSubmitted, TotalPages</td>\n</tr>\n<tr>\n<td>process</td>\n<td>get Caption, CommandLine, Handle, HandleCount, PageFaults, PageFileUsage, PArentProcessId, ProcessId, ThreadCount</td>\n</tr>\n<tr>\n<td>product</td>\n<td>get Description, InstallDate, Name, Vendor, Version</td>\n</tr>\n<tr>\n<td>qfe</td>\n<td>get description, FixComments, HotFixID, InstalledBy, InstalledOn, ServicePackInEffect</td>\n</tr>\n<tr>\n<td>quotasetting</td>\n<td>get Caption, DefaultLimit, Description, DefaultWarningLimit, SettingID, State</td>\n</tr>\n<tr>\n<td>recoveros</td>\n<td>get AutoReboot, DebugFilePath, WriteDebugInfo, WriteToSystemLog</td>\n</tr>\n<tr>\n<td>Registry</td>\n<td>get CurrentSize, MaximumSize, ProposedSize, Status</td>\n</tr>\n<tr>\n<td>scsicontroller</td>\n<td>get Caption, DeviceID, Manufacturer, PNPDeviceID</td>\n</tr>\n<tr>\n<td>server</td>\n<td>get ErrorsAccessPermissions, ErrorsGrantedAccess, ErrorsLogon, ErrorsSystem, FilesOpen, FileDirectorySearches</td>\n</tr>\n<tr>\n<td>service</td>\n<td>get Name, Caption, State, ServiceType, StartMode, pathname</td>\n</tr>\n<tr>\n<td>share</td>\n<td>get name, path, Status</td>\n</tr>\n<tr>\n<td>sounddev</td>\n<td>get Caption, DeviceID, PNPDeviceID, Manufacturer, Status</td>\n</tr>\n<tr>\n<td>startup</td>\n<td>get Caption, Location, Command</td>\n</tr>\n<tr>\n<td>sysaccount</td>\n<td>get Caption, Domain, Name, SID, SIDType, Status</td>\n</tr>\n<tr>\n<td>sysdriver</td>\n<td>get Caption, Name, PathName, ServiceType, State, Status</td>\n</tr>\n<tr>\n<td>systemenclosure</td>\n<td>get Caption, Height, Depth, Manufacturer, Model, SMBIOSAssetTag, AudibleAlarm, SecurityStatus, SecurityBreach, PoweredOn, NumberOfPowerCords</td>\n</tr>\n<tr>\n<td>systemslot</td>\n<td>get Number, SlotDesignation, Status, SupportsHotPlug, Version, CurrentUsage, ConnectorPinout</td>\n</tr>\n<tr>\n<td>tapedrive</td>\n<td>get Name, Capabilities, Compression, Description, MediaType, NeedsCleaning, Status, StatusInfo</td>\n</tr>\n<tr>\n<td>timezone</td>\n<td>get Caption, Bias, DaylightBias, DaylightName, StandardName</td>\n</tr>\n<tr>\n<td>useraccount</td>\n<td>get AccountType, Description, Domain, Disabled, LocalAccount, Lockout, PasswordChangeable, PasswordExpires, PasswordRequired, SID</td>\n</tr>\n<tr>\n<td>memorychip</td>\n<td>get BankLabel, Capacity, Caption, CreationClassName, DataWidth, Description, Devicelocator, FormFactor, HotSwappable, InstallDate, InterleaveDataDepth, InterleavePosition, Manufacturer, MemoryType, Model, Name, OtherIdentifyingInfo, PartNumber, PositionInRow, PoweredOn, Removable, Replaceable, SerialNumber, SKU, Speed, Status, Tag, TotalWidth, TypeDetail, Version</td>\n</tr>\n</tbody></table>\n</body></html>"},{"title":"如何在 Exchange 2010 中给密码即将过期用户发送提醒邮件","date":"2018-08-20T07:40:11.000Z","keywords":"AD, VBScript，Exchange，PowerShell","description":"如何在 Exchange 2010 中给密码即将过期用户发送提醒邮件","_content":"\n一般来说，在部署了微软活动目录的企业域环境中，为了安全起见，不会将用户的密码设置为永不过期，通常设置为60天到90天更改一次，相对比较安全。在密码快要过期的时候，用户登录 Windows 时会有提醒修改密码。不过，也会有很多员工根本不去看这个提示甚至忽略掉，一旦员工域帐号的密码过期时间是在公众假期甚至是外地出差期间，那么结果就是包含邮件在内的相关应用系统无法登陆。随之给域管理员的工作带来压力。有各种各样的方法可以减少此种事件发生，一些第三方工具甚至可以开放给员工自助的密码忘记/重设服务，我们这里不做探讨。\n\n<!--more-->\n\n今天要给大家分享的两个脚本，一个通过 VBscript 找出密码快要过期的用户，另外一个使用 PowerShell 给这些用户发送密码过期提醒邮件，通过设置计划任务部署脚本后已经在某企业稳定运行七年时间，经统计可以减少域管理员密码重设次数60%以上，不失为一种简单高效的方案。\n\n\n### PasswordCheck.vbs\n\n``` vbs\n'############################  PasswordCheck.vbs  ################################\n' \tAuthor:\tRandy Zhong\n' \tSource:\thttps://github.com/randyzhong/\n'\tDescription: This script use VBScript to check user's password expiration date.\n'\t\t\t\t If Lastdate equals 7,5,3,2,1, DisplayName,Email,LastDate,Runtime \n'\t\t\t\t will be recorded to OutFile in CSV format.\n'\tVersion:\t1.0.0\n'#################################################################################\n\n'\tChangelog:   \n'\t\t2011.05.11 v1.0.0 - initial release\n\n\n'\tConst VARIABLES - DON'T EDIT\nOn Error Resume Next\nConst ADS_SCOPE_SUBTREE = 2\nConst SEC_IN_DAY = 86400\nConst ADS_UF_DONT_EXPIRE_PASSWD = &h10000\nConst ForWriting = 2\nConst E_ADS_Property_Not_Found = &h8000500D\nConst E_Table_Not_Found = &h80040E37\nConst NanoSEC_IN_DAY = 864E9\nConst TristateTrue = -1\n\n'\tIMPORTANT VARIABLES TO EDIT\nLDAPDomain = \"LDAP://OU=FABRIKAM Users,DC=Fabrikam,DC=com\"\nBiosDomain = \"FABRIKAM\"\nOutFile = \"C:\\PwdCheck\\passexpired.csv\" \n'\tEND OF IMPOTANT VARIABLES TO EDIT\n\n'\tBEGIN OF CODE - DON'T EDIT\nSet objDomainNT = GetObject(\"WinNT://\" & BiosDomain)\n  \tintMaxPwdAge = objDomainNT.Get(\"MaxPasswordAge\")\nIf intMaxPwdAge < 0 Then\n\tWScript.Echo(\"Password never expired!\")\n\tWScript.Quit    \t\t\nElse\n\tintMaxPwdAge = (intMaxPwdAge/SEC_IN_DAY)\nEnd If \n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n    \nSet objConnection = CreateObject(\"ADODB.Connection\")\nSet objCommand =   CreateObject(\"ADODB.Command\")\n\nobjConnection.Provider = \"ADsDSOObject\"\nobjConnection.Open \"Active Directory Provider\"\n\n\nSet objCommand.ActiveConnection = objConnection\nobjCommand.CommandText = _\n    \"Select DisplayName,Mail,userAccountControl,pwdLastSet from '\" & LDAPDomain & _\n        \"' where objectClass = 'user' and objectClass <> 'computer'\" \n\n    \tobjCommand.Properties(\"Page Size\") = 100000\n\tobjCommand.Properties(\"Searchscope\") = ADS_SCOPE_SUBTREE \n\tSet objRecordSet = objCommand.Execute\n\nIF err.number = E_Table_Not_Found Then\n\tWScript.Echo(\"Error Domain!\")\n\tWScript.Quit \nEnd If\n\nobjRecordSet.MoveFirst\n\nSet txtStreamOut = fso.OpenTextFile(OutFile,ForWriting,true,TristateTrue)\n\ntxtStreamOut.WriteLine \"DisplayName,Email,LastDate,Runtime\"\n\nDo Until objRecordSet.EOF    \n  \n\nAccountName = objRecordSet(\"DisplayName\")\nEmailAddress = objRecordSet(\"Mail\")\nAccountControl = objRecordSet(\"userAccountControl\")\npwdLastSet = objRecordSet(\"pwdLastSet\")\npwdLastSet = #1/1/1601# + (pwdLastSet.highpart * 2^32 + pwdLastSet.lowpart) / NanoSEC_IN_DAY + 480 / 1440\n\nIf (AccountControl And ADS_UF_DONT_EXPIRE_PASSWD)=0 Then\n\t\n\tif (AccountControl and 3) <> 2 and err.number <> E_ADS_Property_Not_Found Then\n\t\n\tLastdate = int(intMaxPwdAge-(now-pwdLastSet))\n\t\tif Lastdate = 7 or Lastdate = 5 or (Lastdate < 4 and Lastdate > 0) then\n\t\t\ttxtStreamOut.WriteLine AccountName & \",\" & EmailAddress & \",\" & Lastdate & \",\" & Now\n\t\tEnd If\n\tEnd If\nEnd If \n\nErr.number = 0\n\nobjRecordSet.MoveNext\nLoop\n'WScript.Echo(\"Finished\")\n'\tEnd OF CODE\n```\n\n\n### Sendmail-PassExpired.ps1\n\n\n``` powershell\n########################  Sendmail-PassExpired.ps1  #############################\n#   Author:\tRandy Zhong\n#   Source:\thttps://github.com/randyzhong/\n#   Description: This script uses Send-MailMessage cmdlet to send HTML format \n#                 message with high priority.\n#\t  Version:\t1.0.0\n#################################################################################\n\n#   Changelog:   \n#\t\t  2011.05.11 v1.0.0 - initial release\n\n\n#   Define VARIABLES\n$csvfile = \"C:\\PwdCheck\\passexpired.csv\"\n\n$smtp = \"mail.fabrikam.com\" \n  \n$from = \"Support@fabrikam.com\" \n \n$subject = \"Warning: Your password is about to expire!\"  \n \n#   Read user email address from CSV file and send warning message with high priority\nImport-Csv $csvfile | ForEach-Object {Send-MailMessage -To $_.Email -Subject $subject -From $from -BodyAsHtm -Body (\"<font color='#1F497D'; font-family='Calibri, Tahoma, Arial'>\"+\"Dear&nbsp;\" + $_.DisplayName +\":\" + \"<br />\" +\"<p><font size='4'>Your password will be expired in <font color='red' size='+2'><strong>\"+ $_.LastDate + \"</strong></font> day(s), please change it soon.</font></p>\") -SmtpServer $smtp -Encoding ([System.Text.Encoding]::UTF8) -Priority high}\n```\n### 计划任务设置\n- 新建个计划任务，设置为每天运行一次\n- 第一步运行 PasswordCheck.vbs 生成用户列表，Program/Script 输入 CScript, 参数输入 \"C:\\Pathname\\PasswordCheck.vbs\"\n- 第二步运行 Sendmail-PassExpired.ps1 发送邮件，Program/Script 输入 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe， 附加参数 -command \". 'C:\\PwdCheck\\Sendmail-PassExpired.ps1'\"\n\n### Exchange 服务器设置\nHUB 角色上面把配置了计划任务的服务器 IP 加入允许匿名转发的连接器 IP 地址池\n","source":"_posts/how-to-send-password-expiry-email-with-exchange-2010.md","raw":"---\ntitle: 如何在 Exchange 2010 中给密码即将过期用户发送提醒邮件\ntags:\n  - VBScript\n  - Exchange\n  - PowerShell\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2018-08-20 15:40:11\nkeywords: AD, VBScript，Exchange，PowerShell\ndescription: 如何在 Exchange 2010 中给密码即将过期用户发送提醒邮件\n---\n\n一般来说，在部署了微软活动目录的企业域环境中，为了安全起见，不会将用户的密码设置为永不过期，通常设置为60天到90天更改一次，相对比较安全。在密码快要过期的时候，用户登录 Windows 时会有提醒修改密码。不过，也会有很多员工根本不去看这个提示甚至忽略掉，一旦员工域帐号的密码过期时间是在公众假期甚至是外地出差期间，那么结果就是包含邮件在内的相关应用系统无法登陆。随之给域管理员的工作带来压力。有各种各样的方法可以减少此种事件发生，一些第三方工具甚至可以开放给员工自助的密码忘记/重设服务，我们这里不做探讨。\n\n<!--more-->\n\n今天要给大家分享的两个脚本，一个通过 VBscript 找出密码快要过期的用户，另外一个使用 PowerShell 给这些用户发送密码过期提醒邮件，通过设置计划任务部署脚本后已经在某企业稳定运行七年时间，经统计可以减少域管理员密码重设次数60%以上，不失为一种简单高效的方案。\n\n\n### PasswordCheck.vbs\n\n``` vbs\n'############################  PasswordCheck.vbs  ################################\n' \tAuthor:\tRandy Zhong\n' \tSource:\thttps://github.com/randyzhong/\n'\tDescription: This script use VBScript to check user's password expiration date.\n'\t\t\t\t If Lastdate equals 7,5,3,2,1, DisplayName,Email,LastDate,Runtime \n'\t\t\t\t will be recorded to OutFile in CSV format.\n'\tVersion:\t1.0.0\n'#################################################################################\n\n'\tChangelog:   \n'\t\t2011.05.11 v1.0.0 - initial release\n\n\n'\tConst VARIABLES - DON'T EDIT\nOn Error Resume Next\nConst ADS_SCOPE_SUBTREE = 2\nConst SEC_IN_DAY = 86400\nConst ADS_UF_DONT_EXPIRE_PASSWD = &h10000\nConst ForWriting = 2\nConst E_ADS_Property_Not_Found = &h8000500D\nConst E_Table_Not_Found = &h80040E37\nConst NanoSEC_IN_DAY = 864E9\nConst TristateTrue = -1\n\n'\tIMPORTANT VARIABLES TO EDIT\nLDAPDomain = \"LDAP://OU=FABRIKAM Users,DC=Fabrikam,DC=com\"\nBiosDomain = \"FABRIKAM\"\nOutFile = \"C:\\PwdCheck\\passexpired.csv\" \n'\tEND OF IMPOTANT VARIABLES TO EDIT\n\n'\tBEGIN OF CODE - DON'T EDIT\nSet objDomainNT = GetObject(\"WinNT://\" & BiosDomain)\n  \tintMaxPwdAge = objDomainNT.Get(\"MaxPasswordAge\")\nIf intMaxPwdAge < 0 Then\n\tWScript.Echo(\"Password never expired!\")\n\tWScript.Quit    \t\t\nElse\n\tintMaxPwdAge = (intMaxPwdAge/SEC_IN_DAY)\nEnd If \n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n    \nSet objConnection = CreateObject(\"ADODB.Connection\")\nSet objCommand =   CreateObject(\"ADODB.Command\")\n\nobjConnection.Provider = \"ADsDSOObject\"\nobjConnection.Open \"Active Directory Provider\"\n\n\nSet objCommand.ActiveConnection = objConnection\nobjCommand.CommandText = _\n    \"Select DisplayName,Mail,userAccountControl,pwdLastSet from '\" & LDAPDomain & _\n        \"' where objectClass = 'user' and objectClass <> 'computer'\" \n\n    \tobjCommand.Properties(\"Page Size\") = 100000\n\tobjCommand.Properties(\"Searchscope\") = ADS_SCOPE_SUBTREE \n\tSet objRecordSet = objCommand.Execute\n\nIF err.number = E_Table_Not_Found Then\n\tWScript.Echo(\"Error Domain!\")\n\tWScript.Quit \nEnd If\n\nobjRecordSet.MoveFirst\n\nSet txtStreamOut = fso.OpenTextFile(OutFile,ForWriting,true,TristateTrue)\n\ntxtStreamOut.WriteLine \"DisplayName,Email,LastDate,Runtime\"\n\nDo Until objRecordSet.EOF    \n  \n\nAccountName = objRecordSet(\"DisplayName\")\nEmailAddress = objRecordSet(\"Mail\")\nAccountControl = objRecordSet(\"userAccountControl\")\npwdLastSet = objRecordSet(\"pwdLastSet\")\npwdLastSet = #1/1/1601# + (pwdLastSet.highpart * 2^32 + pwdLastSet.lowpart) / NanoSEC_IN_DAY + 480 / 1440\n\nIf (AccountControl And ADS_UF_DONT_EXPIRE_PASSWD)=0 Then\n\t\n\tif (AccountControl and 3) <> 2 and err.number <> E_ADS_Property_Not_Found Then\n\t\n\tLastdate = int(intMaxPwdAge-(now-pwdLastSet))\n\t\tif Lastdate = 7 or Lastdate = 5 or (Lastdate < 4 and Lastdate > 0) then\n\t\t\ttxtStreamOut.WriteLine AccountName & \",\" & EmailAddress & \",\" & Lastdate & \",\" & Now\n\t\tEnd If\n\tEnd If\nEnd If \n\nErr.number = 0\n\nobjRecordSet.MoveNext\nLoop\n'WScript.Echo(\"Finished\")\n'\tEnd OF CODE\n```\n\n\n### Sendmail-PassExpired.ps1\n\n\n``` powershell\n########################  Sendmail-PassExpired.ps1  #############################\n#   Author:\tRandy Zhong\n#   Source:\thttps://github.com/randyzhong/\n#   Description: This script uses Send-MailMessage cmdlet to send HTML format \n#                 message with high priority.\n#\t  Version:\t1.0.0\n#################################################################################\n\n#   Changelog:   \n#\t\t  2011.05.11 v1.0.0 - initial release\n\n\n#   Define VARIABLES\n$csvfile = \"C:\\PwdCheck\\passexpired.csv\"\n\n$smtp = \"mail.fabrikam.com\" \n  \n$from = \"Support@fabrikam.com\" \n \n$subject = \"Warning: Your password is about to expire!\"  \n \n#   Read user email address from CSV file and send warning message with high priority\nImport-Csv $csvfile | ForEach-Object {Send-MailMessage -To $_.Email -Subject $subject -From $from -BodyAsHtm -Body (\"<font color='#1F497D'; font-family='Calibri, Tahoma, Arial'>\"+\"Dear&nbsp;\" + $_.DisplayName +\":\" + \"<br />\" +\"<p><font size='4'>Your password will be expired in <font color='red' size='+2'><strong>\"+ $_.LastDate + \"</strong></font> day(s), please change it soon.</font></p>\") -SmtpServer $smtp -Encoding ([System.Text.Encoding]::UTF8) -Priority high}\n```\n### 计划任务设置\n- 新建个计划任务，设置为每天运行一次\n- 第一步运行 PasswordCheck.vbs 生成用户列表，Program/Script 输入 CScript, 参数输入 \"C:\\Pathname\\PasswordCheck.vbs\"\n- 第二步运行 Sendmail-PassExpired.ps1 发送邮件，Program/Script 输入 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe， 附加参数 -command \". 'C:\\PwdCheck\\Sendmail-PassExpired.ps1'\"\n\n### Exchange 服务器设置\nHUB 角色上面把配置了计划任务的服务器 IP 加入允许匿名转发的连接器 IP 地址池\n","slug":"how-to-send-password-expiry-email-with-exchange-2010","published":1,"updated":"2018-08-21T07:47:10.676Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku60044k84s2euxhp1k","content":"<html><head></head><body><p>一般来说，在部署了微软活动目录的企业域环境中，为了安全起见，不会将用户的密码设置为永不过期，通常设置为60天到90天更改一次，相对比较安全。在密码快要过期的时候，用户登录 Windows 时会有提醒修改密码。不过，也会有很多员工根本不去看这个提示甚至忽略掉，一旦员工域帐号的密码过期时间是在公众假期甚至是外地出差期间，那么结果就是包含邮件在内的相关应用系统无法登陆。随之给域管理员的工作带来压力。有各种各样的方法可以减少此种事件发生，一些第三方工具甚至可以开放给员工自助的密码忘记/重设服务，我们这里不做探讨。</p>\n<span id=\"more\"></span>\n\n<p>今天要给大家分享的两个脚本，一个通过 VBscript 找出密码快要过期的用户，另外一个使用 PowerShell 给这些用户发送密码过期提醒邮件，通过设置计划任务部署脚本后已经在某企业稳定运行七年时间，经统计可以减少域管理员密码重设次数60%以上，不失为一种简单高效的方案。</p>\n<h3 id=\"PasswordCheck-vbs\"><a href=\"#PasswordCheck-vbs\" class=\"headerlink\" title=\"PasswordCheck.vbs\"></a>PasswordCheck.vbs</h3><figure class=\"highlight vbs\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">'############################  PasswordCheck.vbs  ################################</span></span><br><span class=\"line\"><span class=\"comment\">' \tAuthor:\tRandy Zhong</span></span><br><span class=\"line\"><span class=\"comment\">' \tSource:\thttps://github.com/randyzhong/</span></span><br><span class=\"line\"><span class=\"comment\">'\tDescription: This script use VBScript to check user's password expiration date.</span></span><br><span class=\"line\"><span class=\"comment\">'\t\t\t\t If Lastdate equals 7,5,3,2,1, DisplayName,Email,LastDate,Runtime </span></span><br><span class=\"line\"><span class=\"comment\">'\t\t\t\t will be recorded to OutFile in CSV format.</span></span><br><span class=\"line\"><span class=\"comment\">'\tVersion:\t1.0.0</span></span><br><span class=\"line\"><span class=\"comment\">'#################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tChangelog:   </span></span><br><span class=\"line\"><span class=\"comment\">'\t\t2011.05.11 v1.0.0 - initial release</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tConst VARIABLES - DON'T EDIT</span></span><br><span class=\"line\"><span class=\"keyword\">On</span> <span class=\"keyword\">Error</span> <span class=\"keyword\">Resume</span> <span class=\"keyword\">Next</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> ADS_SCOPE_SUBTREE = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> SEC_IN_DAY = <span class=\"number\">86400</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> ADS_UF_DONT_EXPIRE_PASSWD = &amp;h10000</span><br><span class=\"line\"><span class=\"keyword\">Const</span> ForWriting = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> E_ADS_Property_Not_Found = &amp;h8000500D</span><br><span class=\"line\"><span class=\"keyword\">Const</span> E_Table_Not_Found = &amp;h80040E37</span><br><span class=\"line\"><span class=\"keyword\">Const</span> NanoSEC_IN_DAY = <span class=\"number\">864E9</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> TristateTrue = <span class=\"number\">-1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tIMPORTANT VARIABLES TO EDIT</span></span><br><span class=\"line\">LDAPDomain = <span class=\"string\">\"LDAP://OU=FABRIKAM Users,DC=Fabrikam,DC=com\"</span></span><br><span class=\"line\">BiosDomain = <span class=\"string\">\"FABRIKAM\"</span></span><br><span class=\"line\">OutFile = <span class=\"string\">\"C:\\PwdCheck\\passexpired.csv\"</span> </span><br><span class=\"line\"><span class=\"comment\">'\tEND OF IMPOTANT VARIABLES TO EDIT</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tBEGIN OF CODE - DON'T EDIT</span></span><br><span class=\"line\"><span class=\"keyword\">Set</span> objDomainNT = <span class=\"built_in\">GetObject</span>(<span class=\"string\">\"WinNT://\"</span> &amp; BiosDomain)</span><br><span class=\"line\">  \tintMaxPwdAge = objDomainNT.<span class=\"keyword\">Get</span>(<span class=\"string\">\"MaxPasswordAge\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">If</span> intMaxPwdAge &lt; <span class=\"number\">0</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">\tWScript.Echo(<span class=\"string\">\"Password never expired!\"</span>)</span><br><span class=\"line\">\tWScript.Quit    \t\t</span><br><span class=\"line\"><span class=\"keyword\">Else</span></span><br><span class=\"line\">\tintMaxPwdAge = (intMaxPwdAge/SEC_IN_DAY)</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">If</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> fso = <span class=\"built_in\">CreateObject</span>(<span class=\"string\">\"Scripting.FileSystemObject\"</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">Set</span> objConnection = <span class=\"built_in\">CreateObject</span>(<span class=\"string\">\"ADODB.Connection\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">Set</span> objCommand =   <span class=\"built_in\">CreateObject</span>(<span class=\"string\">\"ADODB.Command\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">objConnection.Provider = <span class=\"string\">\"ADsDSOObject\"</span></span><br><span class=\"line\">objConnection.Open <span class=\"string\">\"Active Directory Provider\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> objCommand.ActiveConnection = objConnection</span><br><span class=\"line\">objCommand.CommandText = _</span><br><span class=\"line\">    <span class=\"string\">\"Select DisplayName,Mail,userAccountControl,pwdLastSet from '\"</span> &amp; LDAPDomain &amp; _</span><br><span class=\"line\">        <span class=\"string\">\"' where objectClass = 'user' and objectClass &lt;&gt; 'computer'\"</span> </span><br><span class=\"line\"></span><br><span class=\"line\">    \tobjCommand.Properties(<span class=\"string\">\"Page Size\"</span>) = <span class=\"number\">100000</span></span><br><span class=\"line\">\tobjCommand.Properties(<span class=\"string\">\"Searchscope\"</span>) = ADS_SCOPE_SUBTREE </span><br><span class=\"line\">\t<span class=\"keyword\">Set</span> objRecordSet = objCommand.<span class=\"keyword\">Execute</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">IF</span> err.number = E_Table_Not_Found <span class=\"keyword\">Then</span></span><br><span class=\"line\">\tWScript.Echo(<span class=\"string\">\"Error Domain!\"</span>)</span><br><span class=\"line\">\tWScript.Quit </span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\"></span><br><span class=\"line\">objRecordSet.MoveFirst</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> txtStreamOut = fso.OpenTextFile(OutFile,ForWriting,<span class=\"literal\">true</span>,TristateTrue)</span><br><span class=\"line\"></span><br><span class=\"line\">txtStreamOut.WriteLine <span class=\"string\">\"DisplayName,Email,LastDate,Runtime\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Do</span> Until objRecordSet.EOF    </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">AccountName = objRecordSet(<span class=\"string\">\"DisplayName\"</span>)</span><br><span class=\"line\">EmailAddress = objRecordSet(<span class=\"string\">\"Mail\"</span>)</span><br><span class=\"line\">AccountControl = objRecordSet(<span class=\"string\">\"userAccountControl\"</span>)</span><br><span class=\"line\">pwdLastSet = objRecordSet(<span class=\"string\">\"pwdLastSet\"</span>)</span><br><span class=\"line\">pwdLastSet = #<span class=\"number\">1</span>/<span class=\"number\">1</span>/<span class=\"number\">1601</span># + (pwdLastSet.highpart * <span class=\"number\">2</span>^<span class=\"number\">32</span> + pwdLastSet.lowpart) / NanoSEC_IN_DAY + <span class=\"number\">480</span> / <span class=\"number\">1440</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">If</span> (AccountControl <span class=\"keyword\">And</span> ADS_UF_DONT_EXPIRE_PASSWD)=<span class=\"number\">0</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (AccountControl <span class=\"keyword\">and</span> <span class=\"number\">3</span>) &lt;&gt; <span class=\"number\">2</span> <span class=\"keyword\">and</span> err.number &lt;&gt; E_ADS_Property_Not_Found <span class=\"keyword\">Then</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\tLastdate = <span class=\"built_in\">int</span>(intMaxPwdAge-(now-pwdLastSet))</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> Lastdate = <span class=\"number\">7</span> <span class=\"keyword\">or</span> Lastdate = <span class=\"number\">5</span> <span class=\"keyword\">or</span> (Lastdate &lt; <span class=\"number\">4</span> <span class=\"keyword\">and</span> Lastdate &gt; <span class=\"number\">0</span>) <span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t\ttxtStreamOut.WriteLine AccountName &amp; <span class=\"string\">\",\"</span> &amp; EmailAddress &amp; <span class=\"string\">\",\"</span> &amp; Lastdate &amp; <span class=\"string\">\",\"</span> &amp; Now</span><br><span class=\"line\">\t\t<span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">\t<span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">If</span> </span><br><span class=\"line\"></span><br><span class=\"line\">Err.number = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">objRecordSet.MoveNext</span><br><span class=\"line\"><span class=\"keyword\">Loop</span></span><br><span class=\"line\"><span class=\"comment\">'WScript.Echo(\"Finished\")</span></span><br><span class=\"line\"><span class=\"comment\">'\tEnd OF CODE</span></span><br></pre></td></tr></tbody></table></figure>\n\n\n<h3 id=\"Sendmail-PassExpired-ps1\"><a href=\"#Sendmail-PassExpired-ps1\" class=\"headerlink\" title=\"Sendmail-PassExpired.ps1\"></a>Sendmail-PassExpired.ps1</h3><figure class=\"highlight powershell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">########################  Sendmail-PassExpired.ps1  #############################</span></span><br><span class=\"line\"><span class=\"comment\">#   Author:\tRandy Zhong</span></span><br><span class=\"line\"><span class=\"comment\">#   Source:\thttps://github.com/randyzhong/</span></span><br><span class=\"line\"><span class=\"comment\">#   Description: This script uses Send-MailMessage cmdlet to send HTML format </span></span><br><span class=\"line\"><span class=\"comment\">#                 message with high priority.</span></span><br><span class=\"line\"><span class=\"comment\">#\t  Version:\t1.0.0</span></span><br><span class=\"line\"><span class=\"comment\">#################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#   Changelog:   </span></span><br><span class=\"line\"><span class=\"comment\">#\t\t  2011.05.11 v1.0.0 - initial release</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#   Define VARIABLES</span></span><br><span class=\"line\"><span class=\"variable\">$csvfile</span> = <span class=\"string\">\"C:\\PwdCheck\\passexpired.csv\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$smtp</span> = <span class=\"string\">\"mail.fabrikam.com\"</span> </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"variable\">$from</span> = <span class=\"string\">\"Support@fabrikam.com\"</span> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"variable\">$subject</span> = <span class=\"string\">\"Warning: Your password is about to expire!\"</span>  </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#   Read user email address from CSV file and send warning message with high priority</span></span><br><span class=\"line\"><span class=\"built_in\">Import-Csv</span> <span class=\"variable\">$csvfile</span> | <span class=\"built_in\">ForEach-Object</span> {<span class=\"built_in\">Send-MailMessage</span> <span class=\"literal\">-To</span> <span class=\"variable\">$_</span>.Email <span class=\"literal\">-Subject</span> <span class=\"variable\">$subject</span> <span class=\"literal\">-From</span> <span class=\"variable\">$from</span> <span class=\"literal\">-BodyAsHtm</span> <span class=\"literal\">-Body</span> (<span class=\"string\">\"&lt;font color='#1F497D'; font-family='Calibri, Tahoma, Arial'&gt;\"</span>+<span class=\"string\">\"Dear&amp;nbsp;\"</span> + <span class=\"variable\">$_</span>.DisplayName +<span class=\"string\">\":\"</span> + <span class=\"string\">\"&lt;br /&gt;\"</span> +<span class=\"string\">\"&lt;p&gt;&lt;font size='4'&gt;Your password will be expired in &lt;font color='red' size='+2'&gt;&lt;strong&gt;\"</span>+ <span class=\"variable\">$_</span>.LastDate + <span class=\"string\">\"&lt;/strong&gt;&lt;/font&gt; day(s), please change it soon.&lt;/font&gt;&lt;/p&gt;\"</span>) <span class=\"literal\">-SmtpServer</span> <span class=\"variable\">$smtp</span> <span class=\"literal\">-Encoding</span> ([<span class=\"type\">System.Text.Encoding</span>]::UTF8) <span class=\"literal\">-Priority</span> high}</span><br></pre></td></tr></tbody></table></figure>\n<h3 id=\"计划任务设置\"><a href=\"#计划任务设置\" class=\"headerlink\" title=\"计划任务设置\"></a>计划任务设置</h3><ul>\n<li>新建个计划任务，设置为每天运行一次</li>\n<li>第一步运行 PasswordCheck.vbs 生成用户列表，Program/Script 输入 CScript, 参数输入 “C:\\Pathname\\PasswordCheck.vbs”</li>\n<li>第二步运行 Sendmail-PassExpired.ps1 发送邮件，Program/Script 输入 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe， 附加参数 -command “. ‘C:\\PwdCheck\\Sendmail-PassExpired.ps1’”</li>\n</ul>\n<h3 id=\"Exchange-服务器设置\"><a href=\"#Exchange-服务器设置\" class=\"headerlink\" title=\"Exchange 服务器设置\"></a>Exchange 服务器设置</h3><p>HUB 角色上面把配置了计划任务的服务器 IP 加入允许匿名转发的连接器 IP 地址池</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><p>一般来说，在部署了微软活动目录的企业域环境中，为了安全起见，不会将用户的密码设置为永不过期，通常设置为60天到90天更改一次，相对比较安全。在密码快要过期的时候，用户登录 Windows 时会有提醒修改密码。不过，也会有很多员工根本不去看这个提示甚至忽略掉，一旦员工域帐号的密码过期时间是在公众假期甚至是外地出差期间，那么结果就是包含邮件在内的相关应用系统无法登陆。随之给域管理员的工作带来压力。有各种各样的方法可以减少此种事件发生，一些第三方工具甚至可以开放给员工自助的密码忘记/重设服务，我们这里不做探讨。</p></body></html>","more":"<html><head></head><body><p>今天要给大家分享的两个脚本，一个通过 VBscript 找出密码快要过期的用户，另外一个使用 PowerShell 给这些用户发送密码过期提醒邮件，通过设置计划任务部署脚本后已经在某企业稳定运行七年时间，经统计可以减少域管理员密码重设次数60%以上，不失为一种简单高效的方案。</p>\n<h3 id=\"PasswordCheck-vbs\"><a href=\"#PasswordCheck-vbs\" class=\"headerlink\" title=\"PasswordCheck.vbs\"></a>PasswordCheck.vbs</h3><figure class=\"highlight vbs\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">'############################  PasswordCheck.vbs  ################################</span></span><br><span class=\"line\"><span class=\"comment\">' \tAuthor:\tRandy Zhong</span></span><br><span class=\"line\"><span class=\"comment\">' \tSource:\thttps://github.com/randyzhong/</span></span><br><span class=\"line\"><span class=\"comment\">'\tDescription: This script use VBScript to check user's password expiration date.</span></span><br><span class=\"line\"><span class=\"comment\">'\t\t\t\t If Lastdate equals 7,5,3,2,1, DisplayName,Email,LastDate,Runtime </span></span><br><span class=\"line\"><span class=\"comment\">'\t\t\t\t will be recorded to OutFile in CSV format.</span></span><br><span class=\"line\"><span class=\"comment\">'\tVersion:\t1.0.0</span></span><br><span class=\"line\"><span class=\"comment\">'#################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tChangelog:   </span></span><br><span class=\"line\"><span class=\"comment\">'\t\t2011.05.11 v1.0.0 - initial release</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tConst VARIABLES - DON'T EDIT</span></span><br><span class=\"line\"><span class=\"keyword\">On</span> <span class=\"keyword\">Error</span> <span class=\"keyword\">Resume</span> <span class=\"keyword\">Next</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> ADS_SCOPE_SUBTREE = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> SEC_IN_DAY = <span class=\"number\">86400</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> ADS_UF_DONT_EXPIRE_PASSWD = &amp;h10000</span><br><span class=\"line\"><span class=\"keyword\">Const</span> ForWriting = <span class=\"number\">2</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> E_ADS_Property_Not_Found = &amp;h8000500D</span><br><span class=\"line\"><span class=\"keyword\">Const</span> E_Table_Not_Found = &amp;h80040E37</span><br><span class=\"line\"><span class=\"keyword\">Const</span> NanoSEC_IN_DAY = <span class=\"number\">864E9</span></span><br><span class=\"line\"><span class=\"keyword\">Const</span> TristateTrue = <span class=\"number\">-1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tIMPORTANT VARIABLES TO EDIT</span></span><br><span class=\"line\">LDAPDomain = <span class=\"string\">\"LDAP://OU=FABRIKAM Users,DC=Fabrikam,DC=com\"</span></span><br><span class=\"line\">BiosDomain = <span class=\"string\">\"FABRIKAM\"</span></span><br><span class=\"line\">OutFile = <span class=\"string\">\"C:\\PwdCheck\\passexpired.csv\"</span> </span><br><span class=\"line\"><span class=\"comment\">'\tEND OF IMPOTANT VARIABLES TO EDIT</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">'\tBEGIN OF CODE - DON'T EDIT</span></span><br><span class=\"line\"><span class=\"keyword\">Set</span> objDomainNT = <span class=\"built_in\">GetObject</span>(<span class=\"string\">\"WinNT://\"</span> &amp; BiosDomain)</span><br><span class=\"line\">  \tintMaxPwdAge = objDomainNT.<span class=\"keyword\">Get</span>(<span class=\"string\">\"MaxPasswordAge\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">If</span> intMaxPwdAge &lt; <span class=\"number\">0</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">\tWScript.Echo(<span class=\"string\">\"Password never expired!\"</span>)</span><br><span class=\"line\">\tWScript.Quit    \t\t</span><br><span class=\"line\"><span class=\"keyword\">Else</span></span><br><span class=\"line\">\tintMaxPwdAge = (intMaxPwdAge/SEC_IN_DAY)</span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">If</span> </span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> fso = <span class=\"built_in\">CreateObject</span>(<span class=\"string\">\"Scripting.FileSystemObject\"</span>)</span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">Set</span> objConnection = <span class=\"built_in\">CreateObject</span>(<span class=\"string\">\"ADODB.Connection\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">Set</span> objCommand =   <span class=\"built_in\">CreateObject</span>(<span class=\"string\">\"ADODB.Command\"</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">objConnection.Provider = <span class=\"string\">\"ADsDSOObject\"</span></span><br><span class=\"line\">objConnection.Open <span class=\"string\">\"Active Directory Provider\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> objCommand.ActiveConnection = objConnection</span><br><span class=\"line\">objCommand.CommandText = _</span><br><span class=\"line\">    <span class=\"string\">\"Select DisplayName,Mail,userAccountControl,pwdLastSet from '\"</span> &amp; LDAPDomain &amp; _</span><br><span class=\"line\">        <span class=\"string\">\"' where objectClass = 'user' and objectClass &lt;&gt; 'computer'\"</span> </span><br><span class=\"line\"></span><br><span class=\"line\">    \tobjCommand.Properties(<span class=\"string\">\"Page Size\"</span>) = <span class=\"number\">100000</span></span><br><span class=\"line\">\tobjCommand.Properties(<span class=\"string\">\"Searchscope\"</span>) = ADS_SCOPE_SUBTREE </span><br><span class=\"line\">\t<span class=\"keyword\">Set</span> objRecordSet = objCommand.<span class=\"keyword\">Execute</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">IF</span> err.number = E_Table_Not_Found <span class=\"keyword\">Then</span></span><br><span class=\"line\">\tWScript.Echo(<span class=\"string\">\"Error Domain!\"</span>)</span><br><span class=\"line\">\tWScript.Quit </span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\"></span><br><span class=\"line\">objRecordSet.MoveFirst</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Set</span> txtStreamOut = fso.OpenTextFile(OutFile,ForWriting,<span class=\"literal\">true</span>,TristateTrue)</span><br><span class=\"line\"></span><br><span class=\"line\">txtStreamOut.WriteLine <span class=\"string\">\"DisplayName,Email,LastDate,Runtime\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Do</span> Until objRecordSet.EOF    </span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">AccountName = objRecordSet(<span class=\"string\">\"DisplayName\"</span>)</span><br><span class=\"line\">EmailAddress = objRecordSet(<span class=\"string\">\"Mail\"</span>)</span><br><span class=\"line\">AccountControl = objRecordSet(<span class=\"string\">\"userAccountControl\"</span>)</span><br><span class=\"line\">pwdLastSet = objRecordSet(<span class=\"string\">\"pwdLastSet\"</span>)</span><br><span class=\"line\">pwdLastSet = #<span class=\"number\">1</span>/<span class=\"number\">1</span>/<span class=\"number\">1601</span># + (pwdLastSet.highpart * <span class=\"number\">2</span>^<span class=\"number\">32</span> + pwdLastSet.lowpart) / NanoSEC_IN_DAY + <span class=\"number\">480</span> / <span class=\"number\">1440</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">If</span> (AccountControl <span class=\"keyword\">And</span> ADS_UF_DONT_EXPIRE_PASSWD)=<span class=\"number\">0</span> <span class=\"keyword\">Then</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (AccountControl <span class=\"keyword\">and</span> <span class=\"number\">3</span>) &lt;&gt; <span class=\"number\">2</span> <span class=\"keyword\">and</span> err.number &lt;&gt; E_ADS_Property_Not_Found <span class=\"keyword\">Then</span></span><br><span class=\"line\">\t</span><br><span class=\"line\">\tLastdate = <span class=\"built_in\">int</span>(intMaxPwdAge-(now-pwdLastSet))</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> Lastdate = <span class=\"number\">7</span> <span class=\"keyword\">or</span> Lastdate = <span class=\"number\">5</span> <span class=\"keyword\">or</span> (Lastdate &lt; <span class=\"number\">4</span> <span class=\"keyword\">and</span> Lastdate &gt; <span class=\"number\">0</span>) <span class=\"keyword\">then</span></span><br><span class=\"line\">\t\t\ttxtStreamOut.WriteLine AccountName &amp; <span class=\"string\">\",\"</span> &amp; EmailAddress &amp; <span class=\"string\">\",\"</span> &amp; Lastdate &amp; <span class=\"string\">\",\"</span> &amp; Now</span><br><span class=\"line\">\t\t<span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\">\t<span class=\"keyword\">End</span> <span class=\"keyword\">If</span></span><br><span class=\"line\"><span class=\"keyword\">End</span> <span class=\"keyword\">If</span> </span><br><span class=\"line\"></span><br><span class=\"line\">Err.number = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">objRecordSet.MoveNext</span><br><span class=\"line\"><span class=\"keyword\">Loop</span></span><br><span class=\"line\"><span class=\"comment\">'WScript.Echo(\"Finished\")</span></span><br><span class=\"line\"><span class=\"comment\">'\tEnd OF CODE</span></span><br></pre></td></tr></tbody></table></figure>\n\n\n<h3 id=\"Sendmail-PassExpired-ps1\"><a href=\"#Sendmail-PassExpired-ps1\" class=\"headerlink\" title=\"Sendmail-PassExpired.ps1\"></a>Sendmail-PassExpired.ps1</h3><figure class=\"highlight powershell\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">########################  Sendmail-PassExpired.ps1  #############################</span></span><br><span class=\"line\"><span class=\"comment\">#   Author:\tRandy Zhong</span></span><br><span class=\"line\"><span class=\"comment\">#   Source:\thttps://github.com/randyzhong/</span></span><br><span class=\"line\"><span class=\"comment\">#   Description: This script uses Send-MailMessage cmdlet to send HTML format </span></span><br><span class=\"line\"><span class=\"comment\">#                 message with high priority.</span></span><br><span class=\"line\"><span class=\"comment\">#\t  Version:\t1.0.0</span></span><br><span class=\"line\"><span class=\"comment\">#################################################################################</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#   Changelog:   </span></span><br><span class=\"line\"><span class=\"comment\">#\t\t  2011.05.11 v1.0.0 - initial release</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#   Define VARIABLES</span></span><br><span class=\"line\"><span class=\"variable\">$csvfile</span> = <span class=\"string\">\"C:\\PwdCheck\\passexpired.csv\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"variable\">$smtp</span> = <span class=\"string\">\"mail.fabrikam.com\"</span> </span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"variable\">$from</span> = <span class=\"string\">\"Support@fabrikam.com\"</span> </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"variable\">$subject</span> = <span class=\"string\">\"Warning: Your password is about to expire!\"</span>  </span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"comment\">#   Read user email address from CSV file and send warning message with high priority</span></span><br><span class=\"line\"><span class=\"built_in\">Import-Csv</span> <span class=\"variable\">$csvfile</span> | <span class=\"built_in\">ForEach-Object</span> {<span class=\"built_in\">Send-MailMessage</span> <span class=\"literal\">-To</span> <span class=\"variable\">$_</span>.Email <span class=\"literal\">-Subject</span> <span class=\"variable\">$subject</span> <span class=\"literal\">-From</span> <span class=\"variable\">$from</span> <span class=\"literal\">-BodyAsHtm</span> <span class=\"literal\">-Body</span> (<span class=\"string\">\"&lt;font color='#1F497D'; font-family='Calibri, Tahoma, Arial'&gt;\"</span>+<span class=\"string\">\"Dear&amp;nbsp;\"</span> + <span class=\"variable\">$_</span>.DisplayName +<span class=\"string\">\":\"</span> + <span class=\"string\">\"&lt;br /&gt;\"</span> +<span class=\"string\">\"&lt;p&gt;&lt;font size='4'&gt;Your password will be expired in &lt;font color='red' size='+2'&gt;&lt;strong&gt;\"</span>+ <span class=\"variable\">$_</span>.LastDate + <span class=\"string\">\"&lt;/strong&gt;&lt;/font&gt; day(s), please change it soon.&lt;/font&gt;&lt;/p&gt;\"</span>) <span class=\"literal\">-SmtpServer</span> <span class=\"variable\">$smtp</span> <span class=\"literal\">-Encoding</span> ([<span class=\"type\">System.Text.Encoding</span>]::UTF8) <span class=\"literal\">-Priority</span> high}</span><br></pre></td></tr></tbody></table></figure>\n<h3 id=\"计划任务设置\"><a href=\"#计划任务设置\" class=\"headerlink\" title=\"计划任务设置\"></a>计划任务设置</h3><ul>\n<li>新建个计划任务，设置为每天运行一次</li>\n<li>第一步运行 PasswordCheck.vbs 生成用户列表，Program/Script 输入 CScript, 参数输入 “C:\\Pathname\\PasswordCheck.vbs”</li>\n<li>第二步运行 Sendmail-PassExpired.ps1 发送邮件，Program/Script 输入 C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe， 附加参数 -command “. ‘C:\\PwdCheck\\Sendmail-PassExpired.ps1’”</li>\n</ul>\n<h3 id=\"Exchange-服务器设置\"><a href=\"#Exchange-服务器设置\" class=\"headerlink\" title=\"Exchange 服务器设置\"></a>Exchange 服务器设置</h3><p>HUB 角色上面把配置了计划任务的服务器 IP 加入允许匿名转发的连接器 IP 地址池</p></body></html>"},{"title":"如何设置使 HMC 4.0 创建的用户的密码永不过期","date":"2007-11-10T04:01:02.000Z","_content":"\nHMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 `userAccountControl` 的属性来达到默认就是密码永不过期的目的。\n\n1.  以管理员身份登陆 MPS (MPSSQL)，打开 **Provisioning Manager**\n2.  在名称空间 \"Hosted Active Directory\" 中打开  **CreateUser** 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser: \n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n```\n注释或者去掉以下的2句判断语句\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n3.  改完之后应该类似这样\n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<user/>\n<properties>\n<!-- sets the password to never expire -->\n<property name=\"userAccountControl\">\n<value>65536</value>\n</property>\n</properties>\n</executeData>\n<before source=\"procedureData\" sourcePath=\"path\" destination=\"executeData\" destinationPath=\"user\" mode=\"merge\"/>\n<before source=\"data\" sourcePath=\"preferredDomainController\" destination=\"executeData\" mode=\"insert\"/>\n</execute>\n```\n4.  点击 \"Apply\" 保存修改。\n> 解释：`userAccountControl` 属性中，值设置成 65536 表示设置密码永不过期\n\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。\n***\n参考的文章：\n* Microsoft KB:[http://support.microsoft.com/kb/305144](http://support.microsoft.com/kb/305144)\n* MSDN:User-Account-Control Attribute - [http://msdn2.microsoft.com/en-us/library/ms680832.aspx](http://msdn2.microsoft.com/en-us/library/ms680832.aspx)","source":"_posts/how-to-turn-off-password-expiration-in-hmc-40.md","raw":"---\ntitle: 如何设置使 HMC 4.0 创建的用户的密码永不过期\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2007-11-10 12:01:02\n---\n\nHMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 `userAccountControl` 的属性来达到默认就是密码永不过期的目的。\n\n1.  以管理员身份登陆 MPS (MPSSQL)，打开 **Provisioning Manager**\n2.  在名称空间 \"Hosted Active Directory\" 中打开  **CreateUser** 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser: \n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n```\n注释或者去掉以下的2句判断语句\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n3.  改完之后应该类似这样\n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<user/>\n<properties>\n<!-- sets the password to never expire -->\n<property name=\"userAccountControl\">\n<value>65536</value>\n</property>\n</properties>\n</executeData>\n<before source=\"procedureData\" sourcePath=\"path\" destination=\"executeData\" destinationPath=\"user\" mode=\"merge\"/>\n<before source=\"data\" sourcePath=\"preferredDomainController\" destination=\"executeData\" mode=\"insert\"/>\n</execute>\n```\n4.  点击 \"Apply\" 保存修改。\n> 解释：`userAccountControl` 属性中，值设置成 65536 表示设置密码永不过期\n\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。\n***\n参考的文章：\n* Microsoft KB:[http://support.microsoft.com/kb/305144](http://support.microsoft.com/kb/305144)\n* MSDN:User-Account-Control Attribute - [http://msdn2.microsoft.com/en-us/library/ms680832.aspx](http://msdn2.microsoft.com/en-us/library/ms680832.aspx)","slug":"how-to-turn-off-password-expiration-in-hmc-40","published":1,"updated":"2020-01-05T09:00:53.994Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku70048k84se2k20k8g","content":"<html><head></head><body><p>HMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 <code>userAccountControl</code> 的属性来达到默认就是密码永不过期的目的。</p>\n<ol>\n<li>以管理员身份登陆 MPS (MPSSQL)，打开&nbsp;<strong>Provisioning Manager</strong></li>\n<li>在名称空间 “Hosted Active Directory” 中打开  <strong>CreateUser</strong> 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser:&nbsp;<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span>&nbsp;<span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span>&nbsp;<span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span>&nbsp;<span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n注释或者去掉以下的2句判断语句<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>\n<li>改完之后应该类似这样<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- sets the password to never expire --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"userAccountControl\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>65536<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"procedureData\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"path\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destinationPath</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"preferredDomainController\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"insert\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>\n<li>点击 “Apply” 保存修改。<blockquote>\n<p>解释：<code>userAccountControl</code> 属性中，值设置成 65536 表示设置密码永不过期</p>\n</blockquote>\n</li>\n</ol>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。</p>\n<hr>\n<p>参考的文章：</p>\n<ul>\n<li>Microsoft KB:<a href=\"http://support.microsoft.com/kb/305144\">http://support.microsoft.com/kb/305144</a></li>\n<li>MSDN:User-Account-Control Attribute -&nbsp;<a href=\"http://msdn2.microsoft.com/en-us/library/ms680832.aspx\">http://msdn2.microsoft.com/en-us/library/ms680832.aspx</a></li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>HMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 <code>userAccountControl</code> 的属性来达到默认就是密码永不过期的目的。</p>\n<ol>\n<li>以管理员身份登陆 MPS (MPSSQL)，打开&nbsp;<strong>Provisioning Manager</strong></li>\n<li>在名称空间 “Hosted Active Directory” 中打开  <strong>CreateUser</strong> 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser:&nbsp;<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span>&nbsp;<span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span>&nbsp;<span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span>&nbsp;<span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n注释或者去掉以下的2句判断语句<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>\n<li>改完之后应该类似这样<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"comment\">&lt;!-- sets the password to never expire --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"userAccountControl\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>65536<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"procedureData\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"path\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destinationPath</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"preferredDomainController\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"insert\"</span>/&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></li>\n<li>点击 “Apply” 保存修改。<blockquote>\n<p>解释：<code>userAccountControl</code> 属性中，值设置成 65536 表示设置密码永不过期</p>\n</blockquote>\n</li>\n</ol>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。</p>\n<hr>\n<p>参考的文章：</p>\n<ul>\n<li>Microsoft KB:<a href=\"http://support.microsoft.com/kb/305144\">http://support.microsoft.com/kb/305144</a></li>\n<li>MSDN:User-Account-Control Attribute -&nbsp;<a href=\"http://msdn2.microsoft.com/en-us/library/ms680832.aspx\">http://msdn2.microsoft.com/en-us/library/ms680832.aspx</a></li>\n</ul>\n</body></html>"},{"title":"使用 URL Rewrite 重定向 Http 请求至 Https","date":"2010-10-21T01:48:37.000Z","_content":"\n公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 \"HTTP Redirect\" 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。\n\n1. [http://www.iis.net/download/URLRewrite](http://www.iis.net/download/URLRewrite) 到这里下载，有分 32 和 64 位版本。\n2. 安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。\n{% asset_img url-rewrite-1.jpg url-rewrite-1 %}\n3. 双击打开，你会看到一个规则配置的页面。\n{% asset_img url-rewrite-2.jpg url-rewrite-2 %}\n4. 点击 \"Add Rules\" 添加规则，选择默认的\"Blank Rule\" 作为模板。\n{% asset_img url-rewrite-3.jpg url-rewrite-3 %}\n5. 在规则名字这一栏输入 \"Redirect to HTTPS\"。\n{% asset_img url-rewrite-4.jpg url-rewrite-4 %}\n6. 展开 \"Match URL\" 这个小三角，按如下设定：\n**Requested URL:** Matches the Pattern\n**Using:** Regular Expressions\n**Pattern:** (.\\*)\n{% asset_img url-rewrite-5.jpg url-rewrite-5 %}\n7. 在 \"Conditions\" 这里，点击 \"Add...\"。\n{% asset_img url-rewrite-6.jpg url-rewrite-6 %}\n8. 按以下设定输入：\n**Condition Input**: {HTTPS}\n**Check if input string**: Matches the Pattern\n**Pattern**: ^OFF$\n{% asset_img url-rewrite-7.jpg url-rewrite-7 %}\n9. 完成后入下图所示。\n{% asset_img url-rewrite-8.jpg url-rewrite-8 %}\n10. 最后一步就是重定向的设置了。\n - **Action Type**: Redirect\n - **Redirect URL**: [https://{HTTP_HOST}/{R:1](https://%7Bhttp_host%7D/%7BR:1)}\n - **Redirect Type**: See Other (303)\n{% asset_img url-rewrite-9.jpg url-rewrite-9 %}\n\n11. 点击右边的 \"Apply\" 应用，设置完成。\n{% asset_img url-rewrite-10.jpg url-rewrite-10 %}\n{% asset_img url-rewrite-11.jpg url-rewrite-11 %}\n> 补充： 因为本地的 IIS 还有个 Web Service 需要调用http://localhost/directory/service.asmx， 如上设置后，会被重定向去 http://localhost/directory/service.asmx， 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。\n12. 在\"Conditions\"这里，点击 \"Add...\"。\n13. 按以下设定输入，然后点击 Move Up 使其成为第一个条件\n    - **Condition Input**: {HTTPS_HOST}\n    - **Check if input string**: Does Not Matches the Pattern\n    - **Pattern**: ^(localhost)\n{% asset_img url-rewrite-12.jpg url-rewrite-12 %}\n14. 最后设定完成如图。\n{% asset_img url-rewrite-13.jpg url-rewrite-13 %}\n15. 在 web.config 里面你也可以看到最终的设置结果\n{% asset_img url-rewrite-14.jpg url-rewrite-14 %}","source":"_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7.md","raw":"---\ntitle: 使用 URL Rewrite 重定向 Http 请求至 Https\ntags:\n  - IIS\n  - Rewrite\ncategories:\n  - Microsoft\ndate: 2010-10-21 09:48:37\n---\n\n公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 \"HTTP Redirect\" 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。\n\n1. [http://www.iis.net/download/URLRewrite](http://www.iis.net/download/URLRewrite) 到这里下载，有分 32 和 64 位版本。\n2. 安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。\n{% asset_img url-rewrite-1.jpg url-rewrite-1 %}\n3. 双击打开，你会看到一个规则配置的页面。\n{% asset_img url-rewrite-2.jpg url-rewrite-2 %}\n4. 点击 \"Add Rules\" 添加规则，选择默认的\"Blank Rule\" 作为模板。\n{% asset_img url-rewrite-3.jpg url-rewrite-3 %}\n5. 在规则名字这一栏输入 \"Redirect to HTTPS\"。\n{% asset_img url-rewrite-4.jpg url-rewrite-4 %}\n6. 展开 \"Match URL\" 这个小三角，按如下设定：\n**Requested URL:** Matches the Pattern\n**Using:** Regular Expressions\n**Pattern:** (.\\*)\n{% asset_img url-rewrite-5.jpg url-rewrite-5 %}\n7. 在 \"Conditions\" 这里，点击 \"Add...\"。\n{% asset_img url-rewrite-6.jpg url-rewrite-6 %}\n8. 按以下设定输入：\n**Condition Input**: {HTTPS}\n**Check if input string**: Matches the Pattern\n**Pattern**: ^OFF$\n{% asset_img url-rewrite-7.jpg url-rewrite-7 %}\n9. 完成后入下图所示。\n{% asset_img url-rewrite-8.jpg url-rewrite-8 %}\n10. 最后一步就是重定向的设置了。\n - **Action Type**: Redirect\n - **Redirect URL**: [https://{HTTP_HOST}/{R:1](https://%7Bhttp_host%7D/%7BR:1)}\n - **Redirect Type**: See Other (303)\n{% asset_img url-rewrite-9.jpg url-rewrite-9 %}\n\n11. 点击右边的 \"Apply\" 应用，设置完成。\n{% asset_img url-rewrite-10.jpg url-rewrite-10 %}\n{% asset_img url-rewrite-11.jpg url-rewrite-11 %}\n> 补充： 因为本地的 IIS 还有个 Web Service 需要调用http://localhost/directory/service.asmx， 如上设置后，会被重定向去 http://localhost/directory/service.asmx， 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。\n12. 在\"Conditions\"这里，点击 \"Add...\"。\n13. 按以下设定输入，然后点击 Move Up 使其成为第一个条件\n    - **Condition Input**: {HTTPS_HOST}\n    - **Check if input string**: Does Not Matches the Pattern\n    - **Pattern**: ^(localhost)\n{% asset_img url-rewrite-12.jpg url-rewrite-12 %}\n14. 最后设定完成如图。\n{% asset_img url-rewrite-13.jpg url-rewrite-13 %}\n15. 在 web.config 里面你也可以看到最终的设置结果\n{% asset_img url-rewrite-14.jpg url-rewrite-14 %}","slug":"how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7","published":1,"updated":"2020-01-05T09:00:53.994Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku7004bk84s8pdhgyte","content":"<html><head></head><body><p>公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 “HTTP Redirect” 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。</p>\n<p>1.&nbsp;<a href=\"http://www.iis.net/download/URLRewrite\">http://www.iis.net/download/URLRewrite</a>&nbsp;到这里下载，有分 32 和 64 位版本。<br>2. 安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。</p>\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg\" class=\"\" title=\"url-rewrite-1\">\n<ol start=\"3\">\n<li>双击打开，你会看到一个规则配置的页面。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg\" class=\"\" title=\"url-rewrite-2\"></li>\n<li>点击 “Add Rules” 添加规则，选择默认的”Blank Rule” 作为模板。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg\" class=\"\" title=\"url-rewrite-3\"></li>\n<li>在规则名字这一栏输入 “Redirect to HTTPS”。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg\" class=\"\" title=\"url-rewrite-4\"></li>\n<li>展开 “Match URL” 这个小三角，按如下设定：</li>\n</ol>\n<p><strong>Requested URL:</strong>&nbsp;Matches the Pattern<br><strong>Using:</strong>&nbsp;Regular Expressions<br><strong>Pattern:</strong>&nbsp;(.*)</p>\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg\" class=\"\" title=\"url-rewrite-5\">\n<ol start=\"7\">\n<li>在 “Conditions” 这里，点击 “Add…”。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg\" class=\"\" title=\"url-rewrite-6\"></li>\n<li>按以下设定输入：</li>\n</ol>\n<p><strong>Condition Input</strong>: {HTTPS}<br><strong>Check if input string</strong>: Matches the Pattern<br><strong>Pattern</strong>: ^OFF$</p>\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg\" class=\"\" title=\"url-rewrite-7\">\n<ol start=\"9\">\n<li>完成后入下图所示。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg\" class=\"\" title=\"url-rewrite-8\"></li>\n<li>最后一步就是重定向的设置了。</li>\n</ol>\n<ul>\n<li><strong>Action Type</strong>: Redirect</li>\n<li><strong>Redirect URL</strong>:&nbsp;<a href=\"https://{http_host}/%7BR:1\">https://{HTTP_HOST}/{R:1</a>}</li>\n<li><strong>Redirect Type</strong>: See Other (303)<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg\" class=\"\" title=\"url-rewrite-9\"></li>\n</ul>\n<ol start=\"11\">\n<li>点击右边的 “Apply” 应用，设置完成。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg\" class=\"\" title=\"url-rewrite-10\">\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg\" class=\"\" title=\"url-rewrite-11\">\n<blockquote>\n<p>补充： 因为本地的 IIS 还有个 Web Service 需要调用<a href=\"http://localhost/directory/service.asmx%EF%BC%8C\">http://localhost/directory/service.asmx，</a> 如上设置后，会被重定向去 <a href=\"http://localhost/directory/service.asmx%EF%BC%8C\">http://localhost/directory/service.asmx，</a> 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。</p>\n</blockquote>\n</li>\n<li>在”Conditions”这里，点击 “Add…”。</li>\n<li>按以下设定输入，然后点击 Move Up 使其成为第一个条件<ul>\n<li><strong>Condition Input</strong>: {HTTPS_HOST}</li>\n<li><strong>Check if input string</strong>: Does Not Matches the Pattern</li>\n<li><strong>Pattern</strong>: ^(localhost)<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg\" class=\"\" title=\"url-rewrite-12\"></li>\n</ul>\n</li>\n<li>最后设定完成如图。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg\" class=\"\" title=\"url-rewrite-13\"></li>\n<li>在 web.config 里面你也可以看到最终的设置结果<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg\" class=\"\" title=\"url-rewrite-14\"></li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 “HTTP Redirect” 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。</p>\n<p>1.&nbsp;<a href=\"http://www.iis.net/download/URLRewrite\">http://www.iis.net/download/URLRewrite</a>&nbsp;到这里下载，有分 32 和 64 位版本。<br>2. 安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。</p>\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg\" class=\"\" title=\"url-rewrite-1\">\n<ol start=\"3\">\n<li>双击打开，你会看到一个规则配置的页面。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg\" class=\"\" title=\"url-rewrite-2\"></li>\n<li>点击 “Add Rules” 添加规则，选择默认的”Blank Rule” 作为模板。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg\" class=\"\" title=\"url-rewrite-3\"></li>\n<li>在规则名字这一栏输入 “Redirect to HTTPS”。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg\" class=\"\" title=\"url-rewrite-4\"></li>\n<li>展开 “Match URL” 这个小三角，按如下设定：</li>\n</ol>\n<p><strong>Requested URL:</strong>&nbsp;Matches the Pattern<br><strong>Using:</strong>&nbsp;Regular Expressions<br><strong>Pattern:</strong>&nbsp;(.*)</p>\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg\" class=\"\" title=\"url-rewrite-5\">\n<ol start=\"7\">\n<li>在 “Conditions” 这里，点击 “Add…”。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg\" class=\"\" title=\"url-rewrite-6\"></li>\n<li>按以下设定输入：</li>\n</ol>\n<p><strong>Condition Input</strong>: {HTTPS}<br><strong>Check if input string</strong>: Matches the Pattern<br><strong>Pattern</strong>: ^OFF$</p>\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg\" class=\"\" title=\"url-rewrite-7\">\n<ol start=\"9\">\n<li>完成后入下图所示。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg\" class=\"\" title=\"url-rewrite-8\"></li>\n<li>最后一步就是重定向的设置了。</li>\n</ol>\n<ul>\n<li><strong>Action Type</strong>: Redirect</li>\n<li><strong>Redirect URL</strong>:&nbsp;<a href=\"https://{http_host}/%7BR:1\">https://{HTTP_HOST}/{R:1</a>}</li>\n<li><strong>Redirect Type</strong>: See Other (303)<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg\" class=\"\" title=\"url-rewrite-9\"></li>\n</ul>\n<ol start=\"11\">\n<li>点击右边的 “Apply” 应用，设置完成。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg\" class=\"\" title=\"url-rewrite-10\">\n<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg\" class=\"\" title=\"url-rewrite-11\">\n<blockquote>\n<p>补充： 因为本地的 IIS 还有个 Web Service 需要调用<a href=\"http://localhost/directory/service.asmx%EF%BC%8C\">http://localhost/directory/service.asmx，</a> 如上设置后，会被重定向去 <a href=\"http://localhost/directory/service.asmx%EF%BC%8C\">http://localhost/directory/service.asmx，</a> 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。</p>\n</blockquote>\n</li>\n<li>在”Conditions”这里，点击 “Add…”。</li>\n<li>按以下设定输入，然后点击 Move Up 使其成为第一个条件<ul>\n<li><strong>Condition Input</strong>: {HTTPS_HOST}</li>\n<li><strong>Check if input string</strong>: Does Not Matches the Pattern</li>\n<li><strong>Pattern</strong>: ^(localhost)<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg\" class=\"\" title=\"url-rewrite-12\"></li>\n</ul>\n</li>\n<li>最后设定完成如图。<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg\" class=\"\" title=\"url-rewrite-13\"></li>\n<li>在 web.config 里面你也可以看到最终的设置结果<img src=\"/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg\" class=\"\" title=\"url-rewrite-14\"></li>\n</ol>\n</body></html>"},{"title":"HP EliteDesk 800 G3 DM 安装黑苹果","date":"2018-12-31T08:48:35.000Z","keywords":"HP, EliteDesk, 黑苹果, Hackintosh","description":"HP 出品的 1 升迷你机箱，麻雀虽小五脏俱全，我的这台配置为 CPU i7-7700，核显HD630, 8GB内存，256GB Intel SSD， Intel 8265NGW 双频无线网卡，CX20632 声卡，主要部件都支持黑苹果，主要存在的两个问题：一是台式机 U 带的核显 HD630 现在还无法正常睡眠，二是声卡 CX20632 还没有现成的仿冒文件可以用，暂时用 Voodoo HDA 来驱动，以下是我的安装分享。","_content":"\n## GitHub\n本文引用自我的 GitHub:\n[OS-X-HP-EliteDesk-800-G3-DM-Clover](https://github.com/randyzhong/OS-X-HP-EliteDesk-800-G3-DM-Clover)\n\n## 适用机型\nThis repository contains the files and scripts to install macOS on the HP EliteDesk 800 G3 Desktop Mini Business PC (35 W/65 W).\n\n\n![HP EliteDesk 800 G3 Desktop Mini Business PC](https://support.hp.com/doc-images/700/c05373338.jpg)\n\n## Hardware Specs\n### Basic info\nHere is my EliteDesk 800 G3 DM specs:\n- Product Number: Y3A18AV\n- Product Name: HP EliteDesk 800 G3 DM 65W\n- BIOS: P21 Ver.02.22 07/17/2018\n\n### Specs:\n- CPU: Intel® Core i7-7700 @ 3.60 GHz processor (65 W model only)\n- GPU: Integrated Intel® HD Graphics 630 (3 DisplayPorts)\n- Memory: 2 x 4GB Samsung DDR4-2400\n- Storage: Intel® 256 GB SSD, PCI-E Gen3 x 4, Turbo Drive G2 TLC SSD\n- LAN: Intel® I219LM Gigabit Network Connection LOM\n- WLAN: Intel® 8265 802.11ac 2x2 Wi-Fi with Bluetooth M.2 Combo Card Vpro (802.11ac Wave 2 supported)\n- Audio: Conexant CX20632 Audio Codec (all ports are stereo, 1 internal speaker, 1 front headphone, 1 front CITA port)\n\nFull specs you can get from [HP Website](https://support.hp.com/us-en/document/c05371240?jumpid=reg_r1002_cnzh_c-001_title_r0002).\n\n## Configure BIOS Settings\nTo start, set BIOS to defaults.\nThen insure:\n- Advanced -> Boot Options\n  - Disable **Fast Boot**\n  - Disable **CD-ROM Boot**\n  - Enable **USB Storage Boot**\n  - Disable **Network (PXE) Boot**\n  \n- Advanced -> Secure Boot Configuration\n  - Select **Legacy Support Enable and Secure Boot Disable**, press **F10** to save changes, system will reboot and lead you to Secure Boot and ask you to input a 4 digits security code for authorization, type in the code shows on the screen and enter to reboot and then press **F10** again to enter BIOS configuration\n  - Uncheck **Enable MS UEFI CA key** if you don't use Windows\n\n- Advanced -> System Options\n  - Disable **Virtualization Technology (VTx)**\n  - Disable **Virtualization Technology for Directed I/O (VTd)**\n  - Enable **M.2 SSD** if you're using a NVME SSD\n  - Uncheck **M.2 WLAN/BT** if you're using a Intel 8265NGW or other unsupported card\n  - Check **Allow PCIe/PCI SERR# Interrupt** (Uncheck it if have interruption issues)\n\n#### Advanced -> Built-in Device Options\n- Disable **Wake on LAN**\n- Set Video memory size to **64MB** or larger\n- Disable **LAN/WLAN Auto Switching**\n- Disable **Wake on WLAN**\n\n#### Advanced -> Port Options\n- Enable **all** if no specific reasons.\n\n#### Advanced -> Power Management Options\n- Disable **Extended Idle Power States**\n\nPress **F10** to save changes.\n\n## Installation\n- To be updated\n\n### Tested OS\n- macOS High Sierra 10.13.6 \n- macOS Mojave 10.14.1\n\n### Clover\n- Clover r4701.RM (Build by RehabMan)\n\n### Kexts\n- EFICheckDisabler.kext (0.5)\n- FakePCIID_XHCIMux.kext (1.3.15) \n- FakeSMC.kext (6.26-357-gceb835ea.1800)\n  - ACPISensors.kext (6.26-357-gceb835ea.1800)\n  - CPUSensors.kext (6.26-357-gceb835ea.1800)\n  - GPUSensors.kext (6.26-357-gceb835ea.1800)\n  - LPCSensors.kext (6.26-357-gceb835ea.1800)\n- IntelMausiEthernet.kext (2.4.1d1)\n- Lilu.kext (1.2.8)\n  - Added Resources/Headers and Resources/Library folders which are required to build with AppleALC in Xcode\n- VoodooHDA.kext (2.9.1)\n- WhateverGreen.kext (1.2.4)\n- XHCI-unsupported.kext (0.9.2)\n\n## Known Issues:\n- Audio codec CX20632 is not supported yet, using VoodooHDA instead\n- Sleep is not working (Reboot or blackscreen when trying to wake it)\n","source":"_posts/hp-elitedesk-800-g3-dm-hackintosh.md","raw":"---\ntitle: HP EliteDesk 800 G3 DM 安装黑苹果\ntags:\n  - HP, EliteDesk, 黑苹果, Hackintosh\ncategories:\n  - Hackintosh\ndate: 2018-12-31 16:48:35\nkeywords: HP, EliteDesk, 黑苹果, Hackintosh\ndescription: HP 出品的 1 升迷你机箱，麻雀虽小五脏俱全，我的这台配置为 CPU i7-7700，核显HD630, 8GB内存，256GB Intel SSD， Intel 8265NGW 双频无线网卡，CX20632 声卡，主要部件都支持黑苹果，主要存在的两个问题：一是台式机 U 带的核显 HD630 现在还无法正常睡眠，二是声卡 CX20632 还没有现成的仿冒文件可以用，暂时用 Voodoo HDA 来驱动，以下是我的安装分享。\n---\n\n## GitHub\n本文引用自我的 GitHub:\n[OS-X-HP-EliteDesk-800-G3-DM-Clover](https://github.com/randyzhong/OS-X-HP-EliteDesk-800-G3-DM-Clover)\n\n## 适用机型\nThis repository contains the files and scripts to install macOS on the HP EliteDesk 800 G3 Desktop Mini Business PC (35 W/65 W).\n\n\n![HP EliteDesk 800 G3 Desktop Mini Business PC](https://support.hp.com/doc-images/700/c05373338.jpg)\n\n## Hardware Specs\n### Basic info\nHere is my EliteDesk 800 G3 DM specs:\n- Product Number: Y3A18AV\n- Product Name: HP EliteDesk 800 G3 DM 65W\n- BIOS: P21 Ver.02.22 07/17/2018\n\n### Specs:\n- CPU: Intel® Core i7-7700 @ 3.60 GHz processor (65 W model only)\n- GPU: Integrated Intel® HD Graphics 630 (3 DisplayPorts)\n- Memory: 2 x 4GB Samsung DDR4-2400\n- Storage: Intel® 256 GB SSD, PCI-E Gen3 x 4, Turbo Drive G2 TLC SSD\n- LAN: Intel® I219LM Gigabit Network Connection LOM\n- WLAN: Intel® 8265 802.11ac 2x2 Wi-Fi with Bluetooth M.2 Combo Card Vpro (802.11ac Wave 2 supported)\n- Audio: Conexant CX20632 Audio Codec (all ports are stereo, 1 internal speaker, 1 front headphone, 1 front CITA port)\n\nFull specs you can get from [HP Website](https://support.hp.com/us-en/document/c05371240?jumpid=reg_r1002_cnzh_c-001_title_r0002).\n\n## Configure BIOS Settings\nTo start, set BIOS to defaults.\nThen insure:\n- Advanced -> Boot Options\n  - Disable **Fast Boot**\n  - Disable **CD-ROM Boot**\n  - Enable **USB Storage Boot**\n  - Disable **Network (PXE) Boot**\n  \n- Advanced -> Secure Boot Configuration\n  - Select **Legacy Support Enable and Secure Boot Disable**, press **F10** to save changes, system will reboot and lead you to Secure Boot and ask you to input a 4 digits security code for authorization, type in the code shows on the screen and enter to reboot and then press **F10** again to enter BIOS configuration\n  - Uncheck **Enable MS UEFI CA key** if you don't use Windows\n\n- Advanced -> System Options\n  - Disable **Virtualization Technology (VTx)**\n  - Disable **Virtualization Technology for Directed I/O (VTd)**\n  - Enable **M.2 SSD** if you're using a NVME SSD\n  - Uncheck **M.2 WLAN/BT** if you're using a Intel 8265NGW or other unsupported card\n  - Check **Allow PCIe/PCI SERR# Interrupt** (Uncheck it if have interruption issues)\n\n#### Advanced -> Built-in Device Options\n- Disable **Wake on LAN**\n- Set Video memory size to **64MB** or larger\n- Disable **LAN/WLAN Auto Switching**\n- Disable **Wake on WLAN**\n\n#### Advanced -> Port Options\n- Enable **all** if no specific reasons.\n\n#### Advanced -> Power Management Options\n- Disable **Extended Idle Power States**\n\nPress **F10** to save changes.\n\n## Installation\n- To be updated\n\n### Tested OS\n- macOS High Sierra 10.13.6 \n- macOS Mojave 10.14.1\n\n### Clover\n- Clover r4701.RM (Build by RehabMan)\n\n### Kexts\n- EFICheckDisabler.kext (0.5)\n- FakePCIID_XHCIMux.kext (1.3.15) \n- FakeSMC.kext (6.26-357-gceb835ea.1800)\n  - ACPISensors.kext (6.26-357-gceb835ea.1800)\n  - CPUSensors.kext (6.26-357-gceb835ea.1800)\n  - GPUSensors.kext (6.26-357-gceb835ea.1800)\n  - LPCSensors.kext (6.26-357-gceb835ea.1800)\n- IntelMausiEthernet.kext (2.4.1d1)\n- Lilu.kext (1.2.8)\n  - Added Resources/Headers and Resources/Library folders which are required to build with AppleALC in Xcode\n- VoodooHDA.kext (2.9.1)\n- WhateverGreen.kext (1.2.4)\n- XHCI-unsupported.kext (0.9.2)\n\n## Known Issues:\n- Audio codec CX20632 is not supported yet, using VoodooHDA instead\n- Sleep is not working (Reboot or blackscreen when trying to wake it)\n","slug":"hp-elitedesk-800-g3-dm-hackintosh","published":1,"updated":"2019-02-02T07:25:21.091Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku8004gk84s47a75fyh","content":"<html><head></head><body><h2 id=\"GitHub\"><a href=\"#GitHub\" class=\"headerlink\" title=\"GitHub\"></a>GitHub</h2><p>本文引用自我的 GitHub:<br><a href=\"https://github.com/randyzhong/OS-X-HP-EliteDesk-800-G3-DM-Clover\">OS-X-HP-EliteDesk-800-G3-DM-Clover</a></p>\n<h2 id=\"适用机型\"><a href=\"#适用机型\" class=\"headerlink\" title=\"适用机型\"></a>适用机型</h2><p>This repository contains the files and scripts to install macOS on the HP EliteDesk 800 G3 Desktop Mini Business PC (35 W/65 W).</p>\n<p><img src=\"https://support.hp.com/doc-images/700/c05373338.jpg\" alt=\"HP EliteDesk 800 G3 Desktop Mini Business PC\"></p>\n<h2 id=\"Hardware-Specs\"><a href=\"#Hardware-Specs\" class=\"headerlink\" title=\"Hardware Specs\"></a>Hardware Specs</h2><h3 id=\"Basic-info\"><a href=\"#Basic-info\" class=\"headerlink\" title=\"Basic info\"></a>Basic info</h3><p>Here is my EliteDesk 800 G3 DM specs:</p>\n<ul>\n<li>Product Number: Y3A18AV</li>\n<li>Product Name: HP EliteDesk 800 G3 DM 65W</li>\n<li>BIOS: P21 Ver.02.22 07/17/2018</li>\n</ul>\n<h3 id=\"Specs\"><a href=\"#Specs\" class=\"headerlink\" title=\"Specs:\"></a>Specs:</h3><ul>\n<li>CPU: Intel® Core i7-7700 @ 3.60 GHz processor (65 W model only)</li>\n<li>GPU: Integrated Intel® HD Graphics 630 (3 DisplayPorts)</li>\n<li>Memory: 2 x 4GB Samsung DDR4-2400</li>\n<li>Storage: Intel® 256 GB SSD, PCI-E Gen3 x 4, Turbo Drive G2 TLC SSD</li>\n<li>LAN: Intel® I219LM Gigabit Network Connection LOM</li>\n<li>WLAN: Intel® 8265 802.11ac 2x2 Wi-Fi with Bluetooth M.2 Combo Card Vpro (802.11ac Wave 2 supported)</li>\n<li>Audio: Conexant CX20632 Audio Codec (all ports are stereo, 1 internal speaker, 1 front headphone, 1 front CITA port)</li>\n</ul>\n<p>Full specs you can get from <a href=\"https://support.hp.com/us-en/document/c05371240?jumpid=reg_r1002_cnzh_c-001_title_r0002\">HP Website</a>.</p>\n<h2 id=\"Configure-BIOS-Settings\"><a href=\"#Configure-BIOS-Settings\" class=\"headerlink\" title=\"Configure BIOS Settings\"></a>Configure BIOS Settings</h2><p>To start, set BIOS to defaults.<br>Then insure:</p>\n<ul>\n<li><p>Advanced -&gt; Boot Options</p>\n<ul>\n<li>Disable <strong>Fast Boot</strong></li>\n<li>Disable <strong>CD-ROM Boot</strong></li>\n<li>Enable <strong>USB Storage Boot</strong></li>\n<li>Disable <strong>Network (PXE) Boot</strong></li>\n</ul>\n</li>\n<li><p>Advanced -&gt; Secure Boot Configuration</p>\n<ul>\n<li>Select <strong>Legacy Support Enable and Secure Boot Disable</strong>, press <strong>F10</strong> to save changes, system will reboot and lead you to Secure Boot and ask you to input a 4 digits security code for authorization, type in the code shows on the screen and enter to reboot and then press <strong>F10</strong> again to enter BIOS configuration</li>\n<li>Uncheck <strong>Enable MS UEFI CA key</strong> if you don’t use Windows</li>\n</ul>\n</li>\n<li><p>Advanced -&gt; System Options</p>\n<ul>\n<li>Disable <strong>Virtualization Technology (VTx)</strong></li>\n<li>Disable <strong>Virtualization Technology for Directed I/O (VTd)</strong></li>\n<li>Enable <strong>M.2 SSD</strong> if you’re using a NVME SSD</li>\n<li>Uncheck <strong>M.2 WLAN/BT</strong> if you’re using a Intel 8265NGW or other unsupported card</li>\n<li>Check <strong>Allow PCIe/PCI SERR# Interrupt</strong> (Uncheck it if have interruption issues)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Advanced-gt-Built-in-Device-Options\"><a href=\"#Advanced-gt-Built-in-Device-Options\" class=\"headerlink\" title=\"Advanced -> Built-in Device Options\"></a>Advanced -&gt; Built-in Device Options</h4><ul>\n<li>Disable <strong>Wake on LAN</strong></li>\n<li>Set Video memory size to <strong>64MB</strong> or larger</li>\n<li>Disable <strong>LAN/WLAN Auto Switching</strong></li>\n<li>Disable <strong>Wake on WLAN</strong></li>\n</ul>\n<h4 id=\"Advanced-gt-Port-Options\"><a href=\"#Advanced-gt-Port-Options\" class=\"headerlink\" title=\"Advanced -> Port Options\"></a>Advanced -&gt; Port Options</h4><ul>\n<li>Enable <strong>all</strong> if no specific reasons.</li>\n</ul>\n<h4 id=\"Advanced-gt-Power-Management-Options\"><a href=\"#Advanced-gt-Power-Management-Options\" class=\"headerlink\" title=\"Advanced -> Power Management Options\"></a>Advanced -&gt; Power Management Options</h4><ul>\n<li>Disable <strong>Extended Idle Power States</strong></li>\n</ul>\n<p>Press <strong>F10</strong> to save changes.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><ul>\n<li>To be updated</li>\n</ul>\n<h3 id=\"Tested-OS\"><a href=\"#Tested-OS\" class=\"headerlink\" title=\"Tested OS\"></a>Tested OS</h3><ul>\n<li>macOS High Sierra 10.13.6 </li>\n<li>macOS Mojave 10.14.1</li>\n</ul>\n<h3 id=\"Clover\"><a href=\"#Clover\" class=\"headerlink\" title=\"Clover\"></a>Clover</h3><ul>\n<li>Clover r4701.RM (Build by RehabMan)</li>\n</ul>\n<h3 id=\"Kexts\"><a href=\"#Kexts\" class=\"headerlink\" title=\"Kexts\"></a>Kexts</h3><ul>\n<li>EFICheckDisabler.kext (0.5)</li>\n<li>FakePCIID_XHCIMux.kext (1.3.15) </li>\n<li>FakeSMC.kext (6.26-357-gceb835ea.1800)<ul>\n<li>ACPISensors.kext (6.26-357-gceb835ea.1800)</li>\n<li>CPUSensors.kext (6.26-357-gceb835ea.1800)</li>\n<li>GPUSensors.kext (6.26-357-gceb835ea.1800)</li>\n<li>LPCSensors.kext (6.26-357-gceb835ea.1800)</li>\n</ul>\n</li>\n<li>IntelMausiEthernet.kext (2.4.1d1)</li>\n<li>Lilu.kext (1.2.8)<ul>\n<li>Added Resources/Headers and Resources/Library folders which are required to build with AppleALC in Xcode</li>\n</ul>\n</li>\n<li>VoodooHDA.kext (2.9.1)</li>\n<li>WhateverGreen.kext (1.2.4)</li>\n<li>XHCI-unsupported.kext (0.9.2)</li>\n</ul>\n<h2 id=\"Known-Issues\"><a href=\"#Known-Issues\" class=\"headerlink\" title=\"Known Issues:\"></a>Known Issues:</h2><ul>\n<li>Audio codec CX20632 is not supported yet, using VoodooHDA instead</li>\n<li>Sleep is not working (Reboot or blackscreen when trying to wake it)</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h2 id=\"GitHub\"><a href=\"#GitHub\" class=\"headerlink\" title=\"GitHub\"></a>GitHub</h2><p>本文引用自我的 GitHub:<br><a href=\"https://github.com/randyzhong/OS-X-HP-EliteDesk-800-G3-DM-Clover\">OS-X-HP-EliteDesk-800-G3-DM-Clover</a></p>\n<h2 id=\"适用机型\"><a href=\"#适用机型\" class=\"headerlink\" title=\"适用机型\"></a>适用机型</h2><p>This repository contains the files and scripts to install macOS on the HP EliteDesk 800 G3 Desktop Mini Business PC (35 W/65 W).</p>\n<p><img src=\"https://support.hp.com/doc-images/700/c05373338.jpg\" alt=\"HP EliteDesk 800 G3 Desktop Mini Business PC\"></p>\n<h2 id=\"Hardware-Specs\"><a href=\"#Hardware-Specs\" class=\"headerlink\" title=\"Hardware Specs\"></a>Hardware Specs</h2><h3 id=\"Basic-info\"><a href=\"#Basic-info\" class=\"headerlink\" title=\"Basic info\"></a>Basic info</h3><p>Here is my EliteDesk 800 G3 DM specs:</p>\n<ul>\n<li>Product Number: Y3A18AV</li>\n<li>Product Name: HP EliteDesk 800 G3 DM 65W</li>\n<li>BIOS: P21 Ver.02.22 07/17/2018</li>\n</ul>\n<h3 id=\"Specs\"><a href=\"#Specs\" class=\"headerlink\" title=\"Specs:\"></a>Specs:</h3><ul>\n<li>CPU: Intel® Core i7-7700 @ 3.60 GHz processor (65 W model only)</li>\n<li>GPU: Integrated Intel® HD Graphics 630 (3 DisplayPorts)</li>\n<li>Memory: 2 x 4GB Samsung DDR4-2400</li>\n<li>Storage: Intel® 256 GB SSD, PCI-E Gen3 x 4, Turbo Drive G2 TLC SSD</li>\n<li>LAN: Intel® I219LM Gigabit Network Connection LOM</li>\n<li>WLAN: Intel® 8265 802.11ac 2x2 Wi-Fi with Bluetooth M.2 Combo Card Vpro (802.11ac Wave 2 supported)</li>\n<li>Audio: Conexant CX20632 Audio Codec (all ports are stereo, 1 internal speaker, 1 front headphone, 1 front CITA port)</li>\n</ul>\n<p>Full specs you can get from <a href=\"https://support.hp.com/us-en/document/c05371240?jumpid=reg_r1002_cnzh_c-001_title_r0002\">HP Website</a>.</p>\n<h2 id=\"Configure-BIOS-Settings\"><a href=\"#Configure-BIOS-Settings\" class=\"headerlink\" title=\"Configure BIOS Settings\"></a>Configure BIOS Settings</h2><p>To start, set BIOS to defaults.<br>Then insure:</p>\n<ul>\n<li><p>Advanced -&gt; Boot Options</p>\n<ul>\n<li>Disable <strong>Fast Boot</strong></li>\n<li>Disable <strong>CD-ROM Boot</strong></li>\n<li>Enable <strong>USB Storage Boot</strong></li>\n<li>Disable <strong>Network (PXE) Boot</strong></li>\n</ul>\n</li>\n<li><p>Advanced -&gt; Secure Boot Configuration</p>\n<ul>\n<li>Select <strong>Legacy Support Enable and Secure Boot Disable</strong>, press <strong>F10</strong> to save changes, system will reboot and lead you to Secure Boot and ask you to input a 4 digits security code for authorization, type in the code shows on the screen and enter to reboot and then press <strong>F10</strong> again to enter BIOS configuration</li>\n<li>Uncheck <strong>Enable MS UEFI CA key</strong> if you don’t use Windows</li>\n</ul>\n</li>\n<li><p>Advanced -&gt; System Options</p>\n<ul>\n<li>Disable <strong>Virtualization Technology (VTx)</strong></li>\n<li>Disable <strong>Virtualization Technology for Directed I/O (VTd)</strong></li>\n<li>Enable <strong>M.2 SSD</strong> if you’re using a NVME SSD</li>\n<li>Uncheck <strong>M.2 WLAN/BT</strong> if you’re using a Intel 8265NGW or other unsupported card</li>\n<li>Check <strong>Allow PCIe/PCI SERR# Interrupt</strong> (Uncheck it if have interruption issues)</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"Advanced-gt-Built-in-Device-Options\"><a href=\"#Advanced-gt-Built-in-Device-Options\" class=\"headerlink\" title=\"Advanced -> Built-in Device Options\"></a>Advanced -&gt; Built-in Device Options</h4><ul>\n<li>Disable <strong>Wake on LAN</strong></li>\n<li>Set Video memory size to <strong>64MB</strong> or larger</li>\n<li>Disable <strong>LAN/WLAN Auto Switching</strong></li>\n<li>Disable <strong>Wake on WLAN</strong></li>\n</ul>\n<h4 id=\"Advanced-gt-Port-Options\"><a href=\"#Advanced-gt-Port-Options\" class=\"headerlink\" title=\"Advanced -> Port Options\"></a>Advanced -&gt; Port Options</h4><ul>\n<li>Enable <strong>all</strong> if no specific reasons.</li>\n</ul>\n<h4 id=\"Advanced-gt-Power-Management-Options\"><a href=\"#Advanced-gt-Power-Management-Options\" class=\"headerlink\" title=\"Advanced -> Power Management Options\"></a>Advanced -&gt; Power Management Options</h4><ul>\n<li>Disable <strong>Extended Idle Power States</strong></li>\n</ul>\n<p>Press <strong>F10</strong> to save changes.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><ul>\n<li>To be updated</li>\n</ul>\n<h3 id=\"Tested-OS\"><a href=\"#Tested-OS\" class=\"headerlink\" title=\"Tested OS\"></a>Tested OS</h3><ul>\n<li>macOS High Sierra 10.13.6 </li>\n<li>macOS Mojave 10.14.1</li>\n</ul>\n<h3 id=\"Clover\"><a href=\"#Clover\" class=\"headerlink\" title=\"Clover\"></a>Clover</h3><ul>\n<li>Clover r4701.RM (Build by RehabMan)</li>\n</ul>\n<h3 id=\"Kexts\"><a href=\"#Kexts\" class=\"headerlink\" title=\"Kexts\"></a>Kexts</h3><ul>\n<li>EFICheckDisabler.kext (0.5)</li>\n<li>FakePCIID_XHCIMux.kext (1.3.15) </li>\n<li>FakeSMC.kext (6.26-357-gceb835ea.1800)<ul>\n<li>ACPISensors.kext (6.26-357-gceb835ea.1800)</li>\n<li>CPUSensors.kext (6.26-357-gceb835ea.1800)</li>\n<li>GPUSensors.kext (6.26-357-gceb835ea.1800)</li>\n<li>LPCSensors.kext (6.26-357-gceb835ea.1800)</li>\n</ul>\n</li>\n<li>IntelMausiEthernet.kext (2.4.1d1)</li>\n<li>Lilu.kext (1.2.8)<ul>\n<li>Added Resources/Headers and Resources/Library folders which are required to build with AppleALC in Xcode</li>\n</ul>\n</li>\n<li>VoodooHDA.kext (2.9.1)</li>\n<li>WhateverGreen.kext (1.2.4)</li>\n<li>XHCI-unsupported.kext (0.9.2)</li>\n</ul>\n<h2 id=\"Known-Issues\"><a href=\"#Known-Issues\" class=\"headerlink\" title=\"Known Issues:\"></a>Known Issues:</h2><ul>\n<li>Audio codec CX20632 is not supported yet, using VoodooHDA instead</li>\n<li>Sleep is not working (Reboot or blackscreen when trying to wake it)</li>\n</ul>\n</body></html>"},{"title":"在 Ubuntu 16.04 中安装 Docker CE","date":"2017-11-20T07:14:23.000Z","keywords":"Docker, Linux，Ubuntu","description":"安装 Docker 有很多种方式，常用的有三种：大部分人使用官方提供的 Docker 仓库，安装简单，也易于升级，推荐使用这种方法","_content":"\n安装 Docker 有很多种方式，常用的有三种：\n1. 大部分人使用官方提供的 Docker 仓库，安装简单，也易于升级，推荐使用这种方法\n2. 你也可以下载 DEB 包来手动安装和手动升级。通常这种方法适用于在没有互联网连接的与外界物理隔离的机器上安装 Docker\n3. 在开发和测试环境，也可以选择使用脚本来自动安装 Docker\n\nDocker 一开始是没有区分 EE 和 CE 版本的，随着 Docker 的流行，自17.03版本以后分为 CE (Community Edition - 社区版) 和 EE(Enterprise Edition - 企业版)，社区版并非阉割版，可以免费使用，企业版则提供了一些收费的高级特性，我们这里选择从官方仓库来安装 CE 社区版。\n\n<!--more-->\n\n#### 更新 APT\n1. 更新 apt 软件包列表\n\n`$ sudo apt-get update`\n\n![更新 apt 软件包](install-docker-ce-on-ubuntu-16/apt-update.jpg)\n\n2. 安装如下包使 apt 可以通过 HTTPS 来从仓库安装软件\n``` bash\nsudo apt-get install \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    software-properties-common\n```\n3. 添加 Docker 官方的 GPG Key\n\n`$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -`\n\n4. 校验 GPG Key 的指纹，最后8位应该是 0EBFCD88\n\n`$ sudo apt-key fingerprint 0EBFCD88`\n\n![添加/校验 Docker 官方的 GPG Key](install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg)\n\n5. 安装 stable 的 Docker 仓库，一般使用 stable 这个稳定版本。\n``` bash\nsudo add-apt-repository \\\n   \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\\n   $(lsb_release -cs) \\\n   stable\"\n```\n\n#### 安装 Docker CE\n##### 更新 apt 软件包列表\n\n`$ sudo apt-get update`\n![再次更新 apt 软件包](install-docker-ce-on-ubuntu-16/apt-update-docker.jpg)\n这个时候你可以看到 docker 的源了\n\n##### 安装最新的社区版\n\n`$ sudo apt-get install docker-ce`\n\n然而，如果你在国内，你可能会遇到如下错误：\n![安装报错](install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg)\n\n这是因为 Docker 的安装资源文件存放在 Amazon S3，有可能会被伟大的功夫网拦在外面，另外一个可能的原因是 S3 在国内连接太慢，会间歇性连接失败。\n还好国内的 [DaoCloud](https://get.daocloud.io/#install-docker) 公司提供了下面的快速安装方法（实际上就是用第三种的脚本安装）：\n\n`$ curl -sSL https://get.daocloud.io/docker | sh`\n\n这个方法适用于 Ubuntu，Debian,Centos 等大部分 Linux，DaoCloud 会每3小时同步一次 Docker 官方源。\n\n![从 DaoCloud 安装](install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg)\n\n#### 检查 Docker 版本\n\n`$ docker version`\n![permission denied](install-docker-ce-on-ubuntu-16/docker-permission.jpg)\n\n这里需要多一条命令来添加当前用户到 docker 组，这样不用 root 权限也可以使用 Docker\n`$ sudo usermod -aG docker username`  #这里的 username 就是你的非 root 用户名\n\n> 运行之后需要注销重新登录才能生效\n\n``` bash\n$ docker version\n\nClient:\n Version:      17.10.0-ce\n API version:  1.33\n Go version:   go1.8.3\n Git commit:   f4ffd25\n Built:        Tue Oct 17 19:04:16 2017\n OS/Arch:      linux/amd64\n\nServer:\n Version:      17.10.0-ce\n API version:  1.33 (minimum version 1.12)\n Go version:   go1.8.3\n Git commit:   f4ffd25\n Built:        Tue Oct 17 19:02:56 2017\n OS/Arch:      linux/amd64\n Experimental: false\n```\n\n#### 卸载 Docker CE\n`$ sudo apt-get purge docker-ce`\n\n![卸载 Docker CE](install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg)\n卸载 Docker 后, /var/lib/docker/目录下会保留原 Docker 的镜像，存储卷，自定义配置等文件。 如果需要全新安装 Docker，需要删除/var/lib/docker/目录。\n\n`$ sudo rm -rf /var/lib/docker`\n","source":"_posts/install-docker-ce-on-ubuntu-16.md","raw":"---\ntitle: 在 Ubuntu 16.04 中安装 Docker CE\ntags:\n  - Ubuntu\n  - Docker\ncategories:\n  - Docker\ndate: 2017-11-20 15:14:23\nkeywords: Docker, Linux，Ubuntu\ndescription: 安装 Docker 有很多种方式，常用的有三种：大部分人使用官方提供的 Docker 仓库，安装简单，也易于升级，推荐使用这种方法\n---\n\n安装 Docker 有很多种方式，常用的有三种：\n1. 大部分人使用官方提供的 Docker 仓库，安装简单，也易于升级，推荐使用这种方法\n2. 你也可以下载 DEB 包来手动安装和手动升级。通常这种方法适用于在没有互联网连接的与外界物理隔离的机器上安装 Docker\n3. 在开发和测试环境，也可以选择使用脚本来自动安装 Docker\n\nDocker 一开始是没有区分 EE 和 CE 版本的，随着 Docker 的流行，自17.03版本以后分为 CE (Community Edition - 社区版) 和 EE(Enterprise Edition - 企业版)，社区版并非阉割版，可以免费使用，企业版则提供了一些收费的高级特性，我们这里选择从官方仓库来安装 CE 社区版。\n\n<!--more-->\n\n#### 更新 APT\n1. 更新 apt 软件包列表\n\n`$ sudo apt-get update`\n\n![更新 apt 软件包](install-docker-ce-on-ubuntu-16/apt-update.jpg)\n\n2. 安装如下包使 apt 可以通过 HTTPS 来从仓库安装软件\n``` bash\nsudo apt-get install \\\n    apt-transport-https \\\n    ca-certificates \\\n    curl \\\n    software-properties-common\n```\n3. 添加 Docker 官方的 GPG Key\n\n`$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -`\n\n4. 校验 GPG Key 的指纹，最后8位应该是 0EBFCD88\n\n`$ sudo apt-key fingerprint 0EBFCD88`\n\n![添加/校验 Docker 官方的 GPG Key](install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg)\n\n5. 安装 stable 的 Docker 仓库，一般使用 stable 这个稳定版本。\n``` bash\nsudo add-apt-repository \\\n   \"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\\n   $(lsb_release -cs) \\\n   stable\"\n```\n\n#### 安装 Docker CE\n##### 更新 apt 软件包列表\n\n`$ sudo apt-get update`\n![再次更新 apt 软件包](install-docker-ce-on-ubuntu-16/apt-update-docker.jpg)\n这个时候你可以看到 docker 的源了\n\n##### 安装最新的社区版\n\n`$ sudo apt-get install docker-ce`\n\n然而，如果你在国内，你可能会遇到如下错误：\n![安装报错](install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg)\n\n这是因为 Docker 的安装资源文件存放在 Amazon S3，有可能会被伟大的功夫网拦在外面，另外一个可能的原因是 S3 在国内连接太慢，会间歇性连接失败。\n还好国内的 [DaoCloud](https://get.daocloud.io/#install-docker) 公司提供了下面的快速安装方法（实际上就是用第三种的脚本安装）：\n\n`$ curl -sSL https://get.daocloud.io/docker | sh`\n\n这个方法适用于 Ubuntu，Debian,Centos 等大部分 Linux，DaoCloud 会每3小时同步一次 Docker 官方源。\n\n![从 DaoCloud 安装](install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg)\n\n#### 检查 Docker 版本\n\n`$ docker version`\n![permission denied](install-docker-ce-on-ubuntu-16/docker-permission.jpg)\n\n这里需要多一条命令来添加当前用户到 docker 组，这样不用 root 权限也可以使用 Docker\n`$ sudo usermod -aG docker username`  #这里的 username 就是你的非 root 用户名\n\n> 运行之后需要注销重新登录才能生效\n\n``` bash\n$ docker version\n\nClient:\n Version:      17.10.0-ce\n API version:  1.33\n Go version:   go1.8.3\n Git commit:   f4ffd25\n Built:        Tue Oct 17 19:04:16 2017\n OS/Arch:      linux/amd64\n\nServer:\n Version:      17.10.0-ce\n API version:  1.33 (minimum version 1.12)\n Go version:   go1.8.3\n Git commit:   f4ffd25\n Built:        Tue Oct 17 19:02:56 2017\n OS/Arch:      linux/amd64\n Experimental: false\n```\n\n#### 卸载 Docker CE\n`$ sudo apt-get purge docker-ce`\n\n![卸载 Docker CE](install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg)\n卸载 Docker 后, /var/lib/docker/目录下会保留原 Docker 的镜像，存储卷，自定义配置等文件。 如果需要全新安装 Docker，需要删除/var/lib/docker/目录。\n\n`$ sudo rm -rf /var/lib/docker`\n","slug":"install-docker-ce-on-ubuntu-16","published":1,"updated":"2020-01-05T09:00:53.999Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4ku9004ik84shvg41ue7","content":"<html><head></head><body><p>安装 Docker 有很多种方式，常用的有三种：</p>\n<ol>\n<li>大部分人使用官方提供的 Docker 仓库，安装简单，也易于升级，推荐使用这种方法</li>\n<li>你也可以下载 DEB 包来手动安装和手动升级。通常这种方法适用于在没有互联网连接的与外界物理隔离的机器上安装 Docker</li>\n<li>在开发和测试环境，也可以选择使用脚本来自动安装 Docker</li>\n</ol>\n<p>Docker 一开始是没有区分 EE 和 CE 版本的，随着 Docker 的流行，自17.03版本以后分为 CE (Community Edition - 社区版) 和 EE(Enterprise Edition - 企业版)，社区版并非阉割版，可以免费使用，企业版则提供了一些收费的高级特性，我们这里选择从官方仓库来安装 CE 社区版。</p>\n<span id=\"more\"></span>\n\n<h4 id=\"更新-APT\"><a href=\"#更新-APT\" class=\"headerlink\" title=\"更新 APT\"></a>更新 APT</h4><ol>\n<li>更新 apt 软件包列表</li>\n</ol>\n<p><code>$ sudo apt-get update</code></p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/apt-update.jpg\" alt=\"更新 apt 软件包\"></p>\n<ol start=\"2\">\n<li>安装如下包使 apt 可以通过 HTTPS 来从仓库安装软件<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install \\</span><br><span class=\"line\">    apt-transport-https \\</span><br><span class=\"line\">    ca-certificates \\</span><br><span class=\"line\">    curl \\</span><br><span class=\"line\">    software-properties-common</span><br></pre></td></tr></tbody></table></figure></li>\n<li>添加 Docker 官方的 GPG Key</li>\n</ol>\n<p><code>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code></p>\n<ol start=\"4\">\n<li>校验 GPG Key 的指纹，最后8位应该是 0EBFCD88</li>\n</ol>\n<p><code>$ sudo apt-key fingerprint 0EBFCD88</code></p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg\" alt=\"添加/校验 Docker 官方的 GPG Key\"></p>\n<ol start=\"5\">\n<li>安装 stable 的 Docker 仓库，一般使用 stable 这个稳定版本。<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo add-apt-repository \\</span><br><span class=\"line\">   <span class=\"string\">\"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\</span></span><br><span class=\"line\"><span class=\"string\">   <span class=\"subst\">$(lsb_release -cs)</span> \\</span></span><br><span class=\"line\"><span class=\"string\">   stable\"</span></span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<h4 id=\"安装-Docker-CE\"><a href=\"#安装-Docker-CE\" class=\"headerlink\" title=\"安装 Docker CE\"></a>安装 Docker CE</h4><h5 id=\"更新-apt-软件包列表\"><a href=\"#更新-apt-软件包列表\" class=\"headerlink\" title=\"更新 apt 软件包列表\"></a>更新 apt 软件包列表</h5><p><code>$ sudo apt-get update</code><br><img src=\"/install-docker-ce-on-ubuntu-16/apt-update-docker.jpg\" alt=\"再次更新 apt 软件包\"><br>这个时候你可以看到 docker 的源了</p>\n<h5 id=\"安装最新的社区版\"><a href=\"#安装最新的社区版\" class=\"headerlink\" title=\"安装最新的社区版\"></a>安装最新的社区版</h5><p><code>$ sudo apt-get install docker-ce</code></p>\n<p>然而，如果你在国内，你可能会遇到如下错误：<br><img src=\"/install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg\" alt=\"安装报错\"></p>\n<p>这是因为 Docker 的安装资源文件存放在 Amazon S3，有可能会被伟大的功夫网拦在外面，另外一个可能的原因是 S3 在国内连接太慢，会间歇性连接失败。<br>还好国内的 <a href=\"https://get.daocloud.io/#install-docker\">DaoCloud</a> 公司提供了下面的快速安装方法（实际上就是用第三种的脚本安装）：</p>\n<p><code>$ curl -sSL https://get.daocloud.io/docker | sh</code></p>\n<p>这个方法适用于 Ubuntu，Debian,Centos 等大部分 Linux，DaoCloud 会每3小时同步一次 Docker 官方源。</p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg\" alt=\"从 DaoCloud 安装\"></p>\n<h4 id=\"检查-Docker-版本\"><a href=\"#检查-Docker-版本\" class=\"headerlink\" title=\"检查 Docker 版本\"></a>检查 Docker 版本</h4><p><code>$ docker version</code><br><img src=\"/install-docker-ce-on-ubuntu-16/docker-permission.jpg\" alt=\"permission denied\"></p>\n<p>这里需要多一条命令来添加当前用户到 docker 组，这样不用 root 权限也可以使用 Docker<br><code>$ sudo usermod -aG docker username</code>  #这里的 username 就是你的非 root 用户名</p>\n<blockquote>\n<p>运行之后需要注销重新登录才能生效</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker version</span><br><span class=\"line\"></span><br><span class=\"line\">Client:</span><br><span class=\"line\"> Version:      17.10.0-ce</span><br><span class=\"line\"> API version:  1.33</span><br><span class=\"line\"> Go version:   go1.8.3</span><br><span class=\"line\"> Git commit:   f4ffd25</span><br><span class=\"line\"> Built:        Tue Oct 17 19:04:16 2017</span><br><span class=\"line\"> OS/Arch:      linux/amd64</span><br><span class=\"line\"></span><br><span class=\"line\">Server:</span><br><span class=\"line\"> Version:      17.10.0-ce</span><br><span class=\"line\"> API version:  1.33 (minimum version 1.12)</span><br><span class=\"line\"> Go version:   go1.8.3</span><br><span class=\"line\"> Git commit:   f4ffd25</span><br><span class=\"line\"> Built:        Tue Oct 17 19:02:56 2017</span><br><span class=\"line\"> OS/Arch:      linux/amd64</span><br><span class=\"line\"> Experimental: <span class=\"literal\">false</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"卸载-Docker-CE\"><a href=\"#卸载-Docker-CE\" class=\"headerlink\" title=\"卸载 Docker CE\"></a>卸载 Docker CE</h4><p><code>$ sudo apt-get purge docker-ce</code></p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg\" alt=\"卸载 Docker CE\"><br>卸载 Docker 后, /var/lib/docker/目录下会保留原 Docker 的镜像，存储卷，自定义配置等文件。 如果需要全新安装 Docker，需要删除/var/lib/docker/目录。</p>\n<p><code>$ sudo rm -rf /var/lib/docker</code></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><p>安装 Docker 有很多种方式，常用的有三种：</p>\n<ol>\n<li>大部分人使用官方提供的 Docker 仓库，安装简单，也易于升级，推荐使用这种方法</li>\n<li>你也可以下载 DEB 包来手动安装和手动升级。通常这种方法适用于在没有互联网连接的与外界物理隔离的机器上安装 Docker</li>\n<li>在开发和测试环境，也可以选择使用脚本来自动安装 Docker</li>\n</ol>\n<p>Docker 一开始是没有区分 EE 和 CE 版本的，随着 Docker 的流行，自17.03版本以后分为 CE (Community Edition - 社区版) 和 EE(Enterprise Edition - 企业版)，社区版并非阉割版，可以免费使用，企业版则提供了一些收费的高级特性，我们这里选择从官方仓库来安装 CE 社区版。</p></body></html>","more":"<html><head></head><body><h4 id=\"更新-APT\"><a href=\"#更新-APT\" class=\"headerlink\" title=\"更新 APT\"></a>更新 APT</h4><ol>\n<li>更新 apt 软件包列表</li>\n</ol>\n<p><code>$ sudo apt-get update</code></p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/apt-update.jpg\" alt=\"更新 apt 软件包\"></p>\n<ol start=\"2\">\n<li>安装如下包使 apt 可以通过 HTTPS 来从仓库安装软件<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install \\</span><br><span class=\"line\">    apt-transport-https \\</span><br><span class=\"line\">    ca-certificates \\</span><br><span class=\"line\">    curl \\</span><br><span class=\"line\">    software-properties-common</span><br></pre></td></tr></tbody></table></figure></li>\n<li>添加 Docker 官方的 GPG Key</li>\n</ol>\n<p><code>$ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -</code></p>\n<ol start=\"4\">\n<li>校验 GPG Key 的指纹，最后8位应该是 0EBFCD88</li>\n</ol>\n<p><code>$ sudo apt-key fingerprint 0EBFCD88</code></p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg\" alt=\"添加/校验 Docker 官方的 GPG Key\"></p>\n<ol start=\"5\">\n<li>安装 stable 的 Docker 仓库，一般使用 stable 这个稳定版本。<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo add-apt-repository \\</span><br><span class=\"line\">   <span class=\"string\">\"deb [arch=amd64] https://download.docker.com/linux/ubuntu \\</span></span><br><span class=\"line\"><span class=\"string\">   <span class=\"subst\">$(lsb_release -cs)</span> \\</span></span><br><span class=\"line\"><span class=\"string\">   stable\"</span></span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<h4 id=\"安装-Docker-CE\"><a href=\"#安装-Docker-CE\" class=\"headerlink\" title=\"安装 Docker CE\"></a>安装 Docker CE</h4><h5 id=\"更新-apt-软件包列表\"><a href=\"#更新-apt-软件包列表\" class=\"headerlink\" title=\"更新 apt 软件包列表\"></a>更新 apt 软件包列表</h5><p><code>$ sudo apt-get update</code><br><img src=\"/install-docker-ce-on-ubuntu-16/apt-update-docker.jpg\" alt=\"再次更新 apt 软件包\"><br>这个时候你可以看到 docker 的源了</p>\n<h5 id=\"安装最新的社区版\"><a href=\"#安装最新的社区版\" class=\"headerlink\" title=\"安装最新的社区版\"></a>安装最新的社区版</h5><p><code>$ sudo apt-get install docker-ce</code></p>\n<p>然而，如果你在国内，你可能会遇到如下错误：<br><img src=\"/install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg\" alt=\"安装报错\"></p>\n<p>这是因为 Docker 的安装资源文件存放在 Amazon S3，有可能会被伟大的功夫网拦在外面，另外一个可能的原因是 S3 在国内连接太慢，会间歇性连接失败。<br>还好国内的 <a href=\"https://get.daocloud.io/#install-docker\">DaoCloud</a> 公司提供了下面的快速安装方法（实际上就是用第三种的脚本安装）：</p>\n<p><code>$ curl -sSL https://get.daocloud.io/docker | sh</code></p>\n<p>这个方法适用于 Ubuntu，Debian,Centos 等大部分 Linux，DaoCloud 会每3小时同步一次 Docker 官方源。</p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg\" alt=\"从 DaoCloud 安装\"></p>\n<h4 id=\"检查-Docker-版本\"><a href=\"#检查-Docker-版本\" class=\"headerlink\" title=\"检查 Docker 版本\"></a>检查 Docker 版本</h4><p><code>$ docker version</code><br><img src=\"/install-docker-ce-on-ubuntu-16/docker-permission.jpg\" alt=\"permission denied\"></p>\n<p>这里需要多一条命令来添加当前用户到 docker 组，这样不用 root 权限也可以使用 Docker<br><code>$ sudo usermod -aG docker username</code>  #这里的 username 就是你的非 root 用户名</p>\n<blockquote>\n<p>运行之后需要注销重新登录才能生效</p>\n</blockquote>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ docker version</span><br><span class=\"line\"></span><br><span class=\"line\">Client:</span><br><span class=\"line\"> Version:      17.10.0-ce</span><br><span class=\"line\"> API version:  1.33</span><br><span class=\"line\"> Go version:   go1.8.3</span><br><span class=\"line\"> Git commit:   f4ffd25</span><br><span class=\"line\"> Built:        Tue Oct 17 19:04:16 2017</span><br><span class=\"line\"> OS/Arch:      linux/amd64</span><br><span class=\"line\"></span><br><span class=\"line\">Server:</span><br><span class=\"line\"> Version:      17.10.0-ce</span><br><span class=\"line\"> API version:  1.33 (minimum version 1.12)</span><br><span class=\"line\"> Go version:   go1.8.3</span><br><span class=\"line\"> Git commit:   f4ffd25</span><br><span class=\"line\"> Built:        Tue Oct 17 19:02:56 2017</span><br><span class=\"line\"> OS/Arch:      linux/amd64</span><br><span class=\"line\"> Experimental: <span class=\"literal\">false</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"卸载-Docker-CE\"><a href=\"#卸载-Docker-CE\" class=\"headerlink\" title=\"卸载 Docker CE\"></a>卸载 Docker CE</h4><p><code>$ sudo apt-get purge docker-ce</code></p>\n<p><img src=\"/install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg\" alt=\"卸载 Docker CE\"><br>卸载 Docker 后, /var/lib/docker/目录下会保留原 Docker 的镜像，存储卷，自定义配置等文件。 如果需要全新安装 Docker，需要删除/var/lib/docker/目录。</p>\n<p><code>$ sudo rm -rf /var/lib/docker</code></p></body></html>"},{"title":"Install Microsoft Dynamics CRM 4.0 Server on multiple computers","date":"2008-06-28T07:10:02.000Z","_content":"\n这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 `Web Services` 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段， **ADsdkRootDomain** 和**ADWebApplicationRootDomain**， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了\n\n后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多\n[http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx](http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx)","source":"_posts/install-microsoft-dynamics-crm-4-0-server-on-multiple-computers.md","raw":"---\ntitle: Install Microsoft Dynamics CRM 4.0 Server on multiple computers\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2008-06-28 15:10:02\n---\n\n这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 `Web Services` 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段， **ADsdkRootDomain** 和**ADWebApplicationRootDomain**， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了\n\n后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多\n[http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx](http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx)","slug":"install-microsoft-dynamics-crm-4-0-server-on-multiple-computers","published":1,"updated":"2020-01-05T09:00:54.004Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kua004lk84s6h8ngrbv","content":"<html><head></head><body><p>这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 <code>Web Services</code> 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段，&nbsp;<strong>ADsdkRootDomain</strong>&nbsp;和<strong>ADWebApplicationRootDomain</strong>， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了</p>\n<p>后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多<br><a href=\"http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx\">http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 <code>Web Services</code> 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段，&nbsp;<strong>ADsdkRootDomain</strong>&nbsp;和<strong>ADWebApplicationRootDomain</strong>， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了</p>\n<p>后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多<br><a href=\"http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx\">http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx</a></p>\n</body></html>"},{"title":"CentOS 7 安装 LEMP - PHP5.6 + NGINX + MariaDB/MySQL","date":"2018-12-29T03:40:11.000Z","keywords":"CentOS, LEMP, Nginx, PHP, Mariadb, MySQL, FastCGI","description":"以前我们常常听说的 LAMP (Linux, Apache, MySQL, and PHP) 是最经典的建站环境之一，迄今仍旧够到很多中小站长的欢迎。但 Apache 的缺点是有些臃肿，资源开销比较大，对硬件的要求相较于其它一些轻量的 Web 服务器要高，， 而 MySQL 的母公司 SUN 在被 Oracle 收购之后，社区担心 MySQL 的开源许可可能会存在闭源风险，于是 MySQL 之父 Michael Widenius (often called Monty) 以他女儿 Maria 的名字创建了MySQL的另外一个衍生版本：MariaDB。在用 NGINX 替代 Apache 和 MariaDB 替代 MySQL 之后，LEMP 就诞生了，尤其适用于服务器资源吃紧，内存少又想压榨出高并发高流量性能的场景。本文就是记录在 CentOS 7.5 64-bit 系统下面安装 LEMP (PHP5.6 + NGINX + MariaDB/MySQL) 的步骤。","_content":"## 什么是 LEMP\n![LEMP](install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg)\n以前我们常常听说的 LAMP (Linux, Apache, MySQL, and PHP) 是最经典的建站环境之一，迄今仍旧够到很多中小站长的欢迎。但 Apache 的缺点是有些臃肿，资源开销比较大，对硬件的要求相较于其它一些轻量的 Web 服务器要高，， 而 MySQL 的母公司 SUN 在被 Oracle 收购之后，社区担心 MySQL 的开源许可可能会存在闭源风险，于是 MySQL 之父 Michael Widenius (often called Monty) 以他女儿 Maria 的名字创建了MySQL的另外一个衍生版本：MariaDB。在用 NGINX 替代 Apache 和 MariaDB 替代 MySQL 之后，LEMP 就诞生了，尤其适用于服务器资源吃紧，内存少又想压榨出高并发高流量性能的场景。\n<!--more-->\n\n## 测试环境\n本文所述的环境基于腾讯云 CentOS 7.5 64-bit 公共镜像搭建，安装完成后的各组件版本如下：\n- CentOS 7.5 64-bit\n- NGINX 1.14.2\n- MariaDB 5.5.60\n- PHP 5.6.39*\n> *CentOS 官方默认带的 PHP 为 5.4.16，而我们某些程序需要 5.6+ 才能正常运行，本文的目的就是记录下如何安装 PHP5.6 的 LEMP环境\n\n## 开始前的准备工作\n### 时间设置\n**列出当前时间相关设置**\n`timedatectl status`\n```text\n      Local time: Fri 2018-12-28 13:20:01 CST\n  Universal time: Fri 2018-12-28 05:20:01 UTC\n        RTC time: Fri 2018-12-28 05:19:59\n       Time zone: Asia/Shanghai (CST, +0800)\n     NTP enabled: no\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n```\n**1.设置时区**\n`sudo timedatectl set-timezone Asia/Shanghai` （这一步腾讯云的 CentOS 公共镜像已经设置好，可跳过）\n**2.安装 NTP**\n`sudo yum install ntp`\n**3.设置为与 NTP 服务器同步**\n`sudo timedatectl set-ntp true`\n**4.同步时间**\n`sudo ntpdate pool.ntp.org`\n**5.再检查时间设置**\n`timedatectl status` \n```text\n Local time: Fri 2018-12-28 14:05:53 CST\n  Universal time: Fri 2018-12-28 06:05:53 UTC\n        RTC time: Fri 2018-12-28 06:05:51\n       Time zone: Asia/Shanghai (CST, +0800)\n     NTP enabled: yes\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n```\n\n### 安装 yum-utils 软件包便于管理维护\n`sudo yum install yum-utils`\n\n### 获取系统最新更新\n`sudo yum update` #生产环境慎用，这条命令会更新所有软件包，可能会破环依赖关系\n或者用下面 `sudo yum -y update --security` 这条命令只更新安全补丁，胆子小的可以用 `sudo yum update-minimal --security -y`\n> 不管更新啥，在测试环境测好再部署到生产环境是必要的\n\n### 添加含有各种 PHP 版本的 Remi 仓库 (本文用的清华大学镜像站点)\n`sudo yum install https://mirrors.tuna.tsinghua.edu.cn/remi/enterprise/remi-release-7.rpm`\n\n### 启用 Remi 仓库中 PHP 5.6 的源\n`sudo yum-config-manager --enable remi-php56`\n\n## NGINX\n本文推荐从 NGINX 的官方源来安装\n**1.创建 `/etc/yum.repos.d/nginx.repo` 文件，内容如下**\n```config\n[nginx]\nname=nginx repo\n# Choose mainline or stable release\nbaseurl=http://nginx.org/packages/centos/$releasever/$basearch/\n# baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/\ngpgcheck=0\nenabled=1\n```\n**2.更新源信息**\n`sudo yum check-update`\n\n**3.安装 NGINX**\n`sudo yum install nginx`\n\n**4.启动 NGINX**\n`sudo systemctl start nginx`\n\n**5.将 NGINX 添加到开机自启动**\n`sudo systemctl enable nginx`\n\n**6.测试 NGINX**\n![NGINX](install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg)\n\n## MariaDB\n**1.安装 MariaDB 和 MySQL/MariaDB-PHP 支持包**\n`sudo yum install mariadb-server php-mysql`\n\n**2.启动 MariaDB**\n`sudo systemctl start mariadb`\n\n**3.将 MariaDB 添加到开机自启动**\n`sudo systemctl enable mariadb`\n\n**4.安全设置**\n`sudo mysql_secure_installation`\n\n因为是新安装的 MariaDB，还没有为 root 用户设置密码，直接按回车键\nEnter current password for root (enter for none):\n\n接下来按 **Y** 设置 root 密码 \nSet root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\n按 **Y** 或者直接回车键接受以下四个默认安全设置\n- Remove anonymous users?\n- Disallow root login remotely?\n- Remove test database and access to it?\n- Reload privilege tables now?\n\n最后看到如下字样即表示安全设置完成\n```text\nAll done!  If you've completed all of the above steps, your MariaDB\ninstallation should now be secure.\n\nThanks for using MariaDB!\n```\n## PHP 5.6\n**1.安装 PHP FastCGI Processing Manager**\n`sudo yum install php-fpm`\n\n**2.已知漏洞修复**\n编辑 **/etc/php.ini** 文件，关闭 NGINX + PHP-FPM 中关于 fix_pathinfo 的一个漏洞，详情参见[这篇文章](http://www.laruence.com/2010/05/20/1495.html)\n`sudo sed -i 's/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g' /etc/php.ini`\n\n**3.修改 **/etc/php-fpm.d/www.conf**\nPHP 默认是以 Apache 来作为 Web 服务器的，所以其运行的默认用户为 `apache`，我们需要修改为 `nginx`\n```bash\nsudo sed -i 's/user = apache/user = nginx/g' /etc/php-fpm.d/www.conf\nsudo sed -i 's/group = apache/group = nginx/g' /etc/php-fpm.d/www.conf\n```\n**4.启动 PHP-FPM**\n`sudo systemctl start php-fpm`\n\n**5.将 MariaDB 添加到开机自启动**\n`sudo systemctl enable php-fpm`\n\n## 配置 NGINX 使其解析 PHP 文件\n**1.创建你网站程序的目录**\n`sudo mkdir -p /var/www/example.com/`\n\n**2.禁用 NGINX 默认的站点配置文件**\n`sudo mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.disabled`\n\n**3.创建 example.com 的站点配置文件**\n`sudo vi /etc/nginx/conf.d/example.com.conf`\n```nginx\nserver {\n    # Ipv4\n    listen 80;\n\n    # IPv6\n    # listen [::]:80;\n\n    # SSL Ipv4 & v6\n    # listen 443 ssl;\n    # listen [::]:443 ssl;\n\n    # [REQUIRED EDIT] Your domain name goes here\n    server_name example.com www.example.com;\n\n    # [REQUIRED EDIT] Absolute path to your website root on the filesystem\n    root /var/www/example.com;\n        \n    index index.php index.html index.htm;\n\n    # PHP FPM part\n        location ~ [^/]\\.php(/|$) {\n                fastcgi_split_path_info ^(.+?\\.php)(/.*)$;\n                if (!-f $document_root$fastcgi_script_name) {\n                        return 404;\n                }\n\n        # Mitigate https://httpoxy.org/ vulnerabilities\n        fastcgi_param HTTP_PROXY \"\";\n\n         fastcgi_pass 127.0.0.1:9000;\n         fastcgi_index index.php;\n\n        # include the fastcgi_param setting\n        include fastcgi_params;\n\n        # SCRIPT_FILENAME parameter is used for PHP FPM determining\n        #  the script name. If it is not set in fastcgi_params file,\n        # i.e. /etc/nginx/fastcgi_params or in the parent contexts,\n        # please comment off following line:\n        fastcgi_param  SCRIPT_FILENAME   $document_root$fastcgi_script_name;    \n        }\n}\n```\n**4.测试 PHP 解析**\n`sudo vi /var/www/example.com/info.php`\n\n编辑该文件内容如下：\n```php\n<?php phpinfo(); ?>\n```\n然后访问 http://example.com/info.php ，正常的话你应该能看到 PHP 信息页面了。\n\n**5.404 not found/403 Forbidden**\n如果你确认以上操作都已经正常进行，NGINX 和 PHP-FPM 的配置文件都已经改好，但是在访问 PHP 页面的时候出现 404 not found/403 Forbidden 或者 FastCGI sent in stderr: Unable to open primary script 错误，那么有可能是 SELinux 的问题。你可以通过查看 SELinux 的审计日志 **/var/log/audit/audit.log** 来确认，一般会出现 avc: denied { read } for pid=1213 comm=\"nginx\" name=“info.php”... 之类的错误。\n问题确认后，我们用 `setstatus` 来查看当前的 SELinux 设置\n```bash\n# sestatus\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          enforcing\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMax kernel policy version:      31\n```\n 或者 `cat /etc/selinux/config` \n```bash\n# cat /etc/selinux/config \n\n# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=enforcing\n# SELINUXTYPE= can take one of three two values:\n#     targeted - Targeted processes are protected,\n#     minimum - Modification of targeted policy. Only selected processes are protected. \n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n```\n\n如果当前状态是 **enforcing**，说明 SELinux 已经启用，那么你可以试着用 `setenforce 0` 禁用 SELinux（只显示告警）再尝试访问 PHP 文件，如果可以成功访问那你也有两个选择，一是禁用 SELinux （可能没那么安全），二是使用 **restorecon** 来恢复网站目录的 SELinux 安全配置上下文信息：\n`restorecon -R -v /var/www/example.com`\n\n若是之后部署有些网站程序还是没法访问，确定是 SELinux 的锅但是你又想留着它的话，可参考以下几篇文章：\n- [Using NGINX and NGINX Plus with SELinux](https://www.nginx.com/blog/using-nginx-plus-with-selinux/)\n- [SELinux - CentOS Wiki](https://wiki.centos.org/HowTos/SELinux)\n- [Configuring SELinux Policies for Apache Web Servers](https://www.serverlab.ca/tutorials/linux/web-servers-linux/configuring-selinux-policies-for-apache-web-servers/) - 这篇讲 Apache 的，但还是可以作为参考\n","source":"_posts/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi.md","raw":"---\ntitle: CentOS 7 安装 LEMP - PHP5.6 + NGINX + MariaDB/MySQL\ntags:\n  - CentOS\n  - LEMP\n  - Nginx\n  - PHP\n  - MariaDB\n  - MySQL\ncategories:\n  - '*Nix'\ndate: 2018-12-29 11:40:11\nkeywords: CentOS, LEMP, Nginx, PHP, Mariadb, MySQL, FastCGI\ndescription: 以前我们常常听说的 LAMP (Linux, Apache, MySQL, and PHP) 是最经典的建站环境之一，迄今仍旧够到很多中小站长的欢迎。但 Apache 的缺点是有些臃肿，资源开销比较大，对硬件的要求相较于其它一些轻量的 Web 服务器要高，， 而 MySQL 的母公司 SUN 在被 Oracle 收购之后，社区担心 MySQL 的开源许可可能会存在闭源风险，于是 MySQL 之父 Michael Widenius (often called Monty) 以他女儿 Maria 的名字创建了MySQL的另外一个衍生版本：MariaDB。在用 NGINX 替代 Apache 和 MariaDB 替代 MySQL 之后，LEMP 就诞生了，尤其适用于服务器资源吃紧，内存少又想压榨出高并发高流量性能的场景。本文就是记录在 CentOS 7.5 64-bit 系统下面安装 LEMP (PHP5.6 + NGINX + MariaDB/MySQL) 的步骤。\n---\n## 什么是 LEMP\n![LEMP](install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg)\n以前我们常常听说的 LAMP (Linux, Apache, MySQL, and PHP) 是最经典的建站环境之一，迄今仍旧够到很多中小站长的欢迎。但 Apache 的缺点是有些臃肿，资源开销比较大，对硬件的要求相较于其它一些轻量的 Web 服务器要高，， 而 MySQL 的母公司 SUN 在被 Oracle 收购之后，社区担心 MySQL 的开源许可可能会存在闭源风险，于是 MySQL 之父 Michael Widenius (often called Monty) 以他女儿 Maria 的名字创建了MySQL的另外一个衍生版本：MariaDB。在用 NGINX 替代 Apache 和 MariaDB 替代 MySQL 之后，LEMP 就诞生了，尤其适用于服务器资源吃紧，内存少又想压榨出高并发高流量性能的场景。\n<!--more-->\n\n## 测试环境\n本文所述的环境基于腾讯云 CentOS 7.5 64-bit 公共镜像搭建，安装完成后的各组件版本如下：\n- CentOS 7.5 64-bit\n- NGINX 1.14.2\n- MariaDB 5.5.60\n- PHP 5.6.39*\n> *CentOS 官方默认带的 PHP 为 5.4.16，而我们某些程序需要 5.6+ 才能正常运行，本文的目的就是记录下如何安装 PHP5.6 的 LEMP环境\n\n## 开始前的准备工作\n### 时间设置\n**列出当前时间相关设置**\n`timedatectl status`\n```text\n      Local time: Fri 2018-12-28 13:20:01 CST\n  Universal time: Fri 2018-12-28 05:20:01 UTC\n        RTC time: Fri 2018-12-28 05:19:59\n       Time zone: Asia/Shanghai (CST, +0800)\n     NTP enabled: no\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n```\n**1.设置时区**\n`sudo timedatectl set-timezone Asia/Shanghai` （这一步腾讯云的 CentOS 公共镜像已经设置好，可跳过）\n**2.安装 NTP**\n`sudo yum install ntp`\n**3.设置为与 NTP 服务器同步**\n`sudo timedatectl set-ntp true`\n**4.同步时间**\n`sudo ntpdate pool.ntp.org`\n**5.再检查时间设置**\n`timedatectl status` \n```text\n Local time: Fri 2018-12-28 14:05:53 CST\n  Universal time: Fri 2018-12-28 06:05:53 UTC\n        RTC time: Fri 2018-12-28 06:05:51\n       Time zone: Asia/Shanghai (CST, +0800)\n     NTP enabled: yes\nNTP synchronized: yes\n RTC in local TZ: no\n      DST active: n/a\n```\n\n### 安装 yum-utils 软件包便于管理维护\n`sudo yum install yum-utils`\n\n### 获取系统最新更新\n`sudo yum update` #生产环境慎用，这条命令会更新所有软件包，可能会破环依赖关系\n或者用下面 `sudo yum -y update --security` 这条命令只更新安全补丁，胆子小的可以用 `sudo yum update-minimal --security -y`\n> 不管更新啥，在测试环境测好再部署到生产环境是必要的\n\n### 添加含有各种 PHP 版本的 Remi 仓库 (本文用的清华大学镜像站点)\n`sudo yum install https://mirrors.tuna.tsinghua.edu.cn/remi/enterprise/remi-release-7.rpm`\n\n### 启用 Remi 仓库中 PHP 5.6 的源\n`sudo yum-config-manager --enable remi-php56`\n\n## NGINX\n本文推荐从 NGINX 的官方源来安装\n**1.创建 `/etc/yum.repos.d/nginx.repo` 文件，内容如下**\n```config\n[nginx]\nname=nginx repo\n# Choose mainline or stable release\nbaseurl=http://nginx.org/packages/centos/$releasever/$basearch/\n# baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/\ngpgcheck=0\nenabled=1\n```\n**2.更新源信息**\n`sudo yum check-update`\n\n**3.安装 NGINX**\n`sudo yum install nginx`\n\n**4.启动 NGINX**\n`sudo systemctl start nginx`\n\n**5.将 NGINX 添加到开机自启动**\n`sudo systemctl enable nginx`\n\n**6.测试 NGINX**\n![NGINX](install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg)\n\n## MariaDB\n**1.安装 MariaDB 和 MySQL/MariaDB-PHP 支持包**\n`sudo yum install mariadb-server php-mysql`\n\n**2.启动 MariaDB**\n`sudo systemctl start mariadb`\n\n**3.将 MariaDB 添加到开机自启动**\n`sudo systemctl enable mariadb`\n\n**4.安全设置**\n`sudo mysql_secure_installation`\n\n因为是新安装的 MariaDB，还没有为 root 用户设置密码，直接按回车键\nEnter current password for root (enter for none):\n\n接下来按 **Y** 设置 root 密码 \nSet root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\n按 **Y** 或者直接回车键接受以下四个默认安全设置\n- Remove anonymous users?\n- Disallow root login remotely?\n- Remove test database and access to it?\n- Reload privilege tables now?\n\n最后看到如下字样即表示安全设置完成\n```text\nAll done!  If you've completed all of the above steps, your MariaDB\ninstallation should now be secure.\n\nThanks for using MariaDB!\n```\n## PHP 5.6\n**1.安装 PHP FastCGI Processing Manager**\n`sudo yum install php-fpm`\n\n**2.已知漏洞修复**\n编辑 **/etc/php.ini** 文件，关闭 NGINX + PHP-FPM 中关于 fix_pathinfo 的一个漏洞，详情参见[这篇文章](http://www.laruence.com/2010/05/20/1495.html)\n`sudo sed -i 's/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g' /etc/php.ini`\n\n**3.修改 **/etc/php-fpm.d/www.conf**\nPHP 默认是以 Apache 来作为 Web 服务器的，所以其运行的默认用户为 `apache`，我们需要修改为 `nginx`\n```bash\nsudo sed -i 's/user = apache/user = nginx/g' /etc/php-fpm.d/www.conf\nsudo sed -i 's/group = apache/group = nginx/g' /etc/php-fpm.d/www.conf\n```\n**4.启动 PHP-FPM**\n`sudo systemctl start php-fpm`\n\n**5.将 MariaDB 添加到开机自启动**\n`sudo systemctl enable php-fpm`\n\n## 配置 NGINX 使其解析 PHP 文件\n**1.创建你网站程序的目录**\n`sudo mkdir -p /var/www/example.com/`\n\n**2.禁用 NGINX 默认的站点配置文件**\n`sudo mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.disabled`\n\n**3.创建 example.com 的站点配置文件**\n`sudo vi /etc/nginx/conf.d/example.com.conf`\n```nginx\nserver {\n    # Ipv4\n    listen 80;\n\n    # IPv6\n    # listen [::]:80;\n\n    # SSL Ipv4 & v6\n    # listen 443 ssl;\n    # listen [::]:443 ssl;\n\n    # [REQUIRED EDIT] Your domain name goes here\n    server_name example.com www.example.com;\n\n    # [REQUIRED EDIT] Absolute path to your website root on the filesystem\n    root /var/www/example.com;\n        \n    index index.php index.html index.htm;\n\n    # PHP FPM part\n        location ~ [^/]\\.php(/|$) {\n                fastcgi_split_path_info ^(.+?\\.php)(/.*)$;\n                if (!-f $document_root$fastcgi_script_name) {\n                        return 404;\n                }\n\n        # Mitigate https://httpoxy.org/ vulnerabilities\n        fastcgi_param HTTP_PROXY \"\";\n\n         fastcgi_pass 127.0.0.1:9000;\n         fastcgi_index index.php;\n\n        # include the fastcgi_param setting\n        include fastcgi_params;\n\n        # SCRIPT_FILENAME parameter is used for PHP FPM determining\n        #  the script name. If it is not set in fastcgi_params file,\n        # i.e. /etc/nginx/fastcgi_params or in the parent contexts,\n        # please comment off following line:\n        fastcgi_param  SCRIPT_FILENAME   $document_root$fastcgi_script_name;    \n        }\n}\n```\n**4.测试 PHP 解析**\n`sudo vi /var/www/example.com/info.php`\n\n编辑该文件内容如下：\n```php\n<?php phpinfo(); ?>\n```\n然后访问 http://example.com/info.php ，正常的话你应该能看到 PHP 信息页面了。\n\n**5.404 not found/403 Forbidden**\n如果你确认以上操作都已经正常进行，NGINX 和 PHP-FPM 的配置文件都已经改好，但是在访问 PHP 页面的时候出现 404 not found/403 Forbidden 或者 FastCGI sent in stderr: Unable to open primary script 错误，那么有可能是 SELinux 的问题。你可以通过查看 SELinux 的审计日志 **/var/log/audit/audit.log** 来确认，一般会出现 avc: denied { read } for pid=1213 comm=\"nginx\" name=“info.php”... 之类的错误。\n问题确认后，我们用 `setstatus` 来查看当前的 SELinux 设置\n```bash\n# sestatus\nSELinux status:                 enabled\nSELinuxfs mount:                /sys/fs/selinux\nSELinux root directory:         /etc/selinux\nLoaded policy name:             targeted\nCurrent mode:                   enforcing\nMode from config file:          enforcing\nPolicy MLS status:              enabled\nPolicy deny_unknown status:     allowed\nMax kernel policy version:      31\n```\n 或者 `cat /etc/selinux/config` \n```bash\n# cat /etc/selinux/config \n\n# This file controls the state of SELinux on the system.\n# SELINUX= can take one of these three values:\n#     enforcing - SELinux security policy is enforced.\n#     permissive - SELinux prints warnings instead of enforcing.\n#     disabled - No SELinux policy is loaded.\nSELINUX=enforcing\n# SELINUXTYPE= can take one of three two values:\n#     targeted - Targeted processes are protected,\n#     minimum - Modification of targeted policy. Only selected processes are protected. \n#     mls - Multi Level Security protection.\nSELINUXTYPE=targeted\n```\n\n如果当前状态是 **enforcing**，说明 SELinux 已经启用，那么你可以试着用 `setenforce 0` 禁用 SELinux（只显示告警）再尝试访问 PHP 文件，如果可以成功访问那你也有两个选择，一是禁用 SELinux （可能没那么安全），二是使用 **restorecon** 来恢复网站目录的 SELinux 安全配置上下文信息：\n`restorecon -R -v /var/www/example.com`\n\n若是之后部署有些网站程序还是没法访问，确定是 SELinux 的锅但是你又想留着它的话，可参考以下几篇文章：\n- [Using NGINX and NGINX Plus with SELinux](https://www.nginx.com/blog/using-nginx-plus-with-selinux/)\n- [SELinux - CentOS Wiki](https://wiki.centos.org/HowTos/SELinux)\n- [Configuring SELinux Policies for Apache Web Servers](https://www.serverlab.ca/tutorials/linux/web-servers-linux/configuring-selinux-policies-for-apache-web-servers/) - 这篇讲 Apache 的，但还是可以作为参考\n","slug":"install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi","published":1,"updated":"2019-01-02T10:04:02.679Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kua004ok84sczau2y0n","content":"<html><head></head><body><h2 id=\"什么是-LEMP\"><a href=\"#什么是-LEMP\" class=\"headerlink\" title=\"什么是 LEMP\"></a>什么是 LEMP</h2><p><img src=\"/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg\" alt=\"LEMP\"><br>以前我们常常听说的 LAMP (Linux, Apache, MySQL, and PHP) 是最经典的建站环境之一，迄今仍旧够到很多中小站长的欢迎。但 Apache 的缺点是有些臃肿，资源开销比较大，对硬件的要求相较于其它一些轻量的 Web 服务器要高，， 而 MySQL 的母公司 SUN 在被 Oracle 收购之后，社区担心 MySQL 的开源许可可能会存在闭源风险，于是 MySQL 之父 Michael Widenius (often called Monty) 以他女儿 Maria 的名字创建了MySQL的另外一个衍生版本：MariaDB。在用 NGINX 替代 Apache 和 MariaDB 替代 MySQL 之后，LEMP 就诞生了，尤其适用于服务器资源吃紧，内存少又想压榨出高并发高流量性能的场景。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h2><p>本文所述的环境基于腾讯云 CentOS 7.5 64-bit 公共镜像搭建，安装完成后的各组件版本如下：</p>\n<ul>\n<li>CentOS 7.5 64-bit</li>\n<li>NGINX 1.14.2</li>\n<li>MariaDB 5.5.60</li>\n<li>PHP 5.6.39*<blockquote>\n<p>*CentOS 官方默认带的 PHP 为 5.4.16，而我们某些程序需要 5.6+ 才能正常运行，本文的目的就是记录下如何安装 PHP5.6 的 LEMP环境</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"开始前的准备工作\"><a href=\"#开始前的准备工作\" class=\"headerlink\" title=\"开始前的准备工作\"></a>开始前的准备工作</h2><h3 id=\"时间设置\"><a href=\"#时间设置\" class=\"headerlink\" title=\"时间设置\"></a>时间设置</h3><p><strong>列出当前时间相关设置</strong><br><code>timedatectl status</code></p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      Local time: Fri 2018-12-28 13:20:01 CST</span><br><span class=\"line\">  Universal time: Fri 2018-12-28 05:20:01 UTC</span><br><span class=\"line\">        RTC time: Fri 2018-12-28 05:19:59</span><br><span class=\"line\">       Time zone: Asia/Shanghai (CST, +0800)</span><br><span class=\"line\">     NTP enabled: no</span><br><span class=\"line\">NTP synchronized: yes</span><br><span class=\"line\"> RTC in local TZ: no</span><br><span class=\"line\">      DST active: n/a</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>1.设置时区</strong><br><code>sudo timedatectl set-timezone Asia/Shanghai</code> （这一步腾讯云的 CentOS 公共镜像已经设置好，可跳过）<br><strong>2.安装 NTP</strong><br><code>sudo yum install ntp</code><br><strong>3.设置为与 NTP 服务器同步</strong><br><code>sudo timedatectl set-ntp true</code><br><strong>4.同步时间</strong><br><code>sudo ntpdate pool.ntp.org</code><br><strong>5.再检查时间设置</strong><br><code>timedatectl status</code> </p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> Local time: Fri 2018-12-28 14:05:53 CST</span><br><span class=\"line\">  Universal time: Fri 2018-12-28 06:05:53 UTC</span><br><span class=\"line\">        RTC time: Fri 2018-12-28 06:05:51</span><br><span class=\"line\">       Time zone: Asia/Shanghai (CST, +0800)</span><br><span class=\"line\">     NTP enabled: yes</span><br><span class=\"line\">NTP synchronized: yes</span><br><span class=\"line\"> RTC in local TZ: no</span><br><span class=\"line\">      DST active: n/a</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"安装-yum-utils-软件包便于管理维护\"><a href=\"#安装-yum-utils-软件包便于管理维护\" class=\"headerlink\" title=\"安装 yum-utils 软件包便于管理维护\"></a>安装 yum-utils 软件包便于管理维护</h3><p><code>sudo yum install yum-utils</code></p>\n<h3 id=\"获取系统最新更新\"><a href=\"#获取系统最新更新\" class=\"headerlink\" title=\"获取系统最新更新\"></a>获取系统最新更新</h3><p><code>sudo yum update</code> #生产环境慎用，这条命令会更新所有软件包，可能会破环依赖关系<br>或者用下面 <code>sudo yum -y update --security</code> 这条命令只更新安全补丁，胆子小的可以用 <code>sudo yum update-minimal --security -y</code></p>\n<blockquote>\n<p>不管更新啥，在测试环境测好再部署到生产环境是必要的</p>\n</blockquote>\n<h3 id=\"添加含有各种-PHP-版本的-Remi-仓库-本文用的清华大学镜像站点\"><a href=\"#添加含有各种-PHP-版本的-Remi-仓库-本文用的清华大学镜像站点\" class=\"headerlink\" title=\"添加含有各种 PHP 版本的 Remi 仓库 (本文用的清华大学镜像站点)\"></a>添加含有各种 PHP 版本的 Remi 仓库 (本文用的清华大学镜像站点)</h3><p><code>sudo yum install https://mirrors.tuna.tsinghua.edu.cn/remi/enterprise/remi-release-7.rpm</code></p>\n<h3 id=\"启用-Remi-仓库中-PHP-5-6-的源\"><a href=\"#启用-Remi-仓库中-PHP-5-6-的源\" class=\"headerlink\" title=\"启用 Remi 仓库中 PHP 5.6 的源\"></a>启用 Remi 仓库中 PHP 5.6 的源</h3><p><code>sudo yum-config-manager --enable remi-php56</code></p>\n<h2 id=\"NGINX\"><a href=\"#NGINX\" class=\"headerlink\" title=\"NGINX\"></a>NGINX</h2><p>本文推荐从 NGINX 的官方源来安装<br><strong>1.创建 <code>/etc/yum.repos.d/nginx.repo</code> 文件，内容如下</strong></p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[nginx]</span><br><span class=\"line\">name=nginx repo</span><br><span class=\"line\"># Choose mainline or stable release</span><br><span class=\"line\">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class=\"line\"># baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\">enabled=1</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>2.更新源信息</strong><br><code>sudo yum check-update</code></p>\n<p><strong>3.安装 NGINX</strong><br><code>sudo yum install nginx</code></p>\n<p><strong>4.启动 NGINX</strong><br><code>sudo systemctl start nginx</code></p>\n<p><strong>5.将 NGINX 添加到开机自启动</strong><br><code>sudo systemctl enable nginx</code></p>\n<p><strong>6.测试 NGINX</strong><br><img src=\"/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg\" alt=\"NGINX\"></p>\n<h2 id=\"MariaDB\"><a href=\"#MariaDB\" class=\"headerlink\" title=\"MariaDB\"></a>MariaDB</h2><p><strong>1.安装 MariaDB 和 MySQL/MariaDB-PHP 支持包</strong><br><code>sudo yum install mariadb-server php-mysql</code></p>\n<p><strong>2.启动 MariaDB</strong><br><code>sudo systemctl start mariadb</code></p>\n<p><strong>3.将 MariaDB 添加到开机自启动</strong><br><code>sudo systemctl enable mariadb</code></p>\n<p><strong>4.安全设置</strong><br><code>sudo mysql_secure_installation</code></p>\n<p>因为是新安装的 MariaDB，还没有为 root 用户设置密码，直接按回车键<br>Enter current password for root (enter for none):</p>\n<p>接下来按 <strong>Y</strong> 设置 root 密码<br>Set root password? [Y/n] Y<br>New password:<br>Re-enter new password:<br>Password updated successfully!<br>Reloading privilege tables..<br> … Success!</p>\n<p>按 <strong>Y</strong> 或者直接回车键接受以下四个默认安全设置</p>\n<ul>\n<li>Remove anonymous users?</li>\n<li>Disallow root login remotely?</li>\n<li>Remove test database and access to it?</li>\n<li>Reload privilege tables now?</li>\n</ul>\n<p>最后看到如下字样即表示安全设置完成</p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">All done!  If you've completed all of the above steps, your MariaDB</span><br><span class=\"line\">installation should now be secure.</span><br><span class=\"line\"></span><br><span class=\"line\">Thanks for using MariaDB!</span><br></pre></td></tr></tbody></table></figure>\n<h2 id=\"PHP-5-6\"><a href=\"#PHP-5-6\" class=\"headerlink\" title=\"PHP 5.6\"></a>PHP 5.6</h2><p><strong>1.安装 PHP FastCGI Processing Manager</strong><br><code>sudo yum install php-fpm</code></p>\n<p><strong>2.已知漏洞修复</strong><br>编辑 <strong>/etc/php.ini</strong> 文件，关闭 NGINX + PHP-FPM 中关于 fix_pathinfo 的一个漏洞，详情参见<a href=\"http://www.laruence.com/2010/05/20/1495.html\">这篇文章</a><br><code>sudo sed -i 's/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g' /etc/php.ini</code></p>\n<p>**3.修改 <strong>/etc/php-fpm.d/<a href=\"http://www.conf/\">www.conf</a></strong><br>PHP 默认是以 Apache 来作为 Web 服务器的，所以其运行的默认用户为 <code>apache</code>，我们需要修改为 <code>nginx</code></p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo sed -i <span class=\"string\">'s/user = apache/user = nginx/g'</span> /etc/php-fpm.d/www.conf</span><br><span class=\"line\">sudo sed -i <span class=\"string\">'s/group = apache/group = nginx/g'</span> /etc/php-fpm.d/www.conf</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>4.启动 PHP-FPM</strong><br><code>sudo systemctl start php-fpm</code></p>\n<p><strong>5.将 MariaDB 添加到开机自启动</strong><br><code>sudo systemctl enable php-fpm</code></p>\n<h2 id=\"配置-NGINX-使其解析-PHP-文件\"><a href=\"#配置-NGINX-使其解析-PHP-文件\" class=\"headerlink\" title=\"配置 NGINX 使其解析 PHP 文件\"></a>配置 NGINX 使其解析 PHP 文件</h2><p><strong>1.创建你网站程序的目录</strong><br><code>sudo mkdir -p /var/www/example.com/</code></p>\n<p><strong>2.禁用 NGINX 默认的站点配置文件</strong><br><code>sudo mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.disabled</code></p>\n<p><strong>3.创建 example.com 的站点配置文件</strong><br><code>sudo vi /etc/nginx/conf.d/example.com.conf</code></p>\n<figure class=\"highlight nginx\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> {</span><br><span class=\"line\">    <span class=\"comment\"># Ipv4</span></span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># IPv6</span></span><br><span class=\"line\">    <span class=\"comment\"># listen [::]:80;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># SSL Ipv4 &amp; v6</span></span><br><span class=\"line\">    <span class=\"comment\"># listen 443 ssl;</span></span><br><span class=\"line\">    <span class=\"comment\"># listen [::]:443 ssl;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># [REQUIRED EDIT] Your domain name goes here</span></span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> example.com www.example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># [REQUIRED EDIT] Absolute path to your website root on the filesystem</span></span><br><span class=\"line\">    <span class=\"attribute\">root</span> /var/www/example.com;</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"attribute\">index</span> index.php index.html index.htm;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># PHP FPM part</span></span><br><span class=\"line\">        <span class=\"section\">location</span> <span class=\"regexp\">~ [^/]\\.php(/|$)</span> {</span><br><span class=\"line\">                <span class=\"attribute\">fastcgi_split_path_info</span><span class=\"regexp\"> ^(.+?\\.php)(/.*)$</span>;</span><br><span class=\"line\">                <span class=\"attribute\">if</span> (!-f <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>) {</span><br><span class=\"line\">                        <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">                }</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Mitigate https://httpoxy.org/ vulnerabilities</span></span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_param</span> HTTP_PROXY <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">         <span class=\"attribute\">fastcgi_pass</span> <span class=\"number\">127.0.0.1:9000</span>;</span><br><span class=\"line\">         <span class=\"attribute\">fastcgi_index</span> index.php;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># include the fastcgi_param setting</span></span><br><span class=\"line\">        <span class=\"attribute\">include</span> fastcgi_params;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># SCRIPT_FILENAME parameter is used for PHP FPM determining</span></span><br><span class=\"line\">        <span class=\"comment\">#  the script name. If it is not set in fastcgi_params file,</span></span><br><span class=\"line\">        <span class=\"comment\"># i.e. /etc/nginx/fastcgi_params or in the parent contexts,</span></span><br><span class=\"line\">        <span class=\"comment\"># please comment off following line:</span></span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_param</span>  SCRIPT_FILENAME   <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;    </span><br><span class=\"line\">        }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>4.测试 PHP 解析</strong><br><code>sudo vi /var/www/example.com/info.php</code></p>\n<p>编辑该文件内容如下：</p>\n<figure class=\"highlight php\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> <span class=\"title function_ invoke__\">phpinfo</span>(); <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>然后访问 <a href=\"http://example.com/info.php\">http://example.com/info.php</a> ，正常的话你应该能看到 PHP 信息页面了。</p>\n<p><strong>5.404 not found/403 Forbidden</strong><br>如果你确认以上操作都已经正常进行，NGINX 和 PHP-FPM 的配置文件都已经改好，但是在访问 PHP 页面的时候出现 404 not found/403 Forbidden 或者 FastCGI sent in stderr: Unable to open primary script 错误，那么有可能是 SELinux 的问题。你可以通过查看 SELinux 的审计日志 <strong>/var/log/audit/audit.log</strong> 来确认，一般会出现 avc: denied { read } for pid=1213 comm=”nginx” name=“info.php”… 之类的错误。<br>问题确认后，我们用 <code>setstatus</code> 来查看当前的 SELinux 设置</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># sestatus</span></span><br><span class=\"line\">SELinux status:                 enabled</span><br><span class=\"line\">SELinuxfs mount:                /sys/fs/selinux</span><br><span class=\"line\">SELinux root directory:         /etc/selinux</span><br><span class=\"line\">Loaded policy name:             targeted</span><br><span class=\"line\">Current mode:                   enforcing</span><br><span class=\"line\">Mode from config file:          enforcing</span><br><span class=\"line\">Policy MLS status:              enabled</span><br><span class=\"line\">Policy deny_unknown status:     allowed</span><br><span class=\"line\">Max kernel policy version:      31</span><br></pre></td></tr></tbody></table></figure>\n<p> 或者 <code>cat /etc/selinux/config</code> </p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># cat /etc/selinux/config </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># This file controls the state of SELinux on the system.</span></span><br><span class=\"line\"><span class=\"comment\"># SELINUX= can take one of these three values:</span></span><br><span class=\"line\"><span class=\"comment\">#     enforcing - SELinux security policy is enforced.</span></span><br><span class=\"line\"><span class=\"comment\">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class=\"line\"><span class=\"comment\">#     disabled - No SELinux policy is loaded.</span></span><br><span class=\"line\">SELINUX=enforcing</span><br><span class=\"line\"><span class=\"comment\"># SELINUXTYPE= can take one of three two values:</span></span><br><span class=\"line\"><span class=\"comment\">#     targeted - Targeted processes are protected,</span></span><br><span class=\"line\"><span class=\"comment\">#     minimum - Modification of targeted policy. Only selected processes are protected. </span></span><br><span class=\"line\"><span class=\"comment\">#     mls - Multi Level Security protection.</span></span><br><span class=\"line\">SELINUXTYPE=targeted</span><br></pre></td></tr></tbody></table></figure>\n\n<p>如果当前状态是 <strong>enforcing</strong>，说明 SELinux 已经启用，那么你可以试着用 <code>setenforce 0</code> 禁用 SELinux（只显示告警）再尝试访问 PHP 文件，如果可以成功访问那你也有两个选择，一是禁用 SELinux （可能没那么安全），二是使用 <strong>restorecon</strong> 来恢复网站目录的 SELinux 安全配置上下文信息：<br><code>restorecon -R -v /var/www/example.com</code></p>\n<p>若是之后部署有些网站程序还是没法访问，确定是 SELinux 的锅但是你又想留着它的话，可参考以下几篇文章：</p>\n<ul>\n<li><a href=\"https://www.nginx.com/blog/using-nginx-plus-with-selinux/\">Using NGINX and NGINX Plus with SELinux</a></li>\n<li><a href=\"https://wiki.centos.org/HowTos/SELinux\">SELinux - CentOS Wiki</a></li>\n<li><a href=\"https://www.serverlab.ca/tutorials/linux/web-servers-linux/configuring-selinux-policies-for-apache-web-servers/\">Configuring SELinux Policies for Apache Web Servers</a> - 这篇讲 Apache 的，但还是可以作为参考</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><h2 id=\"什么是-LEMP\"><a href=\"#什么是-LEMP\" class=\"headerlink\" title=\"什么是 LEMP\"></a>什么是 LEMP</h2><p><img src=\"/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg\" alt=\"LEMP\"><br>以前我们常常听说的 LAMP (Linux, Apache, MySQL, and PHP) 是最经典的建站环境之一，迄今仍旧够到很多中小站长的欢迎。但 Apache 的缺点是有些臃肿，资源开销比较大，对硬件的要求相较于其它一些轻量的 Web 服务器要高，， 而 MySQL 的母公司 SUN 在被 Oracle 收购之后，社区担心 MySQL 的开源许可可能会存在闭源风险，于是 MySQL 之父 Michael Widenius (often called Monty) 以他女儿 Maria 的名字创建了MySQL的另外一个衍生版本：MariaDB。在用 NGINX 替代 Apache 和 MariaDB 替代 MySQL 之后，LEMP 就诞生了，尤其适用于服务器资源吃紧，内存少又想压榨出高并发高流量性能的场景。</p></body></html>","more":"<html><head></head><body><h2 id=\"测试环境\"><a href=\"#测试环境\" class=\"headerlink\" title=\"测试环境\"></a>测试环境</h2><p>本文所述的环境基于腾讯云 CentOS 7.5 64-bit 公共镜像搭建，安装完成后的各组件版本如下：</p>\n<ul>\n<li>CentOS 7.5 64-bit</li>\n<li>NGINX 1.14.2</li>\n<li>MariaDB 5.5.60</li>\n<li>PHP 5.6.39*<blockquote>\n<p>*CentOS 官方默认带的 PHP 为 5.4.16，而我们某些程序需要 5.6+ 才能正常运行，本文的目的就是记录下如何安装 PHP5.6 的 LEMP环境</p>\n</blockquote>\n</li>\n</ul>\n<h2 id=\"开始前的准备工作\"><a href=\"#开始前的准备工作\" class=\"headerlink\" title=\"开始前的准备工作\"></a>开始前的准备工作</h2><h3 id=\"时间设置\"><a href=\"#时间设置\" class=\"headerlink\" title=\"时间设置\"></a>时间设置</h3><p><strong>列出当前时间相关设置</strong><br><code>timedatectl status</code></p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">      Local time: Fri 2018-12-28 13:20:01 CST</span><br><span class=\"line\">  Universal time: Fri 2018-12-28 05:20:01 UTC</span><br><span class=\"line\">        RTC time: Fri 2018-12-28 05:19:59</span><br><span class=\"line\">       Time zone: Asia/Shanghai (CST, +0800)</span><br><span class=\"line\">     NTP enabled: no</span><br><span class=\"line\">NTP synchronized: yes</span><br><span class=\"line\"> RTC in local TZ: no</span><br><span class=\"line\">      DST active: n/a</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>1.设置时区</strong><br><code>sudo timedatectl set-timezone Asia/Shanghai</code> （这一步腾讯云的 CentOS 公共镜像已经设置好，可跳过）<br><strong>2.安装 NTP</strong><br><code>sudo yum install ntp</code><br><strong>3.设置为与 NTP 服务器同步</strong><br><code>sudo timedatectl set-ntp true</code><br><strong>4.同步时间</strong><br><code>sudo ntpdate pool.ntp.org</code><br><strong>5.再检查时间设置</strong><br><code>timedatectl status</code> </p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"> Local time: Fri 2018-12-28 14:05:53 CST</span><br><span class=\"line\">  Universal time: Fri 2018-12-28 06:05:53 UTC</span><br><span class=\"line\">        RTC time: Fri 2018-12-28 06:05:51</span><br><span class=\"line\">       Time zone: Asia/Shanghai (CST, +0800)</span><br><span class=\"line\">     NTP enabled: yes</span><br><span class=\"line\">NTP synchronized: yes</span><br><span class=\"line\"> RTC in local TZ: no</span><br><span class=\"line\">      DST active: n/a</span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"安装-yum-utils-软件包便于管理维护\"><a href=\"#安装-yum-utils-软件包便于管理维护\" class=\"headerlink\" title=\"安装 yum-utils 软件包便于管理维护\"></a>安装 yum-utils 软件包便于管理维护</h3><p><code>sudo yum install yum-utils</code></p>\n<h3 id=\"获取系统最新更新\"><a href=\"#获取系统最新更新\" class=\"headerlink\" title=\"获取系统最新更新\"></a>获取系统最新更新</h3><p><code>sudo yum update</code> #生产环境慎用，这条命令会更新所有软件包，可能会破环依赖关系<br>或者用下面 <code>sudo yum -y update --security</code> 这条命令只更新安全补丁，胆子小的可以用 <code>sudo yum update-minimal --security -y</code></p>\n<blockquote>\n<p>不管更新啥，在测试环境测好再部署到生产环境是必要的</p>\n</blockquote>\n<h3 id=\"添加含有各种-PHP-版本的-Remi-仓库-本文用的清华大学镜像站点\"><a href=\"#添加含有各种-PHP-版本的-Remi-仓库-本文用的清华大学镜像站点\" class=\"headerlink\" title=\"添加含有各种 PHP 版本的 Remi 仓库 (本文用的清华大学镜像站点)\"></a>添加含有各种 PHP 版本的 Remi 仓库 (本文用的清华大学镜像站点)</h3><p><code>sudo yum install https://mirrors.tuna.tsinghua.edu.cn/remi/enterprise/remi-release-7.rpm</code></p>\n<h3 id=\"启用-Remi-仓库中-PHP-5-6-的源\"><a href=\"#启用-Remi-仓库中-PHP-5-6-的源\" class=\"headerlink\" title=\"启用 Remi 仓库中 PHP 5.6 的源\"></a>启用 Remi 仓库中 PHP 5.6 的源</h3><p><code>sudo yum-config-manager --enable remi-php56</code></p>\n<h2 id=\"NGINX\"><a href=\"#NGINX\" class=\"headerlink\" title=\"NGINX\"></a>NGINX</h2><p>本文推荐从 NGINX 的官方源来安装<br><strong>1.创建 <code>/etc/yum.repos.d/nginx.repo</code> 文件，内容如下</strong></p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[nginx]</span><br><span class=\"line\">name=nginx repo</span><br><span class=\"line\"># Choose mainline or stable release</span><br><span class=\"line\">baseurl=http://nginx.org/packages/centos/$releasever/$basearch/</span><br><span class=\"line\"># baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/</span><br><span class=\"line\">gpgcheck=0</span><br><span class=\"line\">enabled=1</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>2.更新源信息</strong><br><code>sudo yum check-update</code></p>\n<p><strong>3.安装 NGINX</strong><br><code>sudo yum install nginx</code></p>\n<p><strong>4.启动 NGINX</strong><br><code>sudo systemctl start nginx</code></p>\n<p><strong>5.将 NGINX 添加到开机自启动</strong><br><code>sudo systemctl enable nginx</code></p>\n<p><strong>6.测试 NGINX</strong><br><img src=\"/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg\" alt=\"NGINX\"></p>\n<h2 id=\"MariaDB\"><a href=\"#MariaDB\" class=\"headerlink\" title=\"MariaDB\"></a>MariaDB</h2><p><strong>1.安装 MariaDB 和 MySQL/MariaDB-PHP 支持包</strong><br><code>sudo yum install mariadb-server php-mysql</code></p>\n<p><strong>2.启动 MariaDB</strong><br><code>sudo systemctl start mariadb</code></p>\n<p><strong>3.将 MariaDB 添加到开机自启动</strong><br><code>sudo systemctl enable mariadb</code></p>\n<p><strong>4.安全设置</strong><br><code>sudo mysql_secure_installation</code></p>\n<p>因为是新安装的 MariaDB，还没有为 root 用户设置密码，直接按回车键<br>Enter current password for root (enter for none):</p>\n<p>接下来按 <strong>Y</strong> 设置 root 密码<br>Set root password? [Y/n] Y<br>New password:<br>Re-enter new password:<br>Password updated successfully!<br>Reloading privilege tables..<br> … Success!</p>\n<p>按 <strong>Y</strong> 或者直接回车键接受以下四个默认安全设置</p>\n<ul>\n<li>Remove anonymous users?</li>\n<li>Disallow root login remotely?</li>\n<li>Remove test database and access to it?</li>\n<li>Reload privilege tables now?</li>\n</ul>\n<p>最后看到如下字样即表示安全设置完成</p>\n<figure class=\"highlight text\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">All done!  If you've completed all of the above steps, your MariaDB</span><br><span class=\"line\">installation should now be secure.</span><br><span class=\"line\"></span><br><span class=\"line\">Thanks for using MariaDB!</span><br></pre></td></tr></tbody></table></figure>\n<h2 id=\"PHP-5-6\"><a href=\"#PHP-5-6\" class=\"headerlink\" title=\"PHP 5.6\"></a>PHP 5.6</h2><p><strong>1.安装 PHP FastCGI Processing Manager</strong><br><code>sudo yum install php-fpm</code></p>\n<p><strong>2.已知漏洞修复</strong><br>编辑 <strong>/etc/php.ini</strong> 文件，关闭 NGINX + PHP-FPM 中关于 fix_pathinfo 的一个漏洞，详情参见<a href=\"http://www.laruence.com/2010/05/20/1495.html\">这篇文章</a><br><code>sudo sed -i 's/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g' /etc/php.ini</code></p>\n<p>**3.修改 <strong>/etc/php-fpm.d/<a href=\"http://www.conf/\">www.conf</a></strong><br>PHP 默认是以 Apache 来作为 Web 服务器的，所以其运行的默认用户为 <code>apache</code>，我们需要修改为 <code>nginx</code></p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo sed -i <span class=\"string\">'s/user = apache/user = nginx/g'</span> /etc/php-fpm.d/www.conf</span><br><span class=\"line\">sudo sed -i <span class=\"string\">'s/group = apache/group = nginx/g'</span> /etc/php-fpm.d/www.conf</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>4.启动 PHP-FPM</strong><br><code>sudo systemctl start php-fpm</code></p>\n<p><strong>5.将 MariaDB 添加到开机自启动</strong><br><code>sudo systemctl enable php-fpm</code></p>\n<h2 id=\"配置-NGINX-使其解析-PHP-文件\"><a href=\"#配置-NGINX-使其解析-PHP-文件\" class=\"headerlink\" title=\"配置 NGINX 使其解析 PHP 文件\"></a>配置 NGINX 使其解析 PHP 文件</h2><p><strong>1.创建你网站程序的目录</strong><br><code>sudo mkdir -p /var/www/example.com/</code></p>\n<p><strong>2.禁用 NGINX 默认的站点配置文件</strong><br><code>sudo mv /etc/nginx/conf.d/default.conf /etc/nginx/conf.d/default.conf.disabled</code></p>\n<p><strong>3.创建 example.com 的站点配置文件</strong><br><code>sudo vi /etc/nginx/conf.d/example.com.conf</code></p>\n<figure class=\"highlight nginx\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"section\">server</span> {</span><br><span class=\"line\">    <span class=\"comment\"># Ipv4</span></span><br><span class=\"line\">    <span class=\"attribute\">listen</span> <span class=\"number\">80</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># IPv6</span></span><br><span class=\"line\">    <span class=\"comment\"># listen [::]:80;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># SSL Ipv4 &amp; v6</span></span><br><span class=\"line\">    <span class=\"comment\"># listen 443 ssl;</span></span><br><span class=\"line\">    <span class=\"comment\"># listen [::]:443 ssl;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># [REQUIRED EDIT] Your domain name goes here</span></span><br><span class=\"line\">    <span class=\"attribute\">server_name</span> example.com www.example.com;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># [REQUIRED EDIT] Absolute path to your website root on the filesystem</span></span><br><span class=\"line\">    <span class=\"attribute\">root</span> /var/www/example.com;</span><br><span class=\"line\">        </span><br><span class=\"line\">    <span class=\"attribute\">index</span> index.php index.html index.htm;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># PHP FPM part</span></span><br><span class=\"line\">        <span class=\"section\">location</span> <span class=\"regexp\">~ [^/]\\.php(/|$)</span> {</span><br><span class=\"line\">                <span class=\"attribute\">fastcgi_split_path_info</span><span class=\"regexp\"> ^(.+?\\.php)(/.*)$</span>;</span><br><span class=\"line\">                <span class=\"attribute\">if</span> (!-f <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>) {</span><br><span class=\"line\">                        <span class=\"attribute\">return</span> <span class=\"number\">404</span>;</span><br><span class=\"line\">                }</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># Mitigate https://httpoxy.org/ vulnerabilities</span></span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_param</span> HTTP_PROXY <span class=\"string\">\"\"</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">         <span class=\"attribute\">fastcgi_pass</span> <span class=\"number\">127.0.0.1:9000</span>;</span><br><span class=\"line\">         <span class=\"attribute\">fastcgi_index</span> index.php;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># include the fastcgi_param setting</span></span><br><span class=\"line\">        <span class=\"attribute\">include</span> fastcgi_params;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># SCRIPT_FILENAME parameter is used for PHP FPM determining</span></span><br><span class=\"line\">        <span class=\"comment\">#  the script name. If it is not set in fastcgi_params file,</span></span><br><span class=\"line\">        <span class=\"comment\"># i.e. /etc/nginx/fastcgi_params or in the parent contexts,</span></span><br><span class=\"line\">        <span class=\"comment\"># please comment off following line:</span></span><br><span class=\"line\">        <span class=\"attribute\">fastcgi_param</span>  SCRIPT_FILENAME   <span class=\"variable\">$document_root</span><span class=\"variable\">$fastcgi_script_name</span>;    </span><br><span class=\"line\">        }</span><br><span class=\"line\">}</span><br></pre></td></tr></tbody></table></figure>\n<p><strong>4.测试 PHP 解析</strong><br><code>sudo vi /var/www/example.com/info.php</code></p>\n<p>编辑该文件内容如下：</p>\n<figure class=\"highlight php\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span> <span class=\"title function_ invoke__\">phpinfo</span>(); <span class=\"meta\">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>然后访问 <a href=\"http://example.com/info.php\">http://example.com/info.php</a> ，正常的话你应该能看到 PHP 信息页面了。</p>\n<p><strong>5.404 not found/403 Forbidden</strong><br>如果你确认以上操作都已经正常进行，NGINX 和 PHP-FPM 的配置文件都已经改好，但是在访问 PHP 页面的时候出现 404 not found/403 Forbidden 或者 FastCGI sent in stderr: Unable to open primary script 错误，那么有可能是 SELinux 的问题。你可以通过查看 SELinux 的审计日志 <strong>/var/log/audit/audit.log</strong> 来确认，一般会出现 avc: denied { read } for pid=1213 comm=”nginx” name=“info.php”… 之类的错误。<br>问题确认后，我们用 <code>setstatus</code> 来查看当前的 SELinux 设置</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># sestatus</span></span><br><span class=\"line\">SELinux status:                 enabled</span><br><span class=\"line\">SELinuxfs mount:                /sys/fs/selinux</span><br><span class=\"line\">SELinux root directory:         /etc/selinux</span><br><span class=\"line\">Loaded policy name:             targeted</span><br><span class=\"line\">Current mode:                   enforcing</span><br><span class=\"line\">Mode from config file:          enforcing</span><br><span class=\"line\">Policy MLS status:              enabled</span><br><span class=\"line\">Policy deny_unknown status:     allowed</span><br><span class=\"line\">Max kernel policy version:      31</span><br></pre></td></tr></tbody></table></figure>\n<p> 或者 <code>cat /etc/selinux/config</code> </p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># cat /etc/selinux/config </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># This file controls the state of SELinux on the system.</span></span><br><span class=\"line\"><span class=\"comment\"># SELINUX= can take one of these three values:</span></span><br><span class=\"line\"><span class=\"comment\">#     enforcing - SELinux security policy is enforced.</span></span><br><span class=\"line\"><span class=\"comment\">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class=\"line\"><span class=\"comment\">#     disabled - No SELinux policy is loaded.</span></span><br><span class=\"line\">SELINUX=enforcing</span><br><span class=\"line\"><span class=\"comment\"># SELINUXTYPE= can take one of three two values:</span></span><br><span class=\"line\"><span class=\"comment\">#     targeted - Targeted processes are protected,</span></span><br><span class=\"line\"><span class=\"comment\">#     minimum - Modification of targeted policy. Only selected processes are protected. </span></span><br><span class=\"line\"><span class=\"comment\">#     mls - Multi Level Security protection.</span></span><br><span class=\"line\">SELINUXTYPE=targeted</span><br></pre></td></tr></tbody></table></figure>\n\n<p>如果当前状态是 <strong>enforcing</strong>，说明 SELinux 已经启用，那么你可以试着用 <code>setenforce 0</code> 禁用 SELinux（只显示告警）再尝试访问 PHP 文件，如果可以成功访问那你也有两个选择，一是禁用 SELinux （可能没那么安全），二是使用 <strong>restorecon</strong> 来恢复网站目录的 SELinux 安全配置上下文信息：<br><code>restorecon -R -v /var/www/example.com</code></p>\n<p>若是之后部署有些网站程序还是没法访问，确定是 SELinux 的锅但是你又想留着它的话，可参考以下几篇文章：</p>\n<ul>\n<li><a href=\"https://www.nginx.com/blog/using-nginx-plus-with-selinux/\">Using NGINX and NGINX Plus with SELinux</a></li>\n<li><a href=\"https://wiki.centos.org/HowTos/SELinux\">SELinux - CentOS Wiki</a></li>\n<li><a href=\"https://www.serverlab.ca/tutorials/linux/web-servers-linux/configuring-selinux-policies-for-apache-web-servers/\">Configuring SELinux Policies for Apache Web Servers</a> - 这篇讲 Apache 的，但还是可以作为参考</li>\n</ul></body></html>"},{"title":"CentOS 6.4 安装 Lighttpd+PHP5(PHP-FPM)+MySQL","date":"2013-04-28T10:17:41.000Z","_content":"\n#### 1. 安装 MySQL 5.0\n```bash\nyum install mysql mysql-server\n```\n将 MySQL 服务设置成自动启动\n```bash\nchkconfig --levels 23 mysqld on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/mysqld start #启动 mysqld 服务\n```\n接下来要设置 MySQL 的 root 密码\n```bash\nmysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] y\nNew password:\nAborting!\n\nCleaning up...\n[root@m2ahkvpn01 tmp]# mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n]\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n]\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n]\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n]\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n```\n####  2. 安装 Lighttpd\n\nLighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库 Remi RPM + EPEL\n```bash\n# EPEL库\nrpm --import https://fedoraproject.org/static/0608B895.txt\nwget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -ivh epel-release-6-8.noarch.rpm\n\n# Remi库\nrpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n# yum 软件库调整\nyum install yum-priorities\n```\n接下来要编辑两个文件 /etc/yum.repos.d/epel.repo 和 /etc/yum.repos.d/remi.repo，添加\n`priority=10`\n```bash\n#/etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 6 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=$basearch\nfailovermethod=priority\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6\n[...]\n```\n```bash\n#/etc/yum.repos.d/remi.repo\n[remi]\nname=Les RPM de remi pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/remi/mirror\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\nfailovermethod=priority\n\n[remi-test]\nname=Les RPM de remi en test pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/test/mirror\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n```\n安装 Lighttpd\n```bash\nyum install lighttpd\n```\n接下来设置开机启动 lighttpd 并立即启动\n```bash\nchkconfig --levels 23 lighttpd on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/lighttpd start #启动 lighttpd 服务</pre>\n这个时候你有可能会碰到这样的错误\n```\n<span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span>\n\n<span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can't have more connections than fds/2: 1024 1024</span>\n\n第一个是 IPV6 的问题，编辑 `/etc/lighttpd/lighttpd.conf` 文件\n```apacheconf\n[...]\n##\n## Use IPv6?\n##\nserver.use-ipv6 = \"disable\"\n[...]\n```\n第二个报错，编辑 `/etc/lighttpd/lighttpd.conf` 文件，注释掉 `server.max-fds = 2048`\n```apacheconf\n## With SELinux enabled, this is denied by default and needs to be allowed\n## by running the following once : setsebool -P httpd_setrlimit on\nserver.max-fds = 2048\n```\n或者\n```apacheconf\nsetsebool -P httpd_setrlimit 1\n```\n这个是 CentOS 自带的 SELinux 的问题，参见[Bug 571924 - lighttpd's server.max-fds conflicts with SELinux policy](https://bugzilla.redhat.com/show_bug.cgi?id=571924 \"Bug 571924 - lighttpd\")\n\n当然，你也可以用这个命令来暂时禁掉 SELinux\n`setenforce 0`\n然后再运行 `/etc/init.d/lighttpd start` 就没有问题了\n\n#### 3. 安装PHP5 (PHP-FPM)\n\n我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP\n```bash\nyum install php-fpm lighttpd-fastcgi</pre>\n```\n#### 4. 配置 Lighttpd 和 PHP\n\n编辑 `/etc/php-fpm.d/www.conf`，把其中 user 和 group 设定的用户从 apache 改成 lighttpd\n```apacheconf\n[...]\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n; RPM: apache Choosed to be able to access some dir as httpd\nuser = lighttpd\n; RPM: Keep a group allowed to write in log dir.\ngroup = lighttpd\n[...]\n```\n设置开机启动 php-fpm 并立即启动\n```bash\nchkconfig --levels 23 php-fpm on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/php-fpm start #启动 mysqld 服务\n```\n首先我们打开`/etc/php.ini`并在文件尾加入 `cgi.fix_pathinfo = 1`。\n然后打开 /etc/lighttpd/modules.conf  文件并在server.modules块中取消 <span style=\"color: #ff0000\">include \"conf.d/fastcgi.conf\"</span> 的注释（即删除前面的“#”）：\n```apacheconf\n##\n## FastCGI (mod_fastcgi)\n##\ninclude \"conf.d/fastcgi.conf\"\n```\n接着在 `/etc/lighttpd/conf.d/fastcgi.conf` ，找到`fastcgi.server` 块，改成如下：\n```apacheconf\nfastcgi.server += ( \".php\" =&gt;\n        ((\n                \"socket\" =&gt; \"/tmp/php5-fpm.sock\",\n                \"broken-scriptfilename\" =&gt; \"enable\"\n        ))\n)\n```\n修改完成之后重启 lighttpd 服务以使其生效\n```bash\n/etc/init.d/lighttpd restart\n```\n\n#### 5. 测试 PHP\n```bash\nvi /var/www/lighttpd/info.php\n```\n```php\n<php phpinfo();\n?>\n```\n\n####  6. 让 PHP5 支持 MySQL\n```bash\nyum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc\nyum install php-pecl-apc # APC 是类似 eAccelerator 和 Xcache 的php加速组件\n/etc/init.d/php-fpm reload #重新加载 php-fpm\n```\n#### 7.让 PHP-FPM 以 Unix Socket 方式运行\n```bash\nvi /etc/php-fpm.d/www.conf\n```\n```apacheconf\n[...]\n;listen = 127.0.0.1:9000\nlisten = /tmp/php5-fpm.sock\n[...]\n```\nReload PHP-FPM\n\n`/etc/init.d/php-fpm reload`","source":"_posts/installing-lighttpd-php5-mysql-on-centos-64.md","raw":"---\ntitle: CentOS 6.4 安装 Lighttpd+PHP5(PHP-FPM)+MySQL\ntags:\n  - CentOS\n  - Lighttpd\n  - MySQL\n  - PHP\ncategories:\n  - '*Nix'\ndate: 2013-04-28 18:17:41\n---\n\n#### 1. 安装 MySQL 5.0\n```bash\nyum install mysql mysql-server\n```\n将 MySQL 服务设置成自动启动\n```bash\nchkconfig --levels 23 mysqld on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/mysqld start #启动 mysqld 服务\n```\n接下来要设置 MySQL 的 root 密码\n```bash\nmysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] y\nNew password:\nAborting!\n\nCleaning up...\n[root@m2ahkvpn01 tmp]# mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n]\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n]\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n]\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n]\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n```\n####  2. 安装 Lighttpd\n\nLighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库 Remi RPM + EPEL\n```bash\n# EPEL库\nrpm --import https://fedoraproject.org/static/0608B895.txt\nwget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -ivh epel-release-6-8.noarch.rpm\n\n# Remi库\nrpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n# yum 软件库调整\nyum install yum-priorities\n```\n接下来要编辑两个文件 /etc/yum.repos.d/epel.repo 和 /etc/yum.repos.d/remi.repo，添加\n`priority=10`\n```bash\n#/etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 6 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=$basearch\nfailovermethod=priority\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6\n[...]\n```\n```bash\n#/etc/yum.repos.d/remi.repo\n[remi]\nname=Les RPM de remi pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/remi/mirror\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\nfailovermethod=priority\n\n[remi-test]\nname=Les RPM de remi en test pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/test/mirror\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n```\n安装 Lighttpd\n```bash\nyum install lighttpd\n```\n接下来设置开机启动 lighttpd 并立即启动\n```bash\nchkconfig --levels 23 lighttpd on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/lighttpd start #启动 lighttpd 服务</pre>\n这个时候你有可能会碰到这样的错误\n```\n<span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span>\n\n<span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can't have more connections than fds/2: 1024 1024</span>\n\n第一个是 IPV6 的问题，编辑 `/etc/lighttpd/lighttpd.conf` 文件\n```apacheconf\n[...]\n##\n## Use IPv6?\n##\nserver.use-ipv6 = \"disable\"\n[...]\n```\n第二个报错，编辑 `/etc/lighttpd/lighttpd.conf` 文件，注释掉 `server.max-fds = 2048`\n```apacheconf\n## With SELinux enabled, this is denied by default and needs to be allowed\n## by running the following once : setsebool -P httpd_setrlimit on\nserver.max-fds = 2048\n```\n或者\n```apacheconf\nsetsebool -P httpd_setrlimit 1\n```\n这个是 CentOS 自带的 SELinux 的问题，参见[Bug 571924 - lighttpd's server.max-fds conflicts with SELinux policy](https://bugzilla.redhat.com/show_bug.cgi?id=571924 \"Bug 571924 - lighttpd\")\n\n当然，你也可以用这个命令来暂时禁掉 SELinux\n`setenforce 0`\n然后再运行 `/etc/init.d/lighttpd start` 就没有问题了\n\n#### 3. 安装PHP5 (PHP-FPM)\n\n我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP\n```bash\nyum install php-fpm lighttpd-fastcgi</pre>\n```\n#### 4. 配置 Lighttpd 和 PHP\n\n编辑 `/etc/php-fpm.d/www.conf`，把其中 user 和 group 设定的用户从 apache 改成 lighttpd\n```apacheconf\n[...]\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n; RPM: apache Choosed to be able to access some dir as httpd\nuser = lighttpd\n; RPM: Keep a group allowed to write in log dir.\ngroup = lighttpd\n[...]\n```\n设置开机启动 php-fpm 并立即启动\n```bash\nchkconfig --levels 23 php-fpm on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/php-fpm start #启动 mysqld 服务\n```\n首先我们打开`/etc/php.ini`并在文件尾加入 `cgi.fix_pathinfo = 1`。\n然后打开 /etc/lighttpd/modules.conf  文件并在server.modules块中取消 <span style=\"color: #ff0000\">include \"conf.d/fastcgi.conf\"</span> 的注释（即删除前面的“#”）：\n```apacheconf\n##\n## FastCGI (mod_fastcgi)\n##\ninclude \"conf.d/fastcgi.conf\"\n```\n接着在 `/etc/lighttpd/conf.d/fastcgi.conf` ，找到`fastcgi.server` 块，改成如下：\n```apacheconf\nfastcgi.server += ( \".php\" =&gt;\n        ((\n                \"socket\" =&gt; \"/tmp/php5-fpm.sock\",\n                \"broken-scriptfilename\" =&gt; \"enable\"\n        ))\n)\n```\n修改完成之后重启 lighttpd 服务以使其生效\n```bash\n/etc/init.d/lighttpd restart\n```\n\n#### 5. 测试 PHP\n```bash\nvi /var/www/lighttpd/info.php\n```\n```php\n<php phpinfo();\n?>\n```\n\n####  6. 让 PHP5 支持 MySQL\n```bash\nyum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc\nyum install php-pecl-apc # APC 是类似 eAccelerator 和 Xcache 的php加速组件\n/etc/init.d/php-fpm reload #重新加载 php-fpm\n```\n#### 7.让 PHP-FPM 以 Unix Socket 方式运行\n```bash\nvi /etc/php-fpm.d/www.conf\n```\n```apacheconf\n[...]\n;listen = 127.0.0.1:9000\nlisten = /tmp/php5-fpm.sock\n[...]\n```\nReload PHP-FPM\n\n`/etc/init.d/php-fpm reload`","slug":"installing-lighttpd-php5-mysql-on-centos-64","published":1,"updated":"2020-01-05T09:00:54.004Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kub004rk84setu57zzh","content":"<html><head></head><body><h4 id=\"1-安装-MySQL-5-0\"><a href=\"#1-安装-MySQL-5-0\" class=\"headerlink\" title=\"1. 安装 MySQL 5.0\"></a>1. 安装 MySQL 5.0</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mysql mysql-server</span><br></pre></td></tr></tbody></table></figure>\n<p>将 MySQL 服务设置成自动启动</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --levels 23 mysqld on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></span><br><span class=\"line\">/etc/init.d/mysqld start <span class=\"comment\">#启动 mysqld 服务</span></span><br></pre></td></tr></tbody></table></figure>\n<p>接下来要设置 MySQL 的 root 密码</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql_secure_installation</span><br><span class=\"line\"></span><br><span class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</span><br><span class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class=\"line\"></span><br><span class=\"line\">In order to <span class=\"built_in\">log</span> into MySQL to secure it, we<span class=\"string\">'ll need the current</span></span><br><span class=\"line\"><span class=\"string\">password for the root user.  If you'</span>ve just installed MySQL, and</span><br><span class=\"line\">you haven<span class=\"string\">'t set the root password yet, the password will be blank,</span></span><br><span class=\"line\"><span class=\"string\">so you should just press enter here.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">OK, successfully used password, moving on...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Setting the root password ensures that nobody can log into the MySQL</span></span><br><span class=\"line\"><span class=\"string\">root user without the proper authorisation.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Set root password? [Y/n] y</span></span><br><span class=\"line\"><span class=\"string\">New password:</span></span><br><span class=\"line\"><span class=\"string\">Aborting!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Cleaning up...</span></span><br><span class=\"line\"><span class=\"string\">[root@m2ahkvpn01 tmp]# mysql_secure_installation</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</span></span><br><span class=\"line\"><span class=\"string\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">In order to log into MySQL to secure it, we'</span>ll need the current</span><br><span class=\"line\">password <span class=\"keyword\">for</span> the root user.  If you<span class=\"string\">'ve just installed MySQL, and</span></span><br><span class=\"line\"><span class=\"string\">you haven'</span>t <span class=\"built_in\">set</span> the root password yet, the password will be blank,</span><br><span class=\"line\">so you should just press enter here.</span><br><span class=\"line\"></span><br><span class=\"line\">Enter current password <span class=\"keyword\">for</span> root (enter <span class=\"keyword\">for</span> none):</span><br><span class=\"line\">OK, successfully used password, moving on...</span><br><span class=\"line\"></span><br><span class=\"line\">Setting the root password ensures that nobody can <span class=\"built_in\">log</span> into the MySQL</span><br><span class=\"line\">root user without the proper authorisation.</span><br><span class=\"line\"></span><br><span class=\"line\">Set root password? [Y/n] Y</span><br><span class=\"line\">New password:</span><br><span class=\"line\">Re-enter new password:</span><br><span class=\"line\">Password updated successfully!</span><br><span class=\"line\">Reloading privilege tables..</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</span><br><span class=\"line\">to <span class=\"built_in\">log</span> into MySQL without having to have a user account created <span class=\"keyword\">for</span></span><br><span class=\"line\">them.  This is intended only <span class=\"keyword\">for</span> testing, and to make the installation</span><br><span class=\"line\">go a bit smoother.  You should remove them before moving into a</span><br><span class=\"line\">production environment.</span><br><span class=\"line\"></span><br><span class=\"line\">Remove anonymous <span class=\"built_in\">users</span>? [Y/n]</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">Normally, root should only be allowed to connect from <span class=\"string\">'localhost'</span>.  This</span><br><span class=\"line\">ensures that someone cannot guess at the root password from the network.</span><br><span class=\"line\"></span><br><span class=\"line\">Disallow root login remotely? [Y/n]</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">By default, MySQL comes with a database named <span class=\"string\">'test'</span> that anyone can</span><br><span class=\"line\">access.  This is also intended only <span class=\"keyword\">for</span> testing, and should be removed</span><br><span class=\"line\">before moving into a production environment.</span><br><span class=\"line\"></span><br><span class=\"line\">Remove <span class=\"built_in\">test</span> database and access to it? [Y/n]</span><br><span class=\"line\"> - Dropping <span class=\"built_in\">test</span> database...</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"> - Removing privileges on <span class=\"built_in\">test</span> database...</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">Reloading the privilege tables will ensure that all changes made so far</span><br><span class=\"line\">will take effect immediately.</span><br><span class=\"line\"></span><br><span class=\"line\">Reload privilege tables now? [Y/n]</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">Cleaning up...</span><br><span class=\"line\"></span><br><span class=\"line\">All <span class=\"keyword\">done</span>!  If you<span class=\"string\">'ve completed all of the above steps, your MySQL</span></span><br><span class=\"line\"><span class=\"string\">installation should now be secure.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Thanks for using MySQL!</span></span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"2-安装-Lighttpd\"><a href=\"#2-安装-Lighttpd\" class=\"headerlink\" title=\"2. 安装 Lighttpd\"></a>2. 安装 Lighttpd</h4><p>Lighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库&nbsp;Remi RPM + EPEL</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># EPEL库</span></span><br><span class=\"line\">rpm --import https://fedoraproject.org/static/0608B895.txt</span><br><span class=\"line\">wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</span><br><span class=\"line\">rpm -ivh epel-release-6-8.noarch.rpm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Remi库</span></span><br><span class=\"line\">rpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi</span><br><span class=\"line\">rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</span><br><span class=\"line\"><span class=\"comment\"># yum 软件库调整</span></span><br><span class=\"line\">yum install yum-priorities</span><br></pre></td></tr></tbody></table></figure>\n<p>接下来要编辑两个文件&nbsp;/etc/yum.repos.d/epel.repo 和&nbsp;/etc/yum.repos.d/remi.repo，添加<br><code>priority=10</code></p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/epel.repo</span></span><br><span class=\"line\">[epel]</span><br><span class=\"line\">name=Extra Packages <span class=\"keyword\">for</span> Enterprise Linux 6 - <span class=\"variable\">$basearch</span></span><br><span class=\"line\"><span class=\"comment\">#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch</span></span><br><span class=\"line\">mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;amp;<span class=\"built_in\">arch</span>=<span class=\"variable\">$basearch</span></span><br><span class=\"line\">failovermethod=priority</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">priority=10</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</span><br><span class=\"line\">[...]</span><br></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/remi.repo</span></span><br><span class=\"line\">[remi]</span><br><span class=\"line\">name=Les RPM de remi pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></span><br><span class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/</span></span><br><span class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/remi/mirror</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">priority=10</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</span><br><span class=\"line\">failovermethod=priority</span><br><span class=\"line\"></span><br><span class=\"line\">[remi-test]</span><br><span class=\"line\">name=Les RPM de remi en <span class=\"built_in\">test</span> pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></span><br><span class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/</span></span><br><span class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/test/mirror</span><br><span class=\"line\">enabled=0</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</span><br></pre></td></tr></tbody></table></figure>\n<p>安装 Lighttpd</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install lighttpd</span><br></pre></td></tr></tbody></table></figure>\n<p>接下来设置开机启动 lighttpd 并立即启动</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --levels 23 lighttpd on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></span><br><span class=\"line\">/etc/init.d/lighttpd start <span class=\"comment\">#启动 lighttpd 服务&lt;/pre&gt;</span></span><br><span class=\"line\">这个时候你有可能会碰到这样的错误</span><br></pre></td></tr></tbody></table></figure>\n<p><span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span></p>\n<p><span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can’t have more connections than fds/2: 1024 1024</span></p>\n<p>第一个是 IPV6 的问题，编辑&nbsp;<code>/etc/lighttpd/lighttpd.conf</code> 文件</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[...]</span><br><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"comment\">## Use IPv6?</span></span><br><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"attribute\">server</span>.use-ipv6 = <span class=\"string\">\"disable\"</span><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">[...]</span></span><br></pre></td></tr></tbody></table></figure>\n<p>第二个报错，编辑&nbsp;<code>/etc/lighttpd/lighttpd.conf</code> 文件，注释掉&nbsp;<code>server.max-fds = 2048</code></p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## With SELinux enabled, this is denied by default and needs to be allowed</span></span><br><span class=\"line\"><span class=\"comment\">## by running the following once : setsebool -P httpd_setrlimit on</span></span><br><span class=\"line\"><span class=\"attribute\">server</span>.max-fds = <span class=\"number\">2048</span></span><br></pre></td></tr></tbody></table></figure>\n<p>或者</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">setsebool</span> -P httpd_setrlimit <span class=\"number\">1</span></span><br></pre></td></tr></tbody></table></figure>\n<p>这个是 CentOS 自带的 SELinux 的问题，参见<a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=571924\" title=\"Bug 571924 - lighttpd\">Bug 571924 - lighttpd’s server.max-fds conflicts with SELinux policy</a></p>\n<p>当然，你也可以用这个命令来暂时禁掉 SELinux<br><code>setenforce 0</code><br>然后再运行 <code>/etc/init.d/lighttpd start</code> 就没有问题了</p>\n<h4 id=\"3-安装PHP5-PHP-FPM\"><a href=\"#3-安装PHP5-PHP-FPM\" class=\"headerlink\" title=\"3. 安装PHP5 (PHP-FPM)\"></a>3. 安装PHP5 (PHP-FPM)</h4><p>我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php-fpm lighttpd-fastcgi&lt;/pre&gt;</span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"4-配置-Lighttpd-和-PHP\"><a href=\"#4-配置-Lighttpd-和-PHP\" class=\"headerlink\" title=\"4. 配置 Lighttpd 和 PHP\"></a>4. 配置 Lighttpd 和 PHP</h4><p>编辑 <code>/etc/php-fpm.d/www.conf</code>，把其中 user 和 group 设定的用户从 apache 改成 lighttpd</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[...]</span><br><span class=\"line\">; <span class=\"attribute\">Unix</span> user/group of processes</span><br><span class=\"line\">; <span class=\"attribute\">Note</span>: The user is mandatory. If the group is not set, the default user's group</span><br><span class=\"line\">;       <span class=\"attribute\">will</span> be used.</span><br><span class=\"line\">; <span class=\"attribute\">RPM</span>: apache Choosed to be able to access some dir as httpd</span><br><span class=\"line\"><span class=\"attribute\">user</span> = lighttpd</span><br><span class=\"line\">; <span class=\"attribute\">RPM</span>: Keep a group allowed to write in log dir.</span><br><span class=\"line\"><span class=\"attribute\">group</span> = lighttpd<span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">[...]</span></span><br></pre></td></tr></tbody></table></figure>\n<p>设置开机启动 php-fpm 并立即启动</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --levels 23 php-fpm on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></span><br><span class=\"line\">/etc/init.d/php-fpm start <span class=\"comment\">#启动 mysqld 服务</span></span><br></pre></td></tr></tbody></table></figure>\n<p>首先我们打开<code>/etc/php.ini</code>并在文件尾加入 <code>cgi.fix_pathinfo = 1</code>。<br>然后打开&nbsp;/etc/lighttpd/modules.conf&nbsp; 文件并在server.modules块中取消&nbsp;<span style=\"color: #ff0000\">include “conf.d/fastcgi.conf”</span>&nbsp;的注释（即删除前面的“#”）：</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"comment\">## FastCGI (mod_fastcgi)</span></span><br><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"attribute\">include</span> <span class=\"string\">\"conf.d/fastcgi.conf\"</span></span><br></pre></td></tr></tbody></table></figure>\n<p>接着在&nbsp;<code>/etc/lighttpd/conf.d/fastcgi.conf</code>&nbsp;，找到<code>fastcgi.server</code> 块，改成如下：</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">fastcgi</span>.server += ( <span class=\"string\">\".php\"</span> =&amp;gt;</span><br><span class=\"line\">        ((</span><br><span class=\"line\">                \"<span class=\"attribute\">socket</span><span class=\"string\">\" =&amp;gt; \"</span>/tmp/php5-fpm.sock<span class=\"string\">\",</span></span><br><span class=\"line\"><span class=\"string\">                \"</span>broken-scriptfilename<span class=\"string\">\" =&amp;gt; \"</span>enable<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">        ))</span></span><br><span class=\"line\"><span class=\"string\">)</span></span><br></pre></td></tr></tbody></table></figure>\n<p>修改完成之后重启 lighttpd 服务以使其生效</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/init.d/lighttpd restart</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"5-测试-PHP\"><a href=\"#5-测试-PHP\" class=\"headerlink\" title=\"5. 测试 PHP\"></a>5. 测试 PHP</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /var/www/lighttpd/info.php</span><br></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight php\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;php <span class=\"title function_ invoke__\">phpinfo</span>();</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"6-让-PHP5-支持-MySQL\"><a href=\"#6-让-PHP5-支持-MySQL\" class=\"headerlink\" title=\"6. 让 PHP5 支持 MySQL\"></a>6. 让 PHP5 支持 MySQL</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc</span><br><span class=\"line\">yum install php-pecl-apc <span class=\"comment\"># APC 是类似 eAccelerator 和 Xcache 的php加速组件</span></span><br><span class=\"line\">/etc/init.d/php-fpm reload <span class=\"comment\">#重新加载 php-fpm</span></span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"7-让-PHP-FPM-以-Unix-Socket-方式运行\"><a href=\"#7-让-PHP-FPM-以-Unix-Socket-方式运行\" class=\"headerlink\" title=\"7.让 PHP-FPM 以 Unix Socket 方式运行\"></a>7.让 PHP-FPM 以 Unix Socket 方式运行</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/php-fpm.d/www.conf</span><br></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[...]</span><br><span class=\"line\">;<span class=\"attribute\">listen</span> = <span class=\"number\">127.0.0.1:9000</span></span><br><span class=\"line\"><span class=\"attribute\">listen</span> = /tmp/php5-fpm.sock<span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">[...]</span></span><br></pre></td></tr></tbody></table></figure>\n<p>Reload PHP-FPM</p>\n<p><code>/etc/init.d/php-fpm reload</code></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h4 id=\"1-安装-MySQL-5-0\"><a href=\"#1-安装-MySQL-5-0\" class=\"headerlink\" title=\"1. 安装 MySQL 5.0\"></a>1. 安装 MySQL 5.0</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install mysql mysql-server</span><br></pre></td></tr></tbody></table></figure>\n<p>将 MySQL 服务设置成自动启动</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --levels 23 mysqld on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></span><br><span class=\"line\">/etc/init.d/mysqld start <span class=\"comment\">#启动 mysqld 服务</span></span><br></pre></td></tr></tbody></table></figure>\n<p>接下来要设置 MySQL 的 root 密码</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql_secure_installation</span><br><span class=\"line\"></span><br><span class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</span><br><span class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span><br><span class=\"line\"></span><br><span class=\"line\">In order to <span class=\"built_in\">log</span> into MySQL to secure it, we<span class=\"string\">'ll need the current</span></span><br><span class=\"line\"><span class=\"string\">password for the root user.  If you'</span>ve just installed MySQL, and</span><br><span class=\"line\">you haven<span class=\"string\">'t set the root password yet, the password will be blank,</span></span><br><span class=\"line\"><span class=\"string\">so you should just press enter here.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></span><br><span class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></span><br><span class=\"line\"><span class=\"string\">OK, successfully used password, moving on...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Setting the root password ensures that nobody can log into the MySQL</span></span><br><span class=\"line\"><span class=\"string\">root user without the proper authorisation.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Set root password? [Y/n] y</span></span><br><span class=\"line\"><span class=\"string\">New password:</span></span><br><span class=\"line\"><span class=\"string\">Aborting!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Cleaning up...</span></span><br><span class=\"line\"><span class=\"string\">[root@m2ahkvpn01 tmp]# mysql_secure_installation</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</span></span><br><span class=\"line\"><span class=\"string\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">In order to log into MySQL to secure it, we'</span>ll need the current</span><br><span class=\"line\">password <span class=\"keyword\">for</span> the root user.  If you<span class=\"string\">'ve just installed MySQL, and</span></span><br><span class=\"line\"><span class=\"string\">you haven'</span>t <span class=\"built_in\">set</span> the root password yet, the password will be blank,</span><br><span class=\"line\">so you should just press enter here.</span><br><span class=\"line\"></span><br><span class=\"line\">Enter current password <span class=\"keyword\">for</span> root (enter <span class=\"keyword\">for</span> none):</span><br><span class=\"line\">OK, successfully used password, moving on...</span><br><span class=\"line\"></span><br><span class=\"line\">Setting the root password ensures that nobody can <span class=\"built_in\">log</span> into the MySQL</span><br><span class=\"line\">root user without the proper authorisation.</span><br><span class=\"line\"></span><br><span class=\"line\">Set root password? [Y/n] Y</span><br><span class=\"line\">New password:</span><br><span class=\"line\">Re-enter new password:</span><br><span class=\"line\">Password updated successfully!</span><br><span class=\"line\">Reloading privilege tables..</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</span><br><span class=\"line\">to <span class=\"built_in\">log</span> into MySQL without having to have a user account created <span class=\"keyword\">for</span></span><br><span class=\"line\">them.  This is intended only <span class=\"keyword\">for</span> testing, and to make the installation</span><br><span class=\"line\">go a bit smoother.  You should remove them before moving into a</span><br><span class=\"line\">production environment.</span><br><span class=\"line\"></span><br><span class=\"line\">Remove anonymous <span class=\"built_in\">users</span>? [Y/n]</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">Normally, root should only be allowed to connect from <span class=\"string\">'localhost'</span>.  This</span><br><span class=\"line\">ensures that someone cannot guess at the root password from the network.</span><br><span class=\"line\"></span><br><span class=\"line\">Disallow root login remotely? [Y/n]</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">By default, MySQL comes with a database named <span class=\"string\">'test'</span> that anyone can</span><br><span class=\"line\">access.  This is also intended only <span class=\"keyword\">for</span> testing, and should be removed</span><br><span class=\"line\">before moving into a production environment.</span><br><span class=\"line\"></span><br><span class=\"line\">Remove <span class=\"built_in\">test</span> database and access to it? [Y/n]</span><br><span class=\"line\"> - Dropping <span class=\"built_in\">test</span> database...</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"> - Removing privileges on <span class=\"built_in\">test</span> database...</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">Reloading the privilege tables will ensure that all changes made so far</span><br><span class=\"line\">will take effect immediately.</span><br><span class=\"line\"></span><br><span class=\"line\">Reload privilege tables now? [Y/n]</span><br><span class=\"line\"> ... Success!</span><br><span class=\"line\"></span><br><span class=\"line\">Cleaning up...</span><br><span class=\"line\"></span><br><span class=\"line\">All <span class=\"keyword\">done</span>!  If you<span class=\"string\">'ve completed all of the above steps, your MySQL</span></span><br><span class=\"line\"><span class=\"string\">installation should now be secure.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">Thanks for using MySQL!</span></span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"2-安装-Lighttpd\"><a href=\"#2-安装-Lighttpd\" class=\"headerlink\" title=\"2. 安装 Lighttpd\"></a>2. 安装 Lighttpd</h4><p>Lighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库&nbsp;Remi RPM + EPEL</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># EPEL库</span></span><br><span class=\"line\">rpm --import https://fedoraproject.org/static/0608B895.txt</span><br><span class=\"line\">wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</span><br><span class=\"line\">rpm -ivh epel-release-6-8.noarch.rpm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Remi库</span></span><br><span class=\"line\">rpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi</span><br><span class=\"line\">rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</span><br><span class=\"line\"><span class=\"comment\"># yum 软件库调整</span></span><br><span class=\"line\">yum install yum-priorities</span><br></pre></td></tr></tbody></table></figure>\n<p>接下来要编辑两个文件&nbsp;/etc/yum.repos.d/epel.repo 和&nbsp;/etc/yum.repos.d/remi.repo，添加<br><code>priority=10</code></p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/epel.repo</span></span><br><span class=\"line\">[epel]</span><br><span class=\"line\">name=Extra Packages <span class=\"keyword\">for</span> Enterprise Linux 6 - <span class=\"variable\">$basearch</span></span><br><span class=\"line\"><span class=\"comment\">#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch</span></span><br><span class=\"line\">mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;amp;<span class=\"built_in\">arch</span>=<span class=\"variable\">$basearch</span></span><br><span class=\"line\">failovermethod=priority</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">priority=10</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</span><br><span class=\"line\">[...]</span><br></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/remi.repo</span></span><br><span class=\"line\">[remi]</span><br><span class=\"line\">name=Les RPM de remi pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></span><br><span class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/</span></span><br><span class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/remi/mirror</span><br><span class=\"line\">enabled=1</span><br><span class=\"line\">priority=10</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</span><br><span class=\"line\">failovermethod=priority</span><br><span class=\"line\"></span><br><span class=\"line\">[remi-test]</span><br><span class=\"line\">name=Les RPM de remi en <span class=\"built_in\">test</span> pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></span><br><span class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/</span></span><br><span class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/test/mirror</span><br><span class=\"line\">enabled=0</span><br><span class=\"line\">gpgcheck=1</span><br><span class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</span><br></pre></td></tr></tbody></table></figure>\n<p>安装 Lighttpd</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install lighttpd</span><br></pre></td></tr></tbody></table></figure>\n<p>接下来设置开机启动 lighttpd 并立即启动</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --levels 23 lighttpd on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></span><br><span class=\"line\">/etc/init.d/lighttpd start <span class=\"comment\">#启动 lighttpd 服务&lt;/pre&gt;</span></span><br><span class=\"line\">这个时候你有可能会碰到这样的错误</span><br></pre></td></tr></tbody></table></figure>\n<p><span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span></p>\n<p><span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can’t have more connections than fds/2: 1024 1024</span></p>\n<p>第一个是 IPV6 的问题，编辑&nbsp;<code>/etc/lighttpd/lighttpd.conf</code> 文件</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[...]</span><br><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"comment\">## Use IPv6?</span></span><br><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"attribute\">server</span>.use-ipv6 = <span class=\"string\">\"disable\"</span><span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">[...]</span></span><br></pre></td></tr></tbody></table></figure>\n<p>第二个报错，编辑&nbsp;<code>/etc/lighttpd/lighttpd.conf</code> 文件，注释掉&nbsp;<code>server.max-fds = 2048</code></p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## With SELinux enabled, this is denied by default and needs to be allowed</span></span><br><span class=\"line\"><span class=\"comment\">## by running the following once : setsebool -P httpd_setrlimit on</span></span><br><span class=\"line\"><span class=\"attribute\">server</span>.max-fds = <span class=\"number\">2048</span></span><br></pre></td></tr></tbody></table></figure>\n<p>或者</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">setsebool</span> -P httpd_setrlimit <span class=\"number\">1</span></span><br></pre></td></tr></tbody></table></figure>\n<p>这个是 CentOS 自带的 SELinux 的问题，参见<a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=571924\" title=\"Bug 571924 - lighttpd\">Bug 571924 - lighttpd’s server.max-fds conflicts with SELinux policy</a></p>\n<p>当然，你也可以用这个命令来暂时禁掉 SELinux<br><code>setenforce 0</code><br>然后再运行 <code>/etc/init.d/lighttpd start</code> 就没有问题了</p>\n<h4 id=\"3-安装PHP5-PHP-FPM\"><a href=\"#3-安装PHP5-PHP-FPM\" class=\"headerlink\" title=\"3. 安装PHP5 (PHP-FPM)\"></a>3. 安装PHP5 (PHP-FPM)</h4><p>我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php-fpm lighttpd-fastcgi&lt;/pre&gt;</span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"4-配置-Lighttpd-和-PHP\"><a href=\"#4-配置-Lighttpd-和-PHP\" class=\"headerlink\" title=\"4. 配置 Lighttpd 和 PHP\"></a>4. 配置 Lighttpd 和 PHP</h4><p>编辑 <code>/etc/php-fpm.d/www.conf</code>，把其中 user 和 group 设定的用户从 apache 改成 lighttpd</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[...]</span><br><span class=\"line\">; <span class=\"attribute\">Unix</span> user/group of processes</span><br><span class=\"line\">; <span class=\"attribute\">Note</span>: The user is mandatory. If the group is not set, the default user's group</span><br><span class=\"line\">;       <span class=\"attribute\">will</span> be used.</span><br><span class=\"line\">; <span class=\"attribute\">RPM</span>: apache Choosed to be able to access some dir as httpd</span><br><span class=\"line\"><span class=\"attribute\">user</span> = lighttpd</span><br><span class=\"line\">; <span class=\"attribute\">RPM</span>: Keep a group allowed to write in log dir.</span><br><span class=\"line\"><span class=\"attribute\">group</span> = lighttpd<span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">[...]</span></span><br></pre></td></tr></tbody></table></figure>\n<p>设置开机启动 php-fpm 并立即启动</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chkconfig --levels 23 php-fpm on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></span><br><span class=\"line\">/etc/init.d/php-fpm start <span class=\"comment\">#启动 mysqld 服务</span></span><br></pre></td></tr></tbody></table></figure>\n<p>首先我们打开<code>/etc/php.ini</code>并在文件尾加入 <code>cgi.fix_pathinfo = 1</code>。<br>然后打开&nbsp;/etc/lighttpd/modules.conf&nbsp; 文件并在server.modules块中取消&nbsp;<span style=\"color: #ff0000\">include “conf.d/fastcgi.conf”</span>&nbsp;的注释（即删除前面的“#”）：</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"comment\">## FastCGI (mod_fastcgi)</span></span><br><span class=\"line\"><span class=\"comment\">##</span></span><br><span class=\"line\"><span class=\"attribute\">include</span> <span class=\"string\">\"conf.d/fastcgi.conf\"</span></span><br></pre></td></tr></tbody></table></figure>\n<p>接着在&nbsp;<code>/etc/lighttpd/conf.d/fastcgi.conf</code>&nbsp;，找到<code>fastcgi.server</code> 块，改成如下：</p>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">fastcgi</span>.server += ( <span class=\"string\">\".php\"</span> =&amp;gt;</span><br><span class=\"line\">        ((</span><br><span class=\"line\">                \"<span class=\"attribute\">socket</span><span class=\"string\">\" =&amp;gt; \"</span>/tmp/php5-fpm.sock<span class=\"string\">\",</span></span><br><span class=\"line\"><span class=\"string\">                \"</span>broken-scriptfilename<span class=\"string\">\" =&amp;gt; \"</span>enable<span class=\"string\">\"</span></span><br><span class=\"line\"><span class=\"string\">        ))</span></span><br><span class=\"line\"><span class=\"string\">)</span></span><br></pre></td></tr></tbody></table></figure>\n<p>修改完成之后重启 lighttpd 服务以使其生效</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/init.d/lighttpd restart</span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"5-测试-PHP\"><a href=\"#5-测试-PHP\" class=\"headerlink\" title=\"5. 测试 PHP\"></a>5. 测试 PHP</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /var/www/lighttpd/info.php</span><br></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight php\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;php <span class=\"title function_ invoke__\">phpinfo</span>();</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h4 id=\"6-让-PHP5-支持-MySQL\"><a href=\"#6-让-PHP5-支持-MySQL\" class=\"headerlink\" title=\"6. 让 PHP5 支持 MySQL\"></a>6. 让 PHP5 支持 MySQL</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc</span><br><span class=\"line\">yum install php-pecl-apc <span class=\"comment\"># APC 是类似 eAccelerator 和 Xcache 的php加速组件</span></span><br><span class=\"line\">/etc/init.d/php-fpm reload <span class=\"comment\">#重新加载 php-fpm</span></span><br></pre></td></tr></tbody></table></figure>\n<h4 id=\"7-让-PHP-FPM-以-Unix-Socket-方式运行\"><a href=\"#7-让-PHP-FPM-以-Unix-Socket-方式运行\" class=\"headerlink\" title=\"7.让 PHP-FPM 以 Unix Socket 方式运行\"></a>7.让 PHP-FPM 以 Unix Socket 方式运行</h4><figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vi /etc/php-fpm.d/www.conf</span><br></pre></td></tr></tbody></table></figure>\n<figure class=\"highlight apacheconf\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[...]</span><br><span class=\"line\">;<span class=\"attribute\">listen</span> = <span class=\"number\">127.0.0.1:9000</span></span><br><span class=\"line\"><span class=\"attribute\">listen</span> = /tmp/php5-fpm.sock<span class=\"meta\"></span></span><br><span class=\"line\"><span class=\"meta\">[...]</span></span><br></pre></td></tr></tbody></table></figure>\n<p>Reload PHP-FPM</p>\n<p><code>/etc/init.d/php-fpm reload</code></p>\n</body></html>"},{"title":"Installing MSCRM 4.0 without Internet Access","date":"2008-01-08T01:59:15.000Z","_content":"\nIf you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it's being 'manufactured') ships with these prerequisites but the downloads do not.\nThe simplest way is to install each of the Pre-Req's manually. The best place to search for these is [download.microsoft.com](http://download.microsoft.com/). I'll refrain from posting links as these redistributable packages are always being updated.\nThe Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it's installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:\n\n*   \\Redist\\i386\\VCRedist\\vcredist_x86.exe\n*   \\Redist\\i386\\VCRedist\\vcredist_x64.exe\n*   \\Redist\\amd64\\VCRedist\\vcredist_x64.exe\n*   \\Server\\i386\\SetupServer.exe\n*   \\Server\\amd64\\SetupServer.exe\n*   \\Client\\SetupClient.exe\n*   \\DMWizard\\SetupDMClient.exe\n*   \\Exchange\\i386\\setupexchange.exe\n*   \\Exchange\\amd64\\setupexchange.exe\nI added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.\n\n***\n中文版本 ：\n自己上 MS 的网站上去下载 VC++ Runtime\n新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span>\nMSCRM4\\Client\\SetupClient.exe\nMSCRM4\\DMWizard\\SetupDMClient.exe\nMSCRM4\\Exchange\\i386\\setupexchange.exe\nMSCRM4\\Exchange\\amd64\\setupexchange.exe\n\n> 红色的就是表示 VC++ runtime 文件所要放置的位置\n> 蓝色的表示 MS CRM4.0 Server 的安装程序所在位置\n\n因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。","source":"_posts/installing-mscrm-4-0-without-internet-access.md","raw":"---\ntitle: Installing MSCRM 4.0 without Internet Access\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2008-01-08 09:59:15\n---\n\nIf you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it's being 'manufactured') ships with these prerequisites but the downloads do not.\nThe simplest way is to install each of the Pre-Req's manually. The best place to search for these is [download.microsoft.com](http://download.microsoft.com/). I'll refrain from posting links as these redistributable packages are always being updated.\nThe Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it's installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:\n\n*   \\Redist\\i386\\VCRedist\\vcredist_x86.exe\n*   \\Redist\\i386\\VCRedist\\vcredist_x64.exe\n*   \\Redist\\amd64\\VCRedist\\vcredist_x64.exe\n*   \\Server\\i386\\SetupServer.exe\n*   \\Server\\amd64\\SetupServer.exe\n*   \\Client\\SetupClient.exe\n*   \\DMWizard\\SetupDMClient.exe\n*   \\Exchange\\i386\\setupexchange.exe\n*   \\Exchange\\amd64\\setupexchange.exe\nI added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.\n\n***\n中文版本 ：\n自己上 MS 的网站上去下载 VC++ Runtime\n新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span>\nMSCRM4\\Client\\SetupClient.exe\nMSCRM4\\DMWizard\\SetupDMClient.exe\nMSCRM4\\Exchange\\i386\\setupexchange.exe\nMSCRM4\\Exchange\\amd64\\setupexchange.exe\n\n> 红色的就是表示 VC++ runtime 文件所要放置的位置\n> 蓝色的表示 MS CRM4.0 Server 的安装程序所在位置\n\n因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。","slug":"installing-mscrm-4-0-without-internet-access","published":1,"updated":"2020-01-05T09:00:54.004Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuc004uk84s8ef88aqa","content":"<html><head></head><body><p>If you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it’s being ‘manufactured’) ships with these prerequisites but the downloads do not.<br>The simplest way is to install each of the Pre-Req’s manually. The best place to search for these is&nbsp;<a href=\"http://download.microsoft.com/\">download.microsoft.com</a>. I’ll refrain from posting links as these redistributable packages are always being updated.<br>The Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it’s installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:</p>\n<ul>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x86.exe</li>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Server\\i386\\SetupServer.exe</li>\n<li>\\Server\\amd64\\SetupServer.exe</li>\n<li>\\Client\\SetupClient.exe</li>\n<li>\\DMWizard\\SetupDMClient.exe</li>\n<li>\\Exchange\\i386\\setupexchange.exe</li>\n<li>\\Exchange\\amd64\\setupexchange.exe<br>I added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.</li>\n</ul>\n<hr>\n<p>中文版本 ：<br>自己上 MS 的网站上去下载 VC++ Runtime<br>新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录<br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span><br>MSCRM4\\Client\\SetupClient.exe<br>MSCRM4\\DMWizard\\SetupDMClient.exe<br>MSCRM4\\Exchange\\i386\\setupexchange.exe<br>MSCRM4\\Exchange\\amd64\\setupexchange.exe</p>\n<blockquote>\n<p>红色的就是表示 VC++ runtime 文件所要放置的位置<br>蓝色的表示 MS CRM4.0 Server 的安装程序所在位置</p>\n</blockquote>\n<p>因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>If you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it’s being ‘manufactured’) ships with these prerequisites but the downloads do not.<br>The simplest way is to install each of the Pre-Req’s manually. The best place to search for these is&nbsp;<a href=\"http://download.microsoft.com/\">download.microsoft.com</a>. I’ll refrain from posting links as these redistributable packages are always being updated.<br>The Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it’s installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:</p>\n<ul>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x86.exe</li>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Server\\i386\\SetupServer.exe</li>\n<li>\\Server\\amd64\\SetupServer.exe</li>\n<li>\\Client\\SetupClient.exe</li>\n<li>\\DMWizard\\SetupDMClient.exe</li>\n<li>\\Exchange\\i386\\setupexchange.exe</li>\n<li>\\Exchange\\amd64\\setupexchange.exe<br>I added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.</li>\n</ul>\n<hr>\n<p>中文版本 ：<br>自己上 MS 的网站上去下载 VC++ Runtime<br>新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录<br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span><br>MSCRM4\\Client\\SetupClient.exe<br>MSCRM4\\DMWizard\\SetupDMClient.exe<br>MSCRM4\\Exchange\\i386\\setupexchange.exe<br>MSCRM4\\Exchange\\amd64\\setupexchange.exe</p>\n<blockquote>\n<p>红色的就是表示 VC++ runtime 文件所要放置的位置<br>蓝色的表示 MS CRM4.0 Server 的安装程序所在位置</p>\n</blockquote>\n<p>因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。</p>\n</body></html>"},{"title":"在 CentOS 中安装 VMware Tools","date":"2013-04-28T04:26:46.000Z","_content":"\n不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。\n\n在 VMware 中挂上 VMware Tools 的 ISO： VM -> Guest -> Install/Upgrade VMware Tools\n```bash\nmkdir /media/cdrom  #创建挂载点目录\nmount /dev/cdrom /media/cdrom #挂载光盘\ncp /media/cdrom/VMwareTools*.tar.gz /tmp #复制文件到 /tmp\ncd /tmp\ntar –xzvf VMwareTools*.tar.gz &amp;nbsp;# 解压缩\ncd vm* #注意这里的 vm 是小写\n./vmware-install.pl\n```\n基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools\n```bash\n/etc/init.d/networking stop\nrmmod pcnet32\nrmmod vmxnet\ndepmod -a\nmodprobe vmxnet\n/etc/init.d/networking start\n```","source":"_posts/installing-vmware-tools-on-centos.md","raw":"---\ntitle: 在 CentOS 中安装 VMware Tools\ntags:\n  - CentOS\n  - VMware\n  - VMware Tools\ncategories:\n  - '*Nix'\ndate: 2013-04-28 12:26:46\n---\n\n不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。\n\n在 VMware 中挂上 VMware Tools 的 ISO： VM -> Guest -> Install/Upgrade VMware Tools\n```bash\nmkdir /media/cdrom  #创建挂载点目录\nmount /dev/cdrom /media/cdrom #挂载光盘\ncp /media/cdrom/VMwareTools*.tar.gz /tmp #复制文件到 /tmp\ncd /tmp\ntar –xzvf VMwareTools*.tar.gz &amp;nbsp;# 解压缩\ncd vm* #注意这里的 vm 是小写\n./vmware-install.pl\n```\n基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools\n```bash\n/etc/init.d/networking stop\nrmmod pcnet32\nrmmod vmxnet\ndepmod -a\nmodprobe vmxnet\n/etc/init.d/networking start\n```","slug":"installing-vmware-tools-on-centos","published":1,"updated":"2020-01-05T09:00:54.004Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kud004xk84s4s6k5dke","content":"<html><head></head><body><p>不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。</p>\n<p>在 VMware 中挂上 VMware Tools 的 ISO：&nbsp;VM -&gt; Guest -&gt; Install/Upgrade VMware Tools</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> /media/cdrom  <span class=\"comment\">#创建挂载点目录</span></span><br><span class=\"line\">mount /dev/cdrom /media/cdrom <span class=\"comment\">#挂载光盘</span></span><br><span class=\"line\"><span class=\"built_in\">cp</span> /media/cdrom/VMwareTools*.tar.gz /tmp <span class=\"comment\">#复制文件到 /tmp</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /tmp</span><br><span class=\"line\">tar –xzvf VMwareTools*.tar.gz &amp;amp;nbsp;<span class=\"comment\"># 解压缩</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> vm* <span class=\"comment\">#注意这里的 vm 是小写</span></span><br><span class=\"line\">./vmware-install.pl</span><br></pre></td></tr></tbody></table></figure>\n<p>基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/init.d/networking stop</span><br><span class=\"line\">rmmod pcnet32</span><br><span class=\"line\">rmmod vmxnet</span><br><span class=\"line\">depmod -a</span><br><span class=\"line\">modprobe vmxnet</span><br><span class=\"line\">/etc/init.d/networking start</span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。</p>\n<p>在 VMware 中挂上 VMware Tools 的 ISO：&nbsp;VM -&gt; Guest -&gt; Install/Upgrade VMware Tools</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">mkdir</span> /media/cdrom  <span class=\"comment\">#创建挂载点目录</span></span><br><span class=\"line\">mount /dev/cdrom /media/cdrom <span class=\"comment\">#挂载光盘</span></span><br><span class=\"line\"><span class=\"built_in\">cp</span> /media/cdrom/VMwareTools*.tar.gz /tmp <span class=\"comment\">#复制文件到 /tmp</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /tmp</span><br><span class=\"line\">tar –xzvf VMwareTools*.tar.gz &amp;amp;nbsp;<span class=\"comment\"># 解压缩</span></span><br><span class=\"line\"><span class=\"built_in\">cd</span> vm* <span class=\"comment\">#注意这里的 vm 是小写</span></span><br><span class=\"line\">./vmware-install.pl</span><br></pre></td></tr></tbody></table></figure>\n<p>基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools</p>\n<figure class=\"highlight bash\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/init.d/networking stop</span><br><span class=\"line\">rmmod pcnet32</span><br><span class=\"line\">rmmod vmxnet</span><br><span class=\"line\">depmod -a</span><br><span class=\"line\">modprobe vmxnet</span><br><span class=\"line\">/etc/init.d/networking start</span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"Intel NUC8i7BEH 读卡器魔改完美安装黑苹果","date":"2020-01-06T08:48:35.000Z","keywords":"Intel, NUC, Bean Canyon, 黑苹果, Hackintosh","description":"Intel 的性能小钢炮 NUC8i7BEH 硬件上几乎和 Macbook Pro 15.2也就是2018款的13寸 MBP 顶配一样，除了板载的无线网卡和蓝牙，理论可以安装黑苹果，而且在数码之家网友 laice 的努力下，实现了读卡器魔改加装苹果原装无线网卡，完美解决无线和蓝牙的问题。","_content":"\n## GitHub\n本文引用自我的 GitHub:\n[OS-X-NUC8i7BEH-Clover](https://github.com/randyzhong/OS-X-NUC8i7BEH-Clover)\n\n## OS-X-NUC8i7BEH-Clover\nThis repository contains the files and scripts to install macOS on a **modded** Intel NUC8i7BEH (Bean Canyon).\n\n![Catalina-10.15.2.jpg](https://i.loli.net/2020/01/05/cpzUulMALTbi21F.jpg)\n\n## Hardware\n### Specs:\n- CPU: Intel i7-8559U, 4c/8t, base 2.7Ghz, turbo 4.5Ghz, 28w TDP.\n- Graphic: intel Iris plus 655 with 128 eDRAM.\n- RAM: Two sockets 260-pin 1.2 V DDR4 SDRAM SO-DIMM (up to 32Gb, and 2400Mhz)\n- LAN: Intel I219V Gigabit Ethernet Controller (10/100/1000 Mbps)\n- Wi-Fi/BT: Intel Dual Band Wireless-AC 9560 (soldered)\n- 1 * Thunderbolt 3 Four lanes 40Gbps, support DisplayPort 1.2 (17Gbps, up to 4096x2304@60Hz), support USB data (10Gbps)\n- 1 * HDMI 2.0a (MegaChips MCDP2800 LSPCon DisplayPort1.2-to-HDMI 2.0 up to 4096x2160@60Hz)\n- 1 * SATA 6 Gbps, 2.5\" (540 Mbps)\n- 1 * M.2 connector (key type M and B+M) for 2242 and 2280 modules. Four lanes (4 Gbps)\n- 4 * USB-A 3.1 (gen2 10Gbps). One port can deliver 1.5A\n- 1 * Micro SDXC Card Reader\n- 1 * Jack 3.5mm Realtek HD Audio\n\n### My specification\n- 2 * Hynix HMA81GS6AFR8N-UH 8GB DDR4-2400 SODIMM\n- WD Black SN750 NVMe 512G\n- **BCM94360CS2** Wi-Fi/Bluetooth with adapter (will explain how)\n\n## Mod\nNUC8i7BEH uses RTS5227S (use pcie x1) chipset for SD card which can be desoldered/replaced with a BCM94360CS2(or BCM942602CS) to get native AirDrop/Handoff support.\n\nTwo possible Mods:\n- https://www.chiphell.com/thread-2004976-1-1.html (Chinese) - My NUC8 Mod\n![1](https://www.tonymacx86.com/attachments/193557c1jhu2heyxjjl8w8-jpg.422678/)\n![2](https://www.tonymacx86.com/attachments/200739bhrnx7stnmnxej9z-jpg.422679/)\n![3](https://www.tonymacx86.com/attachments/204632xl75bq1uwbil2i8g-jpg.422686/)\n\n- https://www.mydigit.cn/forum.php?mod=viewthread&tid=34830&extra=&page=1 (Chinese) - also looks great!\n\n## Configure BIOS Settings\nOn my NUC8i7BEH, BIOS version updated to **0071**.\n\nThe boot menu and BIOS setup can be accessed by mashing the F2 key during BIOS startup. After the main screen comes up choose \"Advanced\". That gets you to the main BIOS setup screens.\n\nTo start, choose \"Load Defaults\" (choose from the menu or press F9 in the BIOS setup).\n\nThen change:\n- Boot->Boot Configuration, disable \"Network Boot\"\n- Power->Secondary Power Settings, \"Wake on LAN from S4/S5\", set to \"Stay Off\"\n\nThese settings are important but are already set as needed by \"Load Defaults\"\n- Devices->Video, \"IGD Minimum Memory\" set to 64mb or 128mb\n- Devices->Video, \"IGD Aperture Size\" set to 256mb\n- Boot->Secure Boot, \"Secure Boot\" is disabled\n- Boot->Boot Priority->Legacy Boot Priority, enable \"Legacy Boot\" (continue to boot UEFI, but enable legacy for CSM)\n(you will have KP/reboot without it).\n\nThe following settings are important for **Mod** users\n- Devices->Onboard Devices, disable **WLAN** and **Bluetooth**\n- Devices->Onboard Devices, enable **SD Card** to Read/Write as we desoldered/replaced with a BCM94360CS2(or BCM942602CS).\n\nPress **F10** to save changes.\n\n\n## Power Management\n\nEverything required for CPU/IGPU power management is already installed with the steps above.\nThere is no longer any need to use the ssdtPRgen.sh script.\n\nBe aware that hibernation (suspend to disk or S4 sleep) is not well supported on hackintosh.\n\nYou should disable it:\n```\nsudo pmset -a hibernatemode 0\nsudo rm /var/vm/sleepimage\nsudo mkdir /var/vm/sleepimage\n```\nAlways check your hibernatemode after updates and disable it. System updates tend to re-enable it, although the trick above (making sleepimage a directory) tends to help.\n\n\n\n## Installation\n- To be updated\n\n### Tested OS\n- macOS Mojave 10.14.6\n- macOS Catalina 10.15.2\n\n### Clover\n- Clover r5102\n\n### Kexts\n- CPUFriend.kext (1.1.9)\n- VirtualSMC.kext (1.0.9)\n  - SMCProcessor.kext (1.0.9)\n  - SMCSuperIO.kext (1.0.9)\n- IntelMausi.kext (1.0.2)\n- USBPorts.kext (1.0)\n- SATA-unsupported (0.9.2)\n- Lilu.kext (1.4.0)\n- AppleALC (1.4.4)\n- WhateverGreen.kext (1.3.5)\n\n## Works\n- UEFI booting via Clover\n- **AirDrop, Handoff** \n- DP/HDMI video/audio\n- AirPlay mirroring to AppleTV\n- Native USB3/USB2\n- Native audio with AppleHDA\n- Native power management\n- GPU Hardware Acceleration\n- Wired Ethernet\n- Mac App Store working\n- Sleep (hibernation disabled, not tested)\n- **Dual Displays** (1 HDMI, 1 USB-C to DP)\n\n## Other\n- Remove USB Port:HS10 (Built-in Bluetooth)","source":"_posts/intel-nuc8i7beh-mod-hackintosh.md","raw":"---\ntitle: Intel NUC8i7BEH 读卡器魔改完美安装黑苹果\ntags:\n  - Intel, NUC, Bean Canyon, 黑苹果, Hackintosh, 读卡器, 魔改\ncategories:\n  - Hackintosh\ndate: 2020-01-06 16:48:35\nkeywords: Intel, NUC, Bean Canyon, 黑苹果, Hackintosh\ndescription: Intel 的性能小钢炮 NUC8i7BEH 硬件上几乎和 Macbook Pro 15.2也就是2018款的13寸 MBP 顶配一样，除了板载的无线网卡和蓝牙，理论可以安装黑苹果，而且在数码之家网友 laice 的努力下，实现了读卡器魔改加装苹果原装无线网卡，完美解决无线和蓝牙的问题。\n---\n\n## GitHub\n本文引用自我的 GitHub:\n[OS-X-NUC8i7BEH-Clover](https://github.com/randyzhong/OS-X-NUC8i7BEH-Clover)\n\n## OS-X-NUC8i7BEH-Clover\nThis repository contains the files and scripts to install macOS on a **modded** Intel NUC8i7BEH (Bean Canyon).\n\n![Catalina-10.15.2.jpg](https://i.loli.net/2020/01/05/cpzUulMALTbi21F.jpg)\n\n## Hardware\n### Specs:\n- CPU: Intel i7-8559U, 4c/8t, base 2.7Ghz, turbo 4.5Ghz, 28w TDP.\n- Graphic: intel Iris plus 655 with 128 eDRAM.\n- RAM: Two sockets 260-pin 1.2 V DDR4 SDRAM SO-DIMM (up to 32Gb, and 2400Mhz)\n- LAN: Intel I219V Gigabit Ethernet Controller (10/100/1000 Mbps)\n- Wi-Fi/BT: Intel Dual Band Wireless-AC 9560 (soldered)\n- 1 * Thunderbolt 3 Four lanes 40Gbps, support DisplayPort 1.2 (17Gbps, up to 4096x2304@60Hz), support USB data (10Gbps)\n- 1 * HDMI 2.0a (MegaChips MCDP2800 LSPCon DisplayPort1.2-to-HDMI 2.0 up to 4096x2160@60Hz)\n- 1 * SATA 6 Gbps, 2.5\" (540 Mbps)\n- 1 * M.2 connector (key type M and B+M) for 2242 and 2280 modules. Four lanes (4 Gbps)\n- 4 * USB-A 3.1 (gen2 10Gbps). One port can deliver 1.5A\n- 1 * Micro SDXC Card Reader\n- 1 * Jack 3.5mm Realtek HD Audio\n\n### My specification\n- 2 * Hynix HMA81GS6AFR8N-UH 8GB DDR4-2400 SODIMM\n- WD Black SN750 NVMe 512G\n- **BCM94360CS2** Wi-Fi/Bluetooth with adapter (will explain how)\n\n## Mod\nNUC8i7BEH uses RTS5227S (use pcie x1) chipset for SD card which can be desoldered/replaced with a BCM94360CS2(or BCM942602CS) to get native AirDrop/Handoff support.\n\nTwo possible Mods:\n- https://www.chiphell.com/thread-2004976-1-1.html (Chinese) - My NUC8 Mod\n![1](https://www.tonymacx86.com/attachments/193557c1jhu2heyxjjl8w8-jpg.422678/)\n![2](https://www.tonymacx86.com/attachments/200739bhrnx7stnmnxej9z-jpg.422679/)\n![3](https://www.tonymacx86.com/attachments/204632xl75bq1uwbil2i8g-jpg.422686/)\n\n- https://www.mydigit.cn/forum.php?mod=viewthread&tid=34830&extra=&page=1 (Chinese) - also looks great!\n\n## Configure BIOS Settings\nOn my NUC8i7BEH, BIOS version updated to **0071**.\n\nThe boot menu and BIOS setup can be accessed by mashing the F2 key during BIOS startup. After the main screen comes up choose \"Advanced\". That gets you to the main BIOS setup screens.\n\nTo start, choose \"Load Defaults\" (choose from the menu or press F9 in the BIOS setup).\n\nThen change:\n- Boot->Boot Configuration, disable \"Network Boot\"\n- Power->Secondary Power Settings, \"Wake on LAN from S4/S5\", set to \"Stay Off\"\n\nThese settings are important but are already set as needed by \"Load Defaults\"\n- Devices->Video, \"IGD Minimum Memory\" set to 64mb or 128mb\n- Devices->Video, \"IGD Aperture Size\" set to 256mb\n- Boot->Secure Boot, \"Secure Boot\" is disabled\n- Boot->Boot Priority->Legacy Boot Priority, enable \"Legacy Boot\" (continue to boot UEFI, but enable legacy for CSM)\n(you will have KP/reboot without it).\n\nThe following settings are important for **Mod** users\n- Devices->Onboard Devices, disable **WLAN** and **Bluetooth**\n- Devices->Onboard Devices, enable **SD Card** to Read/Write as we desoldered/replaced with a BCM94360CS2(or BCM942602CS).\n\nPress **F10** to save changes.\n\n\n## Power Management\n\nEverything required for CPU/IGPU power management is already installed with the steps above.\nThere is no longer any need to use the ssdtPRgen.sh script.\n\nBe aware that hibernation (suspend to disk or S4 sleep) is not well supported on hackintosh.\n\nYou should disable it:\n```\nsudo pmset -a hibernatemode 0\nsudo rm /var/vm/sleepimage\nsudo mkdir /var/vm/sleepimage\n```\nAlways check your hibernatemode after updates and disable it. System updates tend to re-enable it, although the trick above (making sleepimage a directory) tends to help.\n\n\n\n## Installation\n- To be updated\n\n### Tested OS\n- macOS Mojave 10.14.6\n- macOS Catalina 10.15.2\n\n### Clover\n- Clover r5102\n\n### Kexts\n- CPUFriend.kext (1.1.9)\n- VirtualSMC.kext (1.0.9)\n  - SMCProcessor.kext (1.0.9)\n  - SMCSuperIO.kext (1.0.9)\n- IntelMausi.kext (1.0.2)\n- USBPorts.kext (1.0)\n- SATA-unsupported (0.9.2)\n- Lilu.kext (1.4.0)\n- AppleALC (1.4.4)\n- WhateverGreen.kext (1.3.5)\n\n## Works\n- UEFI booting via Clover\n- **AirDrop, Handoff** \n- DP/HDMI video/audio\n- AirPlay mirroring to AppleTV\n- Native USB3/USB2\n- Native audio with AppleHDA\n- Native power management\n- GPU Hardware Acceleration\n- Wired Ethernet\n- Mac App Store working\n- Sleep (hibernation disabled, not tested)\n- **Dual Displays** (1 HDMI, 1 USB-C to DP)\n\n## Other\n- Remove USB Port:HS10 (Built-in Bluetooth)","slug":"intel-nuc8i7beh-mod-hackintosh","published":1,"updated":"2020-01-07T15:46:58.592Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kue0050k84sc59n9cwo","content":"<html><head></head><body><h2 id=\"GitHub\"><a href=\"#GitHub\" class=\"headerlink\" title=\"GitHub\"></a>GitHub</h2><p>本文引用自我的 GitHub:<br><a href=\"https://github.com/randyzhong/OS-X-NUC8i7BEH-Clover\">OS-X-NUC8i7BEH-Clover</a></p>\n<h2 id=\"OS-X-NUC8i7BEH-Clover\"><a href=\"#OS-X-NUC8i7BEH-Clover\" class=\"headerlink\" title=\"OS-X-NUC8i7BEH-Clover\"></a>OS-X-NUC8i7BEH-Clover</h2><p>This repository contains the files and scripts to install macOS on a <strong>modded</strong> Intel NUC8i7BEH (Bean Canyon).</p>\n<p><img src=\"https://i.loli.net/2020/01/05/cpzUulMALTbi21F.jpg\" alt=\"Catalina-10.15.2.jpg\"></p>\n<h2 id=\"Hardware\"><a href=\"#Hardware\" class=\"headerlink\" title=\"Hardware\"></a>Hardware</h2><h3 id=\"Specs\"><a href=\"#Specs\" class=\"headerlink\" title=\"Specs:\"></a>Specs:</h3><ul>\n<li>CPU: Intel i7-8559U, 4c/8t, base 2.7Ghz, turbo 4.5Ghz, 28w TDP.</li>\n<li>Graphic: intel Iris plus 655 with 128 eDRAM.</li>\n<li>RAM: Two sockets 260-pin 1.2 V DDR4 SDRAM SO-DIMM (up to 32Gb, and 2400Mhz)</li>\n<li>LAN: Intel I219V Gigabit Ethernet Controller (10/100/1000 Mbps)</li>\n<li>Wi-Fi/BT: Intel Dual Band Wireless-AC 9560 (soldered)</li>\n<li>1 * Thunderbolt 3 Four lanes 40Gbps, support DisplayPort 1.2 (17Gbps, up to 4096x2304@60Hz), support USB data (10Gbps)</li>\n<li>1 * HDMI 2.0a (MegaChips MCDP2800 LSPCon DisplayPort1.2-to-HDMI 2.0 up to 4096x2160@60Hz)</li>\n<li>1 * SATA 6 Gbps, 2.5” (540 Mbps)</li>\n<li>1 * M.2 connector (key type M and B+M) for 2242 and 2280 modules. Four lanes (4 Gbps)</li>\n<li>4 * USB-A 3.1 (gen2 10Gbps). One port can deliver 1.5A</li>\n<li>1 * Micro SDXC Card Reader</li>\n<li>1 * Jack 3.5mm Realtek HD Audio</li>\n</ul>\n<h3 id=\"My-specification\"><a href=\"#My-specification\" class=\"headerlink\" title=\"My specification\"></a>My specification</h3><ul>\n<li>2 * Hynix HMA81GS6AFR8N-UH 8GB DDR4-2400 SODIMM</li>\n<li>WD Black SN750 NVMe 512G</li>\n<li><strong>BCM94360CS2</strong> Wi-Fi/Bluetooth with adapter (will explain how)</li>\n</ul>\n<h2 id=\"Mod\"><a href=\"#Mod\" class=\"headerlink\" title=\"Mod\"></a>Mod</h2><p>NUC8i7BEH uses RTS5227S (use pcie x1) chipset for SD card which can be desoldered/replaced with a BCM94360CS2(or BCM942602CS) to get native AirDrop/Handoff support.</p>\n<p>Two possible Mods:</p>\n<ul>\n<li><p><a href=\"https://www.chiphell.com/thread-2004976-1-1.html\">https://www.chiphell.com/thread-2004976-1-1.html</a> (Chinese) - My NUC8 Mod<br><img src=\"https://www.tonymacx86.com/attachments/193557c1jhu2heyxjjl8w8-jpg.422678/\" alt=\"1\"><br><img src=\"https://www.tonymacx86.com/attachments/200739bhrnx7stnmnxej9z-jpg.422679/\" alt=\"2\"><br><img src=\"https://www.tonymacx86.com/attachments/204632xl75bq1uwbil2i8g-jpg.422686/\" alt=\"3\"></p>\n</li>\n<li><p><a href=\"https://www.mydigit.cn/forum.php?mod=viewthread&amp;tid=34830&amp;extra=&amp;page=1\">https://www.mydigit.cn/forum.php?mod=viewthread&amp;tid=34830&amp;extra=&amp;page=1</a> (Chinese) - also looks great!</p>\n</li>\n</ul>\n<h2 id=\"Configure-BIOS-Settings\"><a href=\"#Configure-BIOS-Settings\" class=\"headerlink\" title=\"Configure BIOS Settings\"></a>Configure BIOS Settings</h2><p>On my NUC8i7BEH, BIOS version updated to <strong>0071</strong>.</p>\n<p>The boot menu and BIOS setup can be accessed by mashing the F2 key during BIOS startup. After the main screen comes up choose “Advanced”. That gets you to the main BIOS setup screens.</p>\n<p>To start, choose “Load Defaults” (choose from the menu or press F9 in the BIOS setup).</p>\n<p>Then change:</p>\n<ul>\n<li>Boot-&gt;Boot Configuration, disable “Network Boot”</li>\n<li>Power-&gt;Secondary Power Settings, “Wake on LAN from S4/S5”, set to “Stay Off”</li>\n</ul>\n<p>These settings are important but are already set as needed by “Load Defaults”</p>\n<ul>\n<li>Devices-&gt;Video, “IGD Minimum Memory” set to 64mb or 128mb</li>\n<li>Devices-&gt;Video, “IGD Aperture Size” set to 256mb</li>\n<li>Boot-&gt;Secure Boot, “Secure Boot” is disabled</li>\n<li>Boot-&gt;Boot Priority-&gt;Legacy Boot Priority, enable “Legacy Boot” (continue to boot UEFI, but enable legacy for CSM)<br>(you will have KP/reboot without it).</li>\n</ul>\n<p>The following settings are important for <strong>Mod</strong> users</p>\n<ul>\n<li>Devices-&gt;Onboard Devices, disable <strong>WLAN</strong> and <strong>Bluetooth</strong></li>\n<li>Devices-&gt;Onboard Devices, enable <strong>SD Card</strong> to Read/Write as we desoldered/replaced with a BCM94360CS2(or BCM942602CS).</li>\n</ul>\n<p>Press <strong>F10</strong> to save changes.</p>\n<h2 id=\"Power-Management\"><a href=\"#Power-Management\" class=\"headerlink\" title=\"Power Management\"></a>Power Management</h2><p>Everything required for CPU/IGPU power management is already installed with the steps above.<br>There is no longer any need to use the ssdtPRgen.sh script.</p>\n<p>Be aware that hibernation (suspend to disk or S4 sleep) is not well supported on hackintosh.</p>\n<p>You should disable it:</p>\n<figure class=\"highlight awk\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo pmset -a hibernatemode <span class=\"number\">0</span></span><br><span class=\"line\">sudo rm <span class=\"regexp\">/var/</span>vm/sleepimage</span><br><span class=\"line\">sudo mkdir <span class=\"regexp\">/var/</span>vm/sleepimage</span><br></pre></td></tr></tbody></table></figure>\n<p>Always check your hibernatemode after updates and disable it. System updates tend to re-enable it, although the trick above (making sleepimage a directory) tends to help.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><ul>\n<li>To be updated</li>\n</ul>\n<h3 id=\"Tested-OS\"><a href=\"#Tested-OS\" class=\"headerlink\" title=\"Tested OS\"></a>Tested OS</h3><ul>\n<li>macOS Mojave 10.14.6</li>\n<li>macOS Catalina 10.15.2</li>\n</ul>\n<h3 id=\"Clover\"><a href=\"#Clover\" class=\"headerlink\" title=\"Clover\"></a>Clover</h3><ul>\n<li>Clover r5102</li>\n</ul>\n<h3 id=\"Kexts\"><a href=\"#Kexts\" class=\"headerlink\" title=\"Kexts\"></a>Kexts</h3><ul>\n<li>CPUFriend.kext (1.1.9)</li>\n<li>VirtualSMC.kext (1.0.9)<ul>\n<li>SMCProcessor.kext (1.0.9)</li>\n<li>SMCSuperIO.kext (1.0.9)</li>\n</ul>\n</li>\n<li>IntelMausi.kext (1.0.2)</li>\n<li>USBPorts.kext (1.0)</li>\n<li>SATA-unsupported (0.9.2)</li>\n<li>Lilu.kext (1.4.0)</li>\n<li>AppleALC (1.4.4)</li>\n<li>WhateverGreen.kext (1.3.5)</li>\n</ul>\n<h2 id=\"Works\"><a href=\"#Works\" class=\"headerlink\" title=\"Works\"></a>Works</h2><ul>\n<li>UEFI booting via Clover</li>\n<li><strong>AirDrop, Handoff</strong> </li>\n<li>DP/HDMI video/audio</li>\n<li>AirPlay mirroring to AppleTV</li>\n<li>Native USB3/USB2</li>\n<li>Native audio with AppleHDA</li>\n<li>Native power management</li>\n<li>GPU Hardware Acceleration</li>\n<li>Wired Ethernet</li>\n<li>Mac App Store working</li>\n<li>Sleep (hibernation disabled, not tested)</li>\n<li><strong>Dual Displays</strong> (1 HDMI, 1 USB-C to DP)</li>\n</ul>\n<h2 id=\"Other\"><a href=\"#Other\" class=\"headerlink\" title=\"Other\"></a>Other</h2><ul>\n<li>Remove USB Port:HS10 (Built-in Bluetooth)</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h2 id=\"GitHub\"><a href=\"#GitHub\" class=\"headerlink\" title=\"GitHub\"></a>GitHub</h2><p>本文引用自我的 GitHub:<br><a href=\"https://github.com/randyzhong/OS-X-NUC8i7BEH-Clover\">OS-X-NUC8i7BEH-Clover</a></p>\n<h2 id=\"OS-X-NUC8i7BEH-Clover\"><a href=\"#OS-X-NUC8i7BEH-Clover\" class=\"headerlink\" title=\"OS-X-NUC8i7BEH-Clover\"></a>OS-X-NUC8i7BEH-Clover</h2><p>This repository contains the files and scripts to install macOS on a <strong>modded</strong> Intel NUC8i7BEH (Bean Canyon).</p>\n<p><img src=\"https://i.loli.net/2020/01/05/cpzUulMALTbi21F.jpg\" alt=\"Catalina-10.15.2.jpg\"></p>\n<h2 id=\"Hardware\"><a href=\"#Hardware\" class=\"headerlink\" title=\"Hardware\"></a>Hardware</h2><h3 id=\"Specs\"><a href=\"#Specs\" class=\"headerlink\" title=\"Specs:\"></a>Specs:</h3><ul>\n<li>CPU: Intel i7-8559U, 4c/8t, base 2.7Ghz, turbo 4.5Ghz, 28w TDP.</li>\n<li>Graphic: intel Iris plus 655 with 128 eDRAM.</li>\n<li>RAM: Two sockets 260-pin 1.2 V DDR4 SDRAM SO-DIMM (up to 32Gb, and 2400Mhz)</li>\n<li>LAN: Intel I219V Gigabit Ethernet Controller (10/100/1000 Mbps)</li>\n<li>Wi-Fi/BT: Intel Dual Band Wireless-AC 9560 (soldered)</li>\n<li>1 * Thunderbolt 3 Four lanes 40Gbps, support DisplayPort 1.2 (17Gbps, up to 4096x2304@60Hz), support USB data (10Gbps)</li>\n<li>1 * HDMI 2.0a (MegaChips MCDP2800 LSPCon DisplayPort1.2-to-HDMI 2.0 up to 4096x2160@60Hz)</li>\n<li>1 * SATA 6 Gbps, 2.5” (540 Mbps)</li>\n<li>1 * M.2 connector (key type M and B+M) for 2242 and 2280 modules. Four lanes (4 Gbps)</li>\n<li>4 * USB-A 3.1 (gen2 10Gbps). One port can deliver 1.5A</li>\n<li>1 * Micro SDXC Card Reader</li>\n<li>1 * Jack 3.5mm Realtek HD Audio</li>\n</ul>\n<h3 id=\"My-specification\"><a href=\"#My-specification\" class=\"headerlink\" title=\"My specification\"></a>My specification</h3><ul>\n<li>2 * Hynix HMA81GS6AFR8N-UH 8GB DDR4-2400 SODIMM</li>\n<li>WD Black SN750 NVMe 512G</li>\n<li><strong>BCM94360CS2</strong> Wi-Fi/Bluetooth with adapter (will explain how)</li>\n</ul>\n<h2 id=\"Mod\"><a href=\"#Mod\" class=\"headerlink\" title=\"Mod\"></a>Mod</h2><p>NUC8i7BEH uses RTS5227S (use pcie x1) chipset for SD card which can be desoldered/replaced with a BCM94360CS2(or BCM942602CS) to get native AirDrop/Handoff support.</p>\n<p>Two possible Mods:</p>\n<ul>\n<li><p><a href=\"https://www.chiphell.com/thread-2004976-1-1.html\">https://www.chiphell.com/thread-2004976-1-1.html</a> (Chinese) - My NUC8 Mod<br><img src=\"https://www.tonymacx86.com/attachments/193557c1jhu2heyxjjl8w8-jpg.422678/\" alt=\"1\"><br><img src=\"https://www.tonymacx86.com/attachments/200739bhrnx7stnmnxej9z-jpg.422679/\" alt=\"2\"><br><img src=\"https://www.tonymacx86.com/attachments/204632xl75bq1uwbil2i8g-jpg.422686/\" alt=\"3\"></p>\n</li>\n<li><p><a href=\"https://www.mydigit.cn/forum.php?mod=viewthread&amp;tid=34830&amp;extra=&amp;page=1\">https://www.mydigit.cn/forum.php?mod=viewthread&amp;tid=34830&amp;extra=&amp;page=1</a> (Chinese) - also looks great!</p>\n</li>\n</ul>\n<h2 id=\"Configure-BIOS-Settings\"><a href=\"#Configure-BIOS-Settings\" class=\"headerlink\" title=\"Configure BIOS Settings\"></a>Configure BIOS Settings</h2><p>On my NUC8i7BEH, BIOS version updated to <strong>0071</strong>.</p>\n<p>The boot menu and BIOS setup can be accessed by mashing the F2 key during BIOS startup. After the main screen comes up choose “Advanced”. That gets you to the main BIOS setup screens.</p>\n<p>To start, choose “Load Defaults” (choose from the menu or press F9 in the BIOS setup).</p>\n<p>Then change:</p>\n<ul>\n<li>Boot-&gt;Boot Configuration, disable “Network Boot”</li>\n<li>Power-&gt;Secondary Power Settings, “Wake on LAN from S4/S5”, set to “Stay Off”</li>\n</ul>\n<p>These settings are important but are already set as needed by “Load Defaults”</p>\n<ul>\n<li>Devices-&gt;Video, “IGD Minimum Memory” set to 64mb or 128mb</li>\n<li>Devices-&gt;Video, “IGD Aperture Size” set to 256mb</li>\n<li>Boot-&gt;Secure Boot, “Secure Boot” is disabled</li>\n<li>Boot-&gt;Boot Priority-&gt;Legacy Boot Priority, enable “Legacy Boot” (continue to boot UEFI, but enable legacy for CSM)<br>(you will have KP/reboot without it).</li>\n</ul>\n<p>The following settings are important for <strong>Mod</strong> users</p>\n<ul>\n<li>Devices-&gt;Onboard Devices, disable <strong>WLAN</strong> and <strong>Bluetooth</strong></li>\n<li>Devices-&gt;Onboard Devices, enable <strong>SD Card</strong> to Read/Write as we desoldered/replaced with a BCM94360CS2(or BCM942602CS).</li>\n</ul>\n<p>Press <strong>F10</strong> to save changes.</p>\n<h2 id=\"Power-Management\"><a href=\"#Power-Management\" class=\"headerlink\" title=\"Power Management\"></a>Power Management</h2><p>Everything required for CPU/IGPU power management is already installed with the steps above.<br>There is no longer any need to use the ssdtPRgen.sh script.</p>\n<p>Be aware that hibernation (suspend to disk or S4 sleep) is not well supported on hackintosh.</p>\n<p>You should disable it:</p>\n<figure class=\"highlight awk\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo pmset -a hibernatemode <span class=\"number\">0</span></span><br><span class=\"line\">sudo rm <span class=\"regexp\">/var/</span>vm/sleepimage</span><br><span class=\"line\">sudo mkdir <span class=\"regexp\">/var/</span>vm/sleepimage</span><br></pre></td></tr></tbody></table></figure>\n<p>Always check your hibernatemode after updates and disable it. System updates tend to re-enable it, although the trick above (making sleepimage a directory) tends to help.</p>\n<h2 id=\"Installation\"><a href=\"#Installation\" class=\"headerlink\" title=\"Installation\"></a>Installation</h2><ul>\n<li>To be updated</li>\n</ul>\n<h3 id=\"Tested-OS\"><a href=\"#Tested-OS\" class=\"headerlink\" title=\"Tested OS\"></a>Tested OS</h3><ul>\n<li>macOS Mojave 10.14.6</li>\n<li>macOS Catalina 10.15.2</li>\n</ul>\n<h3 id=\"Clover\"><a href=\"#Clover\" class=\"headerlink\" title=\"Clover\"></a>Clover</h3><ul>\n<li>Clover r5102</li>\n</ul>\n<h3 id=\"Kexts\"><a href=\"#Kexts\" class=\"headerlink\" title=\"Kexts\"></a>Kexts</h3><ul>\n<li>CPUFriend.kext (1.1.9)</li>\n<li>VirtualSMC.kext (1.0.9)<ul>\n<li>SMCProcessor.kext (1.0.9)</li>\n<li>SMCSuperIO.kext (1.0.9)</li>\n</ul>\n</li>\n<li>IntelMausi.kext (1.0.2)</li>\n<li>USBPorts.kext (1.0)</li>\n<li>SATA-unsupported (0.9.2)</li>\n<li>Lilu.kext (1.4.0)</li>\n<li>AppleALC (1.4.4)</li>\n<li>WhateverGreen.kext (1.3.5)</li>\n</ul>\n<h2 id=\"Works\"><a href=\"#Works\" class=\"headerlink\" title=\"Works\"></a>Works</h2><ul>\n<li>UEFI booting via Clover</li>\n<li><strong>AirDrop, Handoff</strong> </li>\n<li>DP/HDMI video/audio</li>\n<li>AirPlay mirroring to AppleTV</li>\n<li>Native USB3/USB2</li>\n<li>Native audio with AppleHDA</li>\n<li>Native power management</li>\n<li>GPU Hardware Acceleration</li>\n<li>Wired Ethernet</li>\n<li>Mac App Store working</li>\n<li>Sleep (hibernation disabled, not tested)</li>\n<li><strong>Dual Displays</strong> (1 HDMI, 1 USB-C to DP)</li>\n</ul>\n<h2 id=\"Other\"><a href=\"#Other\" class=\"headerlink\" title=\"Other\"></a>Other</h2><ul>\n<li>Remove USB Port:HS10 (Built-in Bluetooth)</li>\n</ul>\n</body></html>"},{"title":"Internet Explorer Zonemapping failed due to the data is invalid (event ID: 7016)","date":"2013-03-11T07:53:58.000Z","_content":"\n今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：\n```msdos\nC:\\Users\\user>gpupdate /force Updating Policy...\n\nUser Policy update has completed successfully.\n\nThe following warnings were encountered during user policy processing:\n\nWindows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the \"More information\" link. Computer Policy update has completed successfully.\n\nFor more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.\n```\n运行 `gpresult /h gpreport.html`，打开这个html文件一看\n![GPReport](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg)\nInternet Explorer Zonemapping failed due to the error listed below.\nThe data is invalid.\n\n再来看看事件查看器中有没有相关日志，还真找到一条 Event ID:7016 的错误日志\n\nCompleted Internet Explorer Zonemapping Extension Processing in 343 milliseconds.\n\n![EventID-7016](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg)\n\n我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 **13**.\n\n现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志\n\nWindows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 [KB221833](http://support.microsoft.com/kb/221833 \"How to enable user environment debug logging in retail builds of Windows\")\n\n1.  在 %windir%\\debug\\下面创建 usermode 目录\n2.  打开注册表编辑器，找到\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion**\n3.  新建Key键值  Diagnostics\n4.  在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)\n5.  退出注册表编辑器\n6.  在命令行下再运行 gpupdate /force\n7.  在 %windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件\n打开 gpsvc.log 文件，查找 **ProcessGPOList: Extension Internet Explorer Zonemapping returned**\n\n你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned **<span style=\"color: #ff0000\">0xd</span>**\n\n**<span style=\"color: #ff0000\">0xd</span>** 这个错误代码换算成10进制就是上面日志中的 **ErrorCode: 13** 啦。\n\n接下来我们用 [Err.exe ](http://www.microsoft.com/en-us/download/details.aspx?id=985 \"Microsoft Exchange Server Error Code Look-up\")来看看查找结果：\n```\nERROR_INVALID_DATA winerror.h\n# The data is invalid.\n```\n果然，在查找到的29条符合的纪录中有一条是  The data is invalid\n\n那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 **RSOP.msc** 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：\n\n<span style=\"color: #ff0000\">**  网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。**</span>\n![GPO-IE-Zone-Assignments](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg)\n将这些缺少 Zone value 的条目一一更新之后，`gpupdate /force` 恢复正常！\n\n补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\">**Event ID: 1085** </span>的类似错误，处理方法和 Event ID:7106 的一样。\n\n**另外，还有可能的错误是站点名字使用诸如 192.168.\\* 或者 \\*.123.\\* 之类 \\* 号使用不当，也会导致报错。**\n","source":"_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016.md","raw":"---\ntitle: 'Internet Explorer Zonemapping failed due to the data is invalid (event ID: 7016)'\ntags:\n  - Event ID\n  - Group Policy\n  - Internet Explorer\n  - Zonemapping\ncategories:\n  - Microsoft\ndate: 2013-03-11 15:53:58\n---\n\n今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：\n```msdos\nC:\\Users\\user>gpupdate /force Updating Policy...\n\nUser Policy update has completed successfully.\n\nThe following warnings were encountered during user policy processing:\n\nWindows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the \"More information\" link. Computer Policy update has completed successfully.\n\nFor more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.\n```\n运行 `gpresult /h gpreport.html`，打开这个html文件一看\n![GPReport](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg)\nInternet Explorer Zonemapping failed due to the error listed below.\nThe data is invalid.\n\n再来看看事件查看器中有没有相关日志，还真找到一条 Event ID:7016 的错误日志\n\nCompleted Internet Explorer Zonemapping Extension Processing in 343 milliseconds.\n\n![EventID-7016](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg)\n\n我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 **13**.\n\n现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志\n\nWindows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 [KB221833](http://support.microsoft.com/kb/221833 \"How to enable user environment debug logging in retail builds of Windows\")\n\n1.  在 %windir%\\debug\\下面创建 usermode 目录\n2.  打开注册表编辑器，找到\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion**\n3.  新建Key键值  Diagnostics\n4.  在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)\n5.  退出注册表编辑器\n6.  在命令行下再运行 gpupdate /force\n7.  在 %windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件\n打开 gpsvc.log 文件，查找 **ProcessGPOList: Extension Internet Explorer Zonemapping returned**\n\n你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned **<span style=\"color: #ff0000\">0xd</span>**\n\n**<span style=\"color: #ff0000\">0xd</span>** 这个错误代码换算成10进制就是上面日志中的 **ErrorCode: 13** 啦。\n\n接下来我们用 [Err.exe ](http://www.microsoft.com/en-us/download/details.aspx?id=985 \"Microsoft Exchange Server Error Code Look-up\")来看看查找结果：\n```\nERROR_INVALID_DATA winerror.h\n# The data is invalid.\n```\n果然，在查找到的29条符合的纪录中有一条是  The data is invalid\n\n那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 **RSOP.msc** 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：\n\n<span style=\"color: #ff0000\">**  网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。**</span>\n![GPO-IE-Zone-Assignments](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg)\n将这些缺少 Zone value 的条目一一更新之后，`gpupdate /force` 恢复正常！\n\n补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\">**Event ID: 1085** </span>的类似错误，处理方法和 Event ID:7106 的一样。\n\n**另外，还有可能的错误是站点名字使用诸如 192.168.\\* 或者 \\*.123.\\* 之类 \\* 号使用不当，也会导致报错。**\n","slug":"internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016","published":1,"updated":"2020-01-05T09:00:54.005Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuf0053k84se7sc2qj9","content":"<html><head></head><body><p>今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\user&gt;gpupdate /force Updating Policy...</span><br><span class=\"line\"></span><br><span class=\"line\">User Policy update has completed successfully.</span><br><span class=\"line\"></span><br><span class=\"line\">The following warnings were encountered during user policy processing:</span><br><span class=\"line\"></span><br><span class=\"line\">Windows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the \"More information\" link. Computer Policy update has completed successfully.</span><br><span class=\"line\"></span><br><span class=\"line\">For more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.</span><br></pre></td></tr></tbody></table></figure>\n<p>运行 <code>gpresult /h gpreport.html</code>，打开这个html文件一看<br><img src=\"/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg\" alt=\"GPReport\"><br>Internet Explorer Zonemapping failed due to the error listed below.<br>The data is invalid.</p>\n<p>再来看看事件查看器中有没有相关日志，还真找到一条&nbsp;Event ID:7016 的错误日志</p>\n<p>Completed Internet Explorer Zonemapping Extension Processing in 343 milliseconds.</p>\n<p><img src=\"/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg\" alt=\"EventID-7016\"></p>\n<p>我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 <strong>13</strong>.</p>\n<p>现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志</p>\n<p>Windows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 <a href=\"http://support.microsoft.com/kb/221833\" title=\"How to enable user environment debug logging in retail builds of Windows\">KB221833</a></p>\n<ol>\n<li>在 %windir%\\debug\\下面创建 usermode 目录</li>\n<li>打开注册表编辑器，找到</li>\n</ol>\n<p><strong>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion</strong><br>3.  新建Key键值&nbsp; Diagnostics<br>4.  在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)<br>5.  退出注册表编辑器<br>6.  在命令行下再运行 gpupdate /force<br>7.  在&nbsp;%windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件<br>打开 gpsvc.log 文件，查找 <strong>ProcessGPOList: Extension Internet Explorer Zonemapping returned</strong></p>\n<p>你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned <strong><span style=\"color: #ff0000\">0xd</span></strong></p>\n<p><strong><span style=\"color: #ff0000\">0xd</span></strong> 这个错误代码换算成10进制就是上面日志中的 <strong>ErrorCode:&nbsp;13</strong> 啦。</p>\n<p>接下来我们用 <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=985\" title=\"Microsoft Exchange Server Error Code Look-up\">Err.exe </a>来看看查找结果：</p>\n<figure class=\"highlight nginx\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">ERROR_INVALID_DATA</span> winerror.h</span><br><span class=\"line\"><span class=\"comment\"># The data is invalid.</span></span><br></pre></td></tr></tbody></table></figure>\n<p>果然，在查找到的29条符合的纪录中有一条是&nbsp; The data is invalid</p>\n<p>那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 <strong>RSOP.msc</strong> 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：</p>\n<p><span style=\"color: #ff0000\">**&nbsp; 网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。**</span><br><img src=\"/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg\" alt=\"GPO-IE-Zone-Assignments\"><br>将这些缺少 Zone value 的条目一一更新之后，<code>gpupdate /force</code> 恢复正常！</p>\n<p>补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\"><strong>Event ID: 1085</strong> </span>的类似错误，处理方法和 Event ID:7106 的一样。</p>\n<p><strong>另外，还有可能的错误是站点名字使用诸如 192.168.* 或者 *.123.* 之类 * 号使用不当，也会导致报错。</strong></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Users\\user&gt;gpupdate /force Updating Policy...</span><br><span class=\"line\"></span><br><span class=\"line\">User Policy update has completed successfully.</span><br><span class=\"line\"></span><br><span class=\"line\">The following warnings were encountered during user policy processing:</span><br><span class=\"line\"></span><br><span class=\"line\">Windows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the \"More information\" link. Computer Policy update has completed successfully.</span><br><span class=\"line\"></span><br><span class=\"line\">For more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.</span><br></pre></td></tr></tbody></table></figure>\n<p>运行 <code>gpresult /h gpreport.html</code>，打开这个html文件一看<br><img src=\"/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg\" alt=\"GPReport\"><br>Internet Explorer Zonemapping failed due to the error listed below.<br>The data is invalid.</p>\n<p>再来看看事件查看器中有没有相关日志，还真找到一条&nbsp;Event ID:7016 的错误日志</p>\n<p>Completed Internet Explorer Zonemapping Extension Processing in 343 milliseconds.</p>\n<p><img src=\"/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg\" alt=\"EventID-7016\"></p>\n<p>我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 <strong>13</strong>.</p>\n<p>现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志</p>\n<p>Windows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 <a href=\"http://support.microsoft.com/kb/221833\" title=\"How to enable user environment debug logging in retail builds of Windows\">KB221833</a></p>\n<ol>\n<li>在 %windir%\\debug\\下面创建 usermode 目录</li>\n<li>打开注册表编辑器，找到</li>\n</ol>\n<p><strong>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion</strong><br>3.  新建Key键值&nbsp; Diagnostics<br>4.  在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)<br>5.  退出注册表编辑器<br>6.  在命令行下再运行 gpupdate /force<br>7.  在&nbsp;%windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件<br>打开 gpsvc.log 文件，查找 <strong>ProcessGPOList: Extension Internet Explorer Zonemapping returned</strong></p>\n<p>你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned <strong><span style=\"color: #ff0000\">0xd</span></strong></p>\n<p><strong><span style=\"color: #ff0000\">0xd</span></strong> 这个错误代码换算成10进制就是上面日志中的 <strong>ErrorCode:&nbsp;13</strong> 啦。</p>\n<p>接下来我们用 <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=985\" title=\"Microsoft Exchange Server Error Code Look-up\">Err.exe </a>来看看查找结果：</p>\n<figure class=\"highlight nginx\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">ERROR_INVALID_DATA</span> winerror.h</span><br><span class=\"line\"><span class=\"comment\"># The data is invalid.</span></span><br></pre></td></tr></tbody></table></figure>\n<p>果然，在查找到的29条符合的纪录中有一条是&nbsp; The data is invalid</p>\n<p>那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 <strong>RSOP.msc</strong> 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：</p>\n<p><span style=\"color: #ff0000\">**&nbsp; 网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。**</span><br><img src=\"/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg\" alt=\"GPO-IE-Zone-Assignments\"><br>将这些缺少 Zone value 的条目一一更新之后，<code>gpupdate /force</code> 恢复正常！</p>\n<p>补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\"><strong>Event ID: 1085</strong> </span>的类似错误，处理方法和 Event ID:7106 的一样。</p>\n<p><strong>另外，还有可能的错误是站点名字使用诸如 192.168.* 或者 *.123.* 之类 * 号使用不当，也会导致报错。</strong></p>\n</body></html>"},{"title":"KB289949 - Items that you place in Outlook Today seem to be lost","date":"2014-02-13T02:55:56.000Z","_content":"\n[KB289949 - Items that you place in Outlook Today seem to be lost](http://support.microsoft.com/kb/289949 \"Items that you place in Outlook Today seem to be lost\")\n\n不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？\n\n你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 username@mail.com 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：\n\n![Outlook_Today](kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg)\n\n&nbsp;\n\n那么，我的邮件去哪儿了呢？\n\n其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。\n\n![Outlook_Today_HomePage](kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg)","source":"_posts/kb289949-items-place-outlook-today-seem-lost.md","raw":"---\ntitle: KB289949 - Items that you place in Outlook Today seem to be lost\ntags:\n  - Exchange\n  - Outlook\ncategories:\n  - Microsoft\n  - Office\ndate: 2014-02-13 10:55:56\n---\n\n[KB289949 - Items that you place in Outlook Today seem to be lost](http://support.microsoft.com/kb/289949 \"Items that you place in Outlook Today seem to be lost\")\n\n不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？\n\n你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 username@mail.com 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：\n\n![Outlook_Today](kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg)\n\n&nbsp;\n\n那么，我的邮件去哪儿了呢？\n\n其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。\n\n![Outlook_Today_HomePage](kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg)","slug":"kb289949-items-place-outlook-today-seem-lost","published":1,"updated":"2020-01-05T09:00:54.006Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kug0056k84s1v1z4iiy","content":"<html><head></head><body><p><a href=\"http://support.microsoft.com/kb/289949\" title=\"Items that you place in Outlook Today seem to be lost\">KB289949 - Items that you place in Outlook Today seem to be lost</a></p>\n<p>不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？</p>\n<p>你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 <a href=\"mailto:username@mail.com\">username@mail.com</a> 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：</p>\n<p><img src=\"/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg\" alt=\"Outlook_Today\"></p>\n<p>&amp;nbsp;</p>\n<p>那么，我的邮件去哪儿了呢？</p>\n<p>其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。</p>\n<p><img src=\"/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg\" alt=\"Outlook_Today_HomePage\"></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p><a href=\"http://support.microsoft.com/kb/289949\" title=\"Items that you place in Outlook Today seem to be lost\">KB289949 - Items that you place in Outlook Today seem to be lost</a></p>\n<p>不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？</p>\n<p>你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 <a href=\"mailto:username@mail.com\">username@mail.com</a> 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：</p>\n<p><img src=\"/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg\" alt=\"Outlook_Today\"></p>\n<p>&amp;nbsp;</p>\n<p>那么，我的邮件去哪儿了呢？</p>\n<p>其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。</p>\n<p><img src=\"/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg\" alt=\"Outlook_Today_HomePage\"></p>\n</body></html>"},{"title":"KB974571 Crypto-API Update may break Office Communications Server 2007 R2 installations","date":"2009-10-15T04:15:20.000Z","_content":"\nSecurity updates are important. And as we're currently an evaluation setup for OCS 2007 R2, i've decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.\n\nBelow are error message from event log:\n> Event source: OCS Server\n> Event id: 12290\n> Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.\n\ncheck this [article](http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx)\nUninstall KB [974571 ](http://support.microsoft.com/kb/974571/ \"http://support.microsoft.com/kb/974571/\")and OCS works again.","source":"_posts/kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations.md","raw":"---\ntitle: KB974571 Crypto-API Update may break Office Communications Server 2007 R2 installations\ntags:\n  - Communicator\ncategories:\n  - 沟通协作\ndate: 2009-10-15 12:15:20\n---\n\nSecurity updates are important. And as we're currently an evaluation setup for OCS 2007 R2, i've decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.\n\nBelow are error message from event log:\n> Event source: OCS Server\n> Event id: 12290\n> Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.\n\ncheck this [article](http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx)\nUninstall KB [974571 ](http://support.microsoft.com/kb/974571/ \"http://support.microsoft.com/kb/974571/\")and OCS works again.","slug":"kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations","published":1,"updated":"2020-01-05T09:00:54.007Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kug005ak84sh03o4k69","content":"<html><head></head><body><p>Security updates are important. And as we’re currently an evaluation setup for OCS 2007 R2, i’ve decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.</p>\n<p>Below are error message from event log:</p>\n<blockquote>\n<p>Event source: OCS Server<br>Event id: 12290<br>Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.</p>\n</blockquote>\n<p>check this&nbsp;<a href=\"http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx\">article</a><br>Uninstall KB&nbsp;<a href=\"http://support.microsoft.com/kb/974571/\" title=\"http://support.microsoft.com/kb/974571/\">974571&nbsp;</a>and OCS works again.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Security updates are important. And as we’re currently an evaluation setup for OCS 2007 R2, i’ve decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.</p>\n<p>Below are error message from event log:</p>\n<blockquote>\n<p>Event source: OCS Server<br>Event id: 12290<br>Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.</p>\n</blockquote>\n<p>check this&nbsp;<a href=\"http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx\">article</a><br>Uninstall KB&nbsp;<a href=\"http://support.microsoft.com/kb/974571/\" title=\"http://support.microsoft.com/kb/974571/\">974571&nbsp;</a>and OCS works again.</p>\n</body></html>"},{"title":"Lync Server 2010 发布架构报错","date":"2010-12-24T02:36:47.000Z","_content":"昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:\n```\nScript result: ERROR_VALIDATE_BAD_SQL_VERSION\n\nError: Script failed (code \"ERROR_VALIDATE_BAD_SQL_VERSION\") when installing \"CentralMgmtStore\" on \"LyncServer01.mail2any.local\". For details, see the following log file: \"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"\n\nError: An error occurred: \"Microsoft.Rtc.Common.Data.SqlConnectionException\" \"Cannot open database \"xds\" requested by the login. The login failed.\n\nLogin failed for user 'Mail2Any\\Administrator'.\"\n```\n看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:\n* Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3\n* Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1\n* Standard or Enterprise Edition of SQL Server 2008 R2","source":"_posts/lync-server-2010-publish-topology-error.md","raw":"---\ntitle: Lync Server 2010 发布架构报错\ntags:\n  - Lync\n  - OCS\n  - MSSQL\ncategories:\n  - 沟通协作\ndate: 2010-12-24 10:36:47\n---\n昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:\n```\nScript result: ERROR_VALIDATE_BAD_SQL_VERSION\n\nError: Script failed (code \"ERROR_VALIDATE_BAD_SQL_VERSION\") when installing \"CentralMgmtStore\" on \"LyncServer01.mail2any.local\". For details, see the following log file: \"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"\n\nError: An error occurred: \"Microsoft.Rtc.Common.Data.SqlConnectionException\" \"Cannot open database \"xds\" requested by the login. The login failed.\n\nLogin failed for user 'Mail2Any\\Administrator'.\"\n```\n看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:\n* Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3\n* Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1\n* Standard or Enterprise Edition of SQL Server 2008 R2","slug":"lync-server-2010-publish-topology-error","published":1,"updated":"2020-01-05T09:00:54.007Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuh005ek84s7gxg8icl","content":"<html><head></head><body><p>昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:</p>\n<figure class=\"highlight subunit\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Script result: ERROR_VALIDATE_BAD_SQL_VERSION</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Error: </span>Script failed (code \"ERROR_VALIDATE_BAD_SQL_VERSION\") when installing \"CentralMgmtStore\" on \"LyncServer01.mail2any.local\". For details, see the following log file: \"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Error: </span>An error occurred: \"Microsoft.Rtc.Common.Data.SqlConnectionException\" \"Cannot open database \"xds\" requested by the login. The login failed.</span><br><span class=\"line\"></span><br><span class=\"line\">Login failed for user 'Mail2Any\\Administrator'.\"</span><br></pre></td></tr></tbody></table></figure>\n<p>看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:</p>\n<ul>\n<li>Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 R2</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:</p>\n<figure class=\"highlight subunit\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Script result: ERROR_VALIDATE_BAD_SQL_VERSION</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Error: </span>Script failed (code \"ERROR_VALIDATE_BAD_SQL_VERSION\") when installing \"CentralMgmtStore\" on \"LyncServer01.mail2any.local\". For details, see the following log file: \"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Error: </span>An error occurred: \"Microsoft.Rtc.Common.Data.SqlConnectionException\" \"Cannot open database \"xds\" requested by the login. The login failed.</span><br><span class=\"line\"></span><br><span class=\"line\">Login failed for user 'Mail2Any\\Administrator'.\"</span><br></pre></td></tr></tbody></table></figure>\n<p>看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:</p>\n<ul>\n<li>Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 R2</li>\n</ul>\n</body></html>"},{"title":"VMWare vCenter 4.x 数据库由SQL Express 迁移至SQL Server 2008 R2","date":"2013-11-28T08:38:52.000Z","_content":"\n默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：\n\n1. 停止 VirtualCenter Server service服务，4.x 的服务名是 VMware VirtualCenter Server。\n2. 对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。\n3. 停止现有 SQL Express 的 SQL 服务。\n4. 在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选 Overwrite existing database with replace 选项以保证完全覆盖还原。\n5. 在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。\n6. 修改 vCenter 服务器上面的 System DSN，默认名称是 VMware VirtualCenter，将其连接改至新服务器。\n7. 修改 vCenter 的注册表,\n    1. **HKEY_LOCAL_MACHINE > SOFTWARE > VMware Inc, VMware VirtualCenter > DB**\n    2.  确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter\n    3.  确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User\n8. 更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3\n```msdos\nC:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p\n```\n9. 重建 rollup jobs。参考 http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\n10. 重启 vCenter 服务全文参考 [VMWare KB - Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)](http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579)","source":"_posts/migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2.md","raw":"---\ntitle: VMWare vCenter 4.x 数据库由SQL Express 迁移至SQL Server 2008 R2\ntags:\n  - MSSQL\n  - VMware\ncategories:\n  - 虚拟化\ndate: 2013-11-28 16:38:52\n---\n\n默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：\n\n1. 停止 VirtualCenter Server service服务，4.x 的服务名是 VMware VirtualCenter Server。\n2. 对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。\n3. 停止现有 SQL Express 的 SQL 服务。\n4. 在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选 Overwrite existing database with replace 选项以保证完全覆盖还原。\n5. 在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。\n6. 修改 vCenter 服务器上面的 System DSN，默认名称是 VMware VirtualCenter，将其连接改至新服务器。\n7. 修改 vCenter 的注册表,\n    1. **HKEY_LOCAL_MACHINE > SOFTWARE > VMware Inc, VMware VirtualCenter > DB**\n    2.  确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter\n    3.  确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User\n8. 更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3\n```msdos\nC:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p\n```\n9. 重建 rollup jobs。参考 http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\n10. 重启 vCenter 服务全文参考 [VMWare KB - Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)](http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579)","slug":"migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2","published":1,"updated":"2020-01-05T09:00:54.008Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kui005ik84s7u7l50ya","content":"<html><head></head><body><p>默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：</p>\n<ol>\n<li>停止 VirtualCenter Server service服务，4.x 的服务名是&nbsp;VMware VirtualCenter Server。</li>\n<li>对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。</li>\n<li>停止现有 SQL Express 的 SQL 服务。</li>\n<li>在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选&nbsp;Overwrite existing database with replace 选项以保证完全覆盖还原。</li>\n<li>在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。</li>\n<li>修改 vCenter 服务器上面的 System DSN，默认名称是&nbsp;VMware VirtualCenter，将其连接改至新服务器。</li>\n<li>修改 vCenter 的注册表,<ol>\n<li><strong>HKEY_LOCAL_MACHINE&nbsp;&gt;&nbsp;SOFTWARE&nbsp;&gt;&nbsp;VMware Inc, VMware VirtualCenter&nbsp;&gt;&nbsp;DB</strong></li>\n<li>确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter</li>\n<li>确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User</li>\n</ol>\n</li>\n<li>更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p</span><br></pre></td></tr></tbody></table></figure></li>\n<li>重建&nbsp;rollup jobs。参考&nbsp;<a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\">http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824</a></li>\n<li>重启 vCenter 服务全文参考 <a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579\">VMWare KB -&nbsp;Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)</a></li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：</p>\n<ol>\n<li>停止 VirtualCenter Server service服务，4.x 的服务名是&nbsp;VMware VirtualCenter Server。</li>\n<li>对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。</li>\n<li>停止现有 SQL Express 的 SQL 服务。</li>\n<li>在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选&nbsp;Overwrite existing database with replace 选项以保证完全覆盖还原。</li>\n<li>在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。</li>\n<li>修改 vCenter 服务器上面的 System DSN，默认名称是&nbsp;VMware VirtualCenter，将其连接改至新服务器。</li>\n<li>修改 vCenter 的注册表,<ol>\n<li><strong>HKEY_LOCAL_MACHINE&nbsp;&gt;&nbsp;SOFTWARE&nbsp;&gt;&nbsp;VMware Inc, VMware VirtualCenter&nbsp;&gt;&nbsp;DB</strong></li>\n<li>确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter</li>\n<li>确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User</li>\n</ol>\n</li>\n<li>更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p</span><br></pre></td></tr></tbody></table></figure></li>\n<li>重建&nbsp;rollup jobs。参考&nbsp;<a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\">http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824</a></li>\n<li>重启 vCenter 服务全文参考 <a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579\">VMWare KB -&nbsp;Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)</a></li>\n</ol>\n</body></html>"},{"title":"开新站，并迁移至 WordPress","date":"2013-01-22T17:48:36.000Z","_content":"\n伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 [www.powerk6.org](http://www.powerk6.org \"MT旧站 www.powerk6.org\") 上的部分内容迁移到了这个新站 [winotes.net](http://winotes.net \"新站 winotes.net\")，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。\n\n原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。","source":"_posts/movabletype-2-wordpress.md","raw":"---\ntitle: 开新站，并迁移至 WordPress\ntags:\n  - Movable Type\n  - WordPress\ncategories:\n  - 网站相关\ndate: 2013-01-23 01:48:36\n---\n\n伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 [www.powerk6.org](http://www.powerk6.org \"MT旧站 www.powerk6.org\") 上的部分内容迁移到了这个新站 [winotes.net](http://winotes.net \"新站 winotes.net\")，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。\n\n原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。","slug":"movabletype-2-wordpress","published":1,"updated":"2020-01-05T09:00:54.008Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kui005mk84s6sl92ifz","content":"<html><head></head><body><p>伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 <a href=\"http://www.powerk6.org/\" title=\"MT旧站 www.powerk6.org\">www.powerk6.org</a> 上的部分内容迁移到了这个新站 <a href=\"http://winotes.net/\" title=\"新站 winotes.net\">winotes.net</a>，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。</p>\n<p>原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 <a href=\"http://www.powerk6.org/\" title=\"MT旧站 www.powerk6.org\">www.powerk6.org</a> 上的部分内容迁移到了这个新站 <a href=\"http://winotes.net/\" title=\"新站 winotes.net\">winotes.net</a>，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。</p>\n<p>原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。</p>\n</body></html>"},{"title":"本站博客迁移至 Hexo","date":"2017-06-10T06:40:11.000Z","keywords":null,"description":null,"_content":"\n在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 **GitHub Pages**，继续使用 http://winotes.net 来提供服务。\n\n由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。\n\nWordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。\n","source":"_posts/move-to-hexo.md","raw":"---\ntitle: 本站博客迁移至 Hexo\ntags:\n  - WordPress\n  - Hexo\n  - GitHub\ncategories:\n  - 网站相关\ndate: 2017-06-10 14:40:11\nkeywords:\ndescription:\n---\n\n在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 **GitHub Pages**，继续使用 http://winotes.net 来提供服务。\n\n由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。\n\nWordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。\n","slug":"move-to-hexo","published":1,"updated":"2020-01-05T09:00:54.008Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuj005qk84s6ug17xsr","content":"<html><head></head><body><p>在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 <strong>GitHub Pages</strong>，继续使用 <a href=\"http://winotes.net/\">http://winotes.net</a> 来提供服务。</p>\n<p>由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。</p>\n<p>WordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 <strong>GitHub Pages</strong>，继续使用 <a href=\"http://winotes.net/\">http://winotes.net</a> 来提供服务。</p>\n<p>由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。</p>\n<p>WordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。</p>\n</body></html>"},{"title":"MPF Service Account Error in Deployment Tools","date":"2008-05-18T03:37:03.000Z","_content":"\n如果你在部署 MPS 的时候遇到类似以下问题:\n\n>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed\nHResult: -2146233088\nMessage: Deployment interrupted because of a failure. See inner exception.\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()\nat Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() </br>\nInner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException\nHResult: -2146233088\nMessage: \n```xml\n<errorContext description=\"The network path was not found\" code=\"0x80070035\" executeSeqNo=\"27\">\n<errorSource namespace=\"Computer Management Provider\" procedure=\"Group IsMember\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"TryLocalGroupAdd_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"AddMPFConfigAdmin_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"ConfigureMPFServiceAccounts\" /></errorContext>\n```\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()\nat Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()\n\n是可以手动解决的，方法如下： \n\nPart of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value \"Configuration Server\" and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:\n\n1. Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.\n2. Add MPFServiceAccts group to the \"Windows-based Hosting Service Accounts\" group in Active Directory.\n3. In the MPS Deployment Tool, right-click \"Configure MPF Service Account\" and choose \"Force State.\" Choose the VerifiedGood state and click OK.\n\nYou should then be able to continue with your deployment.","source":"_posts/mpf-service-account-error-in-deployment-tools.md","raw":"---\ntitle: MPF Service Account Error in Deployment Tools\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-05-18 11:37:03\n---\n\n如果你在部署 MPS 的时候遇到类似以下问题:\n\n>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed\nHResult: -2146233088\nMessage: Deployment interrupted because of a failure. See inner exception.\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()\nat Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() </br>\nInner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException\nHResult: -2146233088\nMessage: \n```xml\n<errorContext description=\"The network path was not found\" code=\"0x80070035\" executeSeqNo=\"27\">\n<errorSource namespace=\"Computer Management Provider\" procedure=\"Group IsMember\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"TryLocalGroupAdd_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"AddMPFConfigAdmin_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"ConfigureMPFServiceAccounts\" /></errorContext>\n```\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()\nat Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()\n\n是可以手动解决的，方法如下： \n\nPart of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value \"Configuration Server\" and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:\n\n1. Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.\n2. Add MPFServiceAccts group to the \"Windows-based Hosting Service Accounts\" group in Active Directory.\n3. In the MPS Deployment Tool, right-click \"Configure MPF Service Account\" and choose \"Force State.\" Choose the VerifiedGood state and click OK.\n\nYou should then be able to continue with your deployment.","slug":"mpf-service-account-error-in-deployment-tools","published":1,"updated":"2020-01-05T09:00:54.008Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuk005tk84s3a409689","content":"<html><head></head><body><p>如果你在部署 MPS 的时候遇到类似以下问题:</p>\n<blockquote>\n<p>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed<br>HResult: -2146233088<br>Message: Deployment interrupted because of a failure. See inner exception.<br>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()<br>at Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() <br><br>Inner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException<br>HResult: -2146233088<br>Message: </p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorContext</span> <span class=\"attr\">description</span>=<span class=\"string\">\"The network path was not found\"</span> <span class=\"attr\">code</span>=<span class=\"string\">\"0x80070035\"</span> <span class=\"attr\">executeSeqNo</span>=<span class=\"string\">\"27\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Computer Management Provider\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"Group IsMember\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"TryLocalGroupAdd_\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"AddMPFConfigAdmin_\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ConfigureMPFServiceAccounts\"</span> /&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">errorContext</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()<br>at Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()</p>\n<p>是可以手动解决的，方法如下： </p>\n<p>Part of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value “Configuration Server” and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:</p>\n<ol>\n<li>Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.</li>\n</ol>\n<p>2.&nbsp;Add MPFServiceAccts group to the “Windows-based Hosting Service Accounts” group in Active Directory.<br>3.&nbsp;In the MPS Deployment Tool, right-click “Configure MPF Service Account” and choose “Force State.” Choose the VerifiedGood state and click OK.</p>\n<p>You should then be able to continue with your deployment.</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>如果你在部署 MPS 的时候遇到类似以下问题:</p>\n<blockquote>\n<p>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed<br>HResult: -2146233088<br>Message: Deployment interrupted because of a failure. See inner exception.<br>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()<br>at Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() <br><br>Inner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException<br>HResult: -2146233088<br>Message: </p>\n</blockquote>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorContext</span> <span class=\"attr\">description</span>=<span class=\"string\">\"The network path was not found\"</span> <span class=\"attr\">code</span>=<span class=\"string\">\"0x80070035\"</span> <span class=\"attr\">executeSeqNo</span>=<span class=\"string\">\"27\"</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Computer Management Provider\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"Group IsMember\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"TryLocalGroupAdd_\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"AddMPFConfigAdmin_\"</span> /&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ConfigureMPFServiceAccounts\"</span> /&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">errorContext</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()<br>at Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()</p>\n<p>是可以手动解决的，方法如下： </p>\n<p>Part of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value “Configuration Server” and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:</p>\n<ol>\n<li>Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.</li>\n</ol>\n<p>2.&nbsp;Add MPFServiceAccts group to the “Windows-based Hosting Service Accounts” group in Active Directory.<br>3.&nbsp;In the MPS Deployment Tool, right-click “Configure MPF Service Account” and choose “Force State.” Choose the VerifiedGood state and click OK.</p>\n<p>You should then be able to continue with your deployment.</p>\n</body></html>"},{"title":"MSCRM 4.0 Email Router - 404 not Found","date":"2009-08-20T07:19:02.000Z","_content":"\nHere is a good article regarding to CRM 4.0 Email Router issues:\n\n[http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx](http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx)\n\nBut what I encounterd is not listed.\n\n**If you have an error type HTTP 404 (Not Found)**\n\nThe E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url 'http://servername:5555/orgname'  is correct. The request failed with HTTP status 404:**Not Found**.\"\n\nWorkaround:\n\nCheck your CRM deployment properties, make sure these 2 record are not \"LocalHost\", better use its netbios servername, ip address or FQDN.\n\n**AD App Root Domain, ****AD SDK Root Domain**\n\nHow to check:\n```sql\nSELECT Id, ColumnName, NvarCharColumn From DeploymentProperties\nWHERE ColumnName IN ('ADSdkRootDomain','ADWebApplicationRootDomain')\n```\nPost tasks:\n\n1. Restart IIS.\n\n2. Restart Microsoft Dynamics CRM Asynchronous Processing Services.","source":"_posts/mscrm-40-email-router-404-notfound.md","raw":"---\ntitle: MSCRM 4.0 Email Router - 404 not Found\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2009-08-20 15:19:02\n---\n\nHere is a good article regarding to CRM 4.0 Email Router issues:\n\n[http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx](http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx)\n\nBut what I encounterd is not listed.\n\n**If you have an error type HTTP 404 (Not Found)**\n\nThe E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url 'http://servername:5555/orgname'  is correct. The request failed with HTTP status 404:**Not Found**.\"\n\nWorkaround:\n\nCheck your CRM deployment properties, make sure these 2 record are not \"LocalHost\", better use its netbios servername, ip address or FQDN.\n\n**AD App Root Domain, ****AD SDK Root Domain**\n\nHow to check:\n```sql\nSELECT Id, ColumnName, NvarCharColumn From DeploymentProperties\nWHERE ColumnName IN ('ADSdkRootDomain','ADWebApplicationRootDomain')\n```\nPost tasks:\n\n1. Restart IIS.\n\n2. Restart Microsoft Dynamics CRM Asynchronous Processing Services.","slug":"mscrm-40-email-router-404-notfound","published":1,"updated":"2020-01-05T09:00:54.019Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kul005yk84sbwhu1ptl","content":"<html><head></head><body><p>Here is a good article regarding to CRM 4.0 Email Router issues:</p>\n<p><a href=\"http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx\">http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx</a></p>\n<p>But what I encounterd is not listed.</p>\n<p><strong>If you have an error type HTTP 404 (Not Found)</strong></p>\n<p>The E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url ‘<a href=\"http://servername:5555/orgname'\">http://servername:5555/orgname'</a>&nbsp; is correct. The request failed with HTTP status 404:<strong>Not Found</strong>.”</p>\n<p>Workaround:</p>\n<p>Check your CRM deployment properties, make sure these 2 record are not “LocalHost”, better use its netbios servername, ip address or FQDN.</p>\n<p>**AD App Root Domain,&nbsp;**<strong>AD SDK Root Domain</strong></p>\n<p>How to check:</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Id, ColumnName, NvarCharColumn <span class=\"keyword\">From</span> DeploymentProperties</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> ColumnName <span class=\"keyword\">IN</span> (<span class=\"string\">'ADSdkRootDomain'</span>,<span class=\"string\">'ADWebApplicationRootDomain'</span>)</span><br></pre></td></tr></tbody></table></figure>\n<p>Post tasks:</p>\n<ol>\n<li><p>Restart IIS.</p>\n</li>\n<li><p>Restart Microsoft Dynamics CRM Asynchronous Processing Services.</p>\n</li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Here is a good article regarding to CRM 4.0 Email Router issues:</p>\n<p><a href=\"http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx\">http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx</a></p>\n<p>But what I encounterd is not listed.</p>\n<p><strong>If you have an error type HTTP 404 (Not Found)</strong></p>\n<p>The E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url ‘<a href=\"http://servername:5555/orgname'\">http://servername:5555/orgname'</a>&nbsp; is correct. The request failed with HTTP status 404:<strong>Not Found</strong>.”</p>\n<p>Workaround:</p>\n<p>Check your CRM deployment properties, make sure these 2 record are not “LocalHost”, better use its netbios servername, ip address or FQDN.</p>\n<p>**AD App Root Domain,&nbsp;**<strong>AD SDK Root Domain</strong></p>\n<p>How to check:</p>\n<figure class=\"highlight sql\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SELECT</span> Id, ColumnName, NvarCharColumn <span class=\"keyword\">From</span> DeploymentProperties</span><br><span class=\"line\"><span class=\"keyword\">WHERE</span> ColumnName <span class=\"keyword\">IN</span> (<span class=\"string\">'ADSdkRootDomain'</span>,<span class=\"string\">'ADWebApplicationRootDomain'</span>)</span><br></pre></td></tr></tbody></table></figure>\n<p>Post tasks:</p>\n<ol>\n<li><p>Restart IIS.</p>\n</li>\n<li><p>Restart Microsoft Dynamics CRM Asynchronous Processing Services.</p>\n</li>\n</ol>\n</body></html>"},{"title":"MSCRM Contacts and Accounts are not showing up in Outlook?","date":"2008-09-08T03:09:10.000Z","_content":"\nIn Outlook, go to **Tools**|**Address Book**.\n\nFrom the drop-down list, choose the \"**CRM Contacts**\" Address Book. Is it blank?\n\nIf so, there's an easy way to correct the problem.\n\n1. In Outlook, choose Options from the CRM Menu\n2. Click on the Address Book tab\n3. Select \"Match all contacts in Microsoft Dynamics CRM\" and \"Match all items in Microsoft Dynamics CRM\"\n4. Click OK\n5. Synchronize with CRM by choose \"Synchronize with CRM\" from the CRM menu\n6. Return to CRM Address book. You should now see entries there\nYou might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.","source":"_posts/mscrm-contacts-and-accounts-are-not-showing-up-in-outlook.md","raw":"---\ntitle: MSCRM Contacts and Accounts are not showing up in Outlook?\ntags:\n  - MSCRM\n  - Outlook\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2008-09-08 11:09:10\n---\n\nIn Outlook, go to **Tools**|**Address Book**.\n\nFrom the drop-down list, choose the \"**CRM Contacts**\" Address Book. Is it blank?\n\nIf so, there's an easy way to correct the problem.\n\n1. In Outlook, choose Options from the CRM Menu\n2. Click on the Address Book tab\n3. Select \"Match all contacts in Microsoft Dynamics CRM\" and \"Match all items in Microsoft Dynamics CRM\"\n4. Click OK\n5. Synchronize with CRM by choose \"Synchronize with CRM\" from the CRM menu\n6. Return to CRM Address book. You should now see entries there\nYou might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.","slug":"mscrm-contacts-and-accounts-are-not-showing-up-in-outlook","published":1,"updated":"2020-01-05T09:00:54.019Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kul0061k84s7znmbiyj","content":"<html><head></head><body><p>In Outlook, go to <strong>Tools</strong>|<strong>Address Book</strong>.</p>\n<p>From the drop-down list, choose the “<strong>CRM Contacts</strong>“ Address Book. Is it blank?</p>\n<p>If so, there’s an easy way to correct the problem.</p>\n<ol>\n<li>In Outlook, choose Options from the CRM Menu</li>\n<li>Click on the Address Book tab</li>\n<li>Select “Match all contacts in Microsoft Dynamics CRM” and “Match all items in Microsoft Dynamics CRM”</li>\n<li>Click OK</li>\n<li>Synchronize with CRM by choose “Synchronize with CRM” from the CRM menu</li>\n<li>Return to CRM Address book. You should now see entries there<br>You might need to synch several times before they all get there.&nbsp; This setting is not set by default in 4.0 for some reason.</li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>In Outlook, go to <strong>Tools</strong>|<strong>Address Book</strong>.</p>\n<p>From the drop-down list, choose the “<strong>CRM Contacts</strong>“ Address Book. Is it blank?</p>\n<p>If so, there’s an easy way to correct the problem.</p>\n<ol>\n<li>In Outlook, choose Options from the CRM Menu</li>\n<li>Click on the Address Book tab</li>\n<li>Select “Match all contacts in Microsoft Dynamics CRM” and “Match all items in Microsoft Dynamics CRM”</li>\n<li>Click OK</li>\n<li>Synchronize with CRM by choose “Synchronize with CRM” from the CRM menu</li>\n<li>Return to CRM Address book. You should now see entries there<br>You might need to synch several times before they all get there.&nbsp; This setting is not set by default in 4.0 for some reason.</li>\n</ol>\n</body></html>"},{"title":"微软 CRM 2011 Beta 快速安装图解","date":"2011-09-19T07:19:36.000Z","_content":"\n微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。\n\n下载：\n\n[Microsoft Dynamics CRM 2011 Beta](http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn)\n\n[Microsoft Dynamics CRM 2011 Software Development Kit (SDK)](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200082)\n\n[Microsoft Dynamics CRM 2011 Beta Implementation Guide](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200050)\n\n界面一览\n![CRM2011_20](mscrm-2011-beta-installation/CRM2011_20.jpg)\n1. 自动更新安装程序；\n![CRM2011_0](mscrm-2011-beta-installation/CRM2011_0.jpg)\n2. 输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；\n![CRM2011_1](mscrm-2011-beta-installation/CRM2011_1.jpg)\n3. 新的组件需求；\n![CRM2011_2](mscrm-2011-beta-installation/CRM2011_2.jpg)\n![CRM2011_3](mscrm-2011-beta-installation/CRM2011_3.jpg) ![CRM2011_4](mscrm-2011-beta-installation/CRM2011_4.jpg)\n4. 选择目录，继续；\n![CRM2011_5](mscrm-2011-beta-installation/CRM2011_5.jpg)\n5. 新的角色：前端、后端、部署管理；\n![CRM2011_6](mscrm-2011-beta-installation/CRM2011_6.jpg)\n6. 和 4.0 一样的选择 AD 用户和组创建位置；\n![CRM2011_7](mscrm-2011-beta-installation/CRM2011_7.jpg)\n![CRM2011_8](mscrm-2011-beta-installation/CRM2011_8.jpg) ![CRM2011_9](mscrm-2011-beta-installation/CRM2011_9.jpg) ![CRM2011_10](mscrm-2011-beta-installation/CRM2011_10.jpg) \n![CRM2011_11](mscrm-2011-beta-installation/CRM2011_11.jpg)\n7. 创建一个 CRM 组织；\n![CRM2011_12](mscrm-2011-beta-installation/CRM2011_12.jpg)\n8. 选择报表服务器；\n![CRM2011_13](mscrm-2011-beta-installation/CRM2011_13.jpg) \n![CRM2011_14](mscrm-2011-beta-installation/CRM2011_14.jpg) \n![CRM2011_15](mscrm-2011-beta-installation/CRM2011_15.jpg)\n9. 安装前需求全部满足，开始安装；\n![CRM2011_16](mscrm-2011-beta-installation/CRM2011_16.jpg) \n![CRM2011_17](mscrm-2011-beta-installation/CRM2011_17.jpg) \n![CRM2011_18](mscrm-2011-beta-installation/CRM2011_18.jpg)\n10. 如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；\n![CRM2011_19](mscrm-2011-beta-installation/CRM2011_19.jpg)","source":"_posts/mscrm-2011-beta-installation.md","raw":"---\ntitle: 微软 CRM 2011 Beta 快速安装图解\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2011-09-19 15:19:36\n---\n\n微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。\n\n下载：\n\n[Microsoft Dynamics CRM 2011 Beta](http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn)\n\n[Microsoft Dynamics CRM 2011 Software Development Kit (SDK)](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200082)\n\n[Microsoft Dynamics CRM 2011 Beta Implementation Guide](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200050)\n\n界面一览\n![CRM2011_20](mscrm-2011-beta-installation/CRM2011_20.jpg)\n1. 自动更新安装程序；\n![CRM2011_0](mscrm-2011-beta-installation/CRM2011_0.jpg)\n2. 输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；\n![CRM2011_1](mscrm-2011-beta-installation/CRM2011_1.jpg)\n3. 新的组件需求；\n![CRM2011_2](mscrm-2011-beta-installation/CRM2011_2.jpg)\n![CRM2011_3](mscrm-2011-beta-installation/CRM2011_3.jpg) ![CRM2011_4](mscrm-2011-beta-installation/CRM2011_4.jpg)\n4. 选择目录，继续；\n![CRM2011_5](mscrm-2011-beta-installation/CRM2011_5.jpg)\n5. 新的角色：前端、后端、部署管理；\n![CRM2011_6](mscrm-2011-beta-installation/CRM2011_6.jpg)\n6. 和 4.0 一样的选择 AD 用户和组创建位置；\n![CRM2011_7](mscrm-2011-beta-installation/CRM2011_7.jpg)\n![CRM2011_8](mscrm-2011-beta-installation/CRM2011_8.jpg) ![CRM2011_9](mscrm-2011-beta-installation/CRM2011_9.jpg) ![CRM2011_10](mscrm-2011-beta-installation/CRM2011_10.jpg) \n![CRM2011_11](mscrm-2011-beta-installation/CRM2011_11.jpg)\n7. 创建一个 CRM 组织；\n![CRM2011_12](mscrm-2011-beta-installation/CRM2011_12.jpg)\n8. 选择报表服务器；\n![CRM2011_13](mscrm-2011-beta-installation/CRM2011_13.jpg) \n![CRM2011_14](mscrm-2011-beta-installation/CRM2011_14.jpg) \n![CRM2011_15](mscrm-2011-beta-installation/CRM2011_15.jpg)\n9. 安装前需求全部满足，开始安装；\n![CRM2011_16](mscrm-2011-beta-installation/CRM2011_16.jpg) \n![CRM2011_17](mscrm-2011-beta-installation/CRM2011_17.jpg) \n![CRM2011_18](mscrm-2011-beta-installation/CRM2011_18.jpg)\n10. 如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；\n![CRM2011_19](mscrm-2011-beta-installation/CRM2011_19.jpg)","slug":"mscrm-2011-beta-installation","published":1,"updated":"2020-01-05T09:00:54.008Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kum0065k84sdqbibaez","content":"<html><head></head><body><p>微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。</p>\n<p>下载：</p>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn\">Microsoft Dynamics CRM 2011 Beta</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http://go.microsoft.com/fwlink/?LinkID=200082\">Microsoft Dynamics CRM 2011 Software Development Kit (SDK)</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http://go.microsoft.com/fwlink/?LinkID=200050\">Microsoft Dynamics CRM 2011 Beta Implementation Guide</a></p>\n<p>界面一览<br><img src=\"/mscrm-2011-beta-installation/CRM2011_20.jpg\" alt=\"CRM2011_20\"></p>\n<ol>\n<li>自动更新安装程序；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_0.jpg\" alt=\"CRM2011_0\"></li>\n<li>输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_1.jpg\" alt=\"CRM2011_1\"></li>\n<li>新的组件需求；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_2.jpg\" alt=\"CRM2011_2\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_3.jpg\" alt=\"CRM2011_3\"> <img src=\"/mscrm-2011-beta-installation/CRM2011_4.jpg\" alt=\"CRM2011_4\"></li>\n<li>选择目录，继续；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_5.jpg\" alt=\"CRM2011_5\"></li>\n<li>新的角色：前端、后端、部署管理；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_6.jpg\" alt=\"CRM2011_6\"></li>\n<li>和 4.0 一样的选择 AD 用户和组创建位置；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_7.jpg\" alt=\"CRM2011_7\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_8.jpg\" alt=\"CRM2011_8\"> <img src=\"/mscrm-2011-beta-installation/CRM2011_9.jpg\" alt=\"CRM2011_9\"> <img src=\"/mscrm-2011-beta-installation/CRM2011_10.jpg\" alt=\"CRM2011_10\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_11.jpg\" alt=\"CRM2011_11\"></li>\n<li>创建一个 CRM 组织；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_12.jpg\" alt=\"CRM2011_12\"></li>\n<li>选择报表服务器；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_13.jpg\" alt=\"CRM2011_13\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_14.jpg\" alt=\"CRM2011_14\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_15.jpg\" alt=\"CRM2011_15\"></li>\n<li>安装前需求全部满足，开始安装；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_16.jpg\" alt=\"CRM2011_16\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_17.jpg\" alt=\"CRM2011_17\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_18.jpg\" alt=\"CRM2011_18\"></li>\n<li>如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_19.jpg\" alt=\"CRM2011_19\"></li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。</p>\n<p>下载：</p>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn\">Microsoft Dynamics CRM 2011 Beta</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http://go.microsoft.com/fwlink/?LinkID=200082\">Microsoft Dynamics CRM 2011 Software Development Kit (SDK)</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http://go.microsoft.com/fwlink/?LinkID=200050\">Microsoft Dynamics CRM 2011 Beta Implementation Guide</a></p>\n<p>界面一览<br><img src=\"/mscrm-2011-beta-installation/CRM2011_20.jpg\" alt=\"CRM2011_20\"></p>\n<ol>\n<li>自动更新安装程序；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_0.jpg\" alt=\"CRM2011_0\"></li>\n<li>输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_1.jpg\" alt=\"CRM2011_1\"></li>\n<li>新的组件需求；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_2.jpg\" alt=\"CRM2011_2\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_3.jpg\" alt=\"CRM2011_3\"> <img src=\"/mscrm-2011-beta-installation/CRM2011_4.jpg\" alt=\"CRM2011_4\"></li>\n<li>选择目录，继续；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_5.jpg\" alt=\"CRM2011_5\"></li>\n<li>新的角色：前端、后端、部署管理；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_6.jpg\" alt=\"CRM2011_6\"></li>\n<li>和 4.0 一样的选择 AD 用户和组创建位置；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_7.jpg\" alt=\"CRM2011_7\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_8.jpg\" alt=\"CRM2011_8\"> <img src=\"/mscrm-2011-beta-installation/CRM2011_9.jpg\" alt=\"CRM2011_9\"> <img src=\"/mscrm-2011-beta-installation/CRM2011_10.jpg\" alt=\"CRM2011_10\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_11.jpg\" alt=\"CRM2011_11\"></li>\n<li>创建一个 CRM 组织；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_12.jpg\" alt=\"CRM2011_12\"></li>\n<li>选择报表服务器；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_13.jpg\" alt=\"CRM2011_13\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_14.jpg\" alt=\"CRM2011_14\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_15.jpg\" alt=\"CRM2011_15\"></li>\n<li>安装前需求全部满足，开始安装；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_16.jpg\" alt=\"CRM2011_16\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_17.jpg\" alt=\"CRM2011_17\"><br><img src=\"/mscrm-2011-beta-installation/CRM2011_18.jpg\" alt=\"CRM2011_18\"></li>\n<li>如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；<br><img src=\"/mscrm-2011-beta-installation/CRM2011_19.jpg\" alt=\"CRM2011_19\"></li>\n</ol>\n</body></html>"},{"title":"Multi-Tenancy and Hosting Guidance for Exchange Server 2010 SP2 is released!","date":"2011-12-14T08:06:29.000Z","_content":"\nA multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.\n\nThis document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.\n\nDownload Link: [http://www.microsoft.com/download/en/confirmation.aspx?id=28192](http://www.microsoft.com/download/en/confirmation.aspx?id=28192)\n","source":"_posts/multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released.md","raw":"---\ntitle: Multi-Tenancy and Hosting Guidance for Exchange Server 2010 SP2 is released!\ntags:\n  - Exchange\n  - Hosting\n  - MultiTenancy\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2011-12-14 16:06:29\n---\n\nA multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.\n\nThis document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.\n\nDownload Link: [http://www.microsoft.com/download/en/confirmation.aspx?id=28192](http://www.microsoft.com/download/en/confirmation.aspx?id=28192)\n","slug":"multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released","published":1,"updated":"2020-01-05T09:00:54.019Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kun0067k84sdcnx8lia","content":"<html><head></head><body><p>A multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.</p>\n<p>This document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.</p>\n<p>Download Link: <a href=\"http://www.microsoft.com/download/en/confirmation.aspx?id=28192\">http://www.microsoft.com/download/en/confirmation.aspx?id=28192</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>A multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.</p>\n<p>This document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.</p>\n<p>Download Link: <a href=\"http://www.microsoft.com/download/en/confirmation.aspx?id=28192\">http://www.microsoft.com/download/en/confirmation.aspx?id=28192</a></p>\n</body></html>"},{"title":"OCS各种资料汇总","date":"2008-11-20T15:41:55.000Z","_content":"\nOCS各种资料汇总\n\n*   [Microsoft Office Communications Server 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 客户端部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Enterprise Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP1 试用版</span>](http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn)\n*   [Windows Messenger 5.1 ADM 文件](http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：企业语音规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 联系人管理、状态和即时消息快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile（2007 发行版）](http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Active Directory 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Standard Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 客户端入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 电话和视频快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 多语言用户界面包](http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access](http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 Frequently Asked Questions](http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile](http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：存档和 CDR 服务器部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 QoE Monitoring Server 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）用户指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 会议快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn)\n*   [Communicator 2007 策略文档](http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：命令行参考指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access (2007) 语言包](http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置](http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition](http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 Group Policies](http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）疑难解答指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署 SIP/PSTN 网关](http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：通讯簿服务规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Document: Reference Guide](http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007](http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn)\n*   [Microsoft Office Communications Server 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：配置证书](http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 Quality of Experience Monitoring Server](http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access 规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：规划指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：命令行参考](http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn)\n*   [Office Communicator 自述](http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署概述](http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\"ng=zh-cn)\n*   [Communicator Mobile（2007 发行版）常见问题](http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn)","source":"_posts/ocs-docs.md","raw":"---\ntitle: OCS各种资料汇总\ntags:\n  - OCS\ncategories:\n  - 沟通协作\ndate: 2008-11-20 23:41:55\n---\n\nOCS各种资料汇总\n\n*   [Microsoft Office Communications Server 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 客户端部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Enterprise Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP1 试用版</span>](http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn)\n*   [Windows Messenger 5.1 ADM 文件](http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：企业语音规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 联系人管理、状态和即时消息快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile（2007 发行版）](http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Active Directory 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Standard Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 客户端入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 电话和视频快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 多语言用户界面包](http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access](http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 Frequently Asked Questions](http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile](http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：存档和 CDR 服务器部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 QoE Monitoring Server 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）用户指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 会议快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn)\n*   [Communicator 2007 策略文档](http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：命令行参考指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access (2007) 语言包](http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置](http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition](http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 Group Policies](http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）疑难解答指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署 SIP/PSTN 网关](http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：通讯簿服务规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Document: Reference Guide](http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007](http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn)\n*   [Microsoft Office Communications Server 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：配置证书](http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 Quality of Experience Monitoring Server](http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access 规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：规划指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：命令行参考](http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn)\n*   [Office Communicator 自述](http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署概述](http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\"ng=zh-cn)\n*   [Communicator Mobile（2007 发行版）常见问题](http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn)","slug":"ocs-docs","published":1,"updated":"2020-01-05T09:00:54.020Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuo006bk84sd6wm4wfn","content":"<html><head></head><body><p>OCS各种资料汇总</p>\n<ul>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn\">Microsoft Office Communications Server 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn\">Microsoft Office Communicator 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 2007 客户端部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：Enterprise Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn\">Live Communications Server 2005 SP1 试用版</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn\">Office Communicator 2007 入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn\">Windows Messenger 5.1 ADM 文件</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：企业语音规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn\">Office Communicator 2007 联系人管理、状态和即时消息快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn\">Office Communicator Mobile（2007 发行版）</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：Active Directory 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：Standard Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 客户端入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn\">Office Communicator 2007 电话和视频快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn\">Microsoft Office Communicator 2007 多语言用户界面包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn\">Office Communicator 2007 Frequently Asked Questions</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn\">Live Communications Server 2005 Enterprise Edition 文档：部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn\">Office Communicator Mobile</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：存档和 CDR 服务器部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn\">Office Communications Server 2007 QoE Monitoring Server 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）用户指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn\">Office Communicator 2007 会议快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn\">Communicator 2007 策略文档</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：命令行参考指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access (2007) 语言包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn\">Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn\">Microsoft Office Communicator 2007 Group Policies</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn\">Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）疑难解答指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：部署 SIP/PSTN 网关</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：通讯簿服务规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn\">Live Communications Server 2005 Document: Reference Guide</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn\">Microsoft Office Communications Server 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：配置证书</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn\">Office Communications Server 2007 Quality of Experience Monitoring Server</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access 规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn\">Microsoft Office Communicator 入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：规划指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：命令行参考</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn\">Office Communicator 自述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla%22http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn%22ng=zh-cn\">Live Communications Server 2005 文档：部署概述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）常见问题</a></li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>OCS各种资料汇总</p>\n<ul>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn\">Microsoft Office Communications Server 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn\">Microsoft Office Communicator 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 2007 客户端部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：Enterprise Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn\">Live Communications Server 2005 SP1 试用版</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn\">Office Communicator 2007 入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn\">Windows Messenger 5.1 ADM 文件</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：企业语音规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn\">Office Communicator 2007 联系人管理、状态和即时消息快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn\">Office Communicator Mobile（2007 发行版）</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：Active Directory 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：Standard Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 客户端入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn\">Office Communicator 2007 电话和视频快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn\">Microsoft Office Communicator 2007 多语言用户界面包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn\">Office Communicator 2007 Frequently Asked Questions</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn\">Live Communications Server 2005 Enterprise Edition 文档：部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn\">Office Communicator Mobile</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：存档和 CDR 服务器部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn\">Office Communications Server 2007 QoE Monitoring Server 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）用户指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn\">Office Communicator 2007 会议快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn\">Communicator 2007 策略文档</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：命令行参考指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access (2007) 语言包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn\">Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn\">Microsoft Office Communicator 2007 Group Policies</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn\">Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn\">Microsoft Office Live Meeting 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）疑难解答指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：部署 SIP/PSTN 网关</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：通讯簿服务规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn\">Live Communications Server 2005 Document: Reference Guide</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn\">Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn\">Microsoft Office Communications Server 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：配置证书</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn\">Office Communications Server 2007 Quality of Experience Monitoring Server</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn\">Microsoft Office Communicator Web Access 规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn\">Microsoft Office Communicator 入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：规划指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\">Live Communications Server 2005 文档：命令行参考</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn\">Office Communicator 自述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla%22http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn%22ng=zh-cn\">Live Communications Server 2005 文档：部署概述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn\">Communicator Mobile（2007 发行版）常见问题</a></li>\n</ul>\n</body></html>"},{"title":"packtpub.com 提供每日一本免费电子书","date":"2017-09-01T08:10:23.000Z","keywords":"Packtpub, eBook","description":"Packt是一家创立于2004年，总部位于英国伯明翰的技术书籍出版商，对电子书支持非常友好，除了主流的 PDF 格式以外，还支持 ePub, Mobi格式，还有源码提供，甚至可以直接将电子书发送至你的 Kindle 设备。目前每天都提供一本免费的电子书","_content":"\n\n[Packt](https://www.packtpub.com/)是一家创立于2004年，总部位于英国伯明翰的技术书籍出版商，对电子书支持非常友好，除了主流的 PDF 格式以外，还支持 ePub, Mobi格式，还有源码提供，甚至可以直接将电子书发送至你的 Kindle 设备。\n\n![eBook Formats](packtpub-offer-free-learning/packtpub-eBook-2.jpg)\n\n目前每天都提供一本免费的电子书，需要注册登录，然后到下面这个链接领取：\n\n**https://www.packtpub.com/packt/offers/free-learning**\n\n比如今天送的是这本 TypeScript Design Patterns\n\n![Free Offer](packtpub-offer-free-learning/packtpub-eBook-1.jpg)\n\n> 注意：由于 PacktPub 网站已经启用了 Google 的 reCAPTCHA 验证码，所以你需要科学上网才能领取。\n","source":"_posts/packtpub-offer-free-learning.md","raw":"---\ntitle: packtpub.com 提供每日一本免费电子书\ntags:\n  - Packt\n  - eBook\ncategories:\n  - eBook\ndate: 2017-09-01 16:10:23\nkeywords: Packtpub, eBook\ndescription: Packt是一家创立于2004年，总部位于英国伯明翰的技术书籍出版商，对电子书支持非常友好，除了主流的 PDF 格式以外，还支持 ePub, Mobi格式，还有源码提供，甚至可以直接将电子书发送至你的 Kindle 设备。目前每天都提供一本免费的电子书\n---\n\n\n[Packt](https://www.packtpub.com/)是一家创立于2004年，总部位于英国伯明翰的技术书籍出版商，对电子书支持非常友好，除了主流的 PDF 格式以外，还支持 ePub, Mobi格式，还有源码提供，甚至可以直接将电子书发送至你的 Kindle 设备。\n\n![eBook Formats](packtpub-offer-free-learning/packtpub-eBook-2.jpg)\n\n目前每天都提供一本免费的电子书，需要注册登录，然后到下面这个链接领取：\n\n**https://www.packtpub.com/packt/offers/free-learning**\n\n比如今天送的是这本 TypeScript Design Patterns\n\n![Free Offer](packtpub-offer-free-learning/packtpub-eBook-1.jpg)\n\n> 注意：由于 PacktPub 网站已经启用了 Google 的 reCAPTCHA 验证码，所以你需要科学上网才能领取。\n","slug":"packtpub-offer-free-learning","published":1,"updated":"2020-01-05T09:00:54.020Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuo006dk84s84av5wdo","content":"<html><head></head><body><p><a href=\"https://www.packtpub.com/\">Packt</a>是一家创立于2004年，总部位于英国伯明翰的技术书籍出版商，对电子书支持非常友好，除了主流的 PDF 格式以外，还支持 ePub, Mobi格式，还有源码提供，甚至可以直接将电子书发送至你的 Kindle 设备。</p>\n<p><img src=\"/packtpub-offer-free-learning/packtpub-eBook-2.jpg\" alt=\"eBook Formats\"></p>\n<p>目前每天都提供一本免费的电子书，需要注册登录，然后到下面这个链接领取：</p>\n<p><strong><a href=\"https://www.packtpub.com/packt/offers/free-learning\">https://www.packtpub.com/packt/offers/free-learning</a></strong></p>\n<p>比如今天送的是这本 TypeScript Design Patterns</p>\n<p><img src=\"/packtpub-offer-free-learning/packtpub-eBook-1.jpg\" alt=\"Free Offer\"></p>\n<blockquote>\n<p>注意：由于 PacktPub 网站已经启用了 Google 的 reCAPTCHA 验证码，所以你需要科学上网才能领取。</p>\n</blockquote>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p><a href=\"https://www.packtpub.com/\">Packt</a>是一家创立于2004年，总部位于英国伯明翰的技术书籍出版商，对电子书支持非常友好，除了主流的 PDF 格式以外，还支持 ePub, Mobi格式，还有源码提供，甚至可以直接将电子书发送至你的 Kindle 设备。</p>\n<p><img src=\"/packtpub-offer-free-learning/packtpub-eBook-2.jpg\" alt=\"eBook Formats\"></p>\n<p>目前每天都提供一本免费的电子书，需要注册登录，然后到下面这个链接领取：</p>\n<p><strong><a href=\"https://www.packtpub.com/packt/offers/free-learning\">https://www.packtpub.com/packt/offers/free-learning</a></strong></p>\n<p>比如今天送的是这本 TypeScript Design Patterns</p>\n<p><img src=\"/packtpub-offer-free-learning/packtpub-eBook-1.jpg\" alt=\"Free Offer\"></p>\n<blockquote>\n<p>注意：由于 PacktPub 网站已经启用了 Google 的 reCAPTCHA 验证码，所以你需要科学上网才能领取。</p>\n</blockquote>\n</body></html>"},{"title":"Patches for HMC4.0","date":"2008-09-21T02:44:35.000Z","_content":"\nThere are many updates released after HMC4.0 first release version, here is a simple list:\nMain rollup update:\n\n1. Update Rollup 1 for the Hosted SharePoint services\n2. Update Rollup 2 for the Hosted Exchange services\n3. Update Rollup 3 for the Hosted Exchange services (included Rollup2)\n4. Update Rollup 4 for the Hosted Exchange services (included Rollup3)\n\nOthers not included in the rollups above:\n\n*   [954965](http://support.microsoft.com/kb/954965/en-us) Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [943728](http://support.microsoft.com/kb/943728/en-us) The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [951052](http://support.microsoft.com/kb/951052/en-us) During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail\n*   [949708](http://support.microsoft.com/kb/949708/en-us) Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: \"There is no such object on the server\"\n*   [939216](http://support.microsoft.com/kb/939216/en-us) Some provisioning requests do not work, and you receive a \"0xc220140b\" error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration\n*   [952089](http://support.microsoft.com/kb/952089/en-us) The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0\n*   [945630](http://support.microsoft.com/kb/945630/en-us) Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0\n*   [954150](http://support.microsoft.com/kb/954150/en-us) You receive an error response when you call the \"EnsureServicePointers\" procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0\n*   [943864](http://support.microsoft.com/kb/943864/en-us) Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [945629](http://support.microsoft.com/kb/945629/en-us) How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0\n*   [947005](http://support.microsoft.com/kb/947005/en-us) You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit\n*   [943792](http://support.microsoft.com/kb/943792/en-us) The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0\n*   [950095](http://support.microsoft.com/kb/950095/en-us) Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0\n*   [939560](http://support.microsoft.com/kb/939560/en-us) Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [936159](http://support.microsoft.com/kb/936159/en-us) A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment\n\n**[Update Rollup 1 for the Hosted SharePoint services](http://support.microsoft.com/kb/952075/en-us) - June 30, 2008 v2.0**\n\n* [943837](http://support.microsoft.com/kb/943837/) Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components\n* [939030](http://support.microsoft.com/kb/939030/) You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0\n* [949629](http://support.microsoft.com/kb/949629/) The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0\n* [946516](http://support.microsoft.com/kb/946516/) Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\nThe **GetRoles** method in the Hosted SharePoint 2007 Web services does not return a list of roles.\n\nYou cannot modify the following site properties:\n   - Title\n   - HostHeaderIsSiteName\n   - URL\n   - Target\n   - Theme\n\nNote This update rollup provides a **ModifyCustomerSite** procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.\n• You receive an error message if you try to create a site that is larger than 4 GB.\n\n• The **GetHostingOUPath_** procedure in the Managed Helpers namespace does not exist.\n\n**[Update Rollup 2 for the Hosted Exchange services](http://support.microsoft.com/kb/948755/en-us) - April 30, 2008 v3.0**\n\nThis update rollup fixes the following issues:\n\n• [942100](http://support.microsoft.com/kb/942100/) Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\n• [946495](http://support.microsoft.com/kb/946495/) You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **ReallocateMailbox** method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox's allocation.\n\n• The new **CreateResourceMailbox** procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.\n\n• The **ModifyResourceMailbox** procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.\n\n• The **CreateAddressList** procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.\n\n**[Update Rollup 3 for the Hosted Exchange services](http://support.microsoft.com/kb/952076/en-us) - May 14, 2008 v1.1**\n\nThis update rollup includes the fixes from the following update rollup:\n\n• [948755](http://support.microsoft.com/kb/948755/) Description of **Update Rollup 2** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **DeleteMailbox** procedure in the Hosted Email 2007 namespace may fail. You may receive an \"A procedure tried to release more resources than are currently allocated to a consumer\" error message or a \"No allocations were found to update\" error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.\n\n• By default, all mailboxes that are created have the **ActiveSync** feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.\n\n> Note After you install this update, you can use the **ActiveSyncEnabled** parameter to enable or disable the ActiveSync feature.\n\n• The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):\n• OWAPublicFoldersEnabled\n• OWARecoverDeletedItemsEnabled\n• OWARulesEnabled\n• OWASMimeEnabled\n\n**[Update Rollup 4 for the Hosted Exchange services](http://support.microsoft.com/kb/952077/en-us) - July 21, 2008 v1.0\n**\n\n• [952076](http://support.microsoft.com/kb/952076/) Description of **Update Rollup 3** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n•    When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.\n\n•    When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user's **showInAddressBook** attribute may be cleared. When this occurs, the user is removed from address lists.\n\n•    In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.\n\n•    The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an \"Out Of Memory\" error message.\nAdditionally, this update rollup includes the following tools:\n•    A tool to deny Send As and Receive As rights to administrators and to customer administrators\n•    A tool to modify the names of existing mobile policies","source":"_posts/patches-for-hmc40.md","raw":"---\ntitle: Patches for HMC4.0\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-09-21 10:44:35\n---\n\nThere are many updates released after HMC4.0 first release version, here is a simple list:\nMain rollup update:\n\n1. Update Rollup 1 for the Hosted SharePoint services\n2. Update Rollup 2 for the Hosted Exchange services\n3. Update Rollup 3 for the Hosted Exchange services (included Rollup2)\n4. Update Rollup 4 for the Hosted Exchange services (included Rollup3)\n\nOthers not included in the rollups above:\n\n*   [954965](http://support.microsoft.com/kb/954965/en-us) Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [943728](http://support.microsoft.com/kb/943728/en-us) The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [951052](http://support.microsoft.com/kb/951052/en-us) During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail\n*   [949708](http://support.microsoft.com/kb/949708/en-us) Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: \"There is no such object on the server\"\n*   [939216](http://support.microsoft.com/kb/939216/en-us) Some provisioning requests do not work, and you receive a \"0xc220140b\" error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration\n*   [952089](http://support.microsoft.com/kb/952089/en-us) The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0\n*   [945630](http://support.microsoft.com/kb/945630/en-us) Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0\n*   [954150](http://support.microsoft.com/kb/954150/en-us) You receive an error response when you call the \"EnsureServicePointers\" procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0\n*   [943864](http://support.microsoft.com/kb/943864/en-us) Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [945629](http://support.microsoft.com/kb/945629/en-us) How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0\n*   [947005](http://support.microsoft.com/kb/947005/en-us) You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit\n*   [943792](http://support.microsoft.com/kb/943792/en-us) The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0\n*   [950095](http://support.microsoft.com/kb/950095/en-us) Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0\n*   [939560](http://support.microsoft.com/kb/939560/en-us) Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [936159](http://support.microsoft.com/kb/936159/en-us) A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment\n\n**[Update Rollup 1 for the Hosted SharePoint services](http://support.microsoft.com/kb/952075/en-us) - June 30, 2008 v2.0**\n\n* [943837](http://support.microsoft.com/kb/943837/) Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components\n* [939030](http://support.microsoft.com/kb/939030/) You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0\n* [949629](http://support.microsoft.com/kb/949629/) The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0\n* [946516](http://support.microsoft.com/kb/946516/) Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\nThe **GetRoles** method in the Hosted SharePoint 2007 Web services does not return a list of roles.\n\nYou cannot modify the following site properties:\n   - Title\n   - HostHeaderIsSiteName\n   - URL\n   - Target\n   - Theme\n\nNote This update rollup provides a **ModifyCustomerSite** procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.\n• You receive an error message if you try to create a site that is larger than 4 GB.\n\n• The **GetHostingOUPath_** procedure in the Managed Helpers namespace does not exist.\n\n**[Update Rollup 2 for the Hosted Exchange services](http://support.microsoft.com/kb/948755/en-us) - April 30, 2008 v3.0**\n\nThis update rollup fixes the following issues:\n\n• [942100](http://support.microsoft.com/kb/942100/) Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\n• [946495](http://support.microsoft.com/kb/946495/) You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **ReallocateMailbox** method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox's allocation.\n\n• The new **CreateResourceMailbox** procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.\n\n• The **ModifyResourceMailbox** procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.\n\n• The **CreateAddressList** procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.\n\n**[Update Rollup 3 for the Hosted Exchange services](http://support.microsoft.com/kb/952076/en-us) - May 14, 2008 v1.1**\n\nThis update rollup includes the fixes from the following update rollup:\n\n• [948755](http://support.microsoft.com/kb/948755/) Description of **Update Rollup 2** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **DeleteMailbox** procedure in the Hosted Email 2007 namespace may fail. You may receive an \"A procedure tried to release more resources than are currently allocated to a consumer\" error message or a \"No allocations were found to update\" error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.\n\n• By default, all mailboxes that are created have the **ActiveSync** feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.\n\n> Note After you install this update, you can use the **ActiveSyncEnabled** parameter to enable or disable the ActiveSync feature.\n\n• The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):\n• OWAPublicFoldersEnabled\n• OWARecoverDeletedItemsEnabled\n• OWARulesEnabled\n• OWASMimeEnabled\n\n**[Update Rollup 4 for the Hosted Exchange services](http://support.microsoft.com/kb/952077/en-us) - July 21, 2008 v1.0\n**\n\n• [952076](http://support.microsoft.com/kb/952076/) Description of **Update Rollup 3** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n•    When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.\n\n•    When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user's **showInAddressBook** attribute may be cleared. When this occurs, the user is removed from address lists.\n\n•    In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.\n\n•    The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an \"Out Of Memory\" error message.\nAdditionally, this update rollup includes the following tools:\n•    A tool to deny Send As and Receive As rights to administrators and to customer administrators\n•    A tool to modify the names of existing mobile policies","slug":"patches-for-hmc40","published":1,"updated":"2020-01-05T09:00:54.021Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kup006gk84s4iu7a80l","content":"<html><head></head><body><p>There are many updates released after HMC4.0 first release version, here is a simple list:<br>Main rollup update:</p>\n<ol>\n<li>Update Rollup 1 for the Hosted SharePoint services</li>\n<li>Update Rollup 2 for the Hosted Exchange services</li>\n<li>Update Rollup 3 for the Hosted Exchange services (included Rollup2)</li>\n<li>Update Rollup 4 for the Hosted Exchange services (included Rollup3)</li>\n</ol>\n<p>Others not included in the rollups above:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/954965/en-us\">954965</a>&nbsp;Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943728/en-us\">943728</a>&nbsp;The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/951052/en-us\">951052</a>&nbsp;During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail</li>\n<li><a href=\"http://support.microsoft.com/kb/949708/en-us\">949708</a>&nbsp;Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: “There is no such object on the server”</li>\n<li><a href=\"http://support.microsoft.com/kb/939216/en-us\">939216</a>&nbsp;Some provisioning requests do not work, and you receive a “0xc220140b” error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration</li>\n<li><a href=\"http://support.microsoft.com/kb/952089/en-us\">952089</a>&nbsp;The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945630/en-us\">945630</a>&nbsp;Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/954150/en-us\">954150</a>&nbsp;You receive an error response when you call the “EnsureServicePointers” procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943864/en-us\">943864</a>&nbsp;Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945629/en-us\">945629</a>&nbsp;How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/947005/en-us\">947005</a>&nbsp;You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit</li>\n<li><a href=\"http://support.microsoft.com/kb/943792/en-us\">943792</a>&nbsp;The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/950095/en-us\">950095</a>&nbsp;Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/939560/en-us\">939560</a>&nbsp;Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/936159/en-us\">936159</a>&nbsp;A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment</li>\n</ul>\n<p><strong><a href=\"http://support.microsoft.com/kb/952075/en-us\">Update Rollup 1 for the Hosted SharePoint services</a>&nbsp;- June 30, 2008 v2.0</strong></p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/943837/\">943837</a>&nbsp;Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components</li>\n<li><a href=\"http://support.microsoft.com/kb/939030/\">939030</a>&nbsp;You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/949629/\">949629</a>&nbsp;The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/946516/\">946516</a>&nbsp;Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n</ul>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>The&nbsp;<strong>GetRoles</strong>&nbsp;method in the Hosted SharePoint 2007 Web services does not return a list of roles.</p>\n<p>You cannot modify the following site properties:<br>   -&nbsp;Title<br>   -&nbsp;HostHeaderIsSiteName</p>\n<ul>\n<li>URL</li>\n</ul>\n<p>   -&nbsp;Target<br>   -&nbsp;Theme</p>\n<p>Note This update rollup provides a&nbsp;<strong>ModifyCustomerSite</strong>&nbsp;procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.<br>•&nbsp;You receive an error message if you try to create a site that is larger than 4 GB.</p>\n<p>•&nbsp;The&nbsp;<strong>GetHostingOUPath_</strong>&nbsp;procedure in the Managed Helpers namespace does not exist.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/948755/en-us\">Update Rollup 2 for the Hosted Exchange services</a>&nbsp;- April 30, 2008 v3.0</strong></p>\n<p>This update rollup fixes the following issues:</p>\n<p>•&nbsp;<a href=\"http://support.microsoft.com/kb/942100/\">942100</a>&nbsp;Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>•&nbsp;<a href=\"http://support.microsoft.com/kb/946495/\">946495</a>&nbsp;You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>•&nbsp;The&nbsp;<strong>ReallocateMailbox</strong>&nbsp;method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox’s allocation.</p>\n<p>•&nbsp;The new&nbsp;<strong>CreateResourceMailbox</strong>&nbsp;procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.</p>\n<p>•&nbsp;The&nbsp;<strong>ModifyResourceMailbox</strong>&nbsp;procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.</p>\n<p>•&nbsp;The&nbsp;<strong>CreateAddressList</strong>&nbsp;procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/952076/en-us\">Update Rollup 3 for the Hosted Exchange services</a>&nbsp;- May 14, 2008 v1.1</strong></p>\n<p>This update rollup includes the fixes from the following update rollup:</p>\n<p>• <a href=\"http://support.microsoft.com/kb/948755/\">948755</a>&nbsp;Description of&nbsp;<strong>Update Rollup 2</strong>&nbsp;for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>• The&nbsp;<strong>DeleteMailbox</strong>&nbsp;procedure in the Hosted Email 2007 namespace may fail. You may receive an “A procedure tried to release more resources than are currently allocated to a consumer” error message or a “No allocations were found to update” error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.</p>\n<p>•&nbsp;By default, all mailboxes that are created have the&nbsp;<strong>ActiveSync</strong>&nbsp;feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.</p>\n<blockquote>\n<p>Note After you install this update, you can use the&nbsp;<strong>ActiveSyncEnabled</strong>&nbsp;parameter to enable or disable the ActiveSync feature.</p>\n</blockquote>\n<p>•&nbsp;The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):<br>•&nbsp;OWAPublicFoldersEnabled<br>•&nbsp;OWARecoverDeletedItemsEnabled<br>•&nbsp;OWARulesEnabled<br>•&nbsp;OWASMimeEnabled</p>\n<p>**<a href=\"http://support.microsoft.com/kb/952077/en-us\">Update Rollup 4 for the Hosted Exchange services</a>&nbsp;- July 21, 2008 v1.0<br>**</p>\n<p>•&nbsp;<a href=\"http://support.microsoft.com/kb/952076/\">952076</a>&nbsp;Description of&nbsp;<strong>Update Rollup 3</strong>&nbsp;for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>•&nbsp;&nbsp;&nbsp; When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.</p>\n<p>•&nbsp;&nbsp;&nbsp; When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user’s&nbsp;<strong>showInAddressBook</strong>&nbsp;attribute may be cleared. When this occurs, the user is removed from address lists.</p>\n<p>•&nbsp;&nbsp;&nbsp; In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.</p>\n<p>•&nbsp;&nbsp;&nbsp; The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an “Out Of Memory” error message.<br>Additionally, this update rollup includes the following tools:<br>•&nbsp;&nbsp;&nbsp; A tool to deny Send As and Receive As rights to administrators and to customer administrators<br>•&nbsp;&nbsp;&nbsp; A tool to modify the names of existing mobile policies</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>There are many updates released after HMC4.0 first release version, here is a simple list:<br>Main rollup update:</p>\n<ol>\n<li>Update Rollup 1 for the Hosted SharePoint services</li>\n<li>Update Rollup 2 for the Hosted Exchange services</li>\n<li>Update Rollup 3 for the Hosted Exchange services (included Rollup2)</li>\n<li>Update Rollup 4 for the Hosted Exchange services (included Rollup3)</li>\n</ol>\n<p>Others not included in the rollups above:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/954965/en-us\">954965</a>&nbsp;Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943728/en-us\">943728</a>&nbsp;The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/951052/en-us\">951052</a>&nbsp;During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail</li>\n<li><a href=\"http://support.microsoft.com/kb/949708/en-us\">949708</a>&nbsp;Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: “There is no such object on the server”</li>\n<li><a href=\"http://support.microsoft.com/kb/939216/en-us\">939216</a>&nbsp;Some provisioning requests do not work, and you receive a “0xc220140b” error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration</li>\n<li><a href=\"http://support.microsoft.com/kb/952089/en-us\">952089</a>&nbsp;The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945630/en-us\">945630</a>&nbsp;Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/954150/en-us\">954150</a>&nbsp;You receive an error response when you call the “EnsureServicePointers” procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943864/en-us\">943864</a>&nbsp;Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945629/en-us\">945629</a>&nbsp;How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/947005/en-us\">947005</a>&nbsp;You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit</li>\n<li><a href=\"http://support.microsoft.com/kb/943792/en-us\">943792</a>&nbsp;The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/950095/en-us\">950095</a>&nbsp;Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/939560/en-us\">939560</a>&nbsp;Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/936159/en-us\">936159</a>&nbsp;A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment</li>\n</ul>\n<p><strong><a href=\"http://support.microsoft.com/kb/952075/en-us\">Update Rollup 1 for the Hosted SharePoint services</a>&nbsp;- June 30, 2008 v2.0</strong></p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/943837/\">943837</a>&nbsp;Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components</li>\n<li><a href=\"http://support.microsoft.com/kb/939030/\">939030</a>&nbsp;You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/949629/\">949629</a>&nbsp;The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/946516/\">946516</a>&nbsp;Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n</ul>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>The&nbsp;<strong>GetRoles</strong>&nbsp;method in the Hosted SharePoint 2007 Web services does not return a list of roles.</p>\n<p>You cannot modify the following site properties:<br>   -&nbsp;Title<br>   -&nbsp;HostHeaderIsSiteName</p>\n<ul>\n<li>URL</li>\n</ul>\n<p>   -&nbsp;Target<br>   -&nbsp;Theme</p>\n<p>Note This update rollup provides a&nbsp;<strong>ModifyCustomerSite</strong>&nbsp;procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.<br>•&nbsp;You receive an error message if you try to create a site that is larger than 4 GB.</p>\n<p>•&nbsp;The&nbsp;<strong>GetHostingOUPath_</strong>&nbsp;procedure in the Managed Helpers namespace does not exist.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/948755/en-us\">Update Rollup 2 for the Hosted Exchange services</a>&nbsp;- April 30, 2008 v3.0</strong></p>\n<p>This update rollup fixes the following issues:</p>\n<p>•&nbsp;<a href=\"http://support.microsoft.com/kb/942100/\">942100</a>&nbsp;Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>•&nbsp;<a href=\"http://support.microsoft.com/kb/946495/\">946495</a>&nbsp;You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>•&nbsp;The&nbsp;<strong>ReallocateMailbox</strong>&nbsp;method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox’s allocation.</p>\n<p>•&nbsp;The new&nbsp;<strong>CreateResourceMailbox</strong>&nbsp;procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.</p>\n<p>•&nbsp;The&nbsp;<strong>ModifyResourceMailbox</strong>&nbsp;procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.</p>\n<p>•&nbsp;The&nbsp;<strong>CreateAddressList</strong>&nbsp;procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/952076/en-us\">Update Rollup 3 for the Hosted Exchange services</a>&nbsp;- May 14, 2008 v1.1</strong></p>\n<p>This update rollup includes the fixes from the following update rollup:</p>\n<p>• <a href=\"http://support.microsoft.com/kb/948755/\">948755</a>&nbsp;Description of&nbsp;<strong>Update Rollup 2</strong>&nbsp;for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>• The&nbsp;<strong>DeleteMailbox</strong>&nbsp;procedure in the Hosted Email 2007 namespace may fail. You may receive an “A procedure tried to release more resources than are currently allocated to a consumer” error message or a “No allocations were found to update” error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.</p>\n<p>•&nbsp;By default, all mailboxes that are created have the&nbsp;<strong>ActiveSync</strong>&nbsp;feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.</p>\n<blockquote>\n<p>Note After you install this update, you can use the&nbsp;<strong>ActiveSyncEnabled</strong>&nbsp;parameter to enable or disable the ActiveSync feature.</p>\n</blockquote>\n<p>•&nbsp;The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):<br>•&nbsp;OWAPublicFoldersEnabled<br>•&nbsp;OWARecoverDeletedItemsEnabled<br>•&nbsp;OWARulesEnabled<br>•&nbsp;OWASMimeEnabled</p>\n<p>**<a href=\"http://support.microsoft.com/kb/952077/en-us\">Update Rollup 4 for the Hosted Exchange services</a>&nbsp;- July 21, 2008 v1.0<br>**</p>\n<p>•&nbsp;<a href=\"http://support.microsoft.com/kb/952076/\">952076</a>&nbsp;Description of&nbsp;<strong>Update Rollup 3</strong>&nbsp;for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>•&nbsp;&nbsp;&nbsp; When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.</p>\n<p>•&nbsp;&nbsp;&nbsp; When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user’s&nbsp;<strong>showInAddressBook</strong>&nbsp;attribute may be cleared. When this occurs, the user is removed from address lists.</p>\n<p>•&nbsp;&nbsp;&nbsp; In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.</p>\n<p>•&nbsp;&nbsp;&nbsp; The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an “Out Of Memory” error message.<br>Additionally, this update rollup includes the following tools:<br>•&nbsp;&nbsp;&nbsp; A tool to deny Send As and Receive As rights to administrators and to customer administrators<br>•&nbsp;&nbsp;&nbsp; A tool to modify the names of existing mobile policies</p>\n</body></html>"},{"title":"小心安装 OCS 2007 R2 Cumulative Update 6 (CU6) 和 .NET 4.0","date":"2010-08-15T01:25:18.000Z","_content":"\n今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现\n\n> Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.\n\n最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯\n```cmd\nmsiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx\n```\n打完了数据库补丁后，启动 Front-End 服务正常。\n\n另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。\n\n我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。","source":"_posts/problem-when-installing-ocs2007-r2-cu6-dotnet-40.md","raw":"---\ntitle: 小心安装 OCS 2007 R2 Cumulative Update 6 (CU6) 和 .NET 4.0\ntags:\n  - OCS\ncategories:\n  - 沟通协作\ndate: 2010-08-15 09:25:18\n---\n\n今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现\n\n> Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.\n\n最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯\n```cmd\nmsiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx\n```\n打完了数据库补丁后，启动 Front-End 服务正常。\n\n另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。\n\n我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。","slug":"problem-when-installing-ocs2007-r2-cu6-dotnet-40","published":1,"updated":"2020-01-05T09:00:54.021Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kup006kk84s6fhca0m5","content":"<html><head></head><body><p>今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现</p>\n<blockquote>\n<p>Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.</p>\n</blockquote>\n<p>最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯</p>\n<figure class=\"highlight cmd\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">msiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx</span><br></pre></td></tr></tbody></table></figure>\n<p>打完了数据库补丁后，启动 Front-End 服务正常。</p>\n<p>另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。</p>\n<p>我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现</p>\n<blockquote>\n<p>Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.</p>\n</blockquote>\n<p>最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯</p>\n<figure class=\"highlight cmd\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">msiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx</span><br></pre></td></tr></tbody></table></figure>\n<p>打完了数据库补丁后，启动 Front-End 服务正常。</p>\n<p>另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。</p>\n<p>我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。</p>\n</body></html>"},{"title":"Python练手小程序-中科大网络课堂视频下载","date":"2017-08-28T03:46:31.000Z","keywords":"Python, 练习，中科大，知乎","_content":"\n#### 所谓人生苦短，我用 Python\n作为一个编程小白，我也开始了学习 Python 的过程。之前在知乎上爬贴，看到个有意思的回答，[大家都用 Python 来做什么啊？ - Tsing 的回答](https://www.zhihu.com/question/20799742/answer/99491808#)，答主用了一小段代码拿到了学校研究生网络课堂在线视频的真实地址，答案里面的代码段关键部分被处理过，我看到评论里面好多人在求，我就想自己试试看能不能摸索出来，折腾了几天，终于从白板写出了第一个 Python 小程序。\n\n<!--more-->\n\n以下是[源代码](https://github.com/randyzhong/my-python-learning/blob/master/ustc-wlkt-downloader/ustc-wlkt-downloader.py):\n``` python\n# -*- coding: utf-8 -*-\n# http://wlkt.ustc.edu.cn/ (USTC CERNET IP Only)\n# Public course only\n# If online course is set to private or restricted for Xiaonei only, you have to run this downloader from USTC CERNET IP, or you'll not get the real video source URL.\n# Reference: https://www.zhihu.com/question/20799742/answer/99491808\n\nimport requests\nimport urllib\nfrom bs4 import BeautifulSoup\n\ns = requests.Session() \nlink = \"http://wlkt.ustc.edu.cn/video/detail_3752_0.htm\" # This is a public video\nreq = s.get(link)\nhtml = req.content\nsoup = BeautifulSoup(html, \"html.parser\")\nvideourl1 = soup.find(id=\"videourl1\")['value']\nhtopicid = soup.find(id=\"htopicid\")['value']\nheader = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36',\n           'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',\n           'X-Requested-With': 'XMLHttpRequest',\n           'Host': 'wlkt.ustc.edu.cn',\n           'Origin': 'http://wlkt.ustc.edu.cn',\n           'Referer': 'http://wlkt.ustc.edu.cn/video/detail_3752_0.htm'}\npayload = urllib.urlencode({'videourl1': videourl1,'hid_topicid': htopicid})\nurl = requests.post(\"http://wlkt.ustc.edu.cn/ajaxprocess.php?menu=getvideourl\",data=payload, headers=header)\nprint (\"The real video URL is： http://wlkt.ustc.edu.cn/mp4.php?file=\" + url.content[14:])\n```\n\n这里面最大的坑其实还是校内外IP限制的问题，在中科大的网络课堂视频里面，只有一小部分可以在外网访问，大部分都限制只允许校内教育网IP访问, 如果你在校外，因为后台服务器限制，返回来的只有 xiaowai 几个字，除非你有中科大校内代理，否则这个没法破。我找的这个例子是对公网开放的，权当拿来自己练手。\n","source":"_posts/python-practice-1-ustc-online-course-downloader.md","raw":"---\ntitle: Python练手小程序-中科大网络课堂视频下载\ntags:\n  - Python\ncategories:\n  - Python\ndate: 2017-08-28 11:46:31\nkeywords: Python, 练习，中科大，知乎\n---\n\n#### 所谓人生苦短，我用 Python\n作为一个编程小白，我也开始了学习 Python 的过程。之前在知乎上爬贴，看到个有意思的回答，[大家都用 Python 来做什么啊？ - Tsing 的回答](https://www.zhihu.com/question/20799742/answer/99491808#)，答主用了一小段代码拿到了学校研究生网络课堂在线视频的真实地址，答案里面的代码段关键部分被处理过，我看到评论里面好多人在求，我就想自己试试看能不能摸索出来，折腾了几天，终于从白板写出了第一个 Python 小程序。\n\n<!--more-->\n\n以下是[源代码](https://github.com/randyzhong/my-python-learning/blob/master/ustc-wlkt-downloader/ustc-wlkt-downloader.py):\n``` python\n# -*- coding: utf-8 -*-\n# http://wlkt.ustc.edu.cn/ (USTC CERNET IP Only)\n# Public course only\n# If online course is set to private or restricted for Xiaonei only, you have to run this downloader from USTC CERNET IP, or you'll not get the real video source URL.\n# Reference: https://www.zhihu.com/question/20799742/answer/99491808\n\nimport requests\nimport urllib\nfrom bs4 import BeautifulSoup\n\ns = requests.Session() \nlink = \"http://wlkt.ustc.edu.cn/video/detail_3752_0.htm\" # This is a public video\nreq = s.get(link)\nhtml = req.content\nsoup = BeautifulSoup(html, \"html.parser\")\nvideourl1 = soup.find(id=\"videourl1\")['value']\nhtopicid = soup.find(id=\"htopicid\")['value']\nheader = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36',\n           'Content-Type': 'application/x-www-form-urlencoded;charset=UTF-8',\n           'X-Requested-With': 'XMLHttpRequest',\n           'Host': 'wlkt.ustc.edu.cn',\n           'Origin': 'http://wlkt.ustc.edu.cn',\n           'Referer': 'http://wlkt.ustc.edu.cn/video/detail_3752_0.htm'}\npayload = urllib.urlencode({'videourl1': videourl1,'hid_topicid': htopicid})\nurl = requests.post(\"http://wlkt.ustc.edu.cn/ajaxprocess.php?menu=getvideourl\",data=payload, headers=header)\nprint (\"The real video URL is： http://wlkt.ustc.edu.cn/mp4.php?file=\" + url.content[14:])\n```\n\n这里面最大的坑其实还是校内外IP限制的问题，在中科大的网络课堂视频里面，只有一小部分可以在外网访问，大部分都限制只允许校内教育网IP访问, 如果你在校外，因为后台服务器限制，返回来的只有 xiaowai 几个字，除非你有中科大校内代理，否则这个没法破。我找的这个例子是对公网开放的，权当拿来自己练手。\n","slug":"python-practice-1-ustc-online-course-downloader","published":1,"updated":"2020-01-05T09:00:54.021Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuq006nk84s39n68uzf","content":"<html><head></head><body><h4 id=\"所谓人生苦短，我用-Python\"><a href=\"#所谓人生苦短，我用-Python\" class=\"headerlink\" title=\"所谓人生苦短，我用 Python\"></a>所谓人生苦短，我用 Python</h4><p>作为一个编程小白，我也开始了学习 Python 的过程。之前在知乎上爬贴，看到个有意思的回答，<a href=\"https://www.zhihu.com/question/20799742/answer/99491808#\">大家都用 Python 来做什么啊？ - Tsing 的回答</a>，答主用了一小段代码拿到了学校研究生网络课堂在线视频的真实地址，答案里面的代码段关键部分被处理过，我看到评论里面好多人在求，我就想自己试试看能不能摸索出来，折腾了几天，终于从白板写出了第一个 Python 小程序。</p>\n<span id=\"more\"></span>\n\n<p>以下是<a href=\"https://github.com/randyzhong/my-python-learning/blob/master/ustc-wlkt-downloader/ustc-wlkt-downloader.py\">源代码</a>:</p>\n<figure class=\"highlight python\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"comment\"># http://wlkt.ustc.edu.cn/ (USTC CERNET IP Only)</span></span><br><span class=\"line\"><span class=\"comment\"># Public course only</span></span><br><span class=\"line\"><span class=\"comment\"># If online course is set to private or restricted for Xiaonei only, you have to run this downloader from USTC CERNET IP, or you'll not get the real video source URL.</span></span><br><span class=\"line\"><span class=\"comment\"># Reference: https://www.zhihu.com/question/20799742/answer/99491808</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib</span><br><span class=\"line\"><span class=\"keyword\">from</span> bs4 <span class=\"keyword\">import</span> BeautifulSoup</span><br><span class=\"line\"></span><br><span class=\"line\">s = requests.Session() </span><br><span class=\"line\">link = <span class=\"string\">\"http://wlkt.ustc.edu.cn/video/detail_3752_0.htm\"</span> <span class=\"comment\"># This is a public video</span></span><br><span class=\"line\">req = s.get(link)</span><br><span class=\"line\">html = req.content</span><br><span class=\"line\">soup = BeautifulSoup(html, <span class=\"string\">\"html.parser\"</span>)</span><br><span class=\"line\">videourl1 = soup.find(<span class=\"built_in\">id</span>=<span class=\"string\">\"videourl1\"</span>)[<span class=\"string\">'value'</span>]</span><br><span class=\"line\">htopicid = soup.find(<span class=\"built_in\">id</span>=<span class=\"string\">\"htopicid\"</span>)[<span class=\"string\">'value'</span>]</span><br><span class=\"line\">header = {<span class=\"string\">'User-Agent'</span>: <span class=\"string\">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/x-www-form-urlencoded;charset=UTF-8'</span>,</span><br><span class=\"line\">           <span class=\"string\">'X-Requested-With'</span>: <span class=\"string\">'XMLHttpRequest'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Host'</span>: <span class=\"string\">'wlkt.ustc.edu.cn'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Origin'</span>: <span class=\"string\">'http://wlkt.ustc.edu.cn'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Referer'</span>: <span class=\"string\">'http://wlkt.ustc.edu.cn/video/detail_3752_0.htm'</span>}</span><br><span class=\"line\">payload = urllib.urlencode({<span class=\"string\">'videourl1'</span>: videourl1,<span class=\"string\">'hid_topicid'</span>: htopicid})</span><br><span class=\"line\">url = requests.post(<span class=\"string\">\"http://wlkt.ustc.edu.cn/ajaxprocess.php?menu=getvideourl\"</span>,data=payload, headers=header)</span><br><span class=\"line\"><span class=\"built_in\">print</span> (<span class=\"string\">\"The real video URL is： http://wlkt.ustc.edu.cn/mp4.php?file=\"</span> + url.content[<span class=\"number\">14</span>:])</span><br></pre></td></tr></tbody></table></figure>\n\n<p>这里面最大的坑其实还是校内外IP限制的问题，在中科大的网络课堂视频里面，只有一小部分可以在外网访问，大部分都限制只允许校内教育网IP访问, 如果你在校外，因为后台服务器限制，返回来的只有 xiaowai 几个字，除非你有中科大校内代理，否则这个没法破。我找的这个例子是对公网开放的，权当拿来自己练手。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><h4 id=\"所谓人生苦短，我用-Python\"><a href=\"#所谓人生苦短，我用-Python\" class=\"headerlink\" title=\"所谓人生苦短，我用 Python\"></a>所谓人生苦短，我用 Python</h4><p>作为一个编程小白，我也开始了学习 Python 的过程。之前在知乎上爬贴，看到个有意思的回答，<a href=\"https://www.zhihu.com/question/20799742/answer/99491808#\">大家都用 Python 来做什么啊？ - Tsing 的回答</a>，答主用了一小段代码拿到了学校研究生网络课堂在线视频的真实地址，答案里面的代码段关键部分被处理过，我看到评论里面好多人在求，我就想自己试试看能不能摸索出来，折腾了几天，终于从白板写出了第一个 Python 小程序。</p></body></html>","more":"<html><head></head><body><p>以下是<a href=\"https://github.com/randyzhong/my-python-learning/blob/master/ustc-wlkt-downloader/ustc-wlkt-downloader.py\">源代码</a>:</p>\n<figure class=\"highlight python\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -*- coding: utf-8 -*-</span></span><br><span class=\"line\"><span class=\"comment\"># http://wlkt.ustc.edu.cn/ (USTC CERNET IP Only)</span></span><br><span class=\"line\"><span class=\"comment\"># Public course only</span></span><br><span class=\"line\"><span class=\"comment\"># If online course is set to private or restricted for Xiaonei only, you have to run this downloader from USTC CERNET IP, or you'll not get the real video source URL.</span></span><br><span class=\"line\"><span class=\"comment\"># Reference: https://www.zhihu.com/question/20799742/answer/99491808</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib</span><br><span class=\"line\"><span class=\"keyword\">from</span> bs4 <span class=\"keyword\">import</span> BeautifulSoup</span><br><span class=\"line\"></span><br><span class=\"line\">s = requests.Session() </span><br><span class=\"line\">link = <span class=\"string\">\"http://wlkt.ustc.edu.cn/video/detail_3752_0.htm\"</span> <span class=\"comment\"># This is a public video</span></span><br><span class=\"line\">req = s.get(link)</span><br><span class=\"line\">html = req.content</span><br><span class=\"line\">soup = BeautifulSoup(html, <span class=\"string\">\"html.parser\"</span>)</span><br><span class=\"line\">videourl1 = soup.find(<span class=\"built_in\">id</span>=<span class=\"string\">\"videourl1\"</span>)[<span class=\"string\">'value'</span>]</span><br><span class=\"line\">htopicid = soup.find(<span class=\"built_in\">id</span>=<span class=\"string\">\"htopicid\"</span>)[<span class=\"string\">'value'</span>]</span><br><span class=\"line\">header = {<span class=\"string\">'User-Agent'</span>: <span class=\"string\">'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/60.0.3112.101 Safari/537.36'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Content-Type'</span>: <span class=\"string\">'application/x-www-form-urlencoded;charset=UTF-8'</span>,</span><br><span class=\"line\">           <span class=\"string\">'X-Requested-With'</span>: <span class=\"string\">'XMLHttpRequest'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Host'</span>: <span class=\"string\">'wlkt.ustc.edu.cn'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Origin'</span>: <span class=\"string\">'http://wlkt.ustc.edu.cn'</span>,</span><br><span class=\"line\">           <span class=\"string\">'Referer'</span>: <span class=\"string\">'http://wlkt.ustc.edu.cn/video/detail_3752_0.htm'</span>}</span><br><span class=\"line\">payload = urllib.urlencode({<span class=\"string\">'videourl1'</span>: videourl1,<span class=\"string\">'hid_topicid'</span>: htopicid})</span><br><span class=\"line\">url = requests.post(<span class=\"string\">\"http://wlkt.ustc.edu.cn/ajaxprocess.php?menu=getvideourl\"</span>,data=payload, headers=header)</span><br><span class=\"line\"><span class=\"built_in\">print</span> (<span class=\"string\">\"The real video URL is： http://wlkt.ustc.edu.cn/mp4.php?file=\"</span> + url.content[<span class=\"number\">14</span>:])</span><br></pre></td></tr></tbody></table></figure>\n\n<p>这里面最大的坑其实还是校内外IP限制的问题，在中科大的网络课堂视频里面，只有一小部分可以在外网访问，大部分都限制只允许校内教育网IP访问, 如果你在校外，因为后台服务器限制，返回来的只有 xiaowai 几个字，除非你有中科大校内代理，否则这个没法破。我找的这个例子是对公网开放的，权当拿来自己练手。</p></body></html>"},{"title":"Reporting Service can't start - Event ID 107","date":"2009-12-11T12:55:31.000Z","_content":"\nToday, one of my clients reported that, the reporting service cannot started.\nThey didn't change anything and database service is running fine.\n> Event Type: Error\nEvent Source: Report Server Windows Service (MSSQLSERVER)\nEvent Category: Management\nEvent ID: 107\nDate: 12/10/2009\nTime: 11:53:21 PM\nUser: N/A\nComputer: ABC\nDescription:\nReport Server Windows Service (MSSQLSERVER) cannot connect to the report server database.\n\n> Event Type: Error\nEvent Source: Service Control Manager\nEvent Category: None\nEvent ID: 7000\nDate: 7/27/2008\nTime: 7:26:24 PM\nUser: N/A\nComputer: PRODB\nDescription:\nThe SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:\nThe service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.\n\nThe Reporting Services logs mostly just repeat that \"The Report Server Windows service 'ReportServer' is not running.\" ...\n\nThis issue was caused by a windows hotfix - **KB948109**, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.\n\nThere are 2 ways can make it resolved.\n\n**Solution A**: Use Add/Remove to uninstall this hotfix **KB948109**.\n\n**Solution B**: Change the registry to increase the timeout value.\n\nWe suggest **Solution B.**\n\n\nTo increase the timeout value in the registry, follow these steps:\n   1. Start Registry Editor (Regedit.exe).\n   2. To change the value data for the **ServicesPipeTimeout DWORD** value to 60000 in the**Control** key, follow these steps:\n    1. Locate and then click the following registry key:\n`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet`\n    2. Click the **Control** subkey\n    3. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    4. Click **Decimal**.\n    5. Type 60000, and then click **OK**.\n\n* If the **ServicesPipeTimeout** value is _not_ available, add the new **DWORD** value, and then set its value data to 60000 in the **Control** key. To do so, follow these steps:\n    1. Locate and then click the following registry key:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\n    2. Click the **Control** subkey.\n    3. On the **Edit** menu, point to **New**, and then click **DWORD Value**.\n    4. Type ServicesPipeTimeout, and then press ENTER.\n    5. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    6. Click **Decimal**.\n    7. Type a value of 60000, and then click **OK**.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.\n>**Note **This change does not take effect until the computer is restarted","source":"_posts/reporting-service-cant-start-event-id-107.md","raw":"---\ntitle: Reporting Service can't start - Event ID 107\ntags:\n  - Reporting Service\n  - MSSQL\ncategories:\n  - Microsoft\n  - SQL数据库\ndate: 2009-12-11 20:55:31\n---\n\nToday, one of my clients reported that, the reporting service cannot started.\nThey didn't change anything and database service is running fine.\n> Event Type: Error\nEvent Source: Report Server Windows Service (MSSQLSERVER)\nEvent Category: Management\nEvent ID: 107\nDate: 12/10/2009\nTime: 11:53:21 PM\nUser: N/A\nComputer: ABC\nDescription:\nReport Server Windows Service (MSSQLSERVER) cannot connect to the report server database.\n\n> Event Type: Error\nEvent Source: Service Control Manager\nEvent Category: None\nEvent ID: 7000\nDate: 7/27/2008\nTime: 7:26:24 PM\nUser: N/A\nComputer: PRODB\nDescription:\nThe SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:\nThe service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.\n\nThe Reporting Services logs mostly just repeat that \"The Report Server Windows service 'ReportServer' is not running.\" ...\n\nThis issue was caused by a windows hotfix - **KB948109**, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.\n\nThere are 2 ways can make it resolved.\n\n**Solution A**: Use Add/Remove to uninstall this hotfix **KB948109**.\n\n**Solution B**: Change the registry to increase the timeout value.\n\nWe suggest **Solution B.**\n\n\nTo increase the timeout value in the registry, follow these steps:\n   1. Start Registry Editor (Regedit.exe).\n   2. To change the value data for the **ServicesPipeTimeout DWORD** value to 60000 in the**Control** key, follow these steps:\n    1. Locate and then click the following registry key:\n`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet`\n    2. Click the **Control** subkey\n    3. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    4. Click **Decimal**.\n    5. Type 60000, and then click **OK**.\n\n* If the **ServicesPipeTimeout** value is _not_ available, add the new **DWORD** value, and then set its value data to 60000 in the **Control** key. To do so, follow these steps:\n    1. Locate and then click the following registry key:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\n    2. Click the **Control** subkey.\n    3. On the **Edit** menu, point to **New**, and then click **DWORD Value**.\n    4. Type ServicesPipeTimeout, and then press ENTER.\n    5. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    6. Click **Decimal**.\n    7. Type a value of 60000, and then click **OK**.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.\n>**Note **This change does not take effect until the computer is restarted","slug":"reporting-service-cant-start-event-id-107","published":1,"updated":"2020-01-05T09:00:54.022Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kur006sk84s3qgtd853","content":"<html><head></head><body><p>Today, one of my clients reported that, the reporting service cannot started.<br>They didn’t change anything and database service is running fine.</p>\n<blockquote>\n<p>Event Type: Error<br>Event Source: Report Server Windows Service (MSSQLSERVER)<br>Event Category: Management<br>Event ID: 107<br>Date: 12/10/2009<br>Time: 11:53:21 PM<br>User: N/A<br>Computer: ABC<br>Description:<br>Report Server Windows Service (MSSQLSERVER) cannot connect to the report server database.</p>\n</blockquote>\n<blockquote>\n<p>Event Type: Error<br>Event Source: Service Control Manager<br>Event Category: None<br>Event ID: 7000<br>Date: 7/27/2008<br>Time: 7:26:24 PM<br>User: N/A<br>Computer: PRODB<br>Description:<br>The SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:<br>The service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at <a href=\"http://go.microsoft.com/fwlink/events.asp\">http://go.microsoft.com/fwlink/events.asp</a>.</p>\n</blockquote>\n<p>The Reporting Services logs mostly just repeat that “The Report Server Windows service ‘ReportServer’ is not running.” …</p>\n<p>This issue was caused by a windows hotfix -&nbsp;<strong>KB948109</strong>, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.</p>\n<p>There are 2 ways can make it resolved.</p>\n<p><strong>Solution A</strong>: Use Add/Remove to uninstall this hotfix&nbsp;<strong>KB948109</strong>.</p>\n<p><strong>Solution B</strong>: Change the registry to increase the timeout value.</p>\n<p>We suggest&nbsp;<strong>Solution B.</strong></p>\n<p>To increase the timeout value in the registry, follow these steps:</p>\n<ol>\n<li>Start Registry Editor (Regedit.exe).</li>\n<li>To change the value data for the&nbsp;<strong>ServicesPipeTimeout DWORD</strong>&nbsp;value to 60000 in the<strong>Control</strong>&nbsp;key, follow these steps:<br>1. Locate and then click the following registry key:<br><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</code><br>2. Click the&nbsp;<strong>Control</strong>&nbsp;subkey<br>3. Right-click the&nbsp;<strong>ServicesPipeTimeout DWORD</strong>&nbsp;value, and then click&nbsp;<strong>Modify</strong>.<br>4. Click&nbsp;<strong>Decimal</strong>.<br>5. Type&nbsp;60000, and then click&nbsp;<strong>OK</strong>.</li>\n</ol>\n<ul>\n<li>If the&nbsp;<strong>ServicesPipeTimeout</strong>&nbsp;value is&nbsp;<em>not</em>&nbsp;available, add the new&nbsp;<strong>DWORD</strong>&nbsp;value, and then set its value data to 60000 in the&nbsp;<strong>Control</strong>&nbsp;key. To do so, follow these steps:<ol>\n<li>Locate and then click the following registry key:<br>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</li>\n<li>Click the&nbsp;<strong>Control</strong>&nbsp;subkey.</li>\n<li>On the&nbsp;<strong>Edit</strong>&nbsp;menu, point to&nbsp;<strong>New</strong>, and then click&nbsp;<strong>DWORD Value</strong>.</li>\n<li>Type&nbsp;ServicesPipeTimeout, and then press ENTER.</li>\n<li>Right-click the&nbsp;<strong>ServicesPipeTimeout DWORD</strong>&nbsp;value, and then click&nbsp;<strong>Modify</strong>.</li>\n<li>Click&nbsp;<strong>Decimal</strong>.</li>\n<li>Type a value of&nbsp;60000, and then click&nbsp;<strong>OK</strong>.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.<blockquote>\n<p>**Note&nbsp;**This change does not take effect until the computer is restarted</p>\n</blockquote>\n</li>\n</ol>\n</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Today, one of my clients reported that, the reporting service cannot started.<br>They didn’t change anything and database service is running fine.</p>\n<blockquote>\n<p>Event Type: Error<br>Event Source: Report Server Windows Service (MSSQLSERVER)<br>Event Category: Management<br>Event ID: 107<br>Date: 12/10/2009<br>Time: 11:53:21 PM<br>User: N/A<br>Computer: ABC<br>Description:<br>Report Server Windows Service (MSSQLSERVER) cannot connect to the report server database.</p>\n</blockquote>\n<blockquote>\n<p>Event Type: Error<br>Event Source: Service Control Manager<br>Event Category: None<br>Event ID: 7000<br>Date: 7/27/2008<br>Time: 7:26:24 PM<br>User: N/A<br>Computer: PRODB<br>Description:<br>The SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:<br>The service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at <a href=\"http://go.microsoft.com/fwlink/events.asp\">http://go.microsoft.com/fwlink/events.asp</a>.</p>\n</blockquote>\n<p>The Reporting Services logs mostly just repeat that “The Report Server Windows service ‘ReportServer’ is not running.” …</p>\n<p>This issue was caused by a windows hotfix -&nbsp;<strong>KB948109</strong>, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.</p>\n<p>There are 2 ways can make it resolved.</p>\n<p><strong>Solution A</strong>: Use Add/Remove to uninstall this hotfix&nbsp;<strong>KB948109</strong>.</p>\n<p><strong>Solution B</strong>: Change the registry to increase the timeout value.</p>\n<p>We suggest&nbsp;<strong>Solution B.</strong></p>\n<p>To increase the timeout value in the registry, follow these steps:</p>\n<ol>\n<li>Start Registry Editor (Regedit.exe).</li>\n<li>To change the value data for the&nbsp;<strong>ServicesPipeTimeout DWORD</strong>&nbsp;value to 60000 in the<strong>Control</strong>&nbsp;key, follow these steps:<br>1. Locate and then click the following registry key:<br><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</code><br>2. Click the&nbsp;<strong>Control</strong>&nbsp;subkey<br>3. Right-click the&nbsp;<strong>ServicesPipeTimeout DWORD</strong>&nbsp;value, and then click&nbsp;<strong>Modify</strong>.<br>4. Click&nbsp;<strong>Decimal</strong>.<br>5. Type&nbsp;60000, and then click&nbsp;<strong>OK</strong>.</li>\n</ol>\n<ul>\n<li>If the&nbsp;<strong>ServicesPipeTimeout</strong>&nbsp;value is&nbsp;<em>not</em>&nbsp;available, add the new&nbsp;<strong>DWORD</strong>&nbsp;value, and then set its value data to 60000 in the&nbsp;<strong>Control</strong>&nbsp;key. To do so, follow these steps:<ol>\n<li>Locate and then click the following registry key:<br>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</li>\n<li>Click the&nbsp;<strong>Control</strong>&nbsp;subkey.</li>\n<li>On the&nbsp;<strong>Edit</strong>&nbsp;menu, point to&nbsp;<strong>New</strong>, and then click&nbsp;<strong>DWORD Value</strong>.</li>\n<li>Type&nbsp;ServicesPipeTimeout, and then press ENTER.</li>\n<li>Right-click the&nbsp;<strong>ServicesPipeTimeout DWORD</strong>&nbsp;value, and then click&nbsp;<strong>Modify</strong>.</li>\n<li>Click&nbsp;<strong>Decimal</strong>.</li>\n<li>Type a value of&nbsp;60000, and then click&nbsp;<strong>OK</strong>.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.<blockquote>\n<p>**Note&nbsp;**This change does not take effect until the computer is restarted</p>\n</blockquote>\n</li>\n</ol>\n</li>\n</ul>\n</body></html>"},{"title":"Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part1","date":"2013-07-09T04:54:20.000Z","_content":"\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n![Domain relationship error](solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg)\n\n退出域重新加域，问题依旧。\n\n最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的\n\nservicePrincipalName:\n- HOST/SRV1\n- <span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span>\n- RestrictedKrbHost/SRV1\n- <span style=\"color: #ff0000\">\nRestrictedKrbHost/srv1.mydomainname.com</span>\nTERMSRV/SRV1\n- <span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span>\n\n缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可\n","source":"_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1.md","raw":"---\ntitle: 'Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part1'\ntags:\n  - SPN\n  - Active Directory\ncategories:\n  - Microsoft\n  - 活动目录\ndate: 2013-07-09 12:54:20\n---\n\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n![Domain relationship error](solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg)\n\n退出域重新加域，问题依旧。\n\n最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的\n\nservicePrincipalName:\n- HOST/SRV1\n- <span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span>\n- RestrictedKrbHost/SRV1\n- <span style=\"color: #ff0000\">\nRestrictedKrbHost/srv1.mydomainname.com</span>\nTERMSRV/SRV1\n- <span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span>\n\n缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可\n","slug":"solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1","published":1,"updated":"2020-01-05T09:00:54.022Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kur006uk84s4d0khoj2","content":"<html><head></head><body><p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p><img src=\"/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg\" alt=\"Domain relationship error\"></p>\n<p>退出域重新加域，问题依旧。</p>\n<p>最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的</p>\n<p>servicePrincipalName:</p>\n<ul>\n<li>HOST/SRV1</li>\n<li><span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span></li>\n<li>RestrictedKrbHost/SRV1</li>\n<li><span style=\"color: #ff0000\">\nRestrictedKrbHost/srv1.mydomainname.com</span>\nTERMSRV/SRV1</li>\n<li><span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span></li>\n</ul>\n<p>缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p><img src=\"/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg\" alt=\"Domain relationship error\"></p>\n<p>退出域重新加域，问题依旧。</p>\n<p>最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的</p>\n<p>servicePrincipalName:</p>\n<ul>\n<li>HOST/SRV1</li>\n<li><span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span></li>\n<li>RestrictedKrbHost/SRV1</li>\n<li><span style=\"color: #ff0000\">\nRestrictedKrbHost/srv1.mydomainname.com</span>\nTERMSRV/SRV1</li>\n<li><span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span></li>\n</ul>\n<p>缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可</p>\n</body></html>"},{"title":"Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part2","date":"2013-10-21T02:12:38.000Z","_content":"\n在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：\n\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n退出域重新加域，问题解决，可是第二天早上又在出现。\n\n检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：\n\n**Event 5722**: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:\n<span style=\"color: #ff0000\">Access is denied.</span>\n\n在用户端的电脑上，也有Event 3210 NETLOGON 报错:\n\n**Event 3210:** This computer could not authenticate with \\\\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\">**another computer on the same network using the same name** or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.\n\n注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。\n\n后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。\n\n解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)\n","source":"_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2.md","raw":"---\ntitle: 'Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part2'\ntags:\n  - Active Directory\ncategories:\n  - Microsoft\n  - 活动目录\ndate: 2013-10-21 10:12:38\n---\n\n在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：\n\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n退出域重新加域，问题解决，可是第二天早上又在出现。\n\n检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：\n\n**Event 5722**: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:\n<span style=\"color: #ff0000\">Access is denied.</span>\n\n在用户端的电脑上，也有Event 3210 NETLOGON 报错:\n\n**Event 3210:** This computer could not authenticate with \\\\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\">**another computer on the same network using the same name** or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.\n\n注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。\n\n后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。\n\n解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)\n","slug":"solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2","published":1,"updated":"2020-01-05T09:00:54.022Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kus006zk84s76b1hky8","content":"<html><head></head><body><p>在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：</p>\n<p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p>退出域重新加域，问题解决，可是第二天早上又在出现。</p>\n<p>检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：</p>\n<p><strong>Event 5722</strong>: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:<br><span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>在用户端的电脑上，也有Event 3210 NETLOGON 报错:</p>\n<p><strong>Event 3210:</strong> This computer could not authenticate with \\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\"><strong>another computer on the same network using the same name</strong> or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.</p>\n<p>注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。</p>\n<p>后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。</p>\n<p>解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：</p>\n<p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p>退出域重新加域，问题解决，可是第二天早上又在出现。</p>\n<p>检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：</p>\n<p><strong>Event 5722</strong>: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:<br><span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>在用户端的电脑上，也有Event 3210 NETLOGON 报错:</p>\n<p><strong>Event 3210:</strong> This computer could not authenticate with \\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\"><strong>another computer on the same network using the same name</strong> or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.</p>\n<p>注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。</p>\n<p>后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。</p>\n<p>解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)</p>\n</body></html>"},{"title":"SQL 2005 SP3 & Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5","date":"2009-02-25T01:48:56.000Z","_content":"\nOn a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.\n\nWindows update compatibility tests (**SQL Server 2005 SP3** &amp; **Exchange 2007 SP1 RU6**was included in this test) on HMC 4.0 as well as HMC 4.5 have completed successfully. This means SQL Server 2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.\n\nRef:\n\n##### [SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 ](http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)\n[Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5](http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)","source":"_posts/sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45.md","raw":"---\ntitle: SQL 2005 SP3 & Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5\ntags:\n  - HMC\n  - MSSQL\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-02-25 09:48:56\n---\n\nOn a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.\n\nWindows update compatibility tests (**SQL Server 2005 SP3** &amp; **Exchange 2007 SP1 RU6**was included in this test) on HMC 4.0 as well as HMC 4.5 have completed successfully. This means SQL Server 2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.\n\nRef:\n\n##### [SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 ](http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)\n[Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5](http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)","slug":"sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45","published":1,"updated":"2020-01-05T09:00:54.023Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kus0072k84s7k4g76bw","content":"<html><head></head><body><p>On a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.</p>\n<p>Windows update compatibility tests (<strong>SQL Server 2005 SP3</strong>&nbsp;&amp;&nbsp;<strong>Exchange 2007 SP1 RU6</strong>was included in this test) on HMC 4.0 as well as HMC 4.5&nbsp;have completed successfully. This means&nbsp;SQL Server&nbsp;2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.</p>\n<p>Ref:</p>\n<h5 id=\"SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\"><a href=\"#SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\" class=\"headerlink\" title=\"SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5&nbsp;\"></a><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\">SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5&nbsp;</a></h5><p><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\">Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5</a></p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>On a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.</p>\n<p>Windows update compatibility tests (<strong>SQL Server 2005 SP3</strong>&nbsp;&amp;&nbsp;<strong>Exchange 2007 SP1 RU6</strong>was included in this test) on HMC 4.0 as well as HMC 4.5&nbsp;have completed successfully. This means&nbsp;SQL Server&nbsp;2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.</p>\n<p>Ref:</p>\n<h5 id=\"SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\"><a href=\"#SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\" class=\"headerlink\" title=\"SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5&nbsp;\"></a><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\">SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5&nbsp;</a></h5><p><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\">Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5</a></p>\n</body></html>"},{"title":"腾讯公益404页面现已支持 https","date":"2018-03-16T08:48:35.000Z","keywords":"Web, 404, https, 腾讯","description":"公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。但之前都不支持 https，这两天因为打算将本站的国内镜像站点挂到 Coding.net，然后启用全站 https，这才发现不知道啥时候腾讯公益404页面现已支持 https。","_content":"\n### 公益 404 页面介绍\n[公益404页面](http://www.qq.com/404/)是由腾讯公司员工志愿者自主发起的互联网公益活动。\n\n网站只需要在自己的404页面中嵌入一段简单的代码，就能通过互联网来迅速传播失踪儿童信息，从而提高找回失踪儿童的概率。失踪儿童信息来自宝贝回家寻子网。\n\n之前不支持 https，这两天因为打算将本站的国内镜像站点挂到 Coding.net，然后启用全站 https，这才发现不知道啥时候腾讯公益404页面现已支持 https。\n\n### 公益 404 页面接入方法\n> 注意事项\n如果一个 404 页面的内容小于 512B，IE 会认为该 404 页面不够友好，在 IE 下将不会成功返回该 404 错误页面\n\n复制以下 js 代码，嵌入到您的 404 页面，可以自适应移动设备。\n\n旧版本的嵌入代码：\n```html\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\"></script>\n```\n\n新版本的嵌入代码：\n```html\n<script type=\"text/javascript\" src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\"></script>\n```\n\n### 结语\n可以看到，新的 js 引用源并没有写死是 http 还是 https 协议，这样写的好处就是它会根据你自己网站的情况来自动匹配。\n本站已启用全站 https，所以最终的引用地址就会是\n[**https**://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js](https://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js)\n不管怎样，还是要给鹅厂一个赞。\n","source":"_posts/tencent-404-support-https-now.md","raw":"---\ntitle: 腾讯公益404页面现已支持 https\ntags:\n  - Web, 404, https, 腾讯\ncategories:\n  - 网站相关\ndate: 2018-03-16 16:48:35\nkeywords: Web, 404, https, 腾讯\ndescription: 公益404页面是由腾讯公司员工志愿者自主发起的互联网公益活动。但之前都不支持 https，这两天因为打算将本站的国内镜像站点挂到 Coding.net，然后启用全站 https，这才发现不知道啥时候腾讯公益404页面现已支持 https。\n---\n\n### 公益 404 页面介绍\n[公益404页面](http://www.qq.com/404/)是由腾讯公司员工志愿者自主发起的互联网公益活动。\n\n网站只需要在自己的404页面中嵌入一段简单的代码，就能通过互联网来迅速传播失踪儿童信息，从而提高找回失踪儿童的概率。失踪儿童信息来自宝贝回家寻子网。\n\n之前不支持 https，这两天因为打算将本站的国内镜像站点挂到 Coding.net，然后启用全站 https，这才发现不知道啥时候腾讯公益404页面现已支持 https。\n\n### 公益 404 页面接入方法\n> 注意事项\n如果一个 404 页面的内容小于 512B，IE 会认为该 404 页面不够友好，在 IE 下将不会成功返回该 404 错误页面\n\n复制以下 js 代码，嵌入到您的 404 页面，可以自适应移动设备。\n\n旧版本的嵌入代码：\n```html\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\"></script>\n```\n\n新版本的嵌入代码：\n```html\n<script type=\"text/javascript\" src=\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\" charset=\"utf-8\"></script>\n```\n\n### 结语\n可以看到，新的 js 引用源并没有写死是 http 还是 https 协议，这样写的好处就是它会根据你自己网站的情况来自动匹配。\n本站已启用全站 https，所以最终的引用地址就会是\n[**https**://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js](https://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js)\n不管怎样，还是要给鹅厂一个赞。\n","slug":"tencent-404-support-https-now","published":1,"updated":"2020-01-05T09:00:54.023Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuu0077k84s2059ct2d","content":"<html><head></head><body><h3 id=\"公益-404-页面介绍\"><a href=\"#公益-404-页面介绍\" class=\"headerlink\" title=\"公益 404 页面介绍\"></a>公益 404 页面介绍</h3><p><a href=\"http://www.qq.com/404/\">公益404页面</a>是由腾讯公司员工志愿者自主发起的互联网公益活动。</p>\n<p>网站只需要在自己的404页面中嵌入一段简单的代码，就能通过互联网来迅速传播失踪儿童信息，从而提高找回失踪儿童的概率。失踪儿童信息来自宝贝回家寻子网。</p>\n<p>之前不支持 https，这两天因为打算将本站的国内镜像站点挂到 Coding.net，然后启用全站 https，这才发现不知道啥时候腾讯公益404页面现已支持 https。</p>\n<h3 id=\"公益-404-页面接入方法\"><a href=\"#公益-404-页面接入方法\" class=\"headerlink\" title=\"公益 404 页面接入方法\"></a>公益 404 页面接入方法</h3><blockquote>\n<p>注意事项<br>如果一个 404 页面的内容小于 512B，IE 会认为该 404 页面不够友好，在 IE 下将不会成功返回该 404 错误页面</p>\n</blockquote>\n<p>复制以下 js 代码，嵌入到您的 404 页面，可以自适应移动设备。</p>\n<p>旧版本的嵌入代码：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://www.qq.com/404/search_children.js\"</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>新版本的嵌入代码：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\"</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h3><p>可以看到，新的 js 引用源并没有写死是 http 还是 https 协议，这样写的好处就是它会根据你自己网站的情况来自动匹配。<br>本站已启用全站 https，所以最终的引用地址就会是<br><a href=\"https://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\"><strong>https</strong>://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js</a><br>不管怎样，还是要给鹅厂一个赞。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><h3 id=\"公益-404-页面介绍\"><a href=\"#公益-404-页面介绍\" class=\"headerlink\" title=\"公益 404 页面介绍\"></a>公益 404 页面介绍</h3><p><a href=\"http://www.qq.com/404/\">公益404页面</a>是由腾讯公司员工志愿者自主发起的互联网公益活动。</p>\n<p>网站只需要在自己的404页面中嵌入一段简单的代码，就能通过互联网来迅速传播失踪儿童信息，从而提高找回失踪儿童的概率。失踪儿童信息来自宝贝回家寻子网。</p>\n<p>之前不支持 https，这两天因为打算将本站的国内镜像站点挂到 Coding.net，然后启用全站 https，这才发现不知道啥时候腾讯公益404页面现已支持 https。</p>\n<h3 id=\"公益-404-页面接入方法\"><a href=\"#公益-404-页面接入方法\" class=\"headerlink\" title=\"公益 404 页面接入方法\"></a>公益 404 页面接入方法</h3><blockquote>\n<p>注意事项<br>如果一个 404 页面的内容小于 512B，IE 会认为该 404 页面不够友好，在 IE 下将不会成功返回该 404 错误页面</p>\n</blockquote>\n<p>复制以下 js 代码，嵌入到您的 404 页面，可以自适应移动设备。</p>\n<p>旧版本的嵌入代码：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"http://www.qq.com/404/search_children.js\"</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<p>新版本的嵌入代码：</p>\n<figure class=\"highlight html\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span> <span class=\"attr\">type</span>=<span class=\"string\">\"text/javascript\"</span> <span class=\"attr\">src</span>=<span class=\"string\">\"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\"</span> <span class=\"attr\">charset</span>=<span class=\"string\">\"utf-8\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n\n<h3 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h3><p>可以看到，新的 js 引用源并没有写死是 http 还是 https 协议，这样写的好处就是它会根据你自己网站的情况来自动匹配。<br>本站已启用全站 https，所以最终的引用地址就会是<br><a href=\"https://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js\"><strong>https</strong>://qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js</a><br>不管怎样，还是要给鹅厂一个赞。</p>\n</body></html>"},{"title":"The ReportServerVirtualDirectory element is missing","date":"2009-05-29T07:58:37.000Z","_content":"\nInstall SQL Server 2005 on a Windows Server 2008, when use your browser to access http://localhost/reports, you received below error msg:\n> \"_An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing._ \"\n\nAfter doing some search&amp;research, this is the workaround.\n\nLookin the RSWebApplication.config for the\n```xml\n<ReportServerVirtualDirectory>\n```\nIt will look something like this\n```xml\n<ReportServerVirtualDirectory>\n</ReportServerVirtualDirectory>\n```\nchange to\n```xml\n<ReportServerVirtualDirectory>ReportServer</ReportServerVirtualDirectory>\n```","source":"_posts/the-reportservervirtualdirectory-element-is-missing.md","raw":"---\ntitle: The ReportServerVirtualDirectory element is missing\ntags:\n  - Reporting Service\n  - MSSQL\ncategories:\n  - Microsoft\n  - SQL数据库\ndate: 2009-05-29 15:58:37\n---\n\nInstall SQL Server 2005 on a Windows Server 2008, when use your browser to access http://localhost/reports, you received below error msg:\n> \"_An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing._ \"\n\nAfter doing some search&amp;research, this is the workaround.\n\nLookin the RSWebApplication.config for the\n```xml\n<ReportServerVirtualDirectory>\n```\nIt will look something like this\n```xml\n<ReportServerVirtualDirectory>\n</ReportServerVirtualDirectory>\n```\nchange to\n```xml\n<ReportServerVirtualDirectory>ReportServer</ReportServerVirtualDirectory>\n```","slug":"the-reportservervirtualdirectory-element-is-missing","published":1,"updated":"2020-01-05T09:00:54.023Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuv0079k84s79rt6lls","content":"<html><head></head><body><p>Install SQL Server 2005 on a Windows Server 2008, when use your browser to access <a href=\"http://localhost/reports\">http://localhost/reports</a>, you received below error msg:</p>\n<blockquote>\n<p>“<em>An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing.</em>&nbsp;“</p>\n</blockquote>\n<p>After doing some search&amp;research, this is the workaround.</p>\n<p>Lookin the RSWebApplication.config for the</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>It will look something like this</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>change to</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span>ReportServer<span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>Install SQL Server 2005 on a Windows Server 2008, when use your browser to access <a href=\"http://localhost/reports\">http://localhost/reports</a>, you received below error msg:</p>\n<blockquote>\n<p>“<em>An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing.</em>&nbsp;“</p>\n</blockquote>\n<p>After doing some search&amp;research, this is the workaround.</p>\n<p>Lookin the RSWebApplication.config for the</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>It will look something like this</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>\n<p>change to</p>\n<figure class=\"highlight xml\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span>ReportServer<span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure></body></html>"},{"title":"The specified CGI application encountered an error and the server terminated the process","date":"2013-03-10T04:47:37.000Z","_content":"\n最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误\n\n**The specified CGI application encountered an error and the server terminated the process**\n\n而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。\n\n而今天在访问 Google Analytics 时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！\n\n以下是 Chrome 的 Cookie 清除示例\n![Remove Chrome Cookies](the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg)\n\n在地址栏中输入 **chrome://settings/content** 回车，在 Cookies 下面选择 All cookies and site data... ，在搜索框中输入`microsoft.com` 列出所有 microsoft.com 相关的 cookies，点击 **Remove all** 清除， done 完成！","source":"_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process.md","raw":"---\ntitle: The specified CGI application encountered an error and the server terminated the process\ntags:\n  - Chrome\n  - Cookie\n  - Microsoft\n  - MSDN\ncategories:\n  - Microsoft\ndate: 2013-03-10 12:47:37\n---\n\n最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误\n\n**The specified CGI application encountered an error and the server terminated the process**\n\n而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。\n\n而今天在访问 Google Analytics 时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！\n\n以下是 Chrome 的 Cookie 清除示例\n![Remove Chrome Cookies](the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg)\n\n在地址栏中输入 **chrome://settings/content** 回车，在 Cookies 下面选择 All cookies and site data... ，在搜索框中输入`microsoft.com` 列出所有 microsoft.com 相关的 cookies，点击 **Remove all** 清除， done 完成！","slug":"the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process","published":1,"updated":"2020-01-05T09:00:54.023Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuv007dk84s8p852ce5","content":"<html><head></head><body><p>最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误</p>\n<p><strong>The specified CGI application encountered an error and the server terminated the process</strong></p>\n<p>而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。</p>\n<p>而今天在访问 Google&nbsp;Analytics&nbsp;时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！</p>\n<p>以下是 Chrome 的 Cookie 清除示例<br><img src=\"/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg\" alt=\"Remove Chrome Cookies\"></p>\n<p>在地址栏中输入 <strong>chrome://settings/content</strong> 回车，在 Cookies 下面选择 All cookies and site data… ，在搜索框中输入<code>microsoft.com</code> 列出所有 microsoft.com 相关的 cookies，点击 <strong>Remove all</strong> 清除， done 完成！</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误</p>\n<p><strong>The specified CGI application encountered an error and the server terminated the process</strong></p>\n<p>而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。</p>\n<p>而今天在访问 Google&nbsp;Analytics&nbsp;时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！</p>\n<p>以下是 Chrome 的 Cookie 清除示例<br><img src=\"/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg\" alt=\"Remove Chrome Cookies\"></p>\n<p>在地址栏中输入 <strong>chrome://settings/content</strong> 回车，在 Cookies 下面选择 All cookies and site data… ，在搜索框中输入<code>microsoft.com</code> 列出所有 microsoft.com 相关的 cookies，点击 <strong>Remove all</strong> 清除， done 完成！</p>\n</body></html>"},{"title":"Unofficial Consolidated Server Deployment Guide For HMC4.0","date":"2007-06-05T04:26:06.000Z","_content":"\n这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。\n\nPDF文档下载 {% asset_link HMC4.0_CDG_Draft.pdf Unofficial Consolidated Server Deployment Guide %}\n\nServer Names:\n\n* AD01 :    Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* FE01:     Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n\n* ExCAS01:  Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* ExMBX01:  Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* ISA01:    Windows Server 2003, Standard Edition SP2 with R2, 32-bit\n\n* ExEdge01: Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* MPSSQL01: Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n","source":"_posts/unofficial-consolidated-server-deployment-guide-for-hmc4.md","raw":"---\ntitle: Unofficial Consolidated Server Deployment Guide For HMC4.0\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2007-06-05 12:26:06\n---\n\n这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。\n\nPDF文档下载 {% asset_link HMC4.0_CDG_Draft.pdf Unofficial Consolidated Server Deployment Guide %}\n\nServer Names:\n\n* AD01 :    Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* FE01:     Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n\n* ExCAS01:  Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* ExMBX01:  Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* ISA01:    Windows Server 2003, Standard Edition SP2 with R2, 32-bit\n\n* ExEdge01: Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* MPSSQL01: Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n","slug":"unofficial-consolidated-server-deployment-guide-for-hmc4","published":1,"updated":"2020-01-05T09:00:54.024Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuw007fk84sfcrg8isj","content":"<html><head></head><body><p>这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。</p>\n<p>PDF文档下载&nbsp;<a href=\"/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf\" title=\"Unofficial Consolidated Server Deployment Guide\">Unofficial Consolidated Server Deployment Guide</a></p>\n<p>Server Names:</p>\n<ul>\n<li><p>AD01 :&nbsp;&nbsp;&nbsp; Windows&nbsp;Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>FE01:     Windows&nbsp;Server 2003, Standard&nbsp;Edition&nbsp;SP1 with R2, 32-bit</p>\n</li>\n<li><p>ExCAS01:&nbsp; Windows&nbsp;Server 2003,&nbsp;&nbsp;Standard&nbsp;Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ExMBX01:&nbsp; Windows&nbsp;Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ISA01:&nbsp;&nbsp;  Windows&nbsp;Server 2003, Standard&nbsp;Edition&nbsp;SP2 with R2, 32-bit</p>\n</li>\n<li><p>ExEdge01: Windows&nbsp;Server 2003,&nbsp;&nbsp;Standard&nbsp;Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>MPSSQL01: Windows&nbsp;Server 2003, Standard&nbsp;Edition&nbsp;SP1 with R2, 32-bit</p>\n</li>\n</ul>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。</p>\n<p>PDF文档下载&nbsp;<a href=\"/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf\" title=\"Unofficial Consolidated Server Deployment Guide\">Unofficial Consolidated Server Deployment Guide</a></p>\n<p>Server Names:</p>\n<ul>\n<li><p>AD01 :&nbsp;&nbsp;&nbsp; Windows&nbsp;Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>FE01:     Windows&nbsp;Server 2003, Standard&nbsp;Edition&nbsp;SP1 with R2, 32-bit</p>\n</li>\n<li><p>ExCAS01:&nbsp; Windows&nbsp;Server 2003,&nbsp;&nbsp;Standard&nbsp;Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ExMBX01:&nbsp; Windows&nbsp;Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ISA01:&nbsp;&nbsp;  Windows&nbsp;Server 2003, Standard&nbsp;Edition&nbsp;SP2 with R2, 32-bit</p>\n</li>\n<li><p>ExEdge01: Windows&nbsp;Server 2003,&nbsp;&nbsp;Standard&nbsp;Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>MPSSQL01: Windows&nbsp;Server 2003, Standard&nbsp;Edition&nbsp;SP1 with R2, 32-bit</p>\n</li>\n</ul>\n</body></html>"},{"title":"升级到 Exchange 2010 SP1 后出现的2个小问题","date":"2010-09-12T03:46:31.000Z","_content":"\n今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：\n\n1.  OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误\n2.  某台 Exchange 打开 EMS 时报错如下：\n\n```\n[server.mydomain.local] Connecting to remote server failed with the following error message :\nThe client cannot connect to the destination specified in the request. Verify that the\nservice on the destination is running and is accepting requests. Consult the logs and\ndocumentation for the WS-Management service running on the destination, most commonly IIS\nor WinRM. If the destination is the WinRM service, run the following command on the\ndestination to analyze and configure the WinRM service: \"winrm quickconfig\". For more\ninformation, see the about_Remote_Troubleshooting Help topic.\n+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException\n+ FullyQualifiedErrorId : PSSessionOpenFailed\n```\n1. 这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 \"Require SSL\" 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。\n\n2. 这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。\n","source":"_posts/upgrade-to-exchange-2010-sp1-issues.md","raw":"---\ntitle: 升级到 Exchange 2010 SP1 后出现的2个小问题\ntags:\n  - Exchange\n  - PowerShell\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2010-09-12 11:46:31\n---\n\n今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：\n\n1.  OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误\n2.  某台 Exchange 打开 EMS 时报错如下：\n\n```\n[server.mydomain.local] Connecting to remote server failed with the following error message :\nThe client cannot connect to the destination specified in the request. Verify that the\nservice on the destination is running and is accepting requests. Consult the logs and\ndocumentation for the WS-Management service running on the destination, most commonly IIS\nor WinRM. If the destination is the WinRM service, run the following command on the\ndestination to analyze and configure the WinRM service: \"winrm quickconfig\". For more\ninformation, see the about_Remote_Troubleshooting Help topic.\n+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException\n+ FullyQualifiedErrorId : PSSessionOpenFailed\n```\n1. 这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 \"Require SSL\" 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。\n\n2. 这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。\n","slug":"upgrade-to-exchange-2010-sp1-issues","published":1,"updated":"2020-01-05T09:00:54.027Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kux007ik84sfyemajj1","content":"<html><head></head><body><p>今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：</p>\n<ol>\n<li>OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误</li>\n<li>某台 Exchange&nbsp;打开 EMS 时报错如下：</li>\n</ol>\n<figure class=\"highlight applescript\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[server.mydomain.<span class=\"keyword\">local</span>] Connecting <span class=\"keyword\">to</span> remote server failed <span class=\"keyword\">with</span> <span class=\"keyword\">the</span> following <span class=\"keyword\">error</span> message :</span><br><span class=\"line\">The client cannot connect <span class=\"keyword\">to</span> <span class=\"keyword\">the</span> destination specified <span class=\"keyword\">in</span> <span class=\"keyword\">the</span> request. Verify <span class=\"keyword\">that</span> <span class=\"keyword\">the</span></span><br><span class=\"line\">service <span class=\"keyword\">on</span> <span class=\"keyword\">the</span> destination <span class=\"keyword\">is</span> <span class=\"built_in\">running</span> <span class=\"keyword\">and</span> <span class=\"keyword\">is</span> accepting requests. Consult <span class=\"keyword\">the</span> logs <span class=\"keyword\">and</span></span><br><span class=\"line\">documentation <span class=\"keyword\">for</span> <span class=\"keyword\">the</span> WS-Management service <span class=\"built_in\">running</span> <span class=\"keyword\">on</span> <span class=\"keyword\">the</span> destination, most commonly IIS</span><br><span class=\"line\"><span class=\"keyword\">or</span> WinRM. If <span class=\"keyword\">the</span> destination <span class=\"keyword\">is</span> <span class=\"keyword\">the</span> WinRM service, <span class=\"built_in\">run</span> <span class=\"keyword\">the</span> following command <span class=\"keyword\">on</span> <span class=\"keyword\">the</span></span><br><span class=\"line\">destination <span class=\"keyword\">to</span> analyze <span class=\"keyword\">and</span> configure <span class=\"keyword\">the</span> WinRM service: <span class=\"string\">\"winrm quickconfig\"</span>. For more</span><br><span class=\"line\">information, see <span class=\"keyword\">the</span> about_Remote_Troubleshooting Help topic.</span><br><span class=\"line\">+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException</span><br><span class=\"line\">+ FullyQualifiedErrorId : PSSessionOpenFailed</span><br></pre></td></tr></tbody></table></figure>\n<ol>\n<li><p>这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 “Require SSL” 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。</p>\n</li>\n<li><p>这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。</p>\n</li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：</p>\n<ol>\n<li>OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误</li>\n<li>某台 Exchange&nbsp;打开 EMS 时报错如下：</li>\n</ol>\n<figure class=\"highlight applescript\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[server.mydomain.<span class=\"keyword\">local</span>] Connecting <span class=\"keyword\">to</span> remote server failed <span class=\"keyword\">with</span> <span class=\"keyword\">the</span> following <span class=\"keyword\">error</span> message :</span><br><span class=\"line\">The client cannot connect <span class=\"keyword\">to</span> <span class=\"keyword\">the</span> destination specified <span class=\"keyword\">in</span> <span class=\"keyword\">the</span> request. Verify <span class=\"keyword\">that</span> <span class=\"keyword\">the</span></span><br><span class=\"line\">service <span class=\"keyword\">on</span> <span class=\"keyword\">the</span> destination <span class=\"keyword\">is</span> <span class=\"built_in\">running</span> <span class=\"keyword\">and</span> <span class=\"keyword\">is</span> accepting requests. Consult <span class=\"keyword\">the</span> logs <span class=\"keyword\">and</span></span><br><span class=\"line\">documentation <span class=\"keyword\">for</span> <span class=\"keyword\">the</span> WS-Management service <span class=\"built_in\">running</span> <span class=\"keyword\">on</span> <span class=\"keyword\">the</span> destination, most commonly IIS</span><br><span class=\"line\"><span class=\"keyword\">or</span> WinRM. If <span class=\"keyword\">the</span> destination <span class=\"keyword\">is</span> <span class=\"keyword\">the</span> WinRM service, <span class=\"built_in\">run</span> <span class=\"keyword\">the</span> following command <span class=\"keyword\">on</span> <span class=\"keyword\">the</span></span><br><span class=\"line\">destination <span class=\"keyword\">to</span> analyze <span class=\"keyword\">and</span> configure <span class=\"keyword\">the</span> WinRM service: <span class=\"string\">\"winrm quickconfig\"</span>. For more</span><br><span class=\"line\">information, see <span class=\"keyword\">the</span> about_Remote_Troubleshooting Help topic.</span><br><span class=\"line\">+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException</span><br><span class=\"line\">+ FullyQualifiedErrorId : PSSessionOpenFailed</span><br></pre></td></tr></tbody></table></figure>\n<ol>\n<li><p>这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 “Require SSL” 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。</p>\n</li>\n<li><p>这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。</p>\n</li>\n</ol>\n</body></html>"},{"title":"Cisco 路由器作为 DHCP 服务器在 Skyepe for Business (Lync) 部署中的注意事项","date":"2018-11-05T07:40:11.000Z","keywords":"Skype for Business, Lync, Cisco, DHCP","description":"Cisco 路由器作为 DHCP 服务器在 Skyepe for Business (Lync) 部署中的注意事项","_content":"\n### 前言\n这个问题是以前遇到过的，最近又有人问起，索性在此记录一下：\n\n在部署 Skype/Lync 过程中，我们需要用到 DHCP Option 120 和 43，通常来说，我们会使用 Windows 服务器来做 DHCP，但有的时候，我们在分支机构可能会使用本地的路由器来当 DHCP 服务器，Option 120 通常没有问题，而坑出现在 Option 43, 因为 Skype 走的是 TCP，而且是 SIP over TLS，所以 Option 43 里面是不可以用 IP 地址的，必须要用 FQDN，而且大多数设备需要输入16进制而不是 ASCII 码，那这个时候，你有可能会遇到以下两种情况：\n\n<!--more-->\n\n1. 你的 SIP 服务器的 FQDN 名字长度很短，没有超过23个字符，那么使用 DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会在180个字符以内，这种情况使用思科路由器作 DHCP 没有问题:\n``` msdos\nC:\\Program Files\\Common Files\\Skype for Business Server 2015>DHCPUtil.exe -sipserver server.fqdn.company.com\nSIP Server FQDN : server.fqdn.company.com\nCertificate Provisioning Service URL : https://server.fqdn.company.com:443/CertProv/CertProvisioningService.svc\n\nOption 120:\n0006736572766572046671646E07636F6D70616E7903636F6D00\n\nVendor Class Identifier: MS-UC-Client\nOption 43 (for vendor=MS-UC-Client):\n        Full Option 43 value (Length: 180) : \n        010C4D532D55432D436C69656E740205687474707303177365727665722E6671646E2E636F6\n        D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n        sub-option 1 <UC Identifier>: 4D532D55432D436C69656E74\n        sub-option 2 <URL Scheme>: 6874747073\n        sub-option 3 <Web Server FQDN>: 7365727665722E6671646E2E636F6D70616E792E636F6D\n        sub-option 4 <Port>: 343433\n        sub-option 5 <Relative Path for Cert Prov>: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n\nTo configure DHCP Server with appropriate values, you can do one of the following things:\n        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch\n        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):\n\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0006736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 \n7365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n```\n### 踩坑\n2. 一旦你的 SIP 服务器的 FQDN 名字长度超过23个字符，DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会超过180个字符：\n``` msdos\nC:\\Program Files\\Common Files\\Skype for Business Server 2015>DHCPUtil.exe -sipserver sipserver.fqdn.company.com\nSIP Server FQDN : sipserver.fqdn.company.com\nCertificate Provisioning Service URL : https://sipserver.fqdn.company.com:443/CertProv/CertProvisioningService.svc\n\nOption 120:\n0009736970736572766572046671646E07636F6D70616E7903636F6D00\n\nVendor Class Identifier: MS-UC-Client\nOption 43 (for vendor=MS-UC-Client):\n        Full Option 43 value (Length: 186) : \n        010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2\n        E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n        sub-option 1 <UC Identifier>: 4D532D55432D436C69656E74\n        sub-option 2 <URL Scheme>: 6874747073\n        sub-option 3 <Web Server FQDN>: 7369707365727665722E6671646E2E636F6D70616E792E636F6D\n        sub-option 4 <Port>: 343433\n        sub-option 5 <Relative Path for Cert Prov>: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n\nTo configure DHCP Server with appropriate values, you can do one of the following things:\n        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch\n        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):\n\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0009736970736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 7369707365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n```\n\n这个时候，坑就来了，当你复制 Option 43 这一段去到思科路由器上的时候，路由器并不会报错，但是会将你输入的值截短至**180**个字符\n\n而且没有任何提示，如果是在部署 Skype 电话的时候，你会发现 PIN 认证始终没法出现，你要不仔细检查的话是发现不了问题。\n\n输入的命令\n``` plain\nip dhcp pool POOL1\n network 192.168.10.0 255.255.255.0\n domain-name corp.company.local\n dns-server 119.29.29.29 8.8.8.8\n default-router 192.168.10.1\n option 43 hex 010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n option 120 hex 0009736970736572766572046671646E07636F6D70616E7903636F6D00\n lease 1\n```\n\n路由器接受的：\n``` plain\nip dhcp pool POOL1\n network 192.168.10.0 255.255.255.0\n domain-name corp.company.local\n dns-server 119.29.29.29 8.8.8.8\n default-router 192.168.10.1\n option 43 hex 010c.4d53.2d55.432d.436c.6965.6e74.0205.6874.7470.7303.1a73.6970.7365.7276.6572.2e66.7164.6e2e.636f.6d70.616e.792e.636f.6d04.0334.3433.0525.2f43.6572.7450.726f.762f.4365.7274.5072.6f76.6973.696f.6e69.6e67.5365.7276.6963.652e\n option 120 hex 0009.7369.7073.6572.7665.7204.6671.646e.0763.6f6d.7061.6e79.0363.6f6d.00\n lease 1\n```\n可以看到，Option 43 最后的6个字符 **737663** 被吃了！\n\n思科对此的解释如下，自 IOS 15.1(3)S 以后，Option 后面跟的 hex 部分做了长度限制，超过 180 字符的部分将被截短。\n\n| Release | Modification |\n| - | - |\n| 12.0(1)T | This command was introduced. |\n|12.2(33)SRA | This command was integrated into Cisco IOS Release 12.2(33)SRA. |\n| 12.2SX | This command was supported in the Cisco IOS Release 12.2SX train. Support in a specific 12.2SX release of this train depends on your feature set, platform, and platform hardware. |\n| 12.4(24)T | This command was modified. The none keyword was added. |\n| 15.1(3)S | This command was modified. A maximum limit of 180 characters was set for the dotted hexadecimal data and 255 characters for the ASCII data. |\n\n> The hexadecimal value is truncated to 180 characters entered. Each byte in hexadecimal character strings is two hexadecimal digits. Each byte can be separated by a period, colon, or white space.\n\n\n### 解决方案\n那么有什么解决方案吗？\n\n1. 缩短你的 SIP 服务器 FQDN 名称小于等于23个字符\n2. 换用其它设备或者服务器系统作为 DHCP，比如把 DHCP 从思科路由器上移到思科交换机（思科交换机不存在这个问题）上或者干脆用 Windows Server\n3. 降级路由器的 IOS 版本至 15.1(3)S 以下\n3. 升级 IOS 版本，在 Cisco IOS XE Release 3.2.1S 之后引入了一个 option ext 的命令，这个扩展命令可以支持 255 个字节的 hex 值。\n\n> 思科官方介绍：\nUsing the option ext command you can specify an ASCII string upto 255 characters or 255 bytes of hexadecimal data.\n\n所以你的命令看起来应该是这样的：\n``` plain\nip dhcp pool POOL1\n network 192.168.10.0 255.255.255.0\n domain-name corp.company.local\n dns-server 119.29.29.29 8.8.8.8\n default-router 192.168.10.1\n option ext 43 hex Your full Option 43 hex value here - part1\n option ext 43 hex Your full Option 43 hex value here - part2\n option 120 hex Your Option 120 hex value here\n lease 1\n```\n\n如果这些方案你都没办法实施，那么在部署某些设备比如 Polycom VVX 系列的 Skype Phone 的时候，你还可以用 DHCP Override 去指定 SIP 服务的 URI：\n![Polycom VVX DHCP Override](using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg)\n\n### 附件\n最后，再附上 {% asset_link dhcputil.zip DHCPUtil.exe %} 和相关的 {% asset_link msvcr110.zip DLL文件 %} 下载，希望以上能帮到被此困扰的朋友。\n","source":"_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment.md","raw":"---\ntitle: Cisco 路由器作为 DHCP 服务器在 Skyepe for Business (Lync) 部署中的注意事项\ntags:\n  - Skype for Business\n  - Lync\n  - DHCP\n  - Cisco\ncategories:\n  - 沟通协作\ndate: 2018-11-05 15:40:11\nkeywords: Skype for Business, Lync, Cisco, DHCP\ndescription: Cisco 路由器作为 DHCP 服务器在 Skyepe for Business (Lync) 部署中的注意事项\n---\n\n### 前言\n这个问题是以前遇到过的，最近又有人问起，索性在此记录一下：\n\n在部署 Skype/Lync 过程中，我们需要用到 DHCP Option 120 和 43，通常来说，我们会使用 Windows 服务器来做 DHCP，但有的时候，我们在分支机构可能会使用本地的路由器来当 DHCP 服务器，Option 120 通常没有问题，而坑出现在 Option 43, 因为 Skype 走的是 TCP，而且是 SIP over TLS，所以 Option 43 里面是不可以用 IP 地址的，必须要用 FQDN，而且大多数设备需要输入16进制而不是 ASCII 码，那这个时候，你有可能会遇到以下两种情况：\n\n<!--more-->\n\n1. 你的 SIP 服务器的 FQDN 名字长度很短，没有超过23个字符，那么使用 DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会在180个字符以内，这种情况使用思科路由器作 DHCP 没有问题:\n``` msdos\nC:\\Program Files\\Common Files\\Skype for Business Server 2015>DHCPUtil.exe -sipserver server.fqdn.company.com\nSIP Server FQDN : server.fqdn.company.com\nCertificate Provisioning Service URL : https://server.fqdn.company.com:443/CertProv/CertProvisioningService.svc\n\nOption 120:\n0006736572766572046671646E07636F6D70616E7903636F6D00\n\nVendor Class Identifier: MS-UC-Client\nOption 43 (for vendor=MS-UC-Client):\n        Full Option 43 value (Length: 180) : \n        010C4D532D55432D436C69656E740205687474707303177365727665722E6671646E2E636F6\n        D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n        sub-option 1 <UC Identifier>: 4D532D55432D436C69656E74\n        sub-option 2 <URL Scheme>: 6874747073\n        sub-option 3 <Web Server FQDN>: 7365727665722E6671646E2E636F6D70616E792E636F6D\n        sub-option 4 <Port>: 343433\n        sub-option 5 <Relative Path for Cert Prov>: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n\nTo configure DHCP Server with appropriate values, you can do one of the following things:\n        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch\n        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):\n\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0006736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 \n7365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n```\n### 踩坑\n2. 一旦你的 SIP 服务器的 FQDN 名字长度超过23个字符，DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会超过180个字符：\n``` msdos\nC:\\Program Files\\Common Files\\Skype for Business Server 2015>DHCPUtil.exe -sipserver sipserver.fqdn.company.com\nSIP Server FQDN : sipserver.fqdn.company.com\nCertificate Provisioning Service URL : https://sipserver.fqdn.company.com:443/CertProv/CertProvisioningService.svc\n\nOption 120:\n0009736970736572766572046671646E07636F6D70616E7903636F6D00\n\nVendor Class Identifier: MS-UC-Client\nOption 43 (for vendor=MS-UC-Client):\n        Full Option 43 value (Length: 186) : \n        010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2\n        E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n        sub-option 1 <UC Identifier>: 4D532D55432D436C69656E74\n        sub-option 2 <URL Scheme>: 6874747073\n        sub-option 3 <Web Server FQDN>: 7369707365727665722E6671646E2E636F6D70616E792E636F6D\n        sub-option 4 <Port>: 343433\n        sub-option 5 <Relative Path for Cert Prov>: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n\nTo configure DHCP Server with appropriate values, you can do one of the following things:\n        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch\n        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):\n\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0009736970736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 7369707365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n```\n\n这个时候，坑就来了，当你复制 Option 43 这一段去到思科路由器上的时候，路由器并不会报错，但是会将你输入的值截短至**180**个字符\n\n而且没有任何提示，如果是在部署 Skype 电话的时候，你会发现 PIN 认证始终没法出现，你要不仔细检查的话是发现不了问题。\n\n输入的命令\n``` plain\nip dhcp pool POOL1\n network 192.168.10.0 255.255.255.0\n domain-name corp.company.local\n dns-server 119.29.29.29 8.8.8.8\n default-router 192.168.10.1\n option 43 hex 010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663\n option 120 hex 0009736970736572766572046671646E07636F6D70616E7903636F6D00\n lease 1\n```\n\n路由器接受的：\n``` plain\nip dhcp pool POOL1\n network 192.168.10.0 255.255.255.0\n domain-name corp.company.local\n dns-server 119.29.29.29 8.8.8.8\n default-router 192.168.10.1\n option 43 hex 010c.4d53.2d55.432d.436c.6965.6e74.0205.6874.7470.7303.1a73.6970.7365.7276.6572.2e66.7164.6e2e.636f.6d70.616e.792e.636f.6d04.0334.3433.0525.2f43.6572.7450.726f.762f.4365.7274.5072.6f76.6973.696f.6e69.6e67.5365.7276.6963.652e\n option 120 hex 0009.7369.7073.6572.7665.7204.6671.646e.0763.6f6d.7061.6e79.0363.6f6d.00\n lease 1\n```\n可以看到，Option 43 最后的6个字符 **737663** 被吃了！\n\n思科对此的解释如下，自 IOS 15.1(3)S 以后，Option 后面跟的 hex 部分做了长度限制，超过 180 字符的部分将被截短。\n\n| Release | Modification |\n| - | - |\n| 12.0(1)T | This command was introduced. |\n|12.2(33)SRA | This command was integrated into Cisco IOS Release 12.2(33)SRA. |\n| 12.2SX | This command was supported in the Cisco IOS Release 12.2SX train. Support in a specific 12.2SX release of this train depends on your feature set, platform, and platform hardware. |\n| 12.4(24)T | This command was modified. The none keyword was added. |\n| 15.1(3)S | This command was modified. A maximum limit of 180 characters was set for the dotted hexadecimal data and 255 characters for the ASCII data. |\n\n> The hexadecimal value is truncated to 180 characters entered. Each byte in hexadecimal character strings is two hexadecimal digits. Each byte can be separated by a period, colon, or white space.\n\n\n### 解决方案\n那么有什么解决方案吗？\n\n1. 缩短你的 SIP 服务器 FQDN 名称小于等于23个字符\n2. 换用其它设备或者服务器系统作为 DHCP，比如把 DHCP 从思科路由器上移到思科交换机（思科交换机不存在这个问题）上或者干脆用 Windows Server\n3. 降级路由器的 IOS 版本至 15.1(3)S 以下\n3. 升级 IOS 版本，在 Cisco IOS XE Release 3.2.1S 之后引入了一个 option ext 的命令，这个扩展命令可以支持 255 个字节的 hex 值。\n\n> 思科官方介绍：\nUsing the option ext command you can specify an ASCII string upto 255 characters or 255 bytes of hexadecimal data.\n\n所以你的命令看起来应该是这样的：\n``` plain\nip dhcp pool POOL1\n network 192.168.10.0 255.255.255.0\n domain-name corp.company.local\n dns-server 119.29.29.29 8.8.8.8\n default-router 192.168.10.1\n option ext 43 hex Your full Option 43 hex value here - part1\n option ext 43 hex Your full Option 43 hex value here - part2\n option 120 hex Your Option 120 hex value here\n lease 1\n```\n\n如果这些方案你都没办法实施，那么在部署某些设备比如 Polycom VVX 系列的 Skype Phone 的时候，你还可以用 DHCP Override 去指定 SIP 服务的 URI：\n![Polycom VVX DHCP Override](using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg)\n\n### 附件\n最后，再附上 {% asset_link dhcputil.zip DHCPUtil.exe %} 和相关的 {% asset_link msvcr110.zip DLL文件 %} 下载，希望以上能帮到被此困扰的朋友。\n","slug":"using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment","published":1,"updated":"2019-01-02T01:40:18.122Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kux007mk84s6hfz6ap3","content":"<html><head></head><body><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>这个问题是以前遇到过的，最近又有人问起，索性在此记录一下：</p>\n<p>在部署 Skype/Lync 过程中，我们需要用到 DHCP Option 120 和 43，通常来说，我们会使用 Windows 服务器来做 DHCP，但有的时候，我们在分支机构可能会使用本地的路由器来当 DHCP 服务器，Option 120 通常没有问题，而坑出现在 Option 43, 因为 Skype 走的是 TCP，而且是 SIP over TLS，所以 Option 43 里面是不可以用 IP 地址的，必须要用 FQDN，而且大多数设备需要输入16进制而不是 ASCII 码，那这个时候，你有可能会遇到以下两种情况：</p>\n<span id=\"more\"></span>\n\n<ol>\n<li>你的 SIP 服务器的 FQDN 名字长度很短，没有超过23个字符，那么使用 DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会在180个字符以内，这种情况使用思科路由器作 DHCP 没有问题:<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\Common Files\\Skype for Business Server 2015&gt;DHCPUtil.exe -sipserver server.fqdn.company.com</span><br><span class=\"line\">SIP Server FQDN : server.fqdn.company.com</span><br><span class=\"line\">Certificate Provisioning Service URL : https://server.fqdn.company.com:443/CertProv/CertProvisioningService.svc</span><br><span class=\"line\"></span><br><span class=\"line\">Option 120:</span><br><span class=\"line\">0006736572766572046671646E07636F6D70616E7903636F6D00</span><br><span class=\"line\"></span><br><span class=\"line\">Vendor Class Identifier: MS-UC-Client</span><br><span class=\"line\">Option 43 (for vendor=MS-UC-Client):</span><br><span class=\"line\">        Full Option 43 value (Length: 180) : </span><br><span class=\"line\">        010C4D532D55432D436C69656E740205687474707303177365727665722E6671646E2E636F6</span><br><span class=\"line\">        D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\">        sub-option 1 &lt;UC Identifier&gt;: 4D532D55432D436C69656E74</span><br><span class=\"line\">        sub-option 2 &lt;URL Scheme&gt;: 6874747073</span><br><span class=\"line\">        sub-option 3 &lt;Web Server FQDN&gt;: 7365727665722E6671646E2E636F6D70616E792E636F6D</span><br><span class=\"line\">        sub-option 4 &lt;Port&gt;: 343433</span><br><span class=\"line\">        sub-option 5 &lt;Relative Path for Cert Prov&gt;: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\"></span><br><span class=\"line\">To configure DHCP Server with appropriate values, you can do one of the following things:</span><br><span class=\"line\">        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch</span><br><span class=\"line\">        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):</span><br><span class=\"line\">\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0006736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 </span><br><span class=\"line\">7365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br></pre></td></tr></tbody></table></figure>\n<h3 id=\"踩坑\"><a href=\"#踩坑\" class=\"headerlink\" title=\"踩坑\"></a>踩坑</h3></li>\n<li>一旦你的 SIP 服务器的 FQDN 名字长度超过23个字符，DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会超过180个字符：<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\Common Files\\Skype for Business Server 2015&gt;DHCPUtil.exe -sipserver sipserver.fqdn.company.com</span><br><span class=\"line\">SIP Server FQDN : sipserver.fqdn.company.com</span><br><span class=\"line\">Certificate Provisioning Service URL : https://sipserver.fqdn.company.com:443/CertProv/CertProvisioningService.svc</span><br><span class=\"line\"></span><br><span class=\"line\">Option 120:</span><br><span class=\"line\">0009736970736572766572046671646E07636F6D70616E7903636F6D00</span><br><span class=\"line\"></span><br><span class=\"line\">Vendor Class Identifier: MS-UC-Client</span><br><span class=\"line\">Option 43 (for vendor=MS-UC-Client):</span><br><span class=\"line\">        Full Option 43 value (Length: 186) : </span><br><span class=\"line\">        010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2</span><br><span class=\"line\">        E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\">        sub-option 1 &lt;UC Identifier&gt;: 4D532D55432D436C69656E74</span><br><span class=\"line\">        sub-option 2 &lt;URL Scheme&gt;: 6874747073</span><br><span class=\"line\">        sub-option 3 &lt;Web Server FQDN&gt;: 7369707365727665722E6671646E2E636F6D70616E792E636F6D</span><br><span class=\"line\">        sub-option 4 &lt;Port&gt;: 343433</span><br><span class=\"line\">        sub-option 5 &lt;Relative Path for Cert Prov&gt;: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\"></span><br><span class=\"line\">To configure DHCP Server with appropriate values, you can do one of the following things:</span><br><span class=\"line\">        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch</span><br><span class=\"line\">        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):</span><br><span class=\"line\">\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0009736970736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 7369707365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<p>这个时候，坑就来了，当你复制 Option 43 这一段去到思科路由器上的时候，路由器并不会报错，但是会将你输入的值截短至<strong>180</strong>个字符</p>\n<p>而且没有任何提示，如果是在部署 Skype 电话的时候，你会发现 PIN 认证始终没法出现，你要不仔细检查的话是发现不了问题。</p>\n<p>输入的命令</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip dhcp pool POOL1</span><br><span class=\"line\"> network 192.168.10.0 255.255.255.0</span><br><span class=\"line\"> domain-name corp.company.local</span><br><span class=\"line\"> dns-server 119.29.29.29 8.8.8.8</span><br><span class=\"line\"> default-router 192.168.10.1</span><br><span class=\"line\"> option 43 hex 010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\"> option 120 hex 0009736970736572766572046671646E07636F6D70616E7903636F6D00</span><br><span class=\"line\"> lease 1</span><br></pre></td></tr></tbody></table></figure>\n\n<p>路由器接受的：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip dhcp pool POOL1</span><br><span class=\"line\"> network 192.168.10.0 255.255.255.0</span><br><span class=\"line\"> domain-name corp.company.local</span><br><span class=\"line\"> dns-server 119.29.29.29 8.8.8.8</span><br><span class=\"line\"> default-router 192.168.10.1</span><br><span class=\"line\"> option 43 hex 010c.4d53.2d55.432d.436c.6965.6e74.0205.6874.7470.7303.1a73.6970.7365.7276.6572.2e66.7164.6e2e.636f.6d70.616e.792e.636f.6d04.0334.3433.0525.2f43.6572.7450.726f.762f.4365.7274.5072.6f76.6973.696f.6e69.6e67.5365.7276.6963.652e</span><br><span class=\"line\"> option 120 hex 0009.7369.7073.6572.7665.7204.6671.646e.0763.6f6d.7061.6e79.0363.6f6d.00</span><br><span class=\"line\"> lease 1</span><br></pre></td></tr></tbody></table></figure>\n<p>可以看到，Option 43 最后的6个字符 <strong>737663</strong> 被吃了！</p>\n<p>思科对此的解释如下，自 IOS 15.1(3)S 以后，Option 后面跟的 hex 部分做了长度限制，超过 180 字符的部分将被截短。</p>\n<table>\n<thead>\n<tr>\n<th>Release</th>\n<th>Modification</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>12.0(1)T</td>\n<td>This command was introduced.</td>\n</tr>\n<tr>\n<td>12.2(33)SRA</td>\n<td>This command was integrated into Cisco IOS Release 12.2(33)SRA.</td>\n</tr>\n<tr>\n<td>12.2SX</td>\n<td>This command was supported in the Cisco IOS Release 12.2SX train. Support in a specific 12.2SX release of this train depends on your feature set, platform, and platform hardware.</td>\n</tr>\n<tr>\n<td>12.4(24)T</td>\n<td>This command was modified. The none keyword was added.</td>\n</tr>\n<tr>\n<td>15.1(3)S</td>\n<td>This command was modified. A maximum limit of 180 characters was set for the dotted hexadecimal data and 255 characters for the ASCII data.</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>The hexadecimal value is truncated to 180 characters entered. Each byte in hexadecimal character strings is two hexadecimal digits. Each byte can be separated by a period, colon, or white space.</p>\n</blockquote>\n<h3 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h3><p>那么有什么解决方案吗？</p>\n<ol>\n<li>缩短你的 SIP 服务器 FQDN 名称小于等于23个字符</li>\n<li>换用其它设备或者服务器系统作为 DHCP，比如把 DHCP 从思科路由器上移到思科交换机（思科交换机不存在这个问题）上或者干脆用 Windows Server</li>\n<li>降级路由器的 IOS 版本至 15.1(3)S 以下</li>\n<li>升级 IOS 版本，在 Cisco IOS XE Release 3.2.1S 之后引入了一个 option ext 的命令，这个扩展命令可以支持 255 个字节的 hex 值。</li>\n</ol>\n<blockquote>\n<p>思科官方介绍：<br>Using the option ext command you can specify an ASCII string upto 255 characters or 255 bytes of hexadecimal data.</p>\n</blockquote>\n<p>所以你的命令看起来应该是这样的：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip dhcp pool POOL1</span><br><span class=\"line\"> network 192.168.10.0 255.255.255.0</span><br><span class=\"line\"> domain-name corp.company.local</span><br><span class=\"line\"> dns-server 119.29.29.29 8.8.8.8</span><br><span class=\"line\"> default-router 192.168.10.1</span><br><span class=\"line\"> option ext 43 hex Your full Option 43 hex value here - part1</span><br><span class=\"line\"> option ext 43 hex Your full Option 43 hex value here - part2</span><br><span class=\"line\"> option 120 hex Your Option 120 hex value here</span><br><span class=\"line\"> lease 1</span><br></pre></td></tr></tbody></table></figure>\n\n<p>如果这些方案你都没办法实施，那么在部署某些设备比如 Polycom VVX 系列的 Skype Phone 的时候，你还可以用 DHCP Override 去指定 SIP 服务的 URI：<br><img src=\"/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg\" alt=\"Polycom VVX DHCP Override\"></p>\n<h3 id=\"附件\"><a href=\"#附件\" class=\"headerlink\" title=\"附件\"></a>附件</h3><p>最后，再附上 <a href=\"/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/dhcputil.zip\" title=\"DHCPUtil.exe\">DHCPUtil.exe</a> 和相关的 <a href=\"/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/msvcr110.zip\" title=\"DLL文件\">DLL文件</a> 下载，希望以上能帮到被此困扰的朋友。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><h3 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h3><p>这个问题是以前遇到过的，最近又有人问起，索性在此记录一下：</p>\n<p>在部署 Skype/Lync 过程中，我们需要用到 DHCP Option 120 和 43，通常来说，我们会使用 Windows 服务器来做 DHCP，但有的时候，我们在分支机构可能会使用本地的路由器来当 DHCP 服务器，Option 120 通常没有问题，而坑出现在 Option 43, 因为 Skype 走的是 TCP，而且是 SIP over TLS，所以 Option 43 里面是不可以用 IP 地址的，必须要用 FQDN，而且大多数设备需要输入16进制而不是 ASCII 码，那这个时候，你有可能会遇到以下两种情况：</p></body></html>","more":"<html><head></head><body><ol>\n<li>你的 SIP 服务器的 FQDN 名字长度很短，没有超过23个字符，那么使用 DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会在180个字符以内，这种情况使用思科路由器作 DHCP 没有问题:<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\Common Files\\Skype for Business Server 2015&gt;DHCPUtil.exe -sipserver server.fqdn.company.com</span><br><span class=\"line\">SIP Server FQDN : server.fqdn.company.com</span><br><span class=\"line\">Certificate Provisioning Service URL : https://server.fqdn.company.com:443/CertProv/CertProvisioningService.svc</span><br><span class=\"line\"></span><br><span class=\"line\">Option 120:</span><br><span class=\"line\">0006736572766572046671646E07636F6D70616E7903636F6D00</span><br><span class=\"line\"></span><br><span class=\"line\">Vendor Class Identifier: MS-UC-Client</span><br><span class=\"line\">Option 43 (for vendor=MS-UC-Client):</span><br><span class=\"line\">        Full Option 43 value (Length: 180) : </span><br><span class=\"line\">        010C4D532D55432D436C69656E740205687474707303177365727665722E6671646E2E636F6</span><br><span class=\"line\">        D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\">        sub-option 1 &lt;UC Identifier&gt;: 4D532D55432D436C69656E74</span><br><span class=\"line\">        sub-option 2 &lt;URL Scheme&gt;: 6874747073</span><br><span class=\"line\">        sub-option 3 &lt;Web Server FQDN&gt;: 7365727665722E6671646E2E636F6D70616E792E636F6D</span><br><span class=\"line\">        sub-option 4 &lt;Port&gt;: 343433</span><br><span class=\"line\">        sub-option 5 &lt;Relative Path for Cert Prov&gt;: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\"></span><br><span class=\"line\">To configure DHCP Server with appropriate values, you can do one of the following things:</span><br><span class=\"line\">        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch</span><br><span class=\"line\">        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):</span><br><span class=\"line\">\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0006736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 </span><br><span class=\"line\">7365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br></pre></td></tr></tbody></table></figure>\n<h3 id=\"踩坑\"><a href=\"#踩坑\" class=\"headerlink\" title=\"踩坑\"></a>踩坑</h3></li>\n<li>一旦你的 SIP 服务器的 FQDN 名字长度超过23个字符，DHCPUtil.exe 生成的 Option 43 的 Hex 值长度会超过180个字符：<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">C:\\Program Files\\Common Files\\Skype for Business Server 2015&gt;DHCPUtil.exe -sipserver sipserver.fqdn.company.com</span><br><span class=\"line\">SIP Server FQDN : sipserver.fqdn.company.com</span><br><span class=\"line\">Certificate Provisioning Service URL : https://sipserver.fqdn.company.com:443/CertProv/CertProvisioningService.svc</span><br><span class=\"line\"></span><br><span class=\"line\">Option 120:</span><br><span class=\"line\">0009736970736572766572046671646E07636F6D70616E7903636F6D00</span><br><span class=\"line\"></span><br><span class=\"line\">Vendor Class Identifier: MS-UC-Client</span><br><span class=\"line\">Option 43 (for vendor=MS-UC-Client):</span><br><span class=\"line\">        Full Option 43 value (Length: 186) : </span><br><span class=\"line\">        010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2</span><br><span class=\"line\">        E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\">        sub-option 1 &lt;UC Identifier&gt;: 4D532D55432D436C69656E74</span><br><span class=\"line\">        sub-option 2 &lt;URL Scheme&gt;: 6874747073</span><br><span class=\"line\">        sub-option 3 &lt;Web Server FQDN&gt;: 7369707365727665722E6671646E2E636F6D70616E792E636F6D</span><br><span class=\"line\">        sub-option 4 &lt;Port&gt;: 343433</span><br><span class=\"line\">        sub-option 5 &lt;Relative Path for Cert Prov&gt;: 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\"></span><br><span class=\"line\">To configure DHCP Server with appropriate values, you can do one of the following things:</span><br><span class=\"line\">        1. Run DHCPUtil on the DHCP Server: use '-RunConfigScript' switch</span><br><span class=\"line\">        2. Run the following command on the DHCP Server (modify the path of DHCPConfigScript.bat appropriately):</span><br><span class=\"line\">\"C:\\Program Files\\Common Files\\Skype for Business Server 2015\\DHCPConfigScript.bat\" Configure MS-UC-Client 0009736970736572766572046671646E07636F6D70616E7903636F6D00 4D532D55432D436C69656E74 6874747073 7369707365727665722E6671646E2E636F6D70616E792E636F6D 343433 2F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br></pre></td></tr></tbody></table></figure></li>\n</ol>\n<p>这个时候，坑就来了，当你复制 Option 43 这一段去到思科路由器上的时候，路由器并不会报错，但是会将你输入的值截短至<strong>180</strong>个字符</p>\n<p>而且没有任何提示，如果是在部署 Skype 电话的时候，你会发现 PIN 认证始终没法出现，你要不仔细检查的话是发现不了问题。</p>\n<p>输入的命令</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip dhcp pool POOL1</span><br><span class=\"line\"> network 192.168.10.0 255.255.255.0</span><br><span class=\"line\"> domain-name corp.company.local</span><br><span class=\"line\"> dns-server 119.29.29.29 8.8.8.8</span><br><span class=\"line\"> default-router 192.168.10.1</span><br><span class=\"line\"> option 43 hex 010C4D532D55432D436C69656E7402056874747073031A7369707365727665722E6671646E2E636F6D70616E792E636F6D040334343305252F4365727450726F762F4365727450726F766973696F6E696E67536572766963652E737663</span><br><span class=\"line\"> option 120 hex 0009736970736572766572046671646E07636F6D70616E7903636F6D00</span><br><span class=\"line\"> lease 1</span><br></pre></td></tr></tbody></table></figure>\n\n<p>路由器接受的：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip dhcp pool POOL1</span><br><span class=\"line\"> network 192.168.10.0 255.255.255.0</span><br><span class=\"line\"> domain-name corp.company.local</span><br><span class=\"line\"> dns-server 119.29.29.29 8.8.8.8</span><br><span class=\"line\"> default-router 192.168.10.1</span><br><span class=\"line\"> option 43 hex 010c.4d53.2d55.432d.436c.6965.6e74.0205.6874.7470.7303.1a73.6970.7365.7276.6572.2e66.7164.6e2e.636f.6d70.616e.792e.636f.6d04.0334.3433.0525.2f43.6572.7450.726f.762f.4365.7274.5072.6f76.6973.696f.6e69.6e67.5365.7276.6963.652e</span><br><span class=\"line\"> option 120 hex 0009.7369.7073.6572.7665.7204.6671.646e.0763.6f6d.7061.6e79.0363.6f6d.00</span><br><span class=\"line\"> lease 1</span><br></pre></td></tr></tbody></table></figure>\n<p>可以看到，Option 43 最后的6个字符 <strong>737663</strong> 被吃了！</p>\n<p>思科对此的解释如下，自 IOS 15.1(3)S 以后，Option 后面跟的 hex 部分做了长度限制，超过 180 字符的部分将被截短。</p>\n<table>\n<thead>\n<tr>\n<th>Release</th>\n<th>Modification</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>12.0(1)T</td>\n<td>This command was introduced.</td>\n</tr>\n<tr>\n<td>12.2(33)SRA</td>\n<td>This command was integrated into Cisco IOS Release 12.2(33)SRA.</td>\n</tr>\n<tr>\n<td>12.2SX</td>\n<td>This command was supported in the Cisco IOS Release 12.2SX train. Support in a specific 12.2SX release of this train depends on your feature set, platform, and platform hardware.</td>\n</tr>\n<tr>\n<td>12.4(24)T</td>\n<td>This command was modified. The none keyword was added.</td>\n</tr>\n<tr>\n<td>15.1(3)S</td>\n<td>This command was modified. A maximum limit of 180 characters was set for the dotted hexadecimal data and 255 characters for the ASCII data.</td>\n</tr>\n</tbody></table>\n<blockquote>\n<p>The hexadecimal value is truncated to 180 characters entered. Each byte in hexadecimal character strings is two hexadecimal digits. Each byte can be separated by a period, colon, or white space.</p>\n</blockquote>\n<h3 id=\"解决方案\"><a href=\"#解决方案\" class=\"headerlink\" title=\"解决方案\"></a>解决方案</h3><p>那么有什么解决方案吗？</p>\n<ol>\n<li>缩短你的 SIP 服务器 FQDN 名称小于等于23个字符</li>\n<li>换用其它设备或者服务器系统作为 DHCP，比如把 DHCP 从思科路由器上移到思科交换机（思科交换机不存在这个问题）上或者干脆用 Windows Server</li>\n<li>降级路由器的 IOS 版本至 15.1(3)S 以下</li>\n<li>升级 IOS 版本，在 Cisco IOS XE Release 3.2.1S 之后引入了一个 option ext 的命令，这个扩展命令可以支持 255 个字节的 hex 值。</li>\n</ol>\n<blockquote>\n<p>思科官方介绍：<br>Using the option ext command you can specify an ASCII string upto 255 characters or 255 bytes of hexadecimal data.</p>\n</blockquote>\n<p>所以你的命令看起来应该是这样的：</p>\n<figure class=\"highlight plaintext\"><table><tbody><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ip dhcp pool POOL1</span><br><span class=\"line\"> network 192.168.10.0 255.255.255.0</span><br><span class=\"line\"> domain-name corp.company.local</span><br><span class=\"line\"> dns-server 119.29.29.29 8.8.8.8</span><br><span class=\"line\"> default-router 192.168.10.1</span><br><span class=\"line\"> option ext 43 hex Your full Option 43 hex value here - part1</span><br><span class=\"line\"> option ext 43 hex Your full Option 43 hex value here - part2</span><br><span class=\"line\"> option 120 hex Your Option 120 hex value here</span><br><span class=\"line\"> lease 1</span><br></pre></td></tr></tbody></table></figure>\n\n<p>如果这些方案你都没办法实施，那么在部署某些设备比如 Polycom VVX 系列的 Skype Phone 的时候，你还可以用 DHCP Override 去指定 SIP 服务的 URI：<br><img src=\"/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg\" alt=\"Polycom VVX DHCP Override\"></p>\n<h3 id=\"附件\"><a href=\"#附件\" class=\"headerlink\" title=\"附件\"></a>附件</h3><p>最后，再附上 <a href=\"/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/dhcputil.zip\" title=\"DHCPUtil.exe\">DHCPUtil.exe</a> 和相关的 <a href=\"/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/msvcr110.zip\" title=\"DLL文件\">DLL文件</a> 下载，希望以上能帮到被此困扰的朋友。</p></body></html>"},{"title":"Virtual Server Undo Disks - I am never going to use you again (Can't Merge Disks - Parent Disk is a part of a Saved State)","date":"2009-05-07T09:10:48.000Z","_content":"\n在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:\n\n**\"Virtual Server was unable to commit the changes made during the current session of \"_[VPC NAME]_\". The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.\"**\n\n<!--more-->\n\n解决方法如下:\n\nIf you search google for this, you come up with almost nothing.  But there's a [critical post right here](http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2) about it.  It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn't understand the concept of \"inspecting\" a virtual disk.\n\nThe basic steps are:\n\n1.  Rename the undo disks to *.vhd.  This turns them into a virtual drive in the eyes of Virtual Server.\n2.  Click on the Inspect option in the Virtual Disk section of Virtual Server.  There should be an option to then merge the disk.\n3.  Select a new disk to merge into.  If you try merging into the original parent, Virtual Server will just give you the above error again.\n4.  Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn't be merged to before).","source":"_posts/virtual-server-undo-disks-merge-parent-disk-part-of-saved-state.md","raw":"---\ntitle: Virtual Server Undo Disks - I am never going to use you again (Can't Merge Disks - Parent Disk is a part of a Saved State)\ntags:\n  - Virtual Server\n  - Microsoft\ncategories:\n  - 虚拟化\ndate: 2009-05-07 17:10:48\n---\n\n在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:\n\n**\"Virtual Server was unable to commit the changes made during the current session of \"_[VPC NAME]_\". The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.\"**\n\n<!--more-->\n\n解决方法如下:\n\nIf you search google for this, you come up with almost nothing.  But there's a [critical post right here](http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2) about it.  It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn't understand the concept of \"inspecting\" a virtual disk.\n\nThe basic steps are:\n\n1.  Rename the undo disks to *.vhd.  This turns them into a virtual drive in the eyes of Virtual Server.\n2.  Click on the Inspect option in the Virtual Disk section of Virtual Server.  There should be an option to then merge the disk.\n3.  Select a new disk to merge into.  If you try merging into the original parent, Virtual Server will just give you the above error again.\n4.  Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn't be merged to before).","slug":"virtual-server-undo-disks-merge-parent-disk-part-of-saved-state","published":1,"updated":"2020-01-05T09:00:54.027Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuy007qk84s8zh64fnq","content":"<html><head></head><body><p>在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:</p>\n<p><strong>“Virtual Server was unable to commit the changes made during the current session of “<em>[VPC NAME]</em>“. The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.”</strong></p>\n<span id=\"more\"></span>\n\n<p>解决方法如下:</p>\n<p>If you search google for this, you come up with almost nothing.&nbsp; But there’s a&nbsp;<a href=\"http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2\">critical post right here</a>&nbsp;about it.&nbsp; It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn’t understand the concept of “inspecting” a virtual disk.</p>\n<p>The basic steps are:</p>\n<ol>\n<li>Rename the undo disks to *.vhd.&nbsp; This turns them into a virtual drive in the eyes of Virtual Server.</li>\n<li>Click on the Inspect option in the Virtual Disk section of Virtual Server.&nbsp; There should be an option to then merge the disk.</li>\n<li>Select a new disk to merge into.&nbsp; If you try merging into the original parent, Virtual Server will just give you the above error again.</li>\n<li>Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn’t be merged to before).</li>\n</ol>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body><p>在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:</p>\n<p><strong>“Virtual Server was unable to commit the changes made during the current session of “<em>[VPC NAME]</em>“. The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.”</strong></p></body></html>","more":"<html><head></head><body><p>解决方法如下:</p>\n<p>If you search google for this, you come up with almost nothing.&nbsp; But there’s a&nbsp;<a href=\"http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2\">critical post right here</a>&nbsp;about it.&nbsp; It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn’t understand the concept of “inspecting” a virtual disk.</p>\n<p>The basic steps are:</p>\n<ol>\n<li>Rename the undo disks to *.vhd.&nbsp; This turns them into a virtual drive in the eyes of Virtual Server.</li>\n<li>Click on the Inspect option in the Virtual Disk section of Virtual Server.&nbsp; There should be an option to then merge the disk.</li>\n<li>Select a new disk to merge into.&nbsp; If you try merging into the original parent, Virtual Server will just give you the above error again.</li>\n<li>Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn’t be merged to before).</li>\n</ol></body></html>"},{"title":"解决VirtualBox在Windows7中无法安装USB驱动等问题","date":"2013-03-19T01:32:50.000Z","_content":"\n操作系统：Windows 7 Professional with SP1 32-bit\n\nVirtualBox：VirtualBox-4.2.10-84105-Win.exe\n\n安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，\n![VirtualBox-Driver-1](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg)\n\n前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。\n\n![VirtualBox-Driver-2](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg)\n\n经过一番摸索，找到了解决之道：\n\n1. 因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；\n2. 决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；\n3. 重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);\n4. 在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；\n5. 开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；\n![VirtualBox-Driver-3](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg)\n\n退出安装程序，再重新跑一遍即可，问题解决。","source":"_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7.md","raw":"---\ntitle: 解决VirtualBox在Windows7中无法安装USB驱动等问题\ntags:\n  - VirtualBox\ncategories:\n  - 虚拟化\ndate: 2013-03-19 09:32:50\n---\n\n操作系统：Windows 7 Professional with SP1 32-bit\n\nVirtualBox：VirtualBox-4.2.10-84105-Win.exe\n\n安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，\n![VirtualBox-Driver-1](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg)\n\n前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。\n\n![VirtualBox-Driver-2](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg)\n\n经过一番摸索，找到了解决之道：\n\n1. 因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；\n2. 决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；\n3. 重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);\n4. 在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；\n5. 开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；\n![VirtualBox-Driver-3](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg)\n\n退出安装程序，再重新跑一遍即可，问题解决。","slug":"workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7","published":1,"updated":"2020-01-05T09:00:54.027Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl1jj4kuz007uk84s6x0gcbd5","content":"<html><head></head><body><p>操作系统：Windows 7 Professional with SP1 32-bit</p>\n<p>VirtualBox：VirtualBox-4.2.10-84105-Win.exe</p>\n<p>安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，<br><img src=\"/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg\" alt=\"VirtualBox-Driver-1\"></p>\n<p>前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。</p>\n<p><img src=\"/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg\" alt=\"VirtualBox-Driver-2\"></p>\n<p>经过一番摸索，找到了解决之道：</p>\n<ol>\n<li>因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；</li>\n<li>决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；</li>\n<li>重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);</li>\n<li>在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；</li>\n<li>开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；<br><img src=\"/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg\" alt=\"VirtualBox-Driver-3\"></li>\n</ol>\n<p>退出安装程序，再重新跑一遍即可，问题解决。</p>\n</body></html>","site":{"data":{}},"excerpt":"<html><head></head><body></body></html>","more":"<html><head></head><body><p>操作系统：Windows 7 Professional with SP1 32-bit</p>\n<p>VirtualBox：VirtualBox-4.2.10-84105-Win.exe</p>\n<p>安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，<br><img src=\"/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg\" alt=\"VirtualBox-Driver-1\"></p>\n<p>前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。</p>\n<p><img src=\"/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg\" alt=\"VirtualBox-Driver-2\"></p>\n<p>经过一番摸索，找到了解决之道：</p>\n<ol>\n<li>因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；</li>\n<li>决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；</li>\n<li>重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);</li>\n<li>在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；</li>\n<li>开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；<br><img src=\"/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg\" alt=\"VirtualBox-Driver-3\"></li>\n</ol>\n<p>退出安装程序，再重新跑一遍即可，问题解决。</p>\n</body></html>"}],"PostAsset":[{"_id":"source/_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg","slug":"ADUser-Properties.jpg","post":"cl1jj4kt00001k84sbt8dg481","modified":0,"renderable":0},{"_id":"source/_posts/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip","slug":"config-3.2.21-vmware1.zip","post":"cl1jj4kt70008k84s4umoe63i","modified":0,"renderable":0},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-1.jpg","slug":"inspect-password-field-1.jpg","post":"cl1jj4kta000fk84s4nsr3jmx","modified":0,"renderable":0},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-2.jpg","slug":"inspect-password-field-2.jpg","post":"cl1jj4kta000fk84s4nsr3jmx","modified":0,"renderable":0},{"_id":"source/_posts/easily-reveal-hidden-passwords-in-any-browser/inspect-password-field-3.jpg","slug":"inspect-password-field-3.jpg","post":"cl1jj4kta000fk84s4nsr3jmx","modified":0,"renderable":0},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg","slug":"AdvancedSecurity-Setting.jpg","post":"cl1jj4kte000rk84s70m39o6o","modified":0,"renderable":0},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg","slug":"EventID-1053.jpg","post":"cl1jj4kte000rk84s70m39o6o","modified":0,"renderable":0},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg","slug":"FolderSync-Failed.jpg","post":"cl1jj4kte000rk84s70m39o6o","modified":0,"renderable":0},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg","slug":"Exchange-2010-Btree.jpg","post":"cl1jj4kte000sk84sgsvpczda","modified":0,"renderable":0},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg","slug":"Exchange-2010-JRS-Files.jpg","post":"cl1jj4kte000sk84sgsvpczda","modified":0,"renderable":0},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg","slug":"Exchange_2010_Storage.jpg","post":"cl1jj4kte000sk84sgsvpczda","modified":0,"renderable":0},{"_id":"source/_posts/fix-java8-install-1603-error/Java8_Error_1603.png","slug":"Java8_Error_1603.png","post":"cl1jj4ktg000xk84s08k5861p","modified":0,"renderable":0},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg","slug":"EventID-1004.jpg","post":"cl1jj4ktj0015k84s28lvbk1k","modified":0,"renderable":0},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg","slug":"Permissions-aw.jpg","post":"cl1jj4ktj0015k84s28lvbk1k","modified":0,"renderable":0},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg","slug":"Windows-configures-microsoft-office.jpg","post":"cl1jj4ktj0015k84s28lvbk1k","modified":0,"renderable":0},{"_id":"source/_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg","slug":"piix4_smbus_not_enabled.jpg","post":"cl1jj4ktl001ak84scb3qc5gh","modified":0,"renderable":0},{"_id":"source/_posts/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg","slug":"Change_Countrycount.jpg","post":"cl1jj4ktx002wk84s2ixjdx7s","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/adm-3a.jpg","slug":"adm-3a.jpg","post":"cl1jj4ktz0034k84sgivv7m3t","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vi-vim-cheat-sheet.gif","slug":"vi-vim-cheat-sheet.gif","post":"cl1jj4ktz0034k84sgivv7m3t","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_conf.jpg","slug":"vim_conf.jpg","post":"cl1jj4ktz0034k84sgivv7m3t","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-arrow-key-that-display-abcd-in-vi-on-ubuntu/vim_help.jpg","slug":"vim_help.jpg","post":"cl1jj4ktz0034k84sgivv7m3t","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg","slug":"Fig_1.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg","slug":"Fig_10.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg","slug":"Fig_11.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg","slug":"Fig_12.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg","slug":"Fig_13.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg","slug":"Fig_14.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg","slug":"Fig_15.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg","slug":"Fig_16.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg","slug":"Fig_17.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg","slug":"Fig_18.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg","slug":"Fig_2.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg","slug":"Fig_3.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg","slug":"Fig_4.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg","slug":"Fig_5.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg","slug":"Fig_6.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg","slug":"Fig_7.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg","slug":"Fig_8.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg","slug":"Fig_9.jpg","post":"cl1jj4kty002zk84sdqs75hph","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/create_folder_warning.jpg","slug":"create_folder_warning.jpg","post":"cl1jj4ku00038k84sauteay1z","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy.jpg","slug":"fastcopy.jpg","post":"cl1jj4ku00038k84sauteay1z","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/fastcopy_about.jpg","slug":"fastcopy_about.jpg","post":"cl1jj4ku00038k84sauteay1z","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/rename_warning.jpg","slug":"rename_warning.jpg","post":"cl1jj4ku00038k84sauteay1z","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/robocopy.jpg","slug":"robocopy.jpg","post":"cl1jj4ku00038k84sauteay1z","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-file-path-too-long-on-windows-when-copying/xcopy_failed.jpg","slug":"xcopy_failed.jpg","post":"cl1jj4ku00038k84sauteay1z","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/damaged-copy.png","slug":"damaged-copy.png","post":"cl1jj4ku0003ck84sbfkefzpc","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/expired-cert.png","slug":"expired-cert.png","post":"cl1jj4ku0003ck84sbfkefzpc","modified":0,"renderable":0},{"_id":"source/_posts/how-to-fix-mojave-application-is-damaged-and-cant-be-used-to-install-macOS-errors/valid-cert.png","slug":"valid-cert.png","post":"cl1jj4ku0003ck84sbfkefzpc","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg","slug":"ol_step_1.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg","slug":"ol_step_2.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg","slug":"ol_step_3.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg","slug":"ol_step_4.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg","slug":"ol_step_5.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg","slug":"ol_step_6.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg","slug":"ol_step_7.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg","slug":"ol_step_8.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_9.jpg","slug":"ol_step_9.jpg","post":"cl1jj4ku3003pk84s3thabcqr","modified":0,"renderable":0},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_error.jpg","slug":"install_sql2005_on_win10_error.jpg","post":"cl1jj4ku2003nk84sborchjb0","modified":0,"renderable":0},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_before.jpg","slug":"install_sql2005_on_win10_files_before.jpg","post":"cl1jj4ku2003nk84sborchjb0","modified":0,"renderable":0},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_files_replaced.jpg","slug":"install_sql2005_on_win10_files_replaced.jpg","post":"cl1jj4ku2003nk84sborchjb0","modified":0,"renderable":0},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_finish.jpg","slug":"install_sql2005_on_win10_finish.jpg","post":"cl1jj4ku2003nk84sborchjb0","modified":0,"renderable":0},{"_id":"source/_posts/how-to-install-sql2005-on-win10/install_sql2005_on_win10_ongoging.jpg","slug":"install_sql2005_on_win10_ongoging.jpg","post":"cl1jj4ku2003nk84sborchjb0","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-set-homepage.jpg","slug":"fidder-ie-set-homepage.jpg","post":"cl1jj4ku4003wk84sfhpjfou2","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/fidder-ie-startup.jpg","slug":"fidder-ie-startup.jpg","post":"cl1jj4ku4003wk84sfhpjfou2","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-change-notice.jpg","slug":"ie-change-notice.jpg","post":"cl1jj4ku4003wk84sfhpjfou2","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie-unable-to-set-homepage.jpg","slug":"ie-unable-to-set-homepage.jpg","post":"cl1jj4ku4003wk84sfhpjfou2","modified":0,"renderable":0},{"_id":"source/_posts/how-to-remove-official-ie11-baidu-homepage-locking-on-simplified-chinese-win10-ltsb/ie11-eupp-registry.zip","slug":"ie11-eupp-registry.zip","post":"cl1jj4ku4003wk84sfhpjfou2","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/apt-install-docker-err.jpg","slug":"apt-install-docker-err.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/apt-update-docker.jpg","slug":"apt-update-docker.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/apt-update.jpg","slug":"apt-update.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/docker-gpg-key.jpg","slug":"docker-gpg-key.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/docker-install-from-daocloud.jpg","slug":"docker-install-from-daocloud.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/docker-permission.jpg","slug":"docker-permission.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/install-docker-ce-on-ubuntu-16/uninstall-docker-ce.jpg","slug":"uninstall-docker-ce.jpg","post":"cl1jj4ku9004ik84shvg41ue7","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg","slug":"url-rewrite-1.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg","slug":"url-rewrite-10.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg","slug":"url-rewrite-11.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg","slug":"url-rewrite-12.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg","slug":"url-rewrite-13.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg","slug":"url-rewrite-14.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg","slug":"url-rewrite-2.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg","slug":"url-rewrite-3.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg","slug":"url-rewrite-4.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg","slug":"url-rewrite-5.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg","slug":"url-rewrite-6.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg","slug":"url-rewrite-7.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg","slug":"url-rewrite-8.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg","slug":"url-rewrite-9.jpg","post":"cl1jj4ku7004bk84s8pdhgyte","modified":0,"renderable":0},{"_id":"source/_posts/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/lemp-stack.jpg","slug":"lemp-stack.jpg","post":"cl1jj4kua004ok84sczau2y0n","modified":0,"renderable":0},{"_id":"source/_posts/install-php56-nginx-mariadb-mysql-lemp-stack-on-centos7-with-fastcgi/nginx-welcome.jpg","slug":"nginx-welcome.jpg","post":"cl1jj4kua004ok84sczau2y0n","modified":0,"renderable":0},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg","slug":"EventID-7016.jpg","post":"cl1jj4kuf0053k84se7sc2qj9","modified":0,"renderable":0},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg","slug":"GPO-IE-Zone-Assignments.jpg","post":"cl1jj4kuf0053k84se7sc2qj9","modified":0,"renderable":0},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg","slug":"GPReport.jpg","post":"cl1jj4kuf0053k84se7sc2qj9","modified":0,"renderable":0},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg","slug":"Outlook_Today.jpg","post":"cl1jj4kug0056k84s1v1z4iiy","modified":0,"renderable":0},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg","slug":"Outlook_Today_HomePage.jpg","post":"cl1jj4kug0056k84s1v1z4iiy","modified":0,"renderable":0},{"_id":"source/_posts/packtpub-offer-free-learning/packtpub-eBook-1.jpg","slug":"packtpub-eBook-1.jpg","post":"cl1jj4kuo006dk84s84av5wdo","modified":0,"renderable":0},{"_id":"source/_posts/packtpub-offer-free-learning/packtpub-eBook-2.jpg","slug":"packtpub-eBook-2.jpg","post":"cl1jj4kuo006dk84s84av5wdo","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_0.jpg","slug":"CRM2011_0.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_1.jpg","slug":"CRM2011_1.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_10.jpg","slug":"CRM2011_10.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_11.jpg","slug":"CRM2011_11.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_12.jpg","slug":"CRM2011_12.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_13.jpg","slug":"CRM2011_13.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_14.jpg","slug":"CRM2011_14.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_15.jpg","slug":"CRM2011_15.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_16.jpg","slug":"CRM2011_16.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_17.jpg","slug":"CRM2011_17.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_18.jpg","slug":"CRM2011_18.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_19.jpg","slug":"CRM2011_19.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_2.jpg","slug":"CRM2011_2.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_20.jpg","slug":"CRM2011_20.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_3.jpg","slug":"CRM2011_3.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_4.jpg","slug":"CRM2011_4.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_5.jpg","slug":"CRM2011_5.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_6.jpg","slug":"CRM2011_6.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_7.jpg","slug":"CRM2011_7.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_8.jpg","slug":"CRM2011_8.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_9.jpg","slug":"CRM2011_9.jpg","post":"cl1jj4kum0065k84sdqbibaez","modified":0,"renderable":0},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/Domain-relationship-error.jpg","slug":"Domain-relationship-error.jpg","post":"cl1jj4kur006uk84s4d0khoj2","modified":0,"renderable":0},{"_id":"source/_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg","slug":"Remove-Chrome-Cookies.jpg","post":"cl1jj4kuv007dk84s8p852ce5","modified":0,"renderable":0},{"_id":"source/_posts/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf","slug":"HMC4.0_CDG_Draft.pdf","post":"cl1jj4kuw007fk84sfcrg8isj","modified":0,"renderable":0},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/dhcputil.zip","slug":"dhcputil.zip","post":"cl1jj4kux007mk84s6hfz6ap3","modified":0,"renderable":0},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/msvcr110.zip","slug":"msvcr110.zip","post":"cl1jj4kux007mk84s6hfz6ap3","modified":0,"renderable":0},{"_id":"source/_posts/using-cisco-router-as-dhcp-with-long-option43-in-skype-lync-deployment/polycom_dhcp_option43_override.jpg","slug":"polycom_dhcp_option43_override.jpg","post":"cl1jj4kux007mk84s6hfz6ap3","modified":0,"renderable":0},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg","slug":"VirtualBox-Driver-1.jpg","post":"cl1jj4kuz007uk84s6x0gcbd5","modified":0,"renderable":0},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg","slug":"VirtualBox-Driver-2.jpg","post":"cl1jj4kuz007uk84s6x0gcbd5","modified":0,"renderable":0},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg","slug":"VirtualBox-Driver-3.jpg","post":"cl1jj4kuz007uk84s6x0gcbd5","modified":0,"renderable":0}],"PostCategory":[{"post_id":"cl1jj4kt30003k84sc0flf2kc","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4ktb000jk84s5wm2eefm"},{"post_id":"cl1jj4kt60006k84sauale8de","category_id":"cl1jj4kt9000dk84s268h7kzj","_id":"cl1jj4ktd000ok84s0v6w0noj"},{"post_id":"cl1jj4kt70007k84s0z3b5i3v","category_id":"cl1jj4ktb000kk84s1uz1exmw","_id":"cl1jj4ktf000tk84saz2h6scn"},{"post_id":"cl1jj4kt00001k84sbt8dg481","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kth0010k84sa5ozdciq"},{"post_id":"cl1jj4kt00001k84sbt8dg481","category_id":"cl1jj4ktd000pk84s12c3fx8r","_id":"cl1jj4ktj0013k84s18ctg556"},{"post_id":"cl1jj4ktf000uk84sgy12ao9i","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4ktl0016k84s61ls61rg"},{"post_id":"cl1jj4ktg000xk84s08k5861p","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktl001bk84s8h2dgvsl"},{"post_id":"cl1jj4kt70008k84s4umoe63i","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4ktm001ek84sfujz98s9"},{"post_id":"cl1jj4kti0012k84s6zmm67bo","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktn001jk84sbe6j9beo"},{"post_id":"cl1jj4kt8000bk84s4kd55lpo","category_id":"cl1jj4kth000zk84setwncqtf","_id":"cl1jj4kto001mk84s3dzjanqw"},{"post_id":"cl1jj4ktl001ak84scb3qc5gh","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4ktp001qk84s6kmc87cc"},{"post_id":"cl1jj4kt9000ck84s2vs57rn3","category_id":"cl1jj4ktl0018k84s608zdrrv","_id":"cl1jj4ktq001tk84sdrwyhrvt"},{"post_id":"cl1jj4kta000fk84s4nsr3jmx","category_id":"cl1jj4ktb000kk84s1uz1exmw","_id":"cl1jj4ktq001wk84s80o9bwmi"},{"post_id":"cl1jj4ktb000hk84s10ri5g0g","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktr001zk84s5jk492lx"},{"post_id":"cl1jj4ktb000hk84s10ri5g0g","category_id":"cl1jj4kto001ok84scxnd0x3a","_id":"cl1jj4kts0023k84s7pr3h7er"},{"post_id":"cl1jj4ktb000mk84sd2n6f3bk","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktt0028k84s5677bv91"},{"post_id":"cl1jj4ktb000mk84sd2n6f3bk","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4ktu002ck84sgayo8yxo"},{"post_id":"cl1jj4ktc000nk84s3s6l9ug3","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktv002gk84scf231790"},{"post_id":"cl1jj4ktc000nk84s3s6l9ug3","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4ktv002ik84s47xla7ll"},{"post_id":"cl1jj4kte000rk84s70m39o6o","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktw002nk84s5cf2c79g"},{"post_id":"cl1jj4kte000rk84s70m39o6o","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4ktw002qk84s4o6gcmn2"},{"post_id":"cl1jj4kte000sk84sgsvpczda","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ktx002uk84sgr3s4lya"},{"post_id":"cl1jj4kte000sk84sgsvpczda","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4kty002xk84s4slshplt"},{"post_id":"cl1jj4kth000yk84s473x848b","category_id":"cl1jj4ktw002mk84s16sng7zz","_id":"cl1jj4kty0031k84sbuamdp8b"},{"post_id":"cl1jj4ktx002wk84s2ixjdx7s","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4ktz0035k84s96rb66u8"},{"post_id":"cl1jj4ktj0015k84s28lvbk1k","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ku00039k84scosjh33x"},{"post_id":"cl1jj4ktj0015k84s28lvbk1k","category_id":"cl1jj4kto001ok84scxnd0x3a","_id":"cl1jj4ku1003dk84s643zgkkn"},{"post_id":"cl1jj4ktz0032k84shna61yuc","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4ku1003hk84sf56k9lvt"},{"post_id":"cl1jj4ktm001dk84salvl12uy","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ku2003kk84sekwga9e7"},{"post_id":"cl1jj4ktm001dk84salvl12uy","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4ku3003ok84sf4kghko0"},{"post_id":"cl1jj4ku00038k84sauteay1z","category_id":"cl1jj4ktb000kk84s1uz1exmw","_id":"cl1jj4ku3003qk84s3gkg3j5j"},{"post_id":"cl1jj4ktn001ik84sf1ae55l3","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ku4003uk84s4ag2b7hh"},{"post_id":"cl1jj4ktn001ik84sf1ae55l3","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4ku5003xk84s248d2azw"},{"post_id":"cl1jj4ktn001lk84s9zp0aemq","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ku60042k84sf6tjb8xd"},{"post_id":"cl1jj4ktn001lk84s9zp0aemq","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4ku60045k84s5wdwfv3x"},{"post_id":"cl1jj4ku2003jk84sa1zn171y","category_id":"cl1jj4ktl0018k84s608zdrrv","_id":"cl1jj4ku70049k84s2ol11tcw"},{"post_id":"cl1jj4kto001pk84sdeleh3cl","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4ku7004ck84s0dhoh1ln"},{"post_id":"cl1jj4kto001pk84sdeleh3cl","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4ku8004hk84s54dccl07"},{"post_id":"cl1jj4ku4003tk84s70bf0mbc","category_id":"cl1jj4ktw002mk84s16sng7zz","_id":"cl1jj4ku9004jk84sdyhv4dbw"},{"post_id":"cl1jj4ktp001sk84s627affkl","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kua004mk84s7i5hh1o6"},{"post_id":"cl1jj4ktp001sk84s627affkl","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kub004pk84s3lgpa3wc"},{"post_id":"cl1jj4ku4003wk84sfhpjfou2","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kub004sk84sfy3xgsf6"},{"post_id":"cl1jj4ktq001vk84scrt94yuv","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kud004vk84s7wxi7bo9"},{"post_id":"cl1jj4ktq001vk84scrt94yuv","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kue004yk84s1pew621u"},{"post_id":"cl1jj4ku60044k84s2euxhp1k","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kue0051k84s5e6n5eci"},{"post_id":"cl1jj4ku60044k84s2euxhp1k","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4kuf0054k84s0nfw8j01"},{"post_id":"cl1jj4ku70048k84se2k20k8g","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kug0057k84s5tab3c59"},{"post_id":"cl1jj4ku70048k84se2k20k8g","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kuh005bk84sdkvzaml1"},{"post_id":"cl1jj4ktr001yk84s13hrgado","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuh005fk84s3g0aatt3"},{"post_id":"cl1jj4ktr001yk84s13hrgado","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kui005jk84s0yk282e0"},{"post_id":"cl1jj4ku7004bk84s8pdhgyte","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuj005nk84s6xlma78n"},{"post_id":"cl1jj4ktr0020k84s82h5dcoy","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuk005rk84s4n0a8dqt"},{"post_id":"cl1jj4ktr0020k84s82h5dcoy","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kuk005uk84sdb6pf0qi"},{"post_id":"cl1jj4kts0024k84scty28lr8","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kul005zk84s4x9a0x98"},{"post_id":"cl1jj4kts0024k84scty28lr8","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kum0062k84s6mor8lgw"},{"post_id":"cl1jj4kua004ok84sczau2y0n","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4kun0066k84shut97rz5"},{"post_id":"cl1jj4kub004rk84setu57zzh","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4kun0068k84s30t70iy8"},{"post_id":"cl1jj4ktt0026k84sg6kg5q9w","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuo006ck84sblgc8p45"},{"post_id":"cl1jj4ktt0026k84sg6kg5q9w","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kuo006ek84s2x4i5pw7"},{"post_id":"cl1jj4kud004xk84s4s6k5dke","category_id":"cl1jj4kt80009k84s6s6idm4o","_id":"cl1jj4kup006hk84s723x30xi"},{"post_id":"cl1jj4ktu002bk84sa8wfb44c","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuq006lk84s15vbgvo2"},{"post_id":"cl1jj4ktu002bk84sa8wfb44c","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kuq006ok84sf5qe3bzr"},{"post_id":"cl1jj4kuf0053k84se7sc2qj9","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kur006tk84s5pue0dpg"},{"post_id":"cl1jj4ktu002ek84sf4f56swa","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kur006vk84sh4vte6f3"},{"post_id":"cl1jj4ktu002ek84sf4f56swa","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kus0070k84se1vkhp9f"},{"post_id":"cl1jj4kug0056k84s1v1z4iiy","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kut0073k84s6v6xerym"},{"post_id":"cl1jj4kug0056k84s1v1z4iiy","category_id":"cl1jj4kto001ok84scxnd0x3a","_id":"cl1jj4kuu0078k84sc4sy6y4o"},{"post_id":"cl1jj4ktv002hk84s88yr987w","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuv007ak84senoah1vg"},{"post_id":"cl1jj4ktv002hk84s88yr987w","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kuw007ek84sf9l7hpxp"},{"post_id":"cl1jj4kui005ik84s7u7l50ya","category_id":"cl1jj4ktw002mk84s16sng7zz","_id":"cl1jj4kuw007gk84s25yf6zb0"},{"post_id":"cl1jj4ktw002lk84s2yhb9pz8","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kux007jk84sdizp30al"},{"post_id":"cl1jj4ktw002lk84s2yhb9pz8","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kuy007nk84sazjn1iqx"},{"post_id":"cl1jj4kui005mk84s6sl92ifz","category_id":"cl1jj4ktl0018k84s608zdrrv","_id":"cl1jj4kuy007rk84s69a0fljp"},{"post_id":"cl1jj4kuj005qk84s6ug17xsr","category_id":"cl1jj4ktl0018k84s608zdrrv","_id":"cl1jj4kuz007vk84s3v9l48yn"},{"post_id":"cl1jj4ktw002pk84sc6wb4q3n","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kuz007xk84s7bes5hai"},{"post_id":"cl1jj4ktw002pk84sc6wb4q3n","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kv0007zk84sgdr98kp1"},{"post_id":"cl1jj4kuk005tk84s3a409689","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv00080k84s8i7j57im"},{"post_id":"cl1jj4kuk005tk84s3a409689","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kv00083k84s4ynvfp91"},{"post_id":"cl1jj4ktx002tk84s8sga0r3a","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv00084k84s6npa73rq"},{"post_id":"cl1jj4ktx002tk84s8sga0r3a","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kv00088k84s0jh13j6h"},{"post_id":"cl1jj4kty002zk84sdqs75hph","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv1008ak84sh6ud1r9q"},{"post_id":"cl1jj4kun0067k84sdcnx8lia","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv1008ek84seb9a296l"},{"post_id":"cl1jj4kun0067k84sdcnx8lia","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4kv1008gk84s0ody6kdb"},{"post_id":"cl1jj4kuo006bk84sd6wm4wfn","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv1008kk84s2wv341y9"},{"post_id":"cl1jj4ktz0034k84sgivv7m3t","category_id":"cl1jj4kun006ak84s6k6b3wko","_id":"cl1jj4kv2008mk84sbuxhc41n"},{"post_id":"cl1jj4kup006gk84s4iu7a80l","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv2008pk84s26wde8aw"},{"post_id":"cl1jj4kup006gk84s4iu7a80l","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kv2008qk84sgpe1dmxb"},{"post_id":"cl1jj4kup006kk84s6fhca0m5","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv2008tk84sh5vv4jid"},{"post_id":"cl1jj4ku0003ck84sbfkefzpc","category_id":"cl1jj4kup006ik84sgtot8jfj","_id":"cl1jj4kv2008uk84s3s7z9kzp"},{"post_id":"cl1jj4ku1003gk84sewo26aqc","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv3008xk84sg8rxgqck"},{"post_id":"cl1jj4ku1003gk84sewo26aqc","category_id":"cl1jj4kuq006qk84s8ep8hojf","_id":"cl1jj4kv3008zk84shsplgodu"},{"post_id":"cl1jj4kur006uk84s4d0khoj2","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv30093k84sf9ggcpvu"},{"post_id":"cl1jj4kur006uk84s4d0khoj2","category_id":"cl1jj4ktd000pk84s12c3fx8r","_id":"cl1jj4kv30095k84sh0tlabwy"},{"post_id":"cl1jj4kus006zk84s76b1hky8","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv40098k84sadwuh72m"},{"post_id":"cl1jj4kus006zk84s76b1hky8","category_id":"cl1jj4ktd000pk84s12c3fx8r","_id":"cl1jj4kv4009ak84s8ijefsrl"},{"post_id":"cl1jj4ku2003nk84sborchjb0","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv5009dk84sa834f7xi"},{"post_id":"cl1jj4ku2003nk84sborchjb0","category_id":"cl1jj4kus006xk84s9f73ezsd","_id":"cl1jj4kv5009fk84sfklwfezc"},{"post_id":"cl1jj4kus0072k84s7k4g76bw","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv5009hk84sfizn3l37"},{"post_id":"cl1jj4kus0072k84s7k4g76bw","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kv5009jk84sgw8z7309"},{"post_id":"cl1jj4kuu0077k84s2059ct2d","category_id":"cl1jj4ktl0018k84s608zdrrv","_id":"cl1jj4kv6009mk84s2jhq88ft"},{"post_id":"cl1jj4ku3003pk84s3thabcqr","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv6009nk84s7vjmerfp"},{"post_id":"cl1jj4kuv0079k84s79rt6lls","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv6009pk84sacc92990"},{"post_id":"cl1jj4kuv0079k84s79rt6lls","category_id":"cl1jj4kus006xk84s9f73ezsd","_id":"cl1jj4kv6009rk84senjie6ek"},{"post_id":"cl1jj4kuv007dk84s8p852ce5","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv6009uk84s5x9468s1"},{"post_id":"cl1jj4ku50041k84s8jd00cri","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv6009vk84s9w4pd3sp"},{"post_id":"cl1jj4ku50041k84s8jd00cri","category_id":"cl1jj4kuv007ck84sh4179srj","_id":"cl1jj4kv6009xk84se56e0y3x"},{"post_id":"cl1jj4kuw007fk84sfcrg8isj","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv6009zk84sfq5p8oct"},{"post_id":"cl1jj4kuw007fk84sfcrg8isj","category_id":"cl1jj4kty0030k84saix34ohd","_id":"cl1jj4kv700a2k84sbzdp8ffa"},{"post_id":"cl1jj4kux007ik84sfyemajj1","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv700a3k84s0nic8d13"},{"post_id":"cl1jj4kux007ik84sfyemajj1","category_id":"cl1jj4ktq001uk84s7083dyzs","_id":"cl1jj4kv700a5k84s76so2zoy"},{"post_id":"cl1jj4kux007mk84s6hfz6ap3","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv700a7k84s263dgein"},{"post_id":"cl1jj4ku8004gk84s47a75fyh","category_id":"cl1jj4kup006ik84sgtot8jfj","_id":"cl1jj4kv700aak84s0ss64wt4"},{"post_id":"cl1jj4kuy007qk84s8zh64fnq","category_id":"cl1jj4ktw002mk84s16sng7zz","_id":"cl1jj4kv700ack84s8cqz9jpq"},{"post_id":"cl1jj4kuz007uk84s6x0gcbd5","category_id":"cl1jj4ktw002mk84s16sng7zz","_id":"cl1jj4kv700aek84s7msg8ezc"},{"post_id":"cl1jj4ku9004ik84shvg41ue7","category_id":"cl1jj4kuy007sk84s3a8oau3l","_id":"cl1jj4kv800afk84s96fi74id"},{"post_id":"cl1jj4kua004lk84s6h8ngrbv","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv800ahk84s5lpu6l8w"},{"post_id":"cl1jj4kua004lk84s6h8ngrbv","category_id":"cl1jj4kuz007yk84s05leei37","_id":"cl1jj4kv800aik84sefxx9a9m"},{"post_id":"cl1jj4kuc004uk84s8ef88aqa","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv800akk84sgzwa5h2x"},{"post_id":"cl1jj4kuc004uk84s8ef88aqa","category_id":"cl1jj4kuz007yk84s05leei37","_id":"cl1jj4kv800alk84s4twq9li7"},{"post_id":"cl1jj4kue0050k84sc59n9cwo","category_id":"cl1jj4kup006ik84sgtot8jfj","_id":"cl1jj4kv800ank84sgattbw47"},{"post_id":"cl1jj4kug005ak84sh03o4k69","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv800apk84s8e7mhk10"},{"post_id":"cl1jj4kuh005ek84s7gxg8icl","category_id":"cl1jj4kum0064k84s1vs5coqg","_id":"cl1jj4kv900ask84sfkclgkva"},{"post_id":"cl1jj4kul005yk84sbwhu1ptl","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kv900auk84sf0e8fnrv"},{"post_id":"cl1jj4kul005yk84sbwhu1ptl","category_id":"cl1jj4kuz007yk84s05leei37","_id":"cl1jj4kva00axk84s3u3r61q8"},{"post_id":"cl1jj4kul0061k84s7znmbiyj","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kva00azk84s6pyfgcop"},{"post_id":"cl1jj4kul0061k84s7znmbiyj","category_id":"cl1jj4kuz007yk84s05leei37","_id":"cl1jj4kva00b2k84se34schsk"},{"post_id":"cl1jj4kum0065k84sdqbibaez","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kva00b3k84scb2525vf"},{"post_id":"cl1jj4kum0065k84sdqbibaez","category_id":"cl1jj4kuz007yk84s05leei37","_id":"cl1jj4kva00b5k84s6a009bis"},{"post_id":"cl1jj4kuo006dk84s84av5wdo","category_id":"cl1jj4kv30092k84s96ohhsw4","_id":"cl1jj4kvb00b7k84s9lv8e8t9"},{"post_id":"cl1jj4kuq006nk84s39n68uzf","category_id":"cl1jj4kv40097k84sgmv09ak6","_id":"cl1jj4kvb00bak84sdtb4dlct"},{"post_id":"cl1jj4kur006sk84s3qgtd853","category_id":"cl1jj4kt50004k84s8l7l9m7d","_id":"cl1jj4kvb00bbk84s580d2cvc"},{"post_id":"cl1jj4kur006sk84s3qgtd853","category_id":"cl1jj4kus006xk84s9f73ezsd","_id":"cl1jj4kvb00bdk84sbplrd38m"}],"PostTag":[{"post_id":"cl1jj4kt00001k84sbt8dg481","tag_id":"cl1jj4kt60005k84s5uree33k","_id":"cl1jj4kta000gk84s903ogaiw"},{"post_id":"cl1jj4kt00001k84sbt8dg481","tag_id":"cl1jj4kt8000ak84s4jsfby1c","_id":"cl1jj4ktb000ik84scbytbe8e"},{"post_id":"cl1jj4kt30003k84sc0flf2kc","tag_id":"cl1jj4kta000ek84s72recefh","_id":"cl1jj4ktj0014k84samb5h5bh"},{"post_id":"cl1jj4kt30003k84sc0flf2kc","tag_id":"cl1jj4ktb000lk84sbfaghoka","_id":"cl1jj4ktl0017k84shiyg6lk8"},{"post_id":"cl1jj4kt30003k84sc0flf2kc","tag_id":"cl1jj4kte000qk84sabvw2gry","_id":"cl1jj4ktl001ck84s2z12a5dr"},{"post_id":"cl1jj4kt30003k84sc0flf2kc","tag_id":"cl1jj4ktf000wk84sbvybeab4","_id":"cl1jj4ktm001fk84sfxlh7rw4"},{"post_id":"cl1jj4kt60006k84sauale8de","tag_id":"cl1jj4kti0011k84s4oru9lno","_id":"cl1jj4ktn001kk84sb1uadz79"},{"post_id":"cl1jj4kt70007k84s0z3b5i3v","tag_id":"cl1jj4ktl0019k84s2dz14z9t","_id":"cl1jj4kto001nk84s51r0edil"},{"post_id":"cl1jj4kt70008k84s4umoe63i","tag_id":"cl1jj4ktn001hk84s4stzbl9t","_id":"cl1jj4kts0025k84s156v8ohb"},{"post_id":"cl1jj4kt70008k84s4umoe63i","tag_id":"cl1jj4ktp001rk84s9p14fl9p","_id":"cl1jj4ktt0029k84s7zz2ezn3"},{"post_id":"cl1jj4kt70008k84s4umoe63i","tag_id":"cl1jj4ktq001xk84s2r8k2nr4","_id":"cl1jj4ktu002dk84s1xaz2p6n"},{"post_id":"cl1jj4kt9000ck84s2vs57rn3","tag_id":"cl1jj4kts0022k84s3np1gq0v","_id":"cl1jj4ktv002kk84s6rwdhmt7"},{"post_id":"cl1jj4kt9000ck84s2vs57rn3","tag_id":"cl1jj4ktt002ak84s3k13hfpd","_id":"cl1jj4ktw002ok84sh1fyezud"},{"post_id":"cl1jj4kta000fk84s4nsr3jmx","tag_id":"cl1jj4ktl0019k84s2dz14z9t","_id":"cl1jj4ktx002sk84sacfr82bp"},{"post_id":"cl1jj4ktb000hk84s10ri5g0g","tag_id":"cl1jj4ktw002rk84s55ca4s11","_id":"cl1jj4ktz0036k84s93867zht"},{"post_id":"cl1jj4ktb000hk84s10ri5g0g","tag_id":"cl1jj4kty002yk84s4pscb7q5","_id":"cl1jj4ku0003ak84sapns940i"},{"post_id":"cl1jj4ktz0032k84shna61yuc","tag_id":"cl1jj4ktn001hk84s4stzbl9t","_id":"cl1jj4ku1003ek84s7a1m1bzy"},{"post_id":"cl1jj4ku00038k84sauteay1z","tag_id":"cl1jj4ktl0019k84s2dz14z9t","_id":"cl1jj4ku2003ik84s1dhk6sr1"},{"post_id":"cl1jj4ktb000mk84sd2n6f3bk","tag_id":"cl1jj4ktz0033k84s04gx3ye4","_id":"cl1jj4ku4003vk84s4lxwckah"},{"post_id":"cl1jj4ktb000mk84sd2n6f3bk","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4ku5003yk84sezii0evf"},{"post_id":"cl1jj4ktb000mk84sd2n6f3bk","tag_id":"cl1jj4ku2003lk84s466070q0","_id":"cl1jj4ku60043k84sgynv2uuz"},{"post_id":"cl1jj4ktc000nk84s3s6l9ug3","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4ku7004ak84s1ewgdmeb"},{"post_id":"cl1jj4ktc000nk84s3s6l9ug3","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4ku8004dk84sdkd5haym"},{"post_id":"cl1jj4kte000rk84s70m39o6o","tag_id":"cl1jj4ku60047k84s4waja85u","_id":"cl1jj4kug0058k84sh9onc7u0"},{"post_id":"cl1jj4kte000rk84s70m39o6o","tag_id":"cl1jj4ku8004fk84scirs93ia","_id":"cl1jj4kuh005ck84sfc85e5g3"},{"post_id":"cl1jj4kte000rk84s70m39o6o","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kuh005gk84s4bp5hj1v"},{"post_id":"cl1jj4kte000rk84s70m39o6o","tag_id":"cl1jj4kub004tk84s6ry9fiik","_id":"cl1jj4kui005kk84saqei1ytw"},{"post_id":"cl1jj4kte000rk84s70m39o6o","tag_id":"cl1jj4kue004zk84scz414uog","_id":"cl1jj4kuj005ok84sgpawh5hq"},{"post_id":"cl1jj4kte000sk84sgsvpczda","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kuk005sk84s7uzth6q8"},{"post_id":"cl1jj4kte000sk84sgsvpczda","tag_id":"cl1jj4kuh005dk84shwj60yhx","_id":"cl1jj4kul005wk84s6i1q6wym"},{"post_id":"cl1jj4ktf000uk84sgy12ao9i","tag_id":"cl1jj4kui005lk84sdlu5hpyg","_id":"cl1jj4kul0060k84sfxn8eey1"},{"post_id":"cl1jj4ktg000xk84s08k5861p","tag_id":"cl1jj4kuk005vk84s5uyp412i","_id":"cl1jj4kup006jk84sdoiacecq"},{"post_id":"cl1jj4ktg000xk84s08k5861p","tag_id":"cl1jj4kum0063k84se49igcmt","_id":"cl1jj4kuq006mk84sax66a0dg"},{"post_id":"cl1jj4ktg000xk84s08k5861p","tag_id":"cl1jj4kun0069k84s6aij4n2y","_id":"cl1jj4kur006rk84s8gp254s1"},{"post_id":"cl1jj4kth000yk84s473x848b","tag_id":"cl1jj4kup006fk84s659h5qn1","_id":"cl1jj4kus006yk84s7cog73sx"},{"post_id":"cl1jj4kth000yk84s473x848b","tag_id":"cl1jj4ktq001xk84s2r8k2nr4","_id":"cl1jj4kus0071k84shx1nh4nw"},{"post_id":"cl1jj4kus006zk84s76b1hky8","tag_id":"cl1jj4kt60005k84s5uree33k","_id":"cl1jj4kuu0076k84sf18w7vzw"},{"post_id":"cl1jj4kti0012k84s6zmm67bo","tag_id":"cl1jj4kus006wk84s5x7ohfkw","_id":"cl1jj4kux007lk84s90s0bebu"},{"post_id":"cl1jj4kti0012k84s6zmm67bo","tag_id":"cl1jj4kuu0074k84sggyi5qs9","_id":"cl1jj4kuy007ok84s7h58c610"},{"post_id":"cl1jj4kti0012k84s6zmm67bo","tag_id":"cl1jj4kuv007bk84s3j0fhy6s","_id":"cl1jj4kuz007tk84sh9uved6m"},{"post_id":"cl1jj4ktj0015k84s28lvbk1k","tag_id":"cl1jj4kuu0074k84sggyi5qs9","_id":"cl1jj4kv00087k84s5dxggu5k"},{"post_id":"cl1jj4ktj0015k84s28lvbk1k","tag_id":"cl1jj4kun0069k84s6aij4n2y","_id":"cl1jj4kv10089k84s61a97ln2"},{"post_id":"cl1jj4ktj0015k84s28lvbk1k","tag_id":"cl1jj4kuz007wk84s05tdfudk","_id":"cl1jj4kv1008dk84sd8sv0ql8"},{"post_id":"cl1jj4ktj0015k84s28lvbk1k","tag_id":"cl1jj4ktl0019k84s2dz14z9t","_id":"cl1jj4kv1008fk84sc5ib0m8f"},{"post_id":"cl1jj4ktl001ak84scb3qc5gh","tag_id":"cl1jj4ktn001hk84s4stzbl9t","_id":"cl1jj4kv1008jk84s7vsc086p"},{"post_id":"cl1jj4ktl001ak84scb3qc5gh","tag_id":"cl1jj4ktq001xk84s2r8k2nr4","_id":"cl1jj4kv1008lk84sbblyfrw9"},{"post_id":"cl1jj4ktm001dk84salvl12uy","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kv3008yk84s8dln3e4u"},{"post_id":"cl1jj4ktm001dk84salvl12uy","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv30090k84sfmg15wul"},{"post_id":"cl1jj4ktm001dk84salvl12uy","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4kv30094k84s0grkc8db"},{"post_id":"cl1jj4ktn001ik84sf1ae55l3","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv40099k84s0xzd2z8q"},{"post_id":"cl1jj4ktn001ik84sf1ae55l3","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4kv4009bk84s8kbp616j"},{"post_id":"cl1jj4ktn001lk84s9zp0aemq","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kv5009ik84shg7j8r8a"},{"post_id":"cl1jj4ktn001lk84s9zp0aemq","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv5009kk84s308i94e8"},{"post_id":"cl1jj4kto001pk84sdeleh3cl","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kv6009qk84sc2wtewvs"},{"post_id":"cl1jj4kto001pk84sdeleh3cl","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv6009sk84shqd33r2g"},{"post_id":"cl1jj4ktp001sk84s627affkl","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv6009yk84saxak5ewi"},{"post_id":"cl1jj4ktp001sk84s627affkl","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kv600a0k84s8k7p9rq8"},{"post_id":"cl1jj4ktq001vk84scrt94yuv","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kv700a6k84sfzgy29sw"},{"post_id":"cl1jj4ktq001vk84scrt94yuv","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv700a8k84sehxibp2a"},{"post_id":"cl1jj4ktr001yk84s13hrgado","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv700abk84sc71l6lns"},{"post_id":"cl1jj4ktr0020k84s82h5dcoy","tag_id":"cl1jj4kv700a9k84sgtuz22az","_id":"cl1jj4kv800aok84s1qaf6sra"},{"post_id":"cl1jj4ktr0020k84s82h5dcoy","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kv900aqk84sf87529f1"},{"post_id":"cl1jj4ktr0020k84s82h5dcoy","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kv900atk84sbmlyf8w0"},{"post_id":"cl1jj4ktr0020k84s82h5dcoy","tag_id":"cl1jj4kv800ajk84s06dd30zd","_id":"cl1jj4kv900avk84s69hi0zqz"},{"post_id":"cl1jj4kts0024k84scty28lr8","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kva00ayk84sdrfo2e5j"},{"post_id":"cl1jj4kts0024k84scty28lr8","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4kva00b0k84s5z5z9erm"},{"post_id":"cl1jj4ktt0026k84sg6kg5q9w","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvb00b6k84sgbr52ck2"},{"post_id":"cl1jj4ktt0026k84sg6kg5q9w","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4kvb00b8k84s0ntughgh"},{"post_id":"cl1jj4ktu002bk84sa8wfb44c","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kvc00bfk84s0scqbn5d"},{"post_id":"cl1jj4ktu002bk84sa8wfb44c","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvc00bgk84s8pp9hw36"},{"post_id":"cl1jj4ktu002bk84sa8wfb44c","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4kvc00bik84s2qv0c6pm"},{"post_id":"cl1jj4ktu002ek84sf4f56swa","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvc00bjk84sh4st4e3v"},{"post_id":"cl1jj4ktv002hk84s88yr987w","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvc00bmk84s2agtf1go"},{"post_id":"cl1jj4ktv002hk84s88yr987w","tag_id":"cl1jj4ku5003zk84s1nkohpeb","_id":"cl1jj4kvc00bnk84s6eaxecq3"},{"post_id":"cl1jj4ktw002lk84s2yhb9pz8","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvd00bpk84s31q64liw"},{"post_id":"cl1jj4ktw002pk84sc6wb4q3n","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvd00brk84s3sal4eza"},{"post_id":"cl1jj4ktx002tk84s8sga0r3a","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvd00btk84s8ywz60sl"},{"post_id":"cl1jj4ktx002wk84s2ixjdx7s","tag_id":"cl1jj4kvd00bsk84sbrerdq9r","_id":"cl1jj4kve00bwk84s94di5ihn"},{"post_id":"cl1jj4ktx002wk84s2ixjdx7s","tag_id":"cl1jj4kvd00buk84sgb8s3x0t","_id":"cl1jj4kve00bxk84scm9827w9"},{"post_id":"cl1jj4kty002zk84sdqs75hph","tag_id":"cl1jj4kve00bvk84sdjdl7y9s","_id":"cl1jj4kve00c0k84sdest3xx9"},{"post_id":"cl1jj4kty002zk84sdqs75hph","tag_id":"cl1jj4kve00byk84sc4y7eiml","_id":"cl1jj4kve00c1k84s90zadcth"},{"post_id":"cl1jj4ktz0034k84sgivv7m3t","tag_id":"cl1jj4kve00bzk84s76yxefyv","_id":"cl1jj4kvf00c4k84s7ml8dgwx"},{"post_id":"cl1jj4ktz0034k84sgivv7m3t","tag_id":"cl1jj4kve00c2k84sc4wzbz63","_id":"cl1jj4kvf00c5k84s9jru7bo2"},{"post_id":"cl1jj4ku0003ck84sbfkefzpc","tag_id":"cl1jj4kve00c3k84se2sxf6ne","_id":"cl1jj4kvf00c7k84sc10z7uoq"},{"post_id":"cl1jj4ku1003gk84sewo26aqc","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvf00cbk84sepqo335t"},{"post_id":"cl1jj4ku1003gk84sewo26aqc","tag_id":"cl1jj4kvf00c8k84s9tnyds9d","_id":"cl1jj4kvf00cck84s12ae057y"},{"post_id":"cl1jj4ku1003gk84sewo26aqc","tag_id":"cl1jj4kvf00c9k84sapribjto","_id":"cl1jj4kvg00cek84s9b035a4o"},{"post_id":"cl1jj4ku2003jk84sa1zn171y","tag_id":"cl1jj4kvf00cak84s08g8amh9","_id":"cl1jj4kvg00cfk84s2cmz08zi"},{"post_id":"cl1jj4ku2003nk84sborchjb0","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvg00chk84s1mdpg5pl"},{"post_id":"cl1jj4ku3003pk84s3thabcqr","tag_id":"cl1jj4kve00bvk84sdjdl7y9s","_id":"cl1jj4kvg00ckk84s8rzk43pm"},{"post_id":"cl1jj4ku3003pk84s3thabcqr","tag_id":"cl1jj4kvg00cik84saa3339yz","_id":"cl1jj4kvg00clk84s9oe159nr"},{"post_id":"cl1jj4ku4003tk84s70bf0mbc","tag_id":"cl1jj4kvg00cjk84s252xca6m","_id":"cl1jj4kvg00cok84s41le9nwb"},{"post_id":"cl1jj4ku4003tk84s70bf0mbc","tag_id":"cl1jj4kvg00cmk84s50zo2ljb","_id":"cl1jj4kvg00cpk84sctnxaxak"},{"post_id":"cl1jj4ku4003wk84sfhpjfou2","tag_id":"cl1jj4kvg00cnk84s4llke8b1","_id":"cl1jj4kvh00ctk84s9tgggsm9"},{"post_id":"cl1jj4ku4003wk84sfhpjfou2","tag_id":"cl1jj4kuu0074k84sggyi5qs9","_id":"cl1jj4kvh00cuk84sc6mxew3o"},{"post_id":"cl1jj4ku4003wk84sfhpjfou2","tag_id":"cl1jj4kvh00crk84sf7lc78gc","_id":"cl1jj4kvh00cwk84shevq7n7f"},{"post_id":"cl1jj4ku50041k84s8jd00cri","tag_id":"cl1jj4ktl0019k84s2dz14z9t","_id":"cl1jj4kvh00cxk84s5kvccbu1"},{"post_id":"cl1jj4ku50041k84s8jd00cri","tag_id":"cl1jj4kvh00csk84sbx0o3rh1","_id":"cl1jj4kvh00czk84sded2411p"},{"post_id":"cl1jj4ku60044k84s2euxhp1k","tag_id":"cl1jj4kvh00cvk84sato91j3z","_id":"cl1jj4kvi00d1k84sfk2z846k"},{"post_id":"cl1jj4ku60044k84s2euxhp1k","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kvi00d2k84s53otbtpx"},{"post_id":"cl1jj4ku60044k84s2euxhp1k","tag_id":"cl1jj4kvh00cyk84seqi46os0","_id":"cl1jj4kvi00d4k84sc22n65i0"},{"post_id":"cl1jj4ku70048k84se2k20k8g","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvi00d5k84s485p6vse"},{"post_id":"cl1jj4ku7004bk84s8pdhgyte","tag_id":"cl1jj4kvi00d3k84se5iw1wal","_id":"cl1jj4kvi00d8k84se9ew1i57"},{"post_id":"cl1jj4ku7004bk84s8pdhgyte","tag_id":"cl1jj4kvi00d6k84s7shl9loo","_id":"cl1jj4kvi00d9k84s121td59g"},{"post_id":"cl1jj4ku8004gk84s47a75fyh","tag_id":"cl1jj4kvi00d7k84sax0ahwi2","_id":"cl1jj4kvj00dbk84s37pnfwss"},{"post_id":"cl1jj4ku9004ik84shvg41ue7","tag_id":"cl1jj4kve00bzk84s76yxefyv","_id":"cl1jj4kvj00dek84sfefd8nzw"},{"post_id":"cl1jj4ku9004ik84shvg41ue7","tag_id":"cl1jj4kvj00dck84sd5za1div","_id":"cl1jj4kvj00dfk84s7jm228fi"},{"post_id":"cl1jj4kua004lk84s6h8ngrbv","tag_id":"cl1jj4kvj00ddk84sedo09qbh","_id":"cl1jj4kvj00dhk84s7x52gw2c"},{"post_id":"cl1jj4kua004ok84sczau2y0n","tag_id":"cl1jj4ktn001hk84s4stzbl9t","_id":"cl1jj4kvk00dmk84sa3zqfrqu"},{"post_id":"cl1jj4kua004ok84sczau2y0n","tag_id":"cl1jj4kvj00dgk84s4ev9bsjc","_id":"cl1jj4kvk00dnk84s0kez0spm"},{"post_id":"cl1jj4kua004ok84sczau2y0n","tag_id":"cl1jj4kvj00dik84sd9z8800c","_id":"cl1jj4kvk00dpk84s3afbb84y"},{"post_id":"cl1jj4kua004ok84sczau2y0n","tag_id":"cl1jj4kte000qk84sabvw2gry","_id":"cl1jj4kvk00dqk84s824tgqlf"},{"post_id":"cl1jj4kua004ok84sczau2y0n","tag_id":"cl1jj4kvj00djk84sczst6jdb","_id":"cl1jj4kvk00dsk84s92x2bzfn"},{"post_id":"cl1jj4kua004ok84sczau2y0n","tag_id":"cl1jj4kvj00dkk84sgave4s6m","_id":"cl1jj4kvk00dtk84s0ajmd52m"},{"post_id":"cl1jj4kub004rk84setu57zzh","tag_id":"cl1jj4ktn001hk84s4stzbl9t","_id":"cl1jj4kvk00dvk84s0gaiamih"},{"post_id":"cl1jj4kub004rk84setu57zzh","tag_id":"cl1jj4kvj00dlk84s9ar75gv9","_id":"cl1jj4kvk00dwk84sbsoths2l"},{"post_id":"cl1jj4kub004rk84setu57zzh","tag_id":"cl1jj4kvj00dkk84sgave4s6m","_id":"cl1jj4kvl00dyk84sb5djaoeq"},{"post_id":"cl1jj4kub004rk84setu57zzh","tag_id":"cl1jj4kte000qk84sabvw2gry","_id":"cl1jj4kvl00dzk84s6bk3e8cd"},{"post_id":"cl1jj4kuc004uk84s8ef88aqa","tag_id":"cl1jj4kvj00ddk84sedo09qbh","_id":"cl1jj4kvl00e1k84s3t538w4p"},{"post_id":"cl1jj4kud004xk84s4s6k5dke","tag_id":"cl1jj4ktn001hk84s4stzbl9t","_id":"cl1jj4kvl00e2k84s8ejv7a13"},{"post_id":"cl1jj4kud004xk84s4s6k5dke","tag_id":"cl1jj4ktq001xk84s2r8k2nr4","_id":"cl1jj4kvl00e3k84s9omrbw0t"},{"post_id":"cl1jj4kud004xk84s4s6k5dke","tag_id":"cl1jj4kvk00duk84s9o5bhqa5","_id":"cl1jj4kvl00e5k84s7fk6fajm"},{"post_id":"cl1jj4kue0050k84sc59n9cwo","tag_id":"cl1jj4kvk00dxk84s64gye4g0","_id":"cl1jj4kvl00e6k84s2c1r9lr6"},{"post_id":"cl1jj4kuf0053k84se7sc2qj9","tag_id":"cl1jj4kvl00e0k84sgash5avs","_id":"cl1jj4kvm00eak84sgtkq413q"},{"post_id":"cl1jj4kuf0053k84se7sc2qj9","tag_id":"cl1jj4kvl00e4k84s2c0u1a1i","_id":"cl1jj4kvm00ebk84s806ddshm"},{"post_id":"cl1jj4kuf0053k84se7sc2qj9","tag_id":"cl1jj4kvg00cnk84s4llke8b1","_id":"cl1jj4kvm00edk84shslfc3dl"},{"post_id":"cl1jj4kuf0053k84se7sc2qj9","tag_id":"cl1jj4kvl00e8k84sedjmdefg","_id":"cl1jj4kvm00eek84s61c68892"},{"post_id":"cl1jj4kug0056k84s1v1z4iiy","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kvn00egk84sgbsdbd30"},{"post_id":"cl1jj4kug0056k84s1v1z4iiy","tag_id":"cl1jj4kvl00e9k84s8e6femmn","_id":"cl1jj4kvn00ehk84s30m9gufj"},{"post_id":"cl1jj4kug005ak84sh03o4k69","tag_id":"cl1jj4kvg00cik84saa3339yz","_id":"cl1jj4kvn00ejk84s1i6kf5nn"},{"post_id":"cl1jj4kuh005ek84s7gxg8icl","tag_id":"cl1jj4kvm00efk84s6eh603ov","_id":"cl1jj4kvn00emk84sdpqdd9mz"},{"post_id":"cl1jj4kuh005ek84s7gxg8icl","tag_id":"cl1jj4kvn00eik84s3l7h2yeu","_id":"cl1jj4kvn00enk84sgc5k028p"},{"post_id":"cl1jj4kuh005ek84s7gxg8icl","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvn00epk84s44v94xc7"},{"post_id":"cl1jj4kui005ik84s7u7l50ya","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvo00eqk84s4dwzec52"},{"post_id":"cl1jj4kui005ik84s7u7l50ya","tag_id":"cl1jj4ktq001xk84s2r8k2nr4","_id":"cl1jj4kvo00esk84s0ecc8yml"},{"post_id":"cl1jj4kui005mk84s6sl92ifz","tag_id":"cl1jj4kvn00eok84s5fr1eaf4","_id":"cl1jj4kvo00euk84s9qko4skk"},{"post_id":"cl1jj4kui005mk84s6sl92ifz","tag_id":"cl1jj4kvf00cak84s08g8amh9","_id":"cl1jj4kvo00evk84s58sea60u"},{"post_id":"cl1jj4kuj005qk84s6ug17xsr","tag_id":"cl1jj4kvf00cak84s08g8amh9","_id":"cl1jj4kvr00exk84sazcbfe6x"},{"post_id":"cl1jj4kuj005qk84s6ug17xsr","tag_id":"cl1jj4ktt002ak84s3k13hfpd","_id":"cl1jj4kvr00eyk84s9m2kdwqt"},{"post_id":"cl1jj4kuj005qk84s6ug17xsr","tag_id":"cl1jj4kts0022k84s3np1gq0v","_id":"cl1jj4kvs00f0k84s46dnf4mx"},{"post_id":"cl1jj4kuk005tk84s3a409689","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvs00f1k84seam563yn"},{"post_id":"cl1jj4kul005yk84sbwhu1ptl","tag_id":"cl1jj4kvj00ddk84sedo09qbh","_id":"cl1jj4kvs00f3k84saypc1zfy"},{"post_id":"cl1jj4kul0061k84s7znmbiyj","tag_id":"cl1jj4kvj00ddk84sedo09qbh","_id":"cl1jj4kvs00f6k84s5plz9vub"},{"post_id":"cl1jj4kul0061k84s7znmbiyj","tag_id":"cl1jj4kvl00e9k84s8e6femmn","_id":"cl1jj4kvs00f7k84sf2xjh36u"},{"post_id":"cl1jj4kum0065k84sdqbibaez","tag_id":"cl1jj4kvj00ddk84sedo09qbh","_id":"cl1jj4kvt00f9k84se7pi1n6c"},{"post_id":"cl1jj4kun0067k84sdcnx8lia","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kvt00fck84s7by7eo3f"},{"post_id":"cl1jj4kun0067k84sdcnx8lia","tag_id":"cl1jj4kvs00f8k84s1u7oahwd","_id":"cl1jj4kvt00fdk84s1yawabjr"},{"post_id":"cl1jj4kun0067k84sdcnx8lia","tag_id":"cl1jj4kv800ajk84s06dd30zd","_id":"cl1jj4kvt00ffk84s1969g03r"},{"post_id":"cl1jj4kuo006bk84sd6wm4wfn","tag_id":"cl1jj4kvn00eik84s3l7h2yeu","_id":"cl1jj4kvt00fgk84s2cgp993x"},{"post_id":"cl1jj4kuo006dk84s84av5wdo","tag_id":"cl1jj4kvt00fek84sba8nb0z5","_id":"cl1jj4kvu00fjk84semc91pmz"},{"post_id":"cl1jj4kuo006dk84s84av5wdo","tag_id":"cl1jj4kvt00fhk84s41sb7299","_id":"cl1jj4kvu00fkk84s9a6m81iv"},{"post_id":"cl1jj4kup006gk84s4iu7a80l","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvv00fmk84sg9wth80m"},{"post_id":"cl1jj4kup006kk84s6fhca0m5","tag_id":"cl1jj4kvn00eik84s3l7h2yeu","_id":"cl1jj4kvv00fok84s0mzo4437"},{"post_id":"cl1jj4kuq006nk84s39n68uzf","tag_id":"cl1jj4kvv00fnk84s63eean7i","_id":"cl1jj4kvv00fqk84s6y4sgv20"},{"post_id":"cl1jj4kur006sk84s3qgtd853","tag_id":"cl1jj4kvv00fpk84sdzu7ej4q","_id":"cl1jj4kvv00ftk84sfq8i8v8l"},{"post_id":"cl1jj4kur006sk84s3qgtd853","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvv00fuk84sa1p89kpw"},{"post_id":"cl1jj4kur006uk84s4d0khoj2","tag_id":"cl1jj4kvv00fsk84s99pj1ie5","_id":"cl1jj4kvw00fwk84s2mjgaste"},{"post_id":"cl1jj4kur006uk84s4d0khoj2","tag_id":"cl1jj4kt60005k84s5uree33k","_id":"cl1jj4kvx00fxk84shq980h0m"},{"post_id":"cl1jj4kus0072k84s7k4g76bw","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvx00g0k84sdsu6gefb"},{"post_id":"cl1jj4kus0072k84s7k4g76bw","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvx00g1k84s6p8beg47"},{"post_id":"cl1jj4kuu0077k84s2059ct2d","tag_id":"cl1jj4kvx00fzk84s534whv0g","_id":"cl1jj4kvx00g3k84sfxfo1q1d"},{"post_id":"cl1jj4kuv0079k84s79rt6lls","tag_id":"cl1jj4kvv00fpk84sdzu7ej4q","_id":"cl1jj4kvy00g6k84se35b2agu"},{"post_id":"cl1jj4kuv0079k84s79rt6lls","tag_id":"cl1jj4kvf00c6k84sdz86gma1","_id":"cl1jj4kvy00g7k84s713394bn"},{"post_id":"cl1jj4kuv007dk84s8p852ce5","tag_id":"cl1jj4kvx00g5k84s22b3g62p","_id":"cl1jj4kvy00gbk84s0lh4dwv5"},{"post_id":"cl1jj4kuv007dk84s8p852ce5","tag_id":"cl1jj4kvy00g8k84sesjhcvp6","_id":"cl1jj4kvy00gck84s6e03flvt"},{"post_id":"cl1jj4kuv007dk84s8p852ce5","tag_id":"cl1jj4kuu0074k84sggyi5qs9","_id":"cl1jj4kvz00gek84sfjso75oe"},{"post_id":"cl1jj4kuv007dk84s8p852ce5","tag_id":"cl1jj4kvy00g9k84s5cki85kt","_id":"cl1jj4kvz00gfk84s01nk19v9"},{"post_id":"cl1jj4kuw007fk84sfcrg8isj","tag_id":"cl1jj4kv2008nk84s161bgkb6","_id":"cl1jj4kvz00ghk84sah0v68mb"},{"post_id":"cl1jj4kux007ik84sfyemajj1","tag_id":"cl1jj4ku0003bk84s7zne1aop","_id":"cl1jj4kvz00gik84s2nel88zr"},{"post_id":"cl1jj4kux007ik84sfyemajj1","tag_id":"cl1jj4kvh00cyk84seqi46os0","_id":"cl1jj4kvz00gkk84sdpunbipo"},{"post_id":"cl1jj4kux007mk84s6hfz6ap3","tag_id":"cl1jj4kvz00ggk84sg1wdf1l9","_id":"cl1jj4kw000gok84s2xez6quv"},{"post_id":"cl1jj4kux007mk84s6hfz6ap3","tag_id":"cl1jj4kvm00efk84s6eh603ov","_id":"cl1jj4kw000gpk84sb4xx3k7h"},{"post_id":"cl1jj4kux007mk84s6hfz6ap3","tag_id":"cl1jj4kvz00glk84s7z265w0v","_id":"cl1jj4kw000grk84s401r04hx"},{"post_id":"cl1jj4kux007mk84s6hfz6ap3","tag_id":"cl1jj4kvz00gmk84s687v31rc","_id":"cl1jj4kw000gsk84samck0gtl"},{"post_id":"cl1jj4kuy007qk84s8zh64fnq","tag_id":"cl1jj4kvz00gnk84s7vkm9tae","_id":"cl1jj4kw000gtk84sczsshm9k"},{"post_id":"cl1jj4kuy007qk84s8zh64fnq","tag_id":"cl1jj4kuu0074k84sggyi5qs9","_id":"cl1jj4kw000guk84sb1yk6eoq"},{"post_id":"cl1jj4kuz007uk84s6x0gcbd5","tag_id":"cl1jj4kw000gqk84s5gg3frzx","_id":"cl1jj4kw000gvk84sde7jdi9o"}],"Tag":[{"name":"Active Directory","_id":"cl1jj4kt60005k84s5uree33k"},{"name":"Tips","_id":"cl1jj4kt8000ak84s4jsfby1c"},{"name":"APC","_id":"cl1jj4kta000ek84s72recefh"},{"name":"PECL","_id":"cl1jj4ktb000lk84sbfaghoka"},{"name":"PHP","_id":"cl1jj4kte000qk84sabvw2gry"},{"name":"Yum","_id":"cl1jj4ktf000wk84sbvybeab4"},{"name":"Vobsub","_id":"cl1jj4kti0011k84s4oru9lno"},{"name":"Windows","_id":"cl1jj4ktl0019k84s2dz14z9t"},{"name":"CentOS","_id":"cl1jj4ktn001hk84s4stzbl9t"},{"name":"Kernel","_id":"cl1jj4ktp001rk84s9p14fl9p"},{"name":"VMware","_id":"cl1jj4ktq001xk84s2r8k2nr4"},{"name":"GitHub","_id":"cl1jj4kts0022k84s3np1gq0v"},{"name":"Hexo","_id":"cl1jj4ktt002ak84s3k13hfpd"},{"name":"DCOM","_id":"cl1jj4ktw002rk84s55ca4s11"},{"name":"Excel","_id":"cl1jj4kty002yk84s4pscb7q5"},{"name":"最佳实践","_id":"cl1jj4ktz0033k84s04gx3ye4"},{"name":"Exchange","_id":"cl1jj4ku0003bk84s7zne1aop"},{"name":"Kerberos","_id":"cl1jj4ku2003lk84s466070q0"},{"name":"Rollup","_id":"cl1jj4ku5003zk84s1nkohpeb"},{"name":"Activesync","_id":"cl1jj4ku60047k84s4waja85u"},{"name":"Android","_id":"cl1jj4ku8004fk84scirs93ia"},{"name":"Google","_id":"cl1jj4kub004tk84s6ry9fiik"},{"name":"Nexus","_id":"cl1jj4kue004zk84scz414uog"},{"name":"日志","_id":"cl1jj4kuh005dk84shwj60yhx"},{"name":"CentOS, LVM, 扩容, 根分区","_id":"cl1jj4kui005lk84sdlu5hpyg"},{"name":"Java","_id":"cl1jj4kuk005vk84s5uyp412i"},{"name":"JRE","_id":"cl1jj4kum0063k84se49igcmt"},{"name":"MSI","_id":"cl1jj4kun0069k84s6aij4n2y"},{"name":"Virtual Center","_id":"cl1jj4kup006fk84s659h5qn1"},{"name":"BITS","_id":"cl1jj4kus006wk84s5x7ohfkw"},{"name":"Microsoft","_id":"cl1jj4kuu0074k84sggyi5qs9"},{"name":"WSUS","_id":"cl1jj4kuv007bk84s3j0fhy6s"},{"name":"Office","_id":"cl1jj4kuz007wk84s05tdfudk"},{"name":"HMC","_id":"cl1jj4kv2008nk84s161bgkb6"},{"name":"Autodiscover","_id":"cl1jj4kv700a9k84sgtuz22az"},{"name":"MultiTenancy","_id":"cl1jj4kv800ajk84s06dd30zd"},{"name":"GeoIP","_id":"cl1jj4kvd00bsk84sbrerdq9r"},{"name":"MaxMind","_id":"cl1jj4kvd00buk84sgb8s3x0t"},{"name":"XMPP","_id":"cl1jj4kve00bvk84sdjdl7y9s"},{"name":"Gmail","_id":"cl1jj4kve00byk84sc4y7eiml"},{"name":"Ubuntu","_id":"cl1jj4kve00bzk84s76yxefyv"},{"name":"Linux","_id":"cl1jj4kve00c2k84sc4wzbz63"},{"name":"Hackintosh, macOS, Mojave","_id":"cl1jj4kve00c3k84se2sxf6ne"},{"name":"MSSQL","_id":"cl1jj4kvf00c6k84sdz86gma1"},{"name":"SSRS","_id":"cl1jj4kvf00c8k84s9tnyds9d"},{"name":"TeraData","_id":"cl1jj4kvf00c9k84sapribjto"},{"name":"WordPress","_id":"cl1jj4kvf00cak84s08g8amh9"},{"name":"Communicator","_id":"cl1jj4kvg00cik84saa3339yz"},{"name":"SCVMM","_id":"cl1jj4kvg00cjk84s252xca6m"},{"name":"VMHost","_id":"cl1jj4kvg00cmk84s50zo2ljb"},{"name":"Internet Explorer","_id":"cl1jj4kvg00cnk84s4llke8b1"},{"name":"Fiddler","_id":"cl1jj4kvh00crk84sf7lc78gc"},{"name":"WMIC","_id":"cl1jj4kvh00csk84sbx0o3rh1"},{"name":"VBScript","_id":"cl1jj4kvh00cvk84sato91j3z"},{"name":"PowerShell","_id":"cl1jj4kvh00cyk84seqi46os0"},{"name":"IIS","_id":"cl1jj4kvi00d3k84se5iw1wal"},{"name":"Rewrite","_id":"cl1jj4kvi00d6k84s7shl9loo"},{"name":"HP, EliteDesk, 黑苹果, Hackintosh","_id":"cl1jj4kvi00d7k84sax0ahwi2"},{"name":"Docker","_id":"cl1jj4kvj00dck84sd5za1div"},{"name":"MSCRM","_id":"cl1jj4kvj00ddk84sedo09qbh"},{"name":"LEMP","_id":"cl1jj4kvj00dgk84s4ev9bsjc"},{"name":"Nginx","_id":"cl1jj4kvj00dik84sd9z8800c"},{"name":"MariaDB","_id":"cl1jj4kvj00djk84sczst6jdb"},{"name":"MySQL","_id":"cl1jj4kvj00dkk84sgave4s6m"},{"name":"Lighttpd","_id":"cl1jj4kvj00dlk84s9ar75gv9"},{"name":"VMware Tools","_id":"cl1jj4kvk00duk84s9o5bhqa5"},{"name":"Intel, NUC, Bean Canyon, 黑苹果, Hackintosh, 读卡器, 魔改","_id":"cl1jj4kvk00dxk84s64gye4g0"},{"name":"Event ID","_id":"cl1jj4kvl00e0k84sgash5avs"},{"name":"Group Policy","_id":"cl1jj4kvl00e4k84s2c0u1a1i"},{"name":"Zonemapping","_id":"cl1jj4kvl00e8k84sedjmdefg"},{"name":"Outlook","_id":"cl1jj4kvl00e9k84s8e6femmn"},{"name":"Lync","_id":"cl1jj4kvm00efk84s6eh603ov"},{"name":"OCS","_id":"cl1jj4kvn00eik84s3l7h2yeu"},{"name":"Movable Type","_id":"cl1jj4kvn00eok84s5fr1eaf4"},{"name":"Hosting","_id":"cl1jj4kvs00f8k84s1u7oahwd"},{"name":"Packt","_id":"cl1jj4kvt00fek84sba8nb0z5"},{"name":"eBook","_id":"cl1jj4kvt00fhk84s41sb7299"},{"name":"Python","_id":"cl1jj4kvv00fnk84s63eean7i"},{"name":"Reporting Service","_id":"cl1jj4kvv00fpk84sdzu7ej4q"},{"name":"SPN","_id":"cl1jj4kvv00fsk84s99pj1ie5"},{"name":"Web, 404, https, 腾讯","_id":"cl1jj4kvx00fzk84s534whv0g"},{"name":"Chrome","_id":"cl1jj4kvx00g5k84s22b3g62p"},{"name":"Cookie","_id":"cl1jj4kvy00g8k84sesjhcvp6"},{"name":"MSDN","_id":"cl1jj4kvy00g9k84s5cki85kt"},{"name":"Skype for Business","_id":"cl1jj4kvz00ggk84sg1wdf1l9"},{"name":"DHCP","_id":"cl1jj4kvz00glk84s7z265w0v"},{"name":"Cisco","_id":"cl1jj4kvz00gmk84s687v31rc"},{"name":"Virtual Server","_id":"cl1jj4kvz00gnk84s7vkm9tae"},{"name":"VirtualBox","_id":"cl1jj4kw000gqk84s5gg3frzx"}]}}