{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":1,"renderable":0},{"_id":"themes/maupassant/source/css/jquery.fancybox.css","path":"css/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/maupassant/source/css/style.scss","path":"css/style.scss","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","path":"js/codeblock-resizer.js","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/fancybox.js","path":"js/fancybox.js","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/search.js","path":"js/search.js","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/share.js","path":"js/share.js","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/smartresize.js","path":"js/smartresize.js","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/toggle_menu.js","path":"js/toggle_menu.js","modified":1,"renderable":1},{"_id":"themes/maupassant/source/js/totop.js","path":"js/totop.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/404.md","hash":"fa2962fe80e2f50863bca41720203736aba7afd2","modified":1497596072000},{"_id":"source/CNAME","hash":"8e84eb65c9edda5062eb18d71a9cd8205d454d92","modified":1497541950000},{"_id":"themes/maupassant/.gitignore","hash":"2da79b8fb11dea4b2bee6e0078415eacce8fddf2","modified":1497509064000},{"_id":"themes/maupassant/.travis.yml","hash":"6266b8281f0cf7a8764b0b62621ce9a3ab78ac27","modified":1497509064000},{"_id":"themes/maupassant/LICENSE","hash":"dde2fd301d984b142989c2b208b5b360602f64cb","modified":1497509064000},{"_id":"themes/maupassant/README.md","hash":"038a02c93c77f55248a2f319a2ed0aa325127d57","modified":1497509064000},{"_id":"themes/maupassant/_config.yml","hash":"0feaee4baa6867d3fa5fee9080d29f16952d1243","modified":1497602160000},{"_id":"themes/maupassant/package.json","hash":"81fb4e2ac051ecfb9a93f37b28910291b939771a","modified":1497509064000},{"_id":"source/_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it.md","hash":"9da8c956d48f9f4918f3ede9ecc3b1cdbd2f22e5","modified":1497603922000},{"_id":"source/_posts/apc-undefined-symbol-pcre-exec-in-unknown-on-line-0.md","hash":"dd8e51f58ee66beb98accf79d2b46c3229dde411","modified":1497603850000},{"_id":"source/_posts/centos-64-upgrade-to-kernel-3x.md","hash":"ff4dda5628107f2e6a9ae9ed4728d5ed31ce282f","modified":1497603966000},{"_id":"source/_posts/change-idx-sub-order.md","hash":"1487df337b0e2c3747a928fa70c601ab4aab8dc9","modified":1497604016000},{"_id":"source/_posts/exception-from-hresult-0x800a03ec.md","hash":"568de4072422d425f5d68048318c2282cb2a8fd6","modified":1502852140000},{"_id":"source/_posts/exchange-2010-best-practice-01-cas-array.md","hash":"2ec924f547e317e7b1214aaeec1e3b8bbc352509","modified":1497717704000},{"_id":"source/_posts/exchange-2010-update-rollup-2.md","hash":"0fd15037b86ade0aeb0ee12cd9f57043af94378e","modified":1497604140000},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response.md","hash":"1965d541b5f2372119007bf0d9b6218d7f3a6791","modified":1497604160000},{"_id":"source/_posts/exchange-log-part1-basic-knowledge.md","hash":"b7c0dfc069440a78c437935753f6f701b2e0d967","modified":1497618180000},{"_id":"source/_posts/fix-java8-install-1603-error.md","hash":"322aef4b70c2758780a860859f4592e89e8783b1","modified":1497604234000},{"_id":"source/_posts/fix-vmware-esxi-40-vc-hardware-status-error.md","hash":"1bff74aa082c58712390f80896b70aee8d8abd05","modified":1497604258000},{"_id":"source/_posts/fix-wsus-slow-download-problem.md","hash":"6ca53bb6e5e6ea5480b0a1a262f7cde121f76afa","modified":1497604274000},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010.md","hash":"d7a4a05adde267445ffa1e2eb2f130154817596a","modified":1502852126000},{"_id":"source/_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware.md","hash":"17f31adf4c7e3438ec1a15a686a25d556eaaf229","modified":1497604204000},{"_id":"source/_posts/hmc-40-update-rollup-3-has-been-updated.md","hash":"3cd294d7ba5fe2d2f71855bffc06be4537c6e0cb","modified":1497604298000},{"_id":"source/_posts/hmc-40-update-rollup-5-has-been-released.md","hash":"a5656b76fbd36e00ac92aeee2d29f01886f3b987","modified":1497604306000},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory.md","hash":"72472c9cc0a936bd0ae5b17fea8a232182b1d3d8","modified":1497604316000},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation.md","hash":"42f48c4e8f4b4abab703da6c59e9f7ed4e750e14","modified":1497604324000},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations.md","hash":"f788ae0f98b13570b5d48becabc938632336cb23","modified":1497604362000},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office.md","hash":"b060ecfd2fc5f50015abbbdbb75de48fad9cbd37","modified":1497604396000},{"_id":"source/_posts/hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment.md","hash":"91047d6724b5a25cbc1090e02a00261ae6701df7","modified":1497604434000},{"_id":"source/_posts/hmc-45-is-out.md","hash":"ad994696a7c7d951523345949aff83961db1c1d5","modified":1497604442000},{"_id":"source/_posts/hmc-45-rollup-1.md","hash":"f9b86b9a5182e071e947e16a0ad09b2637ca8626","modified":1497604450000},{"_id":"source/_posts/hmc-45-update-rollup-3-has-been-released.md","hash":"7ca11e3a2446ba4a1c532c3baf9a586c70d70e90","modified":1497604458000},{"_id":"source/_posts/hmc-45-update-rollup-5-has-been-released.md","hash":"9e9a734c8b35ba4265d3cc23b0d6ddcf4f31eb60","modified":1497604466000},{"_id":"source/_posts/hmc-45-update-rollup-6-has-been-released.md","hash":"552364bd88f240ba948bcccd3c50607dafd141bb","modified":1497604494000},{"_id":"source/_posts/hmc-45-ur-2-has-been-released.md","hash":"c66bad8bfe1aa7042335d5f85b29eff723ebfd90","modified":1497604504000},{"_id":"source/_posts/hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept.md","hash":"5b711781f70ccf130d21e6fb2c32941bb2c2a313","modified":1497616972000},{"_id":"source/_posts/hmc-resource-management-part2-hmc-resource-management-and-active-directory.md","hash":"a489ac2943b14421450466653338b2120e372d82","modified":1497616980000},{"_id":"source/_posts/how-to-add-send-on-behalf-permission-to-users-with-mps.md","hash":"6dc71c0f82aeadafc39a9931d3840f7c174c79e4","modified":1497616990000},{"_id":"source/_posts/how-to-build-geoip-database-from-maxmind-csv-format.md","hash":"688d1f04a8a7718a0626d57faceb247aafc883f9","modified":1497617002000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail.md","hash":"ce7aac0425a3bcb004fc3088a134e6610f656d4b","modified":1497617050000},{"_id":"source/_posts/how-to-extract-rpm-package-on-centos.md","hash":"51ef193d423c8100a82d9ffcaee0287bd72dd7bd","modified":1497617062000},{"_id":"source/_posts/how-to-fix-sql2008-ssrs-teradata-extension-load-error.md","hash":"a793833d893d50cb67f8760f697b50fa3d597ac0","modified":1497617150000},{"_id":"source/_posts/how-to-fix-wordpress-admin-blank-white-screen.md","hash":"17b67e2879c1ea35f6d4f4dc8c4160233d3d1097","modified":1497617172000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password.md","hash":"16ca817fe288a7e46fbd942548bc6066df3696a6","modified":1497617186000},{"_id":"source/_posts/how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully.md","hash":"6c6cb0211ddc9cb900dd6babd09a8d39c24f200a","modified":1497432112000},{"_id":"source/_posts/how-to-turn-off-password-expiration-in-hmc-40.md","hash":"e675a47d4ad798a28d0c82a97718c62797c5d362","modified":1497617236000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7.md","hash":"734a0123e10d31d9901db508f0a6e42572696d41","modified":1497617256000},{"_id":"source/_posts/install-microsoft-dynamics-crm-4-0-server-on-multiple-computers.md","hash":"729c8782e4ea7e572a62ef790b90c0a769113795","modified":1497617318000},{"_id":"source/_posts/installing-lighttpd-php5-mysql-on-centos-64.md","hash":"0fc9d1bb8562dff7fa1efca6d4d8dff950db64a9","modified":1497617266000},{"_id":"source/_posts/installing-mscrm-4-0-without-internet-access.md","hash":"63245d4c14e344df0410b9e15e475ece4b6ca3ad","modified":1497617282000},{"_id":"source/_posts/installing-vmware-tools-on-centos.md","hash":"a4ba8406912fc1eea3e149f1236891c4b6abf967","modified":1497617304000},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016.md","hash":"6aa818c03671f3af00eab96c5961e0ab21298d37","modified":1502854641903},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost.md","hash":"08d7c158ee14bf71226687a9f2232db70c46bd21","modified":1497617390000},{"_id":"source/_posts/kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations.md","hash":"8855d77b4e3bb2d4040f36ca1bce30617e364e21","modified":1497617400000},{"_id":"source/_posts/lync-server-2010-publish-topology-error.md","hash":"4e4a86844f7d6796d04f1b7c8662187f99ceb740","modified":1497617410000},{"_id":"source/_posts/migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2.md","hash":"e8cda23e5725e360c6055cae99b2503356cf36d8","modified":1497617418000},{"_id":"source/_posts/movabletype-2-wordpress.md","hash":"98856a5ed6c811920867546559df2aa83b902992","modified":1497617430000},{"_id":"source/_posts/move-to-hexo.md","hash":"a8bed0eccec52b954420c24dc7dfc431c9814037","modified":1497603746000},{"_id":"source/_posts/mpf-service-account-error-in-deployment-tools.md","hash":"143233982812fb855d73ec252b4d984ebe1e012c","modified":1497617464000},{"_id":"source/_posts/mscrm-2011-beta-installation.md","hash":"43f4a6f75e748f21fd21f53dafa26a1ad3a762b8","modified":1497617484000},{"_id":"source/_posts/mscrm-40-email-router-404-notfound.md","hash":"75100502910c1252008e69d0c80a5ccc15a1f084","modified":1497617474000},{"_id":"source/_posts/mscrm-contacts-and-accounts-are-not-showing-up-in-outlook.md","hash":"c8ca60852f979772d114e561e0229284415b3057","modified":1497617490000},{"_id":"source/_posts/multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released.md","hash":"541c245df5c5daeb15019e0d29e18d531891ca81","modified":1497617504000},{"_id":"source/_posts/ocs-docs.md","hash":"6839c32197a85dd2a624cdde037c9c45cc03e856","modified":1497617516000},{"_id":"source/_posts/patches-for-hmc40.md","hash":"72139259203bec444b8b8db07b1fb56a9aca6a75","modified":1497617532000},{"_id":"source/_posts/problem-when-installing-ocs2007-r2-cu6-dotnet-40.md","hash":"72091e6abceb429ec1dda5c780a20748b72fc60a","modified":1497617550000},{"_id":"source/_posts/reporting-service-cant-start-event-id-107.md","hash":"36f498beb14c853d3e72d2a2d6332727eeeb8ab7","modified":1497617572000},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1.md","hash":"c44c1394701c00b18140751e9d757b21f17653ee","modified":1502855127509},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2.md","hash":"926f44cbf3a6d85d1c78bac7ce9265520080ecfd","modified":1502855140144},{"_id":"source/_posts/sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45.md","hash":"b857360829b5e2c83c64b6c30a21c7af68e0a1a4","modified":1497617654000},{"_id":"source/_posts/the-reportservervirtualdirectory-element-is-missing.md","hash":"8d6e7e0b5c7bcfe4ee07fe3cf578d5780e872468","modified":1497617672000},{"_id":"source/_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process.md","hash":"18ab36de9f282e7855ee9f018a6f8f6205692684","modified":1497617692000},{"_id":"source/_posts/unofficial-consolidated-server-deployment-guide-for-hmc4.md","hash":"e5c0c0e0a492e8ab5b5f5476280f77200611e158","modified":1498026972000},{"_id":"source/_posts/upgrade-to-exchange-2010-sp1-issues.md","hash":"f3a032f48354e6c6ea814f8e9440e7423f371ef2","modified":1497617714000},{"_id":"source/_posts/virtual-server-undo-disks-merge-parent-disk-part-of-saved-state.md","hash":"205978425210c13fd2d9c461058398022c188193","modified":1497617730000},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7.md","hash":"2bc02b7f142b83db5c82ac1038e38868141fa8cd","modified":1497617740000},{"_id":"source/about/index.md","hash":"30151064c42521d9f3bf2b8bc7ac79c7adfd8a45","modified":1497621862000},{"_id":"themes/maupassant/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1497509064000},{"_id":"themes/maupassant/.git/config","hash":"17ffceb9ffba824e210cc6fea9633e8c02a226d5","modified":1497509064000},{"_id":"themes/maupassant/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1497508962000},{"_id":"themes/maupassant/.git/index","hash":"e40ae74fb54bba05d1d662b7cc7c43e71bfff660","modified":1497509064000},{"_id":"themes/maupassant/.git/packed-refs","hash":"eac7f996bf092e6b7adba93d848d4bf35a083129","modified":1497509064000},{"_id":"themes/maupassant/languages/de-DE.yml","hash":"5d3556a885e355a8c2da65ef3e7b3ee36a628bfa","modified":1497509064000},{"_id":"themes/maupassant/languages/en.yml","hash":"7cb1778634ce8132efa5da0ee62f2d9d371426c6","modified":1497538932000},{"_id":"themes/maupassant/languages/es-ES.yml","hash":"58e1d04bcd1834fa9d2960e18e027abbbccbedc9","modified":1497509064000},{"_id":"themes/maupassant/languages/fr-FR.yml","hash":"b47906ec0abf867fb3e3360bc046b7afb68aee25","modified":1497509064000},{"_id":"themes/maupassant/languages/ko.yml","hash":"909a33e0befa6978e8e72157c6b415b48551ee31","modified":1497509064000},{"_id":"themes/maupassant/languages/ru.yml","hash":"2476a631f4d3c668de04af85a6c2c97ba2a57e96","modified":1497509064000},{"_id":"themes/maupassant/languages/zh-CN.yml","hash":"e7018d13f6598480e653c99bc4408fff88204849","modified":1497668962000},{"_id":"themes/maupassant/languages/zh-TW.yml","hash":"17b22e638fd21ab16d4c156b22f8c89ececad9f5","modified":1497509064000},{"_id":"themes/maupassant/layout/archive.jade","hash":"84b59ef66d46761a9d39692d9360eb0da7ed43a0","modified":1497587216000},{"_id":"themes/maupassant/layout/base-without-sidebar.jade","hash":"60b5a70f7c61c91aca9fbf813bde26096ef4028f","modified":1497511978000},{"_id":"themes/maupassant/layout/base.jade","hash":"893e1ce1faa0c2fbe65e77c8b2e91b2100ba609d","modified":1497512472000},{"_id":"themes/maupassant/layout/index.jade","hash":"d17fc2715f655aa0867837ef15d2adb910de606f","modified":1497586962000},{"_id":"themes/maupassant/layout/page.jade","hash":"8d70fd3b93f2c9087a9ea7ec538dcc1d413bea01","modified":1497509064000},{"_id":"themes/maupassant/layout/post.jade","hash":"d6d56e1294597191c70f6861ac5fbcb4db9b73e8","modified":1497616820000},{"_id":"themes/maupassant/layout/single-column.jade","hash":"c35fff4d9b331a41af5bc10f4278ec3d9da503db","modified":1497509064000},{"_id":"themes/maupassant/layout/timeline.jade","hash":"649281ace58d7ff08a6ecb10606799ae2f77bb38","modified":1497509064000},{"_id":"source/_posts/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip","hash":"32ba92bf220583bf0d7d01a3fb7c428e5a0de643","modified":1367251808000},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg","hash":"2e1d63669c41a2b53ec30b606da85f67e386f65a","modified":1374240136000},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg","hash":"ac358406a7daeaa34a1ec661e1646fa71990c5ec","modified":1365598374000},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg","hash":"648558deb0ed837e94682f3a41fdc426926f09af","modified":1365598386000},{"_id":"source/_posts/fix-java8-install-1603-error/Java8_Error_1603.png","hash":"a638a3dce361673ae2c0a31bc170a44776a44b85","modified":1497409208000},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg","hash":"98ede366e0a494534c78e79c933287078b58170b","modified":1398685870000},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg","hash":"38d4a4f630cab196b8de87bc7f4fbbeba694cbca","modified":1398685422000},{"_id":"source/_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg","hash":"8d03e220365b0f24f9430ca668b3fb261543f831","modified":1367450378000},{"_id":"source/_posts/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg","hash":"a593a5d877cf8e5359692406a0fe02678d89a85f","modified":1435228768000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg","hash":"d78d4e4778cd156bad0d274dc648b2b247c4a52e","modified":1365598390000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg","hash":"8595d4764df1e1b15267e4586d58a0f9b669d52d","modified":1365598396000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg","hash":"55ed2fc2e33767195fe249ea2407b975b32b3927","modified":1365598396000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg","hash":"859211ff7a3c54461a0090d03cbb0d30c2ad3509","modified":1365598398000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg","hash":"858d8ef08c49e1caef82233f7b87e7994a8452d7","modified":1365598402000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg","hash":"75cf1fdde35cf3a8a2bfa7a130176ba4d79598e4","modified":1365598406000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg","hash":"5bdf0a299af2a9a1f43c75f0569de035666e6331","modified":1365598406000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg","hash":"20538dbcdb41bb69be5436b60a59896e034fe57e","modified":1365598408000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg","hash":"5ae81c5f5ca5a796fbe917c5f9eb3788581bdccb","modified":1365598410000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg","hash":"c78ef1b656087a5e0a32a17d54db598cb32a3d2c","modified":1365598418000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg","hash":"75eeafd0f39f294eb0116939a672c677af5a360b","modified":1365598422000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg","hash":"b1741993cb42f50cce78d0564148604c19440635","modified":1365598424000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg","hash":"3fd96f713a284a6ed534c2832db0300eae1827f7","modified":1365598428000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg","hash":"202fda4f84459ff11730e8380849e70dc520214c","modified":1365598436000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg","hash":"390e2ee3337ef6ee33c3b714436c3bed8a05948c","modified":1365598436000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg","hash":"23cc29c549063744cfd9e92856f60fd323480bf7","modified":1365598450000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg","hash":"df2cc38f2833462d3489d2984563d6a6538fa3a5","modified":1365598458000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg","hash":"f83f1d906285ec094743444391e8b7d8c433161c","modified":1365598460000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg","hash":"8ad97be76143335c5d6157758c8cef0f7fadb75e","modified":1365598470000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg","hash":"60f0afae55d521d8fcc84ae60d830ddad193e958","modified":1365598474000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg","hash":"1d0066fb8669572f7e4b54a08e884f8f356fe085","modified":1365598476000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg","hash":"d28b576656247bb6bb878fc5280a8c7e04934459","modified":1365598478000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_9.jpg","hash":"b22d8b214bdf35bc085797166c1c6538f4374f03","modified":1365598482000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg","hash":"a2062bdd9a8582f012fd4790d730f1620d809ce8","modified":1365598486000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg","hash":"81275626ff835875883d2094048249417b11e455","modified":1365598488000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg","hash":"d40f89bbb714eb6ec06a98ffab4d01a3bf20a46a","modified":1365598492000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg","hash":"9276c435282bd997ed348b2c41254e975900a9a8","modified":1365598494000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg","hash":"9283b5f07a5cbf626922fae3e5a7580a23bc442e","modified":1365598496000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg","hash":"4884407c4ef6f2347012b3174fb7421eb5e29f26","modified":1365598500000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg","hash":"2df7b30c8f7fe6b3406ee3c764f70e9202160e38","modified":1365598502000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg","hash":"9d67a3752f6b4e2459e64ef3287f7727eee0ad0a","modified":1365598504000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg","hash":"fa767532e1cbbe482d0895f431f5067150c418bc","modified":1365598506000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg","hash":"3459567d2c74f8a52102e10c2702e619678cdea2","modified":1365598508000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg","hash":"a9f93734136b5a8ad89d96d67a22c19f909504ea","modified":1365598512000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg","hash":"e0d13719bf978de2e640edfcd21b5d8d07fdc56c","modified":1365598514000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg","hash":"f58f2a546b2e3ea7c9593719d90d4ca3f10758b3","modified":1365598516000},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg","hash":"420389f63f08a89f17ee0dc73e826655ace6e449","modified":1365598520000},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg","hash":"8d31428125b3a0d69cc5f5de115dedc00e12282a","modified":1365598372000},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg","hash":"0f19fa1b05ccb15a31456b0c6a5db087f6b33f8c","modified":1365598440000},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg","hash":"0067e21cdaeec747cca6aac1957106d920f20b74","modified":1392288588000},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg","hash":"f26e8d506a08b96c76d2a644fe27b926f17d572f","modified":1392288912000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_0.jpg","hash":"d880a6432c3811f70aeb08423dfa22614b3553a9","modified":1365598312000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_1.jpg","hash":"5868fccc2e155dd30b5fc91c687ef21b7fdb1420","modified":1365598314000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_10.jpg","hash":"71c77937a593e26759fd466fa48d7d9cc1577423","modified":1365598318000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_11.jpg","hash":"b855d4d4387d2ae1e6d1d02232e6d5f046fb83a6","modified":1365598320000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_12.jpg","hash":"44c12c2af1f813ab83e85499607c16bc391f310e","modified":1365598326000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_13.jpg","hash":"a3067f3c4f0e4302d410fcd7bbb88cd76ffc8e86","modified":1365598326000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_15.jpg","hash":"940f335fb2908d6f3b14e8485d9a4c0a4b75e89d","modified":1365598332000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_16.jpg","hash":"e17cd76bbded50be1bdcae0b30ea3b4e7c0c4949","modified":1365598336000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_17.jpg","hash":"bc28aa38103d1b362f5d1c4abaab59dee347c7bb","modified":1365598338000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_19.jpg","hash":"e338972ab9c3bf0f1f3b50a26b578e026ee823ad","modified":1365598346000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_20.jpg","hash":"e8096c3dcef7feb9540e13ae0b32fbac985d8de7","modified":1365598352000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_4.jpg","hash":"3457f6b7698a8909da940f134ab1043f868240c3","modified":1365598358000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_5.jpg","hash":"d3ac2bdc0876bbaf7c8df02d6f4cf7c00334101d","modified":1365598360000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_6.jpg","hash":"dfe19c4e9b526ad4b995a0c6434da46275418e3b","modified":1365598364000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_7.jpg","hash":"1ebb95f895838cca8c477f5faf9829e027f912c4","modified":1365598366000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_8.jpg","hash":"fb1d5ac70d690c5b70f6ed22d252f862d4a65c49","modified":1365598368000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_9.jpg","hash":"bd493c0bed44e914005417209d080803c6dcd189","modified":1365598372000},{"_id":"source/_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship/Domain-relationship-error.jpg","hash":"7d65bcde1c532ecf174b81c56a2c31a3d02e63d5","modified":1373374136000},{"_id":"source/_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg","hash":"f56a89eda146641d225f2298b6442759be2a2d69","modified":1365598484000},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg","hash":"1574401fef18374f7247f2cc9e3b744be62d4945","modified":1365598528000},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg","hash":"247f0d0a593cefc3ee70a2ce4222d63f3dbb4be7","modified":1365598532000},{"_id":"themes/maupassant/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/pre-rebase.sample","hash":"18be3eb275c1decd3614e139f5a311b75f1b0ab8","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/prepare-commit-msg.sample","hash":"2b6275eda365cad50d167fe3a387c9bc9fedd54f","modified":1497508962000},{"_id":"themes/maupassant/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1497508962000},{"_id":"themes/maupassant/.git/info/exclude","hash":"c879df015d97615050afa7b9641e3352a1e701ac","modified":1497508962000},{"_id":"themes/maupassant/.git/logs/HEAD","hash":"1d364cef6b0013980545dee9a167a067857ef32d","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/after_footer.jade","hash":"78424748d749d5df0f251e896c2d4d1a69b02b62","modified":1497539736000},{"_id":"themes/maupassant/layout/_partial/comments.jade","hash":"e5d604bcaad6558ba56e036de3ef5a840d501155","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/footer.jade","hash":"2a10131f07217e4a4745d9e3cc941d98954fafc9","modified":1497540506000},{"_id":"themes/maupassant/layout/_partial/head.jade","hash":"533a94be6b31bd02d0fdbd5c0571a85a5d83099c","modified":1497533780000},{"_id":"themes/maupassant/layout/_partial/helpers.jade","hash":"000785cb0d656b46c06600a7815875f1031654ef","modified":1497586914000},{"_id":"themes/maupassant/layout/_partial/mathjax.jade","hash":"b54b56faff9e47ab3ca3cdd55056c73e60776f3c","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/mathjax2.jade","hash":"d6ac5dc4e9c7a1b866f1f92d88988cfb35aded4c","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/paginator.jade","hash":"53f9cb77448e84a98da5eb688e2e12b173c555bb","modified":1497586900000},{"_id":"themes/maupassant/layout/_partial/post_nav.jade","hash":"a2d698c84bb6da08195fe870dbd7215f65388d3f","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/tag.jade","hash":"0f0e6770e9d5dd8040e330d71bbbfadd2df36a28","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/toggle_menu.jade","hash":"6f01b9753a0c08c38dca4be1f5713cd5490305a7","modified":1497509064000},{"_id":"themes/maupassant/layout/_partial/totop.jade","hash":"8225bbc3cdb9648bc2e6872e5c616a9a1e4def4f","modified":1497509064000},{"_id":"themes/maupassant/layout/_widget/category.jade","hash":"7c6aed762934ca51aa2669b886254da24b77bc14","modified":1497509064000},{"_id":"themes/maupassant/layout/_widget/hit_counter.jade","hash":"f4f4dcc7a20330a316991bf044eea597d932e635","modified":1497718338000},{"_id":"themes/maupassant/layout/_widget/recent_comments.jade","hash":"e119c5afa85abc60d139e2da99b0bfcd7a6530f8","modified":1497509064000},{"_id":"themes/maupassant/layout/_widget/recent_posts.jade","hash":"19431336d724d2118e46da43683bce9063176541","modified":1497509064000},{"_id":"themes/maupassant/layout/_widget/search.jade","hash":"193546282908e499813534f86d27ef6e0a1357b3","modified":1497509064000},{"_id":"themes/maupassant/layout/_widget/tag.jade","hash":"132f049ce677d0e38f50073174c4ee4b825d4a06","modified":1497509064000},{"_id":"themes/maupassant/source/css/jquery.fancybox.css","hash":"f42f761157f26244673eb2f4a9215c70956f80dc","modified":1497509064000},{"_id":"themes/maupassant/source/css/style.scss","hash":"efb1d3d467098cb6d1fb4bf641bc10501e75ce95","modified":1497595002000},{"_id":"themes/maupassant/source/js/codeblock-resizer.js","hash":"5d0b786d60bf225d9eabcc9cece2719ff4d9b6cd","modified":1497509064000},{"_id":"themes/maupassant/source/js/fancybox.js","hash":"13c4781570339f4fba76a3d7f202e442817dd605","modified":1497509064000},{"_id":"themes/maupassant/source/js/search.js","hash":"0c0630e2ef213701d393b041f10572e951a27985","modified":1497509064000},{"_id":"themes/maupassant/source/js/share.js","hash":"6400d719d5eb14587d854a3dff6b290a3c06dc67","modified":1497509064000},{"_id":"themes/maupassant/source/js/smartresize.js","hash":"3ef157fd877167e3290f42c67a624ea375a46c24","modified":1497509064000},{"_id":"themes/maupassant/source/js/toggle_menu.js","hash":"b7202fe35eae823e75f1772e3ac3a20f6390f667","modified":1497509064000},{"_id":"themes/maupassant/source/js/totop.js","hash":"7dbf8fcf582a4fb6eb9b2c60d6de9f9c2091ec4c","modified":1497509064000},{"_id":"source/_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg","hash":"1fa0b4f68b4c4cdecc6a2c957897072efb996a7c","modified":1389350598000},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg","hash":"11fc5cd8a3cc6b030a44f2f91662e3cd9fe5f174","modified":1374240920000},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg","hash":"b9127c997b2a3fbe5af3d567a963fb1622497853","modified":1374239834000},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg","hash":"6e684cb2b60c1c18350368f0fb8160ae5d7fc0f6","modified":1365598384000},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg","hash":"ed7100cbbd8a5410dfc276943e2b0f3a8290dfe3","modified":1398687258000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg","hash":"b214a67ff9b85bf6926b2f2dde6288c6fb31c768","modified":1365598414000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg","hash":"065cc2c737e72df36f02f6d6fe1621a8c30decfc","modified":1365598422000},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg","hash":"4d271b10f323eb58a1705c61a3c6ffeaddc095a4","modified":1365598432000},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg","hash":"c61006f9c116bdfc6eed68181782478643084158","modified":1365598466000},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg","hash":"316b0d368d9c86ebc64493e14b2cd0b3afe91a02","modified":1365598444000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_14.jpg","hash":"8f53e5482f9679b542a6d111f4dd2671d5c1616e","modified":1365598328000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_18.jpg","hash":"cec7b294319925e755e57f605f3fd7eaf4bdd111","modified":1365598344000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_2.jpg","hash":"f5f0f7d94f7536c687cdf3c7b2077784d1d4c3ac","modified":1365598350000},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_3.jpg","hash":"eca6231c7c9019a81d4ffa3047e4c4eb08cc9d6e","modified":1365598356000},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg","hash":"63b1fe61c8207fc0dde83b79c6e4d5b5a06063bc","modified":1365598526000},{"_id":"themes/maupassant/.git/objects/pack/pack-b9ddf07096fe5bd845a2624e4e7e786f02e2878d.idx","hash":"90125f59656a0767bb53d9403ee8a9ab2a4d199f","modified":1497509064000},{"_id":"themes/maupassant/.git/refs/heads/master","hash":"b600c90f0ab877fd84954ad93b950ffcf6a9ca93","modified":1497509064000},{"_id":"themes/maupassant/.git/logs/refs/heads/master","hash":"1d364cef6b0013980545dee9a167a067857ef32d","modified":1497509064000},{"_id":"themes/maupassant/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1497509064000},{"_id":"themes/maupassant/.git/logs/refs/remotes/origin/HEAD","hash":"1d364cef6b0013980545dee9a167a067857ef32d","modified":1497509064000},{"_id":"source/_posts/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf","hash":"92cc9753001ff66e14d155ec3f7f4133244cce51","modified":1460069438000},{"_id":"themes/maupassant/.git/objects/pack/pack-b9ddf07096fe5bd845a2624e4e7e786f02e2878d.pack","hash":"1c4d89acd7a181a3b68b770e340f54a25d8b82cc","modified":1497509064000}],"Category":[{"name":"Microsoft","_id":"cj6eh5jx100044gyr6zwomofv"},{"name":"*Nix","_id":"cj6eh5jx500094gyrk3b9n38q"},{"name":"数码影音","_id":"cj6eh5jxb000k4gyr14cimqcr"},{"name":"活动目录","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxe000p4gyr6sbh6dbt"},{"name":"Office","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxh000v4gyrrx4mu480"},{"name":"Exchange","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxl00124gyrawgeq8k3"},{"name":"虚拟化","_id":"cj6eh5jy2001v4gyrfo6xbx1o"},{"name":"HMC","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jyc002a4gyr874l68xw"},{"name":"沟通协作","_id":"cj6eh5k03004y4gyrtopr3iz8"},{"name":"MSSQL","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0500574gyrsf0apuwa"},{"name":"网站相关","_id":"cj6eh5k08005d4gyrr54ixx8v"},{"name":"MSCRM","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0e005t4gyrciiubx43"},{"name":"Exchange","_id":"cj6eh5k0s00724gyrgzhbjb2l"},{"name":"SQL数据库","parent":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0u007e4gyrfodvh744"}],"Data":[],"Page":[{"layout":"false","comments":0,"_content":"<html>\n<head>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"http://winotes.net\" homePageName=\"返回主页\"></script>\n</body>\n</html>\n\n","source":"404.md","raw":"layout: false \ncomments: false\npermalink: /404.html\n---\n<html>\n<head>\n</head>\n<body>\n<script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homePageUrl=\"http://winotes.net\" homePageName=\"返回主页\"></script>\n</body>\n</html>\n\n","date":"2017-08-16T03:13:08.933Z","updated":"2017-06-16T06:54:32.000Z","path":"/404.html","title":"","_id":"cj6eh5ju500004gyrkne63rvo","content":"<html><br><head><br></head><br><body><br><script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"http://winotes.net\" homepagename=\"返回主页\"></script><br></body><br></html>\n\n","site":{"data":{}},"excerpt":"","more":"<html><br><head><br></head><br><body><br><script type=\"text/javascript\" src=\"http://www.qq.com/404/search_children.js\" charset=\"utf-8\" homepageurl=\"http://winotes.net\" homepagename=\"返回主页\"></script><br></body><br></html>\n\n"},{"layout":"page","comments":0,"title":"我是谁","_content":"<script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async></script>\n\nRandy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，http://www.powerk6.org 这个网站是我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。\n\n* 大学主修环境工程，出于对计算机的热爱选择了 IT 行业。\n* 目前我和家人居住在深圳。\n* 湖南人，爱吃辣椒。\n* 出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。\n* 一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。\n\n你可以通过以下几种方式联系到我：\n\n<i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a>\n\n<i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a>\n\n<i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a>\n\n<i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a>\n\n<i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a>","source":"about/index.md","raw":"---\nlayout: page \ncomments: false\ntitle: 我是谁\n---\n<script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async></script>\n\nRandy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，http://www.powerk6.org 这个网站是我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。\n\n* 大学主修环境工程，出于对计算机的热爱选择了 IT 行业。\n* 目前我和家人居住在深圳。\n* 湖南人，爱吃辣椒。\n* 出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。\n* 一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。\n\n你可以通过以下几种方式联系到我：\n\n<i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a>\n\n<i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a>\n\n<i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a>\n\n<i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a>\n\n<i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a>","date":"2017-08-16T03:13:03.926Z","updated":"2017-06-16T14:04:22.000Z","path":"about/index.html","_id":"cj6eh5jwz00024gyrmxj5k8gr","content":"<script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async></script>\n\n<p>Randy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，<a href=\"http://www.powerk6.org\" target=\"_blank\" rel=\"external\">http://www.powerk6.org</a> 这个网站是我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。</p>\n<ul>\n<li>大学主修环境工程，出于对计算机的热爱选择了 IT 行业。</li>\n<li>目前我和家人居住在深圳。</li>\n<li>湖南人，爱吃辣椒。</li>\n<li>出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。</li>\n<li>一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。</li>\n</ul>\n<p>你可以通过以下几种方式联系到我：</p>\n<p><i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a></p>\n<p><i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a></p>\n<p><i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a></p>\n<p><i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a></p>\n<p><i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a></p>\n","site":{"data":{}},"excerpt":"","more":"<script src=\"https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js\" async></script>\n\n<p>Randy Zhong 是我的英文名，80后奶爸。我也曾经用 PowerK6 这个自造词作为互联网上的用户名，<a href=\"http://www.powerk6.org\" target=\"_blank\" rel=\"external\">http://www.powerk6.org</a> 这个网站是我的第一个博客，基于 Moveable Type 架设，如果你发现这个网站无法打开，请来这里看看，我把多半曾经写过的技术文章都转移来了这里。</p>\n<ul>\n<li>大学主修环境工程，出于对计算机的热爱选择了 IT 行业。</li>\n<li>目前我和家人居住在深圳。</li>\n<li>湖南人，爱吃辣椒。</li>\n<li>出于兴趣爱好，我维护一些个人项目，谈不上多好，但基本能满足我的需求，你可以在我下面列出的 GitHub 链接找到它们，如果你有什么好的建议和问题，欢迎提出。</li>\n<li>一直以来，我主要关注点在 IT 基础架构领域，随着云计算和 DevOps 的兴起，目前也开始转向云计算。</li>\n</ul>\n<p>你可以通过以下几种方式联系到我：</p>\n<p><i class=\"fa fa-user\"></i> Nickname: <a href=\"http://winotes.net\">Randy Zhong</a></p>\n<p><i class=\"fa fa-envelope\"></i> Email: <a href=\"mailto:me@winotes.net\" target=\"_blank\" rel=\"external\">me@winotes.net</a></p>\n<p><i class=\"fa fa-github\"></i> Github: <a href=\"https://github.com/randyzhong\" target=\"_blank\" rel=\"external\">@randyzhong</a></p>\n<p><i class=\"fa fa-instagram\"></i> Instagram: <a href=\"https://www.instagram.com/randy.zhong\" target=\"_blank\" rel=\"external\">@randy.zhong</a></p>\n<p><i class=\"fa fa-twitter\"></i> Twitter: <a href=\"https://twitter.com/randy_zhong\" target=\"_blank\" rel=\"external\">@randy_zhong</a></p>\n"}],"Post":[{"title":"AD 管理小技巧系列01 - 不重置密码也可延长密码有效期","date":"2013-11-19T02:19:10.000Z","_content":"\n在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。\n\n如果你想不修改密码，延长你的账户有效期的话，这里有个办法：\n\n在 AD 用户的账号属性页面，有个选项叫做 “_用户下次登录时须更改密码_”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。\n\n*   **User must change password at next logon **\n[![AD 用户属性页面](active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg)","source":"_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it.md","raw":"---\ntitle: AD 管理小技巧系列01 - 不重置密码也可延长密码有效期\ntags:\n  - Active Directory\n  - Tips\ncategories:\n  - Microsoft\n  - 活动目录\ndate: 2013-11-19 10:19:10\n---\n\n在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。\n\n如果你想不修改密码，延长你的账户有效期的话，这里有个办法：\n\n在 AD 用户的账号属性页面，有个选项叫做 “_用户下次登录时须更改密码_”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。\n\n*   **User must change password at next logon **\n[![AD 用户属性页面](active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg)","slug":"active-directory-tips-01-extend-password-expiration-date-not-changing-it","published":1,"updated":"2017-06-16T09:05:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jwv00014gyrnd4p2gwr","content":"<p>在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。</p>\n<p>如果你想不修改密码，延长你的账户有效期的话，这里有个办法：</p>\n<p>在 AD 用户的账号属性页面，有个选项叫做 “<em>用户下次登录时须更改密码</em>”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。</p>\n<ul>\n<li><strong>User must change password at next logon </strong><br>[<img src=\"/2013/11/19/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg\" alt=\"AD 用户属性页面\"></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>在大多数企业里面，一般都有设置密码策略，包括密码复杂度、密码历史、密码有效期等等。密码到期不修改，系统在你登陆的时候会要求你更改密码，不更改便不让你登陆。但有些人，尤其是上了年纪的用户，往往记不住太复杂或者太多的密码，他们通常会拿纸笔记下来，反而有泄漏的风险。</p>\n<p>如果你想不修改密码，延长你的账户有效期的话，这里有个办法：</p>\n<p>在 AD 用户的账号属性页面，有个选项叫做 “<em>用户下次登录时须更改密码</em>”，把这个选项先勾选上，应用一下，然后再取消勾选，再应用一次，就达到不重置密码也能延长密码有效期的目的了。</p>\n<ul>\n<li><strong>User must change password at next logon </strong><br>[<img src=\"/2013/11/19/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg\" alt=\"AD 用户属性页面\"></li>\n</ul>\n"},{"title":"APC: undefined symbol: pcre_exec in Unknown on line 0","date":"2013-05-12T14:46:45.000Z","_content":"\nAPC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：\n\nProblem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0\n\n以下是解决方法：\n1. 先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp\n```bash\ncp /etc/php.d/apc.ini /tmp\n```\n2. 移除原来的安装包\n```bash\nyum remove php-pecl-apc\n```\n3. 用 pecl 来安装 apc\n```bash\npecl install apc\n```\n4. 再把 apc.ini 复制回去\n```bash\nmv /tmp/apc.ini /etc/php.d/apc.ini\n```","source":"_posts/apc-undefined-symbol-pcre-exec-in-unknown-on-line-0.md","raw":"---\ntitle: 'APC: undefined symbol: pcre_exec in Unknown on line 0'\ntags:\n  - APC\n  - PECL\n  - PHP\n  - Yum\ncategories:\n  - '*Nix'\ndate: 2013-05-12 22:46:45\n---\n\nAPC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：\n\nProblem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0\n\n以下是解决方法：\n1. 先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp\n```bash\ncp /etc/php.d/apc.ini /tmp\n```\n2. 移除原来的安装包\n```bash\nyum remove php-pecl-apc\n```\n3. 用 pecl 来安装 apc\n```bash\npecl install apc\n```\n4. 再把 apc.ini 复制回去\n```bash\nmv /tmp/apc.ini /etc/php.d/apc.ini\n```","slug":"apc-undefined-symbol-pcre-exec-in-unknown-on-line-0","published":1,"updated":"2017-06-16T09:04:10.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jwz00034gyr2z9orjwe","content":"<p>APC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：</p>\n<p>Problem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0</p>\n<p>以下是解决方法：</p>\n<ol>\n<li><p>先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /etc/php.d/apc.ini /tmp</div></pre></td></tr></table></figure>\n</li>\n<li><p>移除原来的安装包</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum remove php-pecl-apc</div></pre></td></tr></table></figure>\n</li>\n<li><p>用 pecl 来安装 apc</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pecl install apc</div></pre></td></tr></table></figure>\n</li>\n<li><p>再把 apc.ini 复制回去</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mv /tmp/apc.ini /etc/php.d/apc.ini</div></pre></td></tr></table></figure></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>APC是一个类似 eaccelerator 的免费PHP加速器，但你安装通过 yum 安装之后有可能会看到这样的错误：</p>\n<p>Problem: /usr/lib/php/modules/apc.so: undefined symbol: pcre_exec in Unknown on line 0</p>\n<p>以下是解决方法：</p>\n<ol>\n<li><p>先复制 /etc/php.d/apc.ini 文件到临时目录 /tmp</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">cp /etc/php.d/apc.ini /tmp</div></pre></td></tr></table></figure>\n</li>\n<li><p>移除原来的安装包</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum remove php-pecl-apc</div></pre></td></tr></table></figure>\n</li>\n<li><p>用 pecl 来安装 apc</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">pecl install apc</div></pre></td></tr></table></figure>\n</li>\n<li><p>再把 apc.ini 复制回去</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">mv /tmp/apc.ini /etc/php.d/apc.ini</div></pre></td></tr></table></figure></li>\n</ol>\n"},{"title":"CentOS 6.4 升级到 3.x Kernel","date":"2013-04-28T04:12:57.000Z","_content":"\n#### 1.前言\n\n好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。\n\n#### 2.准备工作\n\nCentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。\n\n以下是准备工作：\n\n2.1. 安装组件:\n```bash\nyum groupinstall \"Development Tools\" #这样做会确定你拥有编译时所需的一切工具。\nyum install ncurses-devel #你必须这样才能让 make *config 这个指令正确地执行。\nyum install qt-devel #如果你没有 X 环境，这一条可以不用。\nyum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel #创建 CentOS-6 内核时需要它们。\n```\n2.2. 安装 wget\n```bash\nyum -y install wget #安装 wget 下载工具\n```\n2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 www.kernel.org 获取\n```bash\nwget http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz\n```\n\n#### 3.编译/安装内核\n\n3.1. 解压缩源码包\n```bash\nxz -d linux-3.2.21.tar.xz\ntar xvf linux-3.2.21.tar\n```\n3.2. 配置内核选项\n```bash\ncd linux-3.2.21\nmake oldconfig\nmake menuconfig\n```\n在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个 `kernel panic not syncing attempted to kill init` 之类的错误，这里提供我的一份 .config 文件\n\n{% asset_link config-3.2.21-vmware1.zip Kernel 3.2.21 的.config 文件 %} 点击下载\n\n下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）\n\n3.3. 开始编译\n```bash\nmake bzImage modules modules_install\nmake install #安装\n```\n编辑 GRUB引导菜单，将 default=1 改成 default=0\n`vi /etc/grub.conf` \n\n你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单\n\n`reboot` #重启\n\n至此，CentOS 6.4 升级到 3.x Kernel 完成。\n\n#### 4.补充\n\n如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：\n\n<span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span>\n\n从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见[这篇文章](http://delxu.blog.51cto.com/975660/288682/ \"图解VMware内存机制\")），可能的原因有2个：\n\n首先，确认你的 .config 文件里面有  **CONFIG_VMWARE_BALLOON=m **这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers -&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *\n\n其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：\n```bash\ncd /lib/modules/3.x.xx/kernel/drivers/misc #将版本号改成你自己的\nln -s vmw_balloon.ko vmware_balloon.ko #建立软连接\n```\n**Tips:**\n\n如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：\n`grep -R --include=Makefile '\\bNAME\\.o\\b'`","source":"_posts/centos-64-upgrade-to-kernel-3x.md","raw":"---\ntitle: CentOS 6.4 升级到 3.x Kernel\ntags:\n  - CentOS\n  - Kernel\n  - VMware\ncategories:\n  - '*Nix'\ndate: 2013-04-28 12:12:57\n---\n\n#### 1.前言\n\n好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。\n\n#### 2.准备工作\n\nCentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。\n\n以下是准备工作：\n\n2.1. 安装组件:\n```bash\nyum groupinstall \"Development Tools\" #这样做会确定你拥有编译时所需的一切工具。\nyum install ncurses-devel #你必须这样才能让 make *config 这个指令正确地执行。\nyum install qt-devel #如果你没有 X 环境，这一条可以不用。\nyum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel #创建 CentOS-6 内核时需要它们。\n```\n2.2. 安装 wget\n```bash\nyum -y install wget #安装 wget 下载工具\n```\n2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 www.kernel.org 获取\n```bash\nwget http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz\n```\n\n#### 3.编译/安装内核\n\n3.1. 解压缩源码包\n```bash\nxz -d linux-3.2.21.tar.xz\ntar xvf linux-3.2.21.tar\n```\n3.2. 配置内核选项\n```bash\ncd linux-3.2.21\nmake oldconfig\nmake menuconfig\n```\n在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个 `kernel panic not syncing attempted to kill init` 之类的错误，这里提供我的一份 .config 文件\n\n{% asset_link config-3.2.21-vmware1.zip Kernel 3.2.21 的.config 文件 %} 点击下载\n\n下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）\n\n3.3. 开始编译\n```bash\nmake bzImage modules modules_install\nmake install #安装\n```\n编辑 GRUB引导菜单，将 default=1 改成 default=0\n`vi /etc/grub.conf` \n\n你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单\n\n`reboot` #重启\n\n至此，CentOS 6.4 升级到 3.x Kernel 完成。\n\n#### 4.补充\n\n如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：\n\n<span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span>\n\n从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见[这篇文章](http://delxu.blog.51cto.com/975660/288682/ \"图解VMware内存机制\")），可能的原因有2个：\n\n首先，确认你的 .config 文件里面有  **CONFIG_VMWARE_BALLOON=m **这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers -&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *\n\n其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：\n```bash\ncd /lib/modules/3.x.xx/kernel/drivers/misc #将版本号改成你自己的\nln -s vmw_balloon.ko vmware_balloon.ko #建立软连接\n```\n**Tips:**\n\n如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：\n`grep -R --include=Makefile '\\bNAME\\.o\\b'`","slug":"centos-64-upgrade-to-kernel-3x","published":1,"updated":"2017-06-16T09:06:06.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jx300064gyrvsmrg13g","content":"<h4 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1.前言\"></a>1.前言</h4><p>好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。</p>\n<h4 id=\"2-准备工作\"><a href=\"#2-准备工作\" class=\"headerlink\" title=\"2.准备工作\"></a>2.准备工作</h4><p>CentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。</p>\n<p>以下是准备工作：</p>\n<p>2.1. 安装组件:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum groupinstall <span class=\"string\">\"Development Tools\"</span> <span class=\"comment\">#这样做会确定你拥有编译时所需的一切工具。</span></div><div class=\"line\">yum install ncurses-devel <span class=\"comment\">#你必须这样才能让 make *config 这个指令正确地执行。</span></div><div class=\"line\">yum install qt-devel <span class=\"comment\">#如果你没有 X 环境，这一条可以不用。</span></div><div class=\"line\">yum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel <span class=\"comment\">#创建 CentOS-6 内核时需要它们。</span></div></pre></td></tr></table></figure></p>\n<p>2.2. 安装 wget<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install wget <span class=\"comment\">#安装 wget 下载工具</span></div></pre></td></tr></table></figure></p>\n<p>2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 www.kernel.org 获取<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz</div></pre></td></tr></table></figure></p>\n<h4 id=\"3-编译-安装内核\"><a href=\"#3-编译-安装内核\" class=\"headerlink\" title=\"3.编译/安装内核\"></a>3.编译/安装内核</h4><p>3.1. 解压缩源码包<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">xz -d linux-3.2.21.tar.xz</div><div class=\"line\">tar xvf linux-3.2.21.tar</div></pre></td></tr></table></figure></p>\n<p>3.2. 配置内核选项<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> linux-3.2.21</div><div class=\"line\">make oldconfig</div><div class=\"line\">make menuconfig</div></pre></td></tr></table></figure></p>\n<p>在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个 <code>kernel panic not syncing attempted to kill init</code> 之类的错误，这里提供我的一份 .config 文件</p>\n<a href=\"/2013/04/28/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip\" title=\"Kernel 3.2.21 的.config 文件\">Kernel 3.2.21 的.config 文件</a> 点击下载<br><br>下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）<br><br>3.3. 开始编译<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">make bzImage modules modules_install</div><div class=\"line\">make install <span class=\"comment\">#安装</span></div></pre></td></tr></table></figure>\n<p>编辑 GRUB引导菜单，将 default=1 改成 default=0<br><code>vi /etc/grub.conf</code> </p>\n<p>你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单</p>\n<p><code>reboot</code> #重启</p>\n<p>至此，CentOS 6.4 升级到 3.x Kernel 完成。</p>\n<h4 id=\"4-补充\"><a href=\"#4-补充\" class=\"headerlink\" title=\"4.补充\"></a>4.补充</h4><p>如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：</p>\n<p><span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span></p>\n<p>从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见<a href=\"http://delxu.blog.51cto.com/975660/288682/\" title=\"图解VMware内存机制\" target=\"_blank\" rel=\"external\">这篇文章</a>），可能的原因有2个：</p>\n<p>首先，确认你的 .config 文件里面有  <strong>CONFIG_VMWARE_BALLOON=m </strong>这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers -&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *</p>\n<p>其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> /lib/modules/3.x.xx/kernel/drivers/misc <span class=\"comment\">#将版本号改成你自己的</span></div><div class=\"line\">ln -s vmw_balloon.ko vmware_balloon.ko <span class=\"comment\">#建立软连接</span></div></pre></td></tr></table></figure></p>\n<p><strong>Tips:</strong></p>\n<p>如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：<br><code>grep -R --include=Makefile &#39;\\bNAME\\.o\\b&#39;</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-前言\"><a href=\"#1-前言\" class=\"headerlink\" title=\"1.前言\"></a>1.前言</h4><p>好吧，虽然这是一个关于微软平台的技术日志，但是并不限于Win，最近手头有些事情需要用到 Linux/Unix 等非 Win 系统，所以还是在这里开个分类目录记录下来，有备无患嘛。</p>\n<h4 id=\"2-准备工作\"><a href=\"#2-准备工作\" class=\"headerlink\" title=\"2.准备工作\"></a>2.准备工作</h4><p>CentOS 6.4 发布出来有一段时间了，最近才用上，可是发现内核还是 2.6.32，是不是也太旧了点，于是乎打算将其内核升级到 3.x。</p>\n<p>以下是准备工作：</p>\n<p>2.1. 安装组件:<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum groupinstall <span class=\"string\">\"Development Tools\"</span> <span class=\"comment\">#这样做会确定你拥有编译时所需的一切工具。</span></div><div class=\"line\">yum install ncurses-devel <span class=\"comment\">#你必须这样才能让 make *config 这个指令正确地执行。</span></div><div class=\"line\">yum install qt-devel <span class=\"comment\">#如果你没有 X 环境，这一条可以不用。</span></div><div class=\"line\">yum install hmaccalc zlib-devel binutils-devel elfutils-libelf-devel <span class=\"comment\">#创建 CentOS-6 内核时需要它们。</span></div></pre></td></tr></table></figure></p>\n<p>2.2. 安装 wget<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum -y install wget <span class=\"comment\">#安装 wget 下载工具</span></div></pre></td></tr></table></figure></p>\n<p>2.3. 下载 Kernel 内核源码包，这里用的是北京交大的镜像，你也可以直接去 www.kernel.org 获取<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://mirror.bjtu.edu.cn/kernel/linux/kernel/v3.x/linux-3.2.21.tar.xz</div></pre></td></tr></table></figure></p>\n<h4 id=\"3-编译-安装内核\"><a href=\"#3-编译-安装内核\" class=\"headerlink\" title=\"3.编译/安装内核\"></a>3.编译/安装内核</h4><p>3.1. 解压缩源码包<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">xz -d linux-3.2.21.tar.xz</div><div class=\"line\">tar xvf linux-3.2.21.tar</div></pre></td></tr></table></figure></p>\n<p>3.2. 配置内核选项<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> linux-3.2.21</div><div class=\"line\">make oldconfig</div><div class=\"line\">make menuconfig</div></pre></td></tr></table></figure></p>\n<p>在其中选择你想取消或者启动的选项，但注意别精简得太多，否则很容易出现各种错误甚至无法引导系统，比如来个 <code>kernel panic not syncing attempted to kill init</code> 之类的错误，这里提供我的一份 .config 文件</p>\n<a href=\"/2013/04/28/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip\" title=\"Kernel 3.2.21 的.config 文件\">Kernel 3.2.21 的.config 文件</a> 点击下载<br><br>下载后注意改名，另外还应该对照你自己的环境做些修改。（这个适用于搭建在 Intel CPU上面的 VMware 虚拟机）<br><br>3.3. 开始编译<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">make bzImage modules modules_install</div><div class=\"line\">make install <span class=\"comment\">#安装</span></div></pre></td></tr></table></figure>\n<p>编辑 GRUB引导菜单，将 default=1 改成 default=0<br><code>vi /etc/grub.conf</code> </p>\n<p>你还可以将 hiddenmenu 前面用#注释掉，这样开始会显示引导菜单</p>\n<p><code>reboot</code> #重启</p>\n<p>至此，CentOS 6.4 升级到 3.x Kernel 完成。</p>\n<h4 id=\"4-补充\"><a href=\"#4-补充\" class=\"headerlink\" title=\"4.补充\"></a>4.补充</h4><p>如果你的 CentOS 是安装在 VMware 上的话，在最后 make install 这一步的时候有可能会看到这样的警告：</p>\n<p><span style=\"color: #0000ff\">ERROR: modinfo: could not find module vmware_balloon</span></p>\n<p>从字面上来看，是找不到 vmware_balloon 模块，这个 vmware_balloon 实际上被称之为内存释放或者气球膨胀（参见<a href=\"http://delxu.blog.51cto.com/975660/288682/\" title=\"图解VMware内存机制\" target=\"_blank\" rel=\"external\">这篇文章</a>），可能的原因有2个：</p>\n<p>首先，确认你的 .config 文件里面有  <strong>CONFIG_VMWARE_BALLOON=m </strong>这一行，或者你可以用 make menuconfig 进去内核编译菜单，选中 Device Drivers -&gt; MISC devices -&gt; VMware Balloon Driver 为 M 或者 *</p>\n<p>其次，而这个模块在后面的版本中，已经更名为 vmw_balloon，所以 可以用下面的命令来解决：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> /lib/modules/3.x.xx/kernel/drivers/misc <span class=\"comment\">#将版本号改成你自己的</span></div><div class=\"line\">ln -s vmw_balloon.ko vmware_balloon.ko <span class=\"comment\">#建立软连接</span></div></pre></td></tr></table></figure></p>\n<p><strong>Tips:</strong></p>\n<p>如果你最后 make install 的时候有很多 could not find module xxxx 的错误，而你又不知道其对应的是 .config 中哪一项的时候，可以用这条命令：<br><code>grep -R --include=Makefile &#39;\\bNAME\\.o\\b&#39;</code></p>\n"},{"title":"修改idx/sub字幕的字幕显示顺序","date":"2005-04-02T14:50:50.000Z","_content":"\n如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？\n\n编辑.idx文件\n\n找到\n\\# Language index in use\n\nlangidx: 0\n\n把langidx: 0 的数字改成中文字幕的index no\n比如在这个文件里面\n\\# Chinese\n\nid: zh, index: 2\n\n那就改成langidx: 2，保存。\n\n后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，\n\n注册表里面的设置是优先的，位置在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages`\n\n里面有一个名为Langx的字串值，修改Lang0 的键值为 \"Chinese\" 才能使默认显示为中文\n\n如果是Vobsub2.23及其以前版本在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub`\n\nVSFilter2.3x则在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter`\n","source":"_posts/change-idx-sub-order.md","raw":"---\ntitle: 修改idx/sub字幕的字幕显示顺序\ntags:\n  - Vobsub\ncategories:\n  - 数码影音\ndate: 2005-04-02 22:50:50\n---\n\n如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？\n\n编辑.idx文件\n\n找到\n\\# Language index in use\n\nlangidx: 0\n\n把langidx: 0 的数字改成中文字幕的index no\n比如在这个文件里面\n\\# Chinese\n\nid: zh, index: 2\n\n那就改成langidx: 2，保存。\n\n后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，\n\n注册表里面的设置是优先的，位置在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages`\n\n里面有一个名为Langx的字串值，修改Lang0 的键值为 \"Chinese\" 才能使默认显示为中文\n\n如果是Vobsub2.23及其以前版本在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub`\n\nVSFilter2.3x则在\n\n`HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter`\n","slug":"change-idx-sub-order","published":1,"updated":"2017-06-16T09:06:56.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jx400074gyrfehelqun","content":"<p>如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？</p>\n<p>编辑.idx文件</p>\n<p>找到<br># Language index in use</p>\n<p>langidx: 0</p>\n<p>把langidx: 0 的数字改成中文字幕的index no<br>比如在这个文件里面<br># Chinese</p>\n<p>id: zh, index: 2</p>\n<p>那就改成langidx: 2，保存。</p>\n<p>后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，</p>\n<p>注册表里面的设置是优先的，位置在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages</code></p>\n<p>里面有一个名为Langx的字串值，修改Lang0 的键值为 “Chinese” 才能使默认显示为中文</p>\n<p>如果是Vobsub2.23及其以前版本在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub</code></p>\n<p>VSFilter2.3x则在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter</code></p>\n","site":{"data":{}},"excerpt":"","more":"<p>如何修改idx/sub字幕的字幕显示顺序,使中文字幕排在最前面？</p>\n<p>编辑.idx文件</p>\n<p>找到<br># Language index in use</p>\n<p>langidx: 0</p>\n<p>把langidx: 0 的数字改成中文字幕的index no<br>比如在这个文件里面<br># Chinese</p>\n<p>id: zh, index: 2</p>\n<p>那就改成langidx: 2，保存。</p>\n<p>后来发现这样还不行，摸索一番，发现VSFilter/Vobsub在注册表里面还有相关设置，</p>\n<p>注册表里面的设置是优先的，位置在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter\\PreferedLanguages</code></p>\n<p>里面有一个名为Langx的字串值，修改Lang0 的键值为 “Chinese” 才能使默认显示为中文</p>\n<p>如果是Vobsub2.23及其以前版本在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\Vobsub</code></p>\n<p>VSFilter2.3x则在</p>\n<p><code>HKEY_CURRENT_USER\\Software\\Gabest\\VSFilter</code></p>\n"},{"title":"Exception from HRESULT: 0x800A03EC","date":"2009-08-20T06:09:45.000Z","_content":"\n我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是 **SYSTEM** 但是在执行中报出了一下错误:\n> Exception from HRESULT: **0x800A03EC\n> **   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)\n\nGoogle 了大半天, 总算是找到了问题所在:\n\n[http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required](http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required)\n\n在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户 \"Desktop\" 文件夹似乎是必须的\n\n* Windows 2008 Server x64\n\n在 \"C:\\Windows\\**SysWOW64**\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n\n* Windows 2008 Server x86\n\n在 \"C:\\Windows\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n\n注意 64-bit 的要在 **SysWOW64** 下面\n","source":"_posts/exception-from-hresult-0x800a03ec.md","raw":"---\ntitle: 'Exception from HRESULT: 0x800A03EC'\ntags:\n  - DCOM\n  - Excel\ncategories:\n  - Microsoft\n  - Office\ndate: 2009-08-20 14:09:45\n---\n\n我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是 **SYSTEM** 但是在执行中报出了一下错误:\n> Exception from HRESULT: **0x800A03EC\n> **   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)\n\nGoogle 了大半天, 总算是找到了问题所在:\n\n[http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required](http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required)\n\n在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户 \"Desktop\" 文件夹似乎是必须的\n\n* Windows 2008 Server x64\n\n在 \"C:\\Windows\\**SysWOW64**\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n\n* Windows 2008 Server x86\n\n在 \"C:\\Windows\\config\\systemprofile\" 下创建 \"Desktop\" 目录\n\n\t\t`C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n\n注意 64-bit 的要在 **SysWOW64** 下面\n","slug":"exception-from-hresult-0x800a03ec","published":1,"updated":"2017-08-16T02:55:40.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jx500084gyr2ypc89bc","content":"<p>我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是 <strong>SYSTEM</strong> 但是在执行中报出了一下错误:</p>\n<blockquote>\n<p>Exception from HRESULT: <strong>0x800A03EC\n</strong>   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)</p>\n</blockquote>\n<p>Google 了大半天, 总算是找到了问题所在:</p>\n<p><a href=\"http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required\" target=\"_blank\" rel=\"external\">http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required</a></p>\n<p>在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户 “Desktop” 文件夹似乎是必须的</p>\n<ul>\n<li>Windows 2008 Server x64</li>\n</ul>\n<p>在 “C:\\Windows*<em>SysWOW64*</em>\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>`C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n</code></pre><ul>\n<li>Windows 2008 Server x86</li>\n</ul>\n<p>在 “C:\\Windows\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>`C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n</code></pre><p>注意 64-bit 的要在 <strong>SysWOW64</strong> 下面</p>\n","site":{"data":{}},"excerpt":"","more":"<p>我们新的生产环境, Windows 2008 64-bit, 自己写的一个 Windows Service, 用到了 Excel 的 DCOM 组件, 服务的执行账户是 <strong>SYSTEM</strong> 但是在执行中报出了一下错误:</p>\n<blockquote>\n<p>Exception from HRESULT: <strong>0x800A03EC\n</strong>   at Microsoft.Office.Interop.Excel.Workbooks.Open(String Filename, Object UpdateLinks, Object ReadOnly, Object Format, Object Password, Object WriteResPassword, Object IgnoreReadOnlyRecommended, Object Origin, Object Delimiter, Object Editable, Object Notify, Object Converter, Object AddToMru, Object Local, Object CorruptLoad)</p>\n</blockquote>\n<p>Google 了大半天, 总算是找到了问题所在:</p>\n<p><a href=\"http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required\" target=\"_blank\" rel=\"external\">http://social.msdn.microsoft.com/Forums/en-US/innovateonoffice/thread/b81a3c4e-62db-488b-af06-44421818ef91?prof=required</a></p>\n<p>在 Windows 2008 中, 如果以 SYSTEM 用户跑, 系统会去寻找 SYSTEM 这个用户的 Profile 目录, 而这个用户是不能按照交互用户登录的,而且在处理 Excel 文件的过程中, 一个 for SYSTEM 账户 “Desktop” 文件夹似乎是必须的</p>\n<ul>\n<li>Windows 2008 Server x64</li>\n</ul>\n<p>在 “C:\\Windows*<em>SysWOW64*</em>\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>`C:\\Windows\\SysWOW64\\config\\systemprofile\\Desktop`\n</code></pre><ul>\n<li>Windows 2008 Server x86</li>\n</ul>\n<p>在 “C:\\Windows\\config\\systemprofile” 下创建 “Desktop” 目录</p>\n<pre><code>`C:\\Windows\\System32\\config\\systemprofile\\Desktop`\n</code></pre><p>注意 64-bit 的要在 <strong>SysWOW64</strong> 下面</p>\n"},{"title":"Exchange 2010 最佳实践01 - CAS Array","date":"2013-12-06T01:44:56.000Z","_content":"\nCAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。\n\n实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  \n\n**CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。**\n\nWhy? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。\n\na)  内部 Outlook 用户 (TCP连接)。\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。\n* Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。\n* 连接建立。\n\nb)  外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）\n\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。\n* Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。\n* 而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。\n* 当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。\n默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。\n\n当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。\n\nc)  外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。\n* Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。\n\n** CAS Array **的场景下，客户端最好能做** Kerberos **认证 （Exchange 2010 SP1）。\n\n在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）\n\n而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：[http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx](http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx)\n\n那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。\n\n**即便你只有一个 CAS 服务器，也建议配置 CAS Array **。","source":"_posts/exchange-2010-best-practice-01-cas-array.md","raw":"---\ntitle: Exchange 2010 最佳实践01 - CAS Array\ntags:\n  - 最佳实践\n  - Exchange\n  - Kerberos\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2013-12-06 09:44:56\n---\n\nCAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。\n\n实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  \n\n**CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。**\n\nWhy? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。\n\na)  内部 Outlook 用户 (TCP连接)。\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。\n* Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。\n* 连接建立。\n\nb)  外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）\n\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。\n* Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。\n* 而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。\n* 当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。\n默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。\n\n当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。\n\nc)  外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）\n* Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。\n* Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。\n\n** CAS Array **的场景下，客户端最好能做** Kerberos **认证 （Exchange 2010 SP1）。\n\n在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）\n\n而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：[http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx](http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx)\n\n那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。\n\n**即便你只有一个 CAS 服务器，也建议配置 CAS Array **。","slug":"exchange-2010-best-practice-01-cas-array","published":1,"updated":"2017-06-17T16:41:44.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jx6000b4gyr6nuipmr1","content":"<p>CAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。</p>\n<p>实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  </p>\n<p><strong>CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。</strong></p>\n<p>Why? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。</p>\n<p>a)  内部 Outlook 用户 (TCP连接)。</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。</li>\n<li>Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。</li>\n<li>连接建立。</li>\n</ul>\n<p>b)  外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。</li>\n<li>Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。</li>\n<li>而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。</li>\n<li>当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。<br>默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。</li>\n</ul>\n<p>当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。</p>\n<p>c)  外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。</li>\n<li>Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。</li>\n</ul>\n<p><strong> CAS Array </strong>的场景下，客户端最好能做<strong> Kerberos </strong>认证 （Exchange 2010 SP1）。</p>\n<p>在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）</p>\n<p>而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：<a href=\"http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx</a></p>\n<p>那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。</p>\n<p><strong>即便你只有一个 CAS 服务器，也建议配置 CAS Array </strong>。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>CAS Array 的概念是第一次在 Exchange 2010 中被引入，其主要目的是在于统一客户端访问名称，便于不管连接哪台服务器均能够使用同样一个名字访问，因此在不建立NLB的情况下使用CAS ARRAY能够统一访问名称。</p>\n<p>实际的部署 CAS Array 的过程我就不说了，网上很多教程。这里要提出来的三点建议，也许对你的环境会有帮助。  </p>\n<p><strong>CAS Array 的内外部 FQDN 不要用一样的，说更清楚点，内部 CAS Array 的 FQDN 不要能被外部 DNS 解析。</strong></p>\n<p>Why? 就算我内外FQDN一样，我也还是能正常访问 Exchange 啊。对，你确实还是能够访问，但是却增加了 Outlook 的连接时间，在某些慢速网络下，甚至会导致连接超时。我们下面详细来看看各种场景下的连接情况。</p>\n<p>a)  内部 Outlook 用户 (TCP连接)。</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 192.168.1.30 (内网IP)。</li>\n<li>Outlook 会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接 192.168.1.30。</li>\n<li>连接建立。</li>\n</ul>\n<p>b)  外部 Outlook 用户 （CAS Array内部FQDN可以从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，比如说outlook.internal.local -&gt; 123.234.213.213 (公网IP)。</li>\n<li>Outlook会认为自己在内网，于是尝试使用DCE/RPC 也就是135 端口去连接123.234.213.213。</li>\n<li>而大多数情况下，防火墙是不会允许公网的 135 端口通信的，所以得等待TCP连接超时，这其中还有几次重试的时间。</li>\n<li>当 Outlook 发现 TCP/135 的端口无法连接的时候，才发现，哦，原来我不在内网啊，那就只能尝试使用 https协议去连接 443 端口。<br>默认情况下， 在快速网络环境下，Outlook 会使用 TCP 先行尝试连接，不成功的情况下才会使用 Http/Https ，这里TCP连接浪费的时间，短则10来秒，最长可达30秒钟以上，所以，Outlook Anywhere用户体验会变得糟糕。</li>\n</ul>\n<p>当然，你可以改成无论何时都是先用http/https 连接，对于 Outlook Anywhere 用户，很适合，不过这会对内网用户造成困扰，甚至无法登陆，因为内外网证书很可能不一致，导致设定的 FQDN 名称和证书的 Common Name 不匹配，会总提示输入用户名和密码，即便你输入的是正确的，还是会不停地跳出来。</p>\n<p>c)  外部 Outlook 用户 （CAS Array内部FQDN不能从公网解析）</p>\n<ul>\n<li>Outlook会通过DNS去查询内部 FQDN 对应的 IP，但此时从 DNS 并不能返回查询结果。</li>\n<li>Outlook 知悉，哦，地址无法解析，我在外网，于是直接使用 Https 去建立连接。</li>\n</ul>\n<p><strong> CAS Array </strong>的场景下，客户端最好能做<strong> Kerberos </strong>认证 （Exchange 2010 SP1）。</p>\n<p>在 Exchange 2010 中，所有的域客户端的 MAPI 访问实际上都是通过 CAS 来走，而客户端的认证会使用协商认证，即negotiate authentication，也就是会先使用 Kerberos 认证。失败之后再尝试 NTLM 认证。（注：Outlook Anywhere 不适用）</p>\n<p>而在配置了 CAS Array 的环境下，Kerberos 认证会失败的，因为 Kerberos 认证的时候，发起的service ticket中的authenticator 使用的是 CAS Array FQDN的 SPN，而不是 CAS Server 的 SPN，所以会认证失败。具体的实现步骤可以参考这里：<a href=\"http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/b/exchange/archive/2011/04/15/recommendation-enabling-kerberos-authentication-for-mapi-clients.aspx</a></p>\n<p>那么，开启 Kerberos 认证有啥好处呢？除了可以满足一些企业的安全需求外，还能减少 CAS 服务器和 AD 的负载，这对大型企业中的性能优化很有帮助。</p>\n<p><strong>即便你只有一个 CAS 服务器，也建议配置 CAS Array </strong>。</p>\n"},{"title":"Exchange 2010 Update Rollup 2","date":"2010-03-06T00:42:16.000Z","_content":"\nToday Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010\\. RU2 comes 3 months after the release of RU1\\. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:\n\n*   [977633](http://support.microsoft.com/kb/977633/) Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server\n*   [979431](http://support.microsoft.com/kb/979431/) The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server\n*   [979480](http://support.microsoft.com/kb/979480/) Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients\n*   [979563](http://support.microsoft.com/kb/979563/) Exchange Server 2010 Push Notifications does not work\n*   [979566](http://support.microsoft.com/kb/979566/) A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010\n*   [980261](http://support.microsoft.com/kb/980261/) This fix introduces the supports for Exchange Server 2010 page patching when a \"-1022″ disk I/O error is generated\n*   [980262](http://support.microsoft.com/kb/980262/) Event ID 2156 is logged on a computer that is running Exchange Server 2010\nThe related knowledgebase article (KB979611) can be found [here](http://support.microsoft.com/?kbid=979611). You can download Exchange 2010 Rollup 2 directly from [here](http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en).","source":"_posts/exchange-2010-update-rollup-2.md","raw":"---\ntitle: Exchange 2010 Update Rollup 2\ntags:\n  - Exchange\n  - Rollup\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2010-03-06 08:42:16\n---\n\nToday Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010\\. RU2 comes 3 months after the release of RU1\\. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:\n\n*   [977633](http://support.microsoft.com/kb/977633/) Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server\n*   [979431](http://support.microsoft.com/kb/979431/) The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server\n*   [979480](http://support.microsoft.com/kb/979480/) Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients\n*   [979563](http://support.microsoft.com/kb/979563/) Exchange Server 2010 Push Notifications does not work\n*   [979566](http://support.microsoft.com/kb/979566/) A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010\n*   [980261](http://support.microsoft.com/kb/980261/) This fix introduces the supports for Exchange Server 2010 page patching when a \"-1022″ disk I/O error is generated\n*   [980262](http://support.microsoft.com/kb/980262/) Event ID 2156 is logged on a computer that is running Exchange Server 2010\nThe related knowledgebase article (KB979611) can be found [here](http://support.microsoft.com/?kbid=979611). You can download Exchange 2010 Rollup 2 directly from [here](http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en).","slug":"exchange-2010-update-rollup-2","published":1,"updated":"2017-06-16T09:09:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jx7000c4gyryv2yuw6k","content":"<p>Today Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010. RU2 comes 3 months after the release of RU1. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/977633/\" target=\"_blank\" rel=\"external\">977633</a> Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server</li>\n<li><a href=\"http://support.microsoft.com/kb/979431/\" target=\"_blank\" rel=\"external\">979431</a> The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server</li>\n<li><a href=\"http://support.microsoft.com/kb/979480/\" target=\"_blank\" rel=\"external\">979480</a> Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients</li>\n<li><a href=\"http://support.microsoft.com/kb/979563/\" target=\"_blank\" rel=\"external\">979563</a> Exchange Server 2010 Push Notifications does not work</li>\n<li><a href=\"http://support.microsoft.com/kb/979566/\" target=\"_blank\" rel=\"external\">979566</a> A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010</li>\n<li><a href=\"http://support.microsoft.com/kb/980261/\" target=\"_blank\" rel=\"external\">980261</a> This fix introduces the supports for Exchange Server 2010 page patching when a “-1022″ disk I/O error is generated</li>\n<li><a href=\"http://support.microsoft.com/kb/980262/\" target=\"_blank\" rel=\"external\">980262</a> Event ID 2156 is logged on a computer that is running Exchange Server 2010<br>The related knowledgebase article (KB979611) can be found <a href=\"http://support.microsoft.com/?kbid=979611\" target=\"_blank\" rel=\"external\">here</a>. You can download Exchange 2010 Rollup 2 directly from <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en\" target=\"_blank\" rel=\"external\">here</a>.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Today Microsoft released Update Rollup 2 for Microsoft Exchange Server 2010. RU2 comes 3 months after the release of RU1. The list of included fixes is not as long as with RU1, but RU2 does contain some important additional fixes over RU1:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/977633/\" target=\"_blank\" rel=\"external\">977633</a> Certain third-party IMAP4 clients cannot connect to Exchange Server 2003 mailboxes through an Exchange Server 2010 CAS server</li>\n<li><a href=\"http://support.microsoft.com/kb/979431/\" target=\"_blank\" rel=\"external\">979431</a> The POP3 service crashes when a user connects to a mailbox through the POP3 protocol and the user is migrated from an Exchange Server 2003 server to an Exchange Server 2010 server</li>\n<li><a href=\"http://support.microsoft.com/kb/979480/\" target=\"_blank\" rel=\"external\">979480</a> Users cannot receive new messages if they access mailboxes that are moved to another Exchange Server 2010 RU1 server by using IMAP4 clients</li>\n<li><a href=\"http://support.microsoft.com/kb/979563/\" target=\"_blank\" rel=\"external\">979563</a> Exchange Server 2010 Push Notifications does not work</li>\n<li><a href=\"http://support.microsoft.com/kb/979566/\" target=\"_blank\" rel=\"external\">979566</a> A 0×85010014 error is generated when linked mailbox users try to synchronize their mailboxes with mobile devices in a CAS-CAS proxying scenario in Exchange Server 2010</li>\n<li><a href=\"http://support.microsoft.com/kb/980261/\" target=\"_blank\" rel=\"external\">980261</a> This fix introduces the supports for Exchange Server 2010 page patching when a “-1022″ disk I/O error is generated</li>\n<li><a href=\"http://support.microsoft.com/kb/980262/\" target=\"_blank\" rel=\"external\">980262</a> Event ID 2156 is logged on a computer that is running Exchange Server 2010<br>The related knowledgebase article (KB979611) can be found <a href=\"http://support.microsoft.com/?kbid=979611\" target=\"_blank\" rel=\"external\">here</a>. You can download Exchange 2010 Rollup 2 directly from <a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=6d3ae3e0-3982-46d6-9e9c-7d7d63fae565&amp;displaylang=en\" target=\"_blank\" rel=\"external\">here</a>.</li>\n</ul>\n"},{"title":"Exchange Activesync returned an HTTP 500 response","date":"2013-07-19T05:40:52.000Z","_content":"\nExchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。\n\n去到 [TestExchangeConnectivity](https://www.testexchangeconnectivity.com/ \"Microsoft Remote Connectivity Analyzer\") 网站测试，发现有报错：\n\nAttempting the FolderSync command on the Exchange ActiveSync session.\nThe test of the FolderSync command failed.\n\nAdditional Details\nExchange Activesync returned an HTTP 500 response. (Internal Server Error)\n\n{% asset_img FolderSync-Failed.jpg 500 error %}\n\n换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：\n\n{% asset_img EventID-1053.jpg EventID-1053 %}\n\nExchange ActiveSync doesn't have sufficient permissions to create the \"CN=Randy Zhong,OU=IT,DC=company,DC=com\" container under Active Directory user \"Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span>\n\nActive directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0\".\n\n<span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type \"msExchActiveSyncDevices\" and doesn't have any deny permissions that block such operations.\n\nDetails:%3\n\n\n从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.\n\n**解决方法：**\n\n1. 在DC上打开Active Directory Users and Computers\n2. 在菜单上点击 View, 勾选 Advanced Features\n3. 找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡\n4. 点击 Advanced，选中 Include inheritable permissions from this object's parent.\n5. \n{% asset_img AdvancedSecurity-Setting.jpg AdvancedSecurity-Setting %}\n\n等待 AD 复制完成后，再尝试配置手机，问题解决。\n\n<span style=\"color: #ff0000\">补充：\n</span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span>","source":"_posts/exchange-activesync-returned-an-http-500-response.md","raw":"\n---\ntitle: Exchange Activesync returned an HTTP 500 response\ntags:\n  - Activesync\n  - Android\n  - Exchange\n  - Google\n  - Nexus\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2013-07-19 13:40:52\n---\n\nExchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。\n\n去到 [TestExchangeConnectivity](https://www.testexchangeconnectivity.com/ \"Microsoft Remote Connectivity Analyzer\") 网站测试，发现有报错：\n\nAttempting the FolderSync command on the Exchange ActiveSync session.\nThe test of the FolderSync command failed.\n\nAdditional Details\nExchange Activesync returned an HTTP 500 response. (Internal Server Error)\n\n{% asset_img FolderSync-Failed.jpg 500 error %}\n\n换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：\n\n{% asset_img EventID-1053.jpg EventID-1053 %}\n\nExchange ActiveSync doesn't have sufficient permissions to create the \"CN=Randy Zhong,OU=IT,DC=company,DC=com\" container under Active Directory user \"Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span>\n\nActive directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0\".\n\n<span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type \"msExchActiveSyncDevices\" and doesn't have any deny permissions that block such operations.\n\nDetails:%3\n\n\n从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.\n\n**解决方法：**\n\n1. 在DC上打开Active Directory Users and Computers\n2. 在菜单上点击 View, 勾选 Advanced Features\n3. 找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡\n4. 点击 Advanced，选中 Include inheritable permissions from this object's parent.\n5. \n{% asset_img AdvancedSecurity-Setting.jpg AdvancedSecurity-Setting %}\n\n等待 AD 复制完成后，再尝试配置手机，问题解决。\n\n<span style=\"color: #ff0000\">补充：\n</span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span>","slug":"exchange-activesync-returned-an-http-500-response","published":1,"updated":"2017-06-16T09:09:20.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jx9000f4gyrkqeit3rh","content":"<p>Exchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。</p>\n<p>去到 <a href=\"https://www.testexchangeconnectivity.com/\" title=\"Microsoft Remote Connectivity Analyzer\" target=\"_blank\" rel=\"external\">TestExchangeConnectivity</a> 网站测试，发现有报错：</p>\n<p>Attempting the FolderSync command on the Exchange ActiveSync session.<br>The test of the FolderSync command failed.</p>\n<p>Additional Details<br>Exchange Activesync returned an HTTP 500 response. (Internal Server Error)</p>\n<img src=\"/2013/07/19/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg\" alt=\"500 error\" title=\"500 error\">\n<p>换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：</p>\n<img src=\"/2013/07/19/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg\" alt=\"EventID-1053\" title=\"EventID-1053\">\n<p>Exchange ActiveSync doesn’t have sufficient permissions to create the “CN=Randy Zhong,OU=IT,DC=company,DC=com” container under Active Directory user “Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>Active directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0”.</p>\n<p><span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type “msExchActiveSyncDevices” and doesn’t have any deny permissions that block such operations.</p>\n<p>Details:%3</p>\n<p>从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.</p>\n<p><strong>解决方法：</strong></p>\n<ol>\n<li>在DC上打开Active Directory Users and Computers</li>\n<li>在菜单上点击 View, 勾选 Advanced Features</li>\n<li>找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡</li>\n<li>点击 Advanced，选中 Include inheritable permissions from this object’s parent.</li>\n<li><img src=\"/2013/07/19/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg\" alt=\"AdvancedSecurity-Setting\" title=\"AdvancedSecurity-Setting\">\n</li>\n</ol>\n<p>等待 AD 复制完成后，再尝试配置手机，问题解决。</p>\n<p><span style=\"color: #ff0000\">补充：<br></span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Exchange Server 2010 SP1, 手机是 Google Nexus (Samsung i9250)，系统是 Android 4.0.4，用户已经启用 ActiveSync, 结果用手机无法创建 Exchange 邮件账户，提示无法连接到服务器。</p>\n<p>去到 <a href=\"https://www.testexchangeconnectivity.com/\" title=\"Microsoft Remote Connectivity Analyzer\" target=\"_blank\" rel=\"external\">TestExchangeConnectivity</a> 网站测试，发现有报错：</p>\n<p>Attempting the FolderSync command on the Exchange ActiveSync session.<br>The test of the FolderSync command failed.</p>\n<p>Additional Details<br>Exchange Activesync returned an HTTP 500 response. (Internal Server Error)</p>\n<img src=\"/2013/07/19/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg\" alt=\"500 error\" title=\"500 error\">\n<p>换个用户测试，发现可以通过，确定问题在用户设置上面。继而查看 Exchange 服务器的日志，发现有 ID:1053 的错误纪录：</p>\n<img src=\"/2013/07/19/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg\" alt=\"EventID-1053\" title=\"EventID-1053\">\n<p>Exchange ActiveSync doesn’t have sufficient permissions to create the “CN=Randy Zhong,OU=IT,DC=company,DC=com” container under Active Directory user “Active Directory operation failed on DC01.company.com. This error is not retriable. Additional information: <span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>Active directory response: 00000005: SecErr: DSID-031521D0, problem 4003 (INSUFF_ACCESS_RIGHTS), data 0”.</p>\n<p><span style=\"color: #ff0000\">Make sure the user has inherited permission granted to domain\\Exchange Servers</span> to allow List, Create child, Delete child of object type “msExchActiveSyncDevices” and doesn’t have any deny permissions that block such operations.</p>\n<p>Details:%3</p>\n<p>从上面可以看到，出错原因是 Exchange Servers 没有足够的权限，导致 Access is denied.</p>\n<p><strong>解决方法：</strong></p>\n<ol>\n<li>在DC上打开Active Directory Users and Computers</li>\n<li>在菜单上点击 View, 勾选 Advanced Features</li>\n<li>找到该问题用户，鼠标右键点击选中用户，在弹出菜单中选择 properties ，然后去到 Security 标签卡</li>\n<li>点击 Advanced，选中 Include inheritable permissions from this object’s parent.</li>\n<li><img src=\"/2013/07/19/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg\" alt=\"AdvancedSecurity-Setting\" title=\"AdvancedSecurity-Setting\">\n</li>\n</ol>\n<p>等待 AD 复制完成后，再尝试配置手机，问题解决。</p>\n<p><span style=\"color: #ff0000\">补充：<br></span><span style=\"color: #ff0000\">如果碰到某些用户以上操作都不起作用的话，可以尝试在 EMC 中先禁掉用户的 ActiveSync，然后尝试配置手机，当然会提示失败，之后再开启 ActiveSync, 再试一下，多半就可以了。</span></p>\n"},{"title":"Exchange 日志文件详解（上）：基础知识","date":"2011-10-11T00:52:45.000Z","_content":"\n#### 1. ESE - Extensible Storage Engine 可扩展存储引擎\n\n众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。\n![Figure 1 - 平衡树结构示意图](exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg)\n\n目前，有四个正在使用的 ESE 版本：\n\n* **ESE97** Exchange Server 5.5 中的数据库引擎。\n* **ESENT** 用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。\n* **ESE98** Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，\n* **ESE for Exchange 2007/2010** Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。\n\n越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。\n\n#### 2. Transaction Log 事务日志文件\n除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。\n\n**ESE基于事务的ACID特征**\n\nESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从\"收件箱\"移动到\"已删除邮件\"文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。\n\n为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。\n\n万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。\n\n**ESE 的处理机制**\n\n这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。\n\n因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。\n\n当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。\n\n因此，ESE至少需要三种类型的数据：\n1. 在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。\n2. 硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。\n3. 硬盘上的 .edb 邮件数据库文件。\n\n具体步骤来说：\n1. 需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。\n2. 已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。\n3. 如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。\n4. 更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。\n\n下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。\n![Figure 2 - Exchange 2010存储步骤示Figure意图](exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg)\n\n**ESE数据库相关的文件**\n* .edb - ESE主数据库文件，又称之为 MAPI 数据库文件\n* Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。\n* .stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。\n\n在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。\n\n而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。\n\n这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.\n* Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。\n* Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。\n* Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。\n* E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。\n* E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。\n* E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。\n* E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。\n* Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。\n* .jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。\nExchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)\nExchange 2010 ：E0xres00001.jrs ... E0xres00009.jrs (10个，共计10MB)\n![Figure 3 - Exchange 2010 的日志预留文件](exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg)\n\n##### 未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复","source":"_posts/exchange-log-part1-basic-knowledge.md","raw":"---\ntitle: Exchange 日志文件详解（上）：基础知识\ntags:\n  - Exchange\n  - 日志\ncategories:\n  - Microsoft\n  - Exchange\ndate: 2011-10-11 08:52:45\n---\n\n#### 1. ESE - Extensible Storage Engine 可扩展存储引擎\n\n众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。\n![Figure 1 - 平衡树结构示意图](exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg)\n\n目前，有四个正在使用的 ESE 版本：\n\n* **ESE97** Exchange Server 5.5 中的数据库引擎。\n* **ESENT** 用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。\n* **ESE98** Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，\n* **ESE for Exchange 2007/2010** Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。\n\n越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。\n\n#### 2. Transaction Log 事务日志文件\n除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。\n\n**ESE基于事务的ACID特征**\n\nESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从\"收件箱\"移动到\"已删除邮件\"文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。\n\n为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。\n\n万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。\n\n**ESE 的处理机制**\n\n这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。\n\n因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。\n\n当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。\n\n因此，ESE至少需要三种类型的数据：\n1. 在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。\n2. 硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。\n3. 硬盘上的 .edb 邮件数据库文件。\n\n具体步骤来说：\n1. 需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。\n2. 已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。\n3. 如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。\n4. 更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。\n\n下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。\n![Figure 2 - Exchange 2010存储步骤示Figure意图](exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg)\n\n**ESE数据库相关的文件**\n* .edb - ESE主数据库文件，又称之为 MAPI 数据库文件\n* Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。\n* .stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。\n\n在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。\n\n而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。\n\n这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.\n* Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。\n* Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。\n* Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。\n* E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。\n* E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。\n* E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。\n* E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。\n* Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。\n* .jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。\nExchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)\nExchange 2010 ：E0xres00001.jrs ... E0xres00009.jrs (10个，共计10MB)\n![Figure 3 - Exchange 2010 的日志预留文件](exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg)\n\n##### 未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复","slug":"exchange-log-part1-basic-knowledge","published":1,"updated":"2017-06-16T13:03:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxa000h4gyr6gmbkx3x","content":"<h4 id=\"1-ESE-Extensible-Storage-Engine-可扩展存储引擎\"><a href=\"#1-ESE-Extensible-Storage-Engine-可扩展存储引擎\" class=\"headerlink\" title=\"1. ESE - Extensible Storage Engine 可扩展存储引擎\"></a>1. ESE - Extensible Storage Engine 可扩展存储引擎</h4><p>众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。<br><img src=\"/2011/10/11/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg\" alt=\"Figure 1 - 平衡树结构示意图\"></p>\n<p>目前，有四个正在使用的 ESE 版本：</p>\n<ul>\n<li><strong>ESE97</strong> Exchange Server 5.5 中的数据库引擎。</li>\n<li><strong>ESENT</strong> 用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。</li>\n<li><strong>ESE98</strong> Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，</li>\n<li><strong>ESE for Exchange 2007/2010</strong> Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。</li>\n</ul>\n<p>越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。</p>\n<h4 id=\"2-Transaction-Log-事务日志文件\"><a href=\"#2-Transaction-Log-事务日志文件\" class=\"headerlink\" title=\"2. Transaction Log 事务日志文件\"></a>2. Transaction Log 事务日志文件</h4><p>除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。</p>\n<p><strong>ESE基于事务的ACID特征</strong></p>\n<p>ESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从”收件箱”移动到”已删除邮件”文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。</p>\n<p>为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。</p>\n<p>万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。</p>\n<p><strong>ESE 的处理机制</strong></p>\n<p>这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。</p>\n<p>因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。</p>\n<p>当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。</p>\n<p>因此，ESE至少需要三种类型的数据：</p>\n<ol>\n<li>在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。</li>\n<li>硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。</li>\n<li>硬盘上的 .edb 邮件数据库文件。</li>\n</ol>\n<p>具体步骤来说：</p>\n<ol>\n<li>需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。</li>\n<li>已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。</li>\n<li>如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。</li>\n<li>更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。</li>\n</ol>\n<p>下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。<br><img src=\"/2011/10/11/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg\" alt=\"Figure 2 - Exchange 2010存储步骤示Figure意图\"></p>\n<p><strong>ESE数据库相关的文件</strong></p>\n<ul>\n<li>.edb - ESE主数据库文件，又称之为 MAPI 数据库文件</li>\n<li>Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。</li>\n<li>.stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。</li>\n</ul>\n<p>在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。</p>\n<p>而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。</p>\n<p>这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.</p>\n<ul>\n<li>Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。</li>\n<li>Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。</li>\n<li>Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。</li>\n<li>E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。</li>\n<li>E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。</li>\n<li>E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。</li>\n<li>E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。</li>\n<li>Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。</li>\n<li>.jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。<br>Exchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)<br>Exchange 2010 ：E0xres00001.jrs … E0xres00009.jrs (10个，共计10MB)<br><img src=\"/2011/10/11/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg\" alt=\"Figure 3 - Exchange 2010 的日志预留文件\"></li>\n</ul>\n<h5 id=\"未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\"><a href=\"#未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\" class=\"headerlink\" title=\"未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复\"></a>未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复</h5>","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-ESE-Extensible-Storage-Engine-可扩展存储引擎\"><a href=\"#1-ESE-Extensible-Storage-Engine-可扩展存储引擎\" class=\"headerlink\" title=\"1. ESE - Extensible Storage Engine 可扩展存储引擎\"></a>1. ESE - Extensible Storage Engine 可扩展存储引擎</h4><p>众所周知，Exchange 的邮件数据库文件是 .edb，实际上是ESE 数据库，它采用 B+ tree 平衡树结构来存储数据，如下图所示，树的根级别的节点个数与树的叶级别的节点个数总是相同的。因此，树是平衡的。详情这里不再展开，感兴趣的可以自行查找相关资料。<br><img src=\"/2011/10/11/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg\" alt=\"Figure 1 - 平衡树结构示意图\"></p>\n<p>目前，有四个正在使用的 ESE 版本：</p>\n<ul>\n<li><strong>ESE97</strong> Exchange Server 5.5 中的数据库引擎。</li>\n<li><strong>ESENT</strong> 用于 Active Directory 和许多其他 Microsoft Windows 组件的数据库引擎。与 ESE 的其他版本（它们使用 5 MB 日志文件和 4 KB 页大小）不同，ESENT 的 Active Directory 实现使用 10 MB 日志文件和 8 KB 页大小。</li>\n<li><strong>ESE98</strong> Exchange 2000 Server 和 Exchange Server 2003 （32位）的数据库引擎，使用 5MB的日志文件和 4KB 页大小，</li>\n<li><strong>ESE for Exchange 2007/2010</strong> Exchange Server 2007/2010 的数据库引擎，ESE98的改进版本。Exchange 2007 使用1MB的日志文件和8 KB 页大小。而在 Exchange 2010 中，使用 1MB 的日志文件和32 KB 页大小。</li>\n</ul>\n<p>越小的日志文件和页大小可以提供更快的读写访问速度和更好的灾难容忍度。</p>\n<h4 id=\"2-Transaction-Log-事务日志文件\"><a href=\"#2-Transaction-Log-事务日志文件\" class=\"headerlink\" title=\"2. Transaction Log 事务日志文件\"></a>2. Transaction Log 事务日志文件</h4><p>除了 .edb 的数据库文件以外，ESE还有其它的组成部分，这里主要介绍和事务日志相关的文件类型。</p>\n<p><strong>ESE基于事务的ACID特征</strong></p>\n<p>ESE 是复杂的、基于事务的数据库引擎。事务是一系列被视为原子（不可划分）单位的操作。对于事务中的操作，要么完成并永久保存所有操作，要么不执行任何操作。例如，将邮件从”收件箱”移动到”已删除邮件”文件夹时需要执行相应的操作。邮件从一个文件夹中删除，然后被添加到另一个文件夹中，并更新文件夹属性。如果发生故障，您并不希望让邮件出现两个副本，或者根本没有副本，或者出现与实际文件夹内容不一致的文件夹属性值（例如，项目数）。</p>\n<p>为了防止发生类似这样的问题，ESE 将操作捆绑到事务中。ESE 确保除非事务被提交到数据库，否则不会永久应用任何操作。事务被提交到数据库文件时，将永久应用所有操作。</p>\n<p>万一发生崩溃，ESE 还会在启动时自动处理恢复，并回滚任何未提交的事务。如果在提交事务之前 ESE 出现故障，则整个事务都会回滚，就好像事务从未发生过。如果在提交事务之后 ESE 崩溃，则整个事务被永久性保存，并且客户端可以看见更改。</p>\n<p><strong>ESE 的处理机制</strong></p>\n<p>这里以 Exchange Server 2010 为例，简单讲讲 ESE 的处理机制，了解了这个可以帮助我们判断将来 Exchange 灾难恢复的时候所应该采取的措施。</p>\n<p>因为事物的原子性，为了保证数据库的一致和完整，事务必须全部成功或全部失败，如果事务中途失败，则必须回滚到事务开始的状态。当用户要修改邮箱中的内容时，被修改的内容首先被提取出来放到内存中，实际的修改是发生在内存里的，当修改完成后，这些内容必须被尽快写回硬盘，这样才表示一个事务成功完成了，这也是事务的持久性要求。</p>\n<p>当内存的修改完成后，这些结果就会立即写入日志(E0x.log)中，而不是直接读写.edb 文件，因为可能这个文件会变得非常巨大，直接的写入会影响系统性能。当成功写入日志后，该事务就成功完成了。接下来，ESE引擎会在后台慢慢将这些日志里的修改记录写回真正的 .edb 数据库里去（对用户来讲是透明的）。</p>\n<p>因此，ESE至少需要三种类型的数据：</p>\n<ol>\n<li>在内存中已经更改但还未写入日志的数据 (称之为 Dirty Page - 脏页)。</li>\n<li>硬盘上的 .log 日志文件 (包括已经写入和暂未写入的 .edb 数据库的两种)。</li>\n<li>硬盘上的 .edb 邮件数据库文件。</li>\n</ol>\n<p>具体步骤来说：</p>\n<ol>\n<li>需要修改的邮件数据在内存中被初始化，并且按页大小被分成多页。</li>\n<li>已经修改完成的部分会被写入到日志文件(先写入 E0x.log，写满之后会将E0x.log重新命名为 E0x00000001.log，然后再创建个新的E0x.log，再写满之后会将其重命名为E0x00000002.log，以此类推)。</li>\n<li>如果Exchange认为该页面内容已经不再需要的话，这些修改将会被写入到 .edb 的数据库中。</li>\n<li>更新检查点文件(E0x.chk)以记录目前的 .edb 数据库已经将多少日志文件的内容写入到了数据库。</li>\n</ol>\n<p>下面的这幅图大概展现了这个过程。实际上还有E00tmp.log 以及 .JRS 等文件也需要用到，这个下面再说。<br><img src=\"/2011/10/11/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg\" alt=\"Figure 2 - Exchange 2010存储步骤示Figure意图\"></p>\n<p><strong>ESE数据库相关的文件</strong></p>\n<ul>\n<li>.edb - ESE主数据库文件，又称之为 MAPI 数据库文件</li>\n<li>Tmp.edb -临时数据库文件，在邮件数据库卸载或者Exchange Information Store 服务停止的时候会被自动删除。</li>\n<li>.stm - .stm 文件也是 ESE 数据库，它被称为流式数据库文件，用来存储本机 Internet 内容。这里再啰嗦两句: 因为在Exchange 5.5以及更早的版本里，只有单个的EDB文件，那时微软主推的是内部邮件系统，因此其主要协议为MAPI，这是微软的私有邮件协议。Exchange 5.5中， Internet 邮件连接器在收到 MIME 格式的邮件时，会转换成 MAPI 或者 MDBEF 的平衡树结构再存储成EDB；而当用户通过类似 POP3/IMAP协议来收取邮件时，又要将其从 MAPI 格式转换成原生 Internet 格式 (MIME) 之后才能传回给用户，这显然是设计所限带来了性能的损失。在Exchange 2000里，微软加大了对Internet邮件的支持，这就是STM文件的来源。MAPI格式是RPC和二进制标准的，而STM是纯文本加上一些MIME编码格式，这样的设计使得非MAPI客户端可以直接使用 .stm 文件来处理邮件而无需转换。</li>\n</ul>\n<p>在MAPI客户端环境中.edb 文件中存储了所有MAPI客户端访问所需要的数据。</p>\n<p>而在非MAPI客户端情形下， .stm 文件存储了实际的数据，但是其对应的指针和头信息是存在 .edb文件中的。所以两个文件之间又引用和关联，缺一不可。</p>\n<p>这个 .stm 和 .edb 文件共存的情况一直被沿用到了 Exchange 2003.</p>\n<ul>\n<li>Edb.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。存放当前的日志文件，大小为5MB。</li>\n<li>Edbtmp.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。当 Edb.log到达5MB以后，Edb.log文件将被重命名为Edb00001.log，在这期间如果有新数据需要写入怎么办，于是就有了这个Edbtmp.log临时日志文件用来接收新的需要写入日志的内容，在 Edb.log重命名Edb00001.log完成后，Edbtmp.log也将被改名为Edb.log。</li>\n<li>Edb00001.log - 存在于Exchange Server 4.0, 5.0, and 5.5中。日志序列文件。</li>\n<li>E0x.chk - 存在于所有Exchange 版本中。文件名中的x 按邮件存储组的创建编号来命名，从0起。检查点文件，用来标记哪些日志已经被写入数据库，哪些还没有。</li>\n<li>E0x.log -存在于Exchange 2000之后的版本中。用来存放目前最新的邮件更改信息,在到达日志文件目标大小后，将会被重命名为下一个带有lGeneration 数字序列的日志文件，比如从 E0000000001.log 到 E000000000E.log，这里的数字是16进制。 在重命名完成后，会创建新的 E0x.log 文件。</li>\n<li>E0Xtmp.log - 存在于Exchange 2000之后的版本中。 每当 E0x.log 文件被写满之后，这个临时的 E0xtmp.log 文件将被用来接收新的内容，最后将会被改名为新的E0x.log 。</li>\n<li>E0xxxxxxxxx.log -存在于Exchange 版本中，序列日志文件，16进制递增。</li>\n<li>Res1.log 和 Res2.log -存在于 Exchange 2000/2003 中。日志保留文件。主要的作用是防止日志所在硬盘被写满的时候，还能保证数据库文件能被干净的卸载下来。什么意思？当邮件数据库一被挂载的时候，系统会自动创建这2个文件，每个5MB，加起来10MB。当磁盘即将写满的时候(比如剩余空间小于5MB - Exchange 2003)，E0x.log 会到不了5MB就已写满，此时已经写入日志的数据也没法提交应用到EDB数据库中，可能会导致文件丢失，而有了这两个文件以后，在磁盘即将写满的时候，系统会自动将 Res2.log作为下一个新的日志文件，以保证以前的事务数据能够正常写入，然后再自动卸载数据库以保证数据的一致性。有必要的话，Res1.log 也将被用上。就是说，在挂载数据库的时候，系统已经为你预留了10MB的空间来预防数据的丢失。</li>\n<li>.jrs - 类似于 Exchange 2003, 在Exchange 2007 和 Exchange 2010 中的日志预留文件，每个大小1MB。Exchange 2007 只有2个，而 Exchange 2010 有10个。<br>Exchange 2007 ：E0xres00001.jrs 和 E0xres00002.jrs (2个，共计2MB)<br>Exchange 2010 ：E0xres00001.jrs … E0xres00009.jrs (10个，共计10MB)<br><img src=\"/2011/10/11/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg\" alt=\"Figure 3 - Exchange 2010 的日志预留文件\"></li>\n</ul>\n<h5 id=\"未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\"><a href=\"#未完待续：下篇是Exchange-日志文件详解（下）：灾难恢复\" class=\"headerlink\" title=\"未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复\"></a>未完待续：下篇是Exchange 日志文件详解（下）：灾难恢复</h5>"},{"title":"解决 Windows 下 Java8 的 1603 安装错误","id":"260","date":"2015-03-19T14:40:11.000Z","_content":"近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。\n![Java8u40 Install Error Code: 1603](fix-java8-install-1603-error/Java8_Error_1603.png)\n\n最后终于解决：\n1. 关闭 Java 安装程序;\n2. 在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 **javacpl.exe** 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）\n3. 在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；\n4. 重新尝试安装 Java8u40;\n5. 安装成功后再次运行 **javacpl.exe**，恢复勾选 `Enable Java content in browser`\n","source":"_posts/fix-java8-install-1603-error.md","raw":"---\ntitle: 解决 Windows 下 Java8 的 1603 安装错误\ntags:\n  - Java\n  - JRE\n  - MSI\nid: 260\ncategories:\n  - Microsoft\ndate: 2015-03-19 22:40:11\n---\n近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。\n![Java8u40 Install Error Code: 1603](fix-java8-install-1603-error/Java8_Error_1603.png)\n\n最后终于解决：\n1. 关闭 Java 安装程序;\n2. 在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 **javacpl.exe** 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）\n3. 在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；\n4. 重新尝试安装 Java8u40;\n5. 安装成功后再次运行 **javacpl.exe**，恢复勾选 `Enable Java content in browser`\n","slug":"fix-java8-install-1603-error","published":1,"updated":"2017-06-16T09:10:34.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxc000m4gyr54dtp2l3","content":"<p>近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。<br><img src=\"/2015/03/19/fix-java8-install-1603-error/Java8_Error_1603.png\" alt=\"Java8u40 Install Error Code: 1603\"></p>\n<p>最后终于解决：</p>\n<ol>\n<li>关闭 Java 安装程序;</li>\n<li>在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 <strong>javacpl.exe</strong> 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）</li>\n<li>在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；</li>\n<li>重新尝试安装 Java8u40;</li>\n<li>安装成功后再次运行 <strong>javacpl.exe</strong>，恢复勾选 <code>Enable Java content in browser</code></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>近期访问一些应用的网站老是提示 Java 版本过低，需要升级，于是下载了 jre-8u40-windows 来安装，结果老是装不上去，出现这个 1603 错误，试了很多次都一样。<br><img src=\"/2015/03/19/fix-java8-install-1603-error/Java8_Error_1603.png\" alt=\"Java8u40 Install Error Code: 1603\"></p>\n<p>最后终于解决：</p>\n<ol>\n<li>关闭 Java 安装程序;</li>\n<li>在 C:\\Program Files (x86)\\Java\\jre1.8.0_40\\bin 找到 <strong>javacpl.exe</strong> 文件，运行之；（这里的jre1.8.0_40 指的是 Java 8u40，你的版本如有不同请自行替换）</li>\n<li>在 Java 的控制面板的 Security 标签页取消勾选  Enable Java content in browser ， OK 确认；</li>\n<li>重新尝试安装 Java8u40;</li>\n<li>安装成功后再次运行 <strong>javacpl.exe</strong>，恢复勾选 <code>Enable Java content in browser</code></li>\n</ol>\n"},{"title":"解决 VMWare ESXi 4.0 在 VC 中主机硬件状态无法监控的问题","date":"2010-06-15T07:15:52.000Z","_content":"\n最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现\n> Error Message: \"Hardware monitoring service not responding, the host is not powered on\"\n\n重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：\n在 VC 中删掉原来的主机再重新添加,问题就解决了。","source":"_posts/fix-vmware-esxi-40-vc-hardware-status-error.md","raw":"---\ntitle: 解决 VMWare ESXi 4.0 在 VC 中主机硬件状态无法监控的问题\ntags:\n  - Virtual Center\n  - VMware\ncategories:\n  - 虚拟化\ndate: 2010-06-15 15:15:52\n---\n\n最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现\n> Error Message: \"Hardware monitoring service not responding, the host is not powered on\"\n\n重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：\n在 VC 中删掉原来的主机再重新添加,问题就解决了。","slug":"fix-vmware-esxi-40-vc-hardware-status-error","published":1,"updated":"2017-06-16T09:10:58.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxd000n4gyrd99k0t31","content":"<p>最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现</p>\n<blockquote>\n<p>Error Message: “Hardware monitoring service not responding, the host is not powered on”</p>\n</blockquote>\n<p>重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：<br>在 VC 中删掉原来的主机再重新添加,问题就解决了。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>最近 VMWare 释出了 VSphere 4.0 Update2 的更新，忍不住就把目前在跑的几台 Dell PE1950 给升级到了 Update2，别的都没啥问题，就是发现在 VC Client 中无法监测到主机的硬件状态了， 一点 Hardware Status，就出现</p>\n<blockquote>\n<p>Error Message: “Hardware monitoring service not responding, the host is not powered on”</p>\n</blockquote>\n<p>重启服务，重启主机都试过了，问题依旧，后来在 Google 大神的帮助下，终于找到了解决方法：<br>在 VC 中删掉原来的主机再重新添加,问题就解决了。</p>\n"},{"title":"解决 WSUS 下载速度慢的问题","date":"2014-06-10T06:40:11.000Z","_content":"\n解决 WSUS 下载速度慢的问题:\n\n新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。\n\n出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。\n\n解决方案：\n\n1.  如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername%\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n\n2. 如果你使用 SQL 数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername% -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n最后重启WSUS服务生效。\n\n注：**BITS** (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。","source":"_posts/fix-wsus-slow-download-problem.md","raw":"---\ntitle: 解决 WSUS 下载速度慢的问题\ntags:\n  - BITS\n  - Microsoft\n  - WSUS\ncategories:\n  - Microsoft\ndate: 2014-06-10 14:40:11\n---\n\n解决 WSUS 下载速度慢的问题:\n\n新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。\n\n出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。\n\n解决方案：\n\n1.  如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername%\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n\n2. 如果你使用 SQL 数据库：\n```cmd\n%programfiles%\\Update Services\\Setup\\ExecuteSQL.exe -S %Computername% -d \"SUSDB\" -Q \"update tbConfigurationC set BitsDownloadPriorityForeground=1\"\n```\n最后重启WSUS服务生效。\n\n注：**BITS** (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。","slug":"fix-wsus-slow-download-problem","published":1,"updated":"2017-06-16T09:11:14.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxf000r4gyr6lkh6l62","content":"<p>解决 WSUS 下载速度慢的问题:</p>\n<p>新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。</p>\n<p>出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。</p>\n<p>解决方案：</p>\n<ol>\n<li><p>如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span>\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</div></pre></td></tr></table></figure>\n</li>\n<li><p>如果你使用 SQL 数据库：</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span> -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>最后重启WSUS服务生效。</p>\n<p>注：<strong>BITS</strong> (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>解决 WSUS 下载速度慢的问题:</p>\n<p>新建的 WSUS 3.0 SP2 服务器，操作系统为 2008 R2，更新补丁非常慢，总共几十个G的补丁文件，下载了三天了才2G。</p>\n<p>出现这样的问题，大部分情况是因为 WSUS 通过后台下载补丁文件所导致，也就是我们所说的 BITS 服务，可以试着将后台下载改为前台下载。</p>\n<p>解决方案：</p>\n<ol>\n<li><p>如果你的 WSUS 用的是WID（Windows Internal Database）默认数据库：</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span>\\MICROSOFT##SSEE -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</div></pre></td></tr></table></figure>\n</li>\n<li><p>如果你使用 SQL 数据库：</p>\n<figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"variable\">%programfiles%</span>\\Update Services\\Setup\\ExecuteSQL.exe -S <span class=\"variable\">%Computername%</span> -d \"SUSDB\" -Q \"update tbConfigurationC <span class=\"built_in\">set</span> BitsDownloadPriorityForeground=<span class=\"number\">1</span>\"</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>最后重启WSUS服务生效。</p>\n<p>注：<strong>BITS</strong> (后台智能传送服务 Background Intelligent Transfer Service) 是一个 Windows 组件，它可以在前台或后台异步传输文件，为保证其他网络应用程序获得响应而调整传输速度，并在重新启动计算机或重新建立网络连接之后自动恢复文件传输。</p>\n"},{"title":"Fixed: Please wait while Windows configures Microsoft Office Professional Plus 2010","date":"2014-04-28T04:02:35.000Z","_content":"\n上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：\n\n![Windows configures microsoft office ](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg)\n\nPlease wait while windows configures Microsoft Office Professional Plus 2010.\n\n而且是每次都会有，不厌其烦。微软官方也给出了解决方案：\n\n请参考KB2528748: [http://support.microsoft.com/kb/2528748](http://support.microsoft.com/kb/2528748 \"Microsoft Office 2010 Professional Plus configures each time you start\")\n\n运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：\n\n\n![EventID-1004](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg)\n\nThe resource 'HKEY_CLASSES_ROOT\\.aw\\' does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM 账号，然后赋予如下权限即可。\n\n![Permissions-aw](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg)\n\nBy the way, 这个方法适用于所有 Office 系列。\n","source":"_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010.md","raw":"---\ntitle: 'Fixed: Please wait while Windows configures Microsoft Office Professional Plus 2010'\ntags:\n  - Microsoft\n  - MSI\n  - Office\n  - Windows\ncategories:\n  - Microsoft\n  - Office\ndate: 2014-04-28 12:02:35\n---\n\n上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：\n\n![Windows configures microsoft office ](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg)\n\nPlease wait while windows configures Microsoft Office Professional Plus 2010.\n\n而且是每次都会有，不厌其烦。微软官方也给出了解决方案：\n\n请参考KB2528748: [http://support.microsoft.com/kb/2528748](http://support.microsoft.com/kb/2528748 \"Microsoft Office 2010 Professional Plus configures each time you start\")\n\n运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：\n\n\n![EventID-1004](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg)\n\nThe resource 'HKEY_CLASSES_ROOT\\.aw\\' does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM 账号，然后赋予如下权限即可。\n\n![Permissions-aw](fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg)\n\nBy the way, 这个方法适用于所有 Office 系列。\n","slug":"fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010","published":1,"updated":"2017-08-16T02:55:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxg000t4gyrv3of0uev","content":"<p>上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：</p>\n<p><img src=\"/2014/04/28/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg\" alt=\"Windows configures microsoft office \"></p>\n<p>Please wait while windows configures Microsoft Office Professional Plus 2010.</p>\n<p>而且是每次都会有，不厌其烦。微软官方也给出了解决方案：</p>\n<p>请参考KB2528748: <a href=\"http://support.microsoft.com/kb/2528748\" title=\"Microsoft Office 2010 Professional Plus configures each time you start\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/2528748</a></p>\n<p>运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：</p>\n<p><img src=\"/2014/04/28/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg\" alt=\"EventID-1004\"></p>\n<p>The resource ‘HKEY_CLASSES_ROOT.aw\\’ does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM 账号，然后赋予如下权限即可。</p>\n<p><img src=\"/2014/04/28/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg\" alt=\"Permissions-aw\"></p>\n<p>By the way, 这个方法适用于所有 Office 系列。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>上周五通过 .msi 安装包部署了一个软件，今天发现每次启动 Office 2010 的组件—不管是 Word, Excel, PowerPoint 还是 Outlook，都会出现这个提示：</p>\n<p><img src=\"/2014/04/28/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg\" alt=\"Windows configures microsoft office \"></p>\n<p>Please wait while windows configures Microsoft Office Professional Plus 2010.</p>\n<p>而且是每次都会有，不厌其烦。微软官方也给出了解决方案：</p>\n<p>请参考KB2528748: <a href=\"http://support.microsoft.com/kb/2528748\" title=\"Microsoft Office 2010 Professional Plus configures each time you start\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/2528748</a></p>\n<p>运气好的话，说不定问题就能解决，但如果你和我这个倒霉蛋一样，这个方案根本没用的时候，不妨再检查你的日志：</p>\n<p><img src=\"/2014/04/28/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg\" alt=\"EventID-1004\"></p>\n<p>The resource ‘HKEY_CLASSES_ROOT.aw\\’ does not exist. 其实 .aw 这个键值不是不存在，而是由于某种原因，权限丢失了，只要将其所有者改为 SYSTEM 账号，然后赋予如下权限即可。</p>\n<p><img src=\"/2014/04/28/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg\" alt=\"Permissions-aw\"></p>\n<p>By the way, 这个方法适用于所有 Office 系列。</p>\n"},{"title":"修复安装于VMware上的CentOS启动时出现 piix4_smbus Host SMBus controller not enabled 的错误","date":"2013-05-01T15:45:49.000Z","_content":"\n如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：\n\n![piix4_smbus 0000:00:007.3: Host SMBus controller not enabled](fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg) \n\n**piix4_smbus 0000:00:007.3: Host SMBus controller not enabled**\n> \"The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it...\"\n\n从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：\n```bash\nvi /etc/modprobe.d/blacklist.conf\n#加入以下两行\n#intel piix4 driver\nblacklist i2c_piix4\n```","source":"_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware.md","raw":"---\ntitle: 修复安装于VMware上的CentOS启动时出现 piix4_smbus Host SMBus controller not enabled 的错误\ntags:\n  - CentOS\n  - VMware\ncategories:\n  - '*Nix'\ndate: 2013-05-01 23:45:49\n---\n\n如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：\n\n![piix4_smbus 0000:00:007.3: Host SMBus controller not enabled](fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg) \n\n**piix4_smbus 0000:00:007.3: Host SMBus controller not enabled**\n> \"The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it...\"\n\n从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：\n```bash\nvi /etc/modprobe.d/blacklist.conf\n#加入以下两行\n#intel piix4 driver\nblacklist i2c_piix4\n```","slug":"fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware","published":1,"updated":"2017-06-16T09:10:04.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxh000w4gyra00n0suk","content":"<p>如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：</p>\n<p><img src=\"/2013/05/01/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg\" alt=\"piix4_smbus 0000:00:007.3: Host SMBus controller not enabled\"> </p>\n<p><strong>piix4_smbus 0000:00:007.3: Host SMBus controller not enabled</strong></p>\n<blockquote>\n<p>“The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it…”</p>\n</blockquote>\n<p>从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /etc/modprobe.d/blacklist.conf</div><div class=\"line\"><span class=\"comment\">#加入以下两行</span></div><div class=\"line\"><span class=\"comment\">#intel piix4 driver</span></div><div class=\"line\">blacklist i2c_piix4</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>如果你的 CentOS 6.4 是在 VMware 的虚拟机上安装的，那么在启动的时候，你可能会看到这样一个错误：</p>\n<p><img src=\"/2013/05/01/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg\" alt=\"piix4_smbus 0000:00:007.3: Host SMBus controller not enabled\"> </p>\n<p><strong>piix4_smbus 0000:00:007.3: Host SMBus controller not enabled</strong></p>\n<blockquote>\n<p>“The PIIX4 (properly known as the 82371AB) is an Intel chip with a lot of functionality. Among other things, it implements the PCI bus. One of its minor functions is implementing a System Management Bus. This is a true SMBus - you can not access it on I2C levels. The good news is that it natively understands SMBus commands and you do not have to worry about timing problems. The bad news is that non-SMBus devices connected to it can confuse it…”</p>\n</blockquote>\n<p>从内核的说明文档来看，这个 piix4 实际上是 Intel 82371AB 南桥芯片，多功能总线控制器，而在 VMware 里面并没有这个真实的芯片组，但在启动时最会尝试载入这个驱动模块，所以会报错，虽然对系统没有任何影响，但如果你看着不爽想移除掉的话，也是可以的：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /etc/modprobe.d/blacklist.conf</div><div class=\"line\"><span class=\"comment\">#加入以下两行</span></div><div class=\"line\"><span class=\"comment\">#intel piix4 driver</span></div><div class=\"line\">blacklist i2c_piix4</div></pre></td></tr></table></figure></p>\n"},{"title":"HMC 4.0 Update Rollup 3 has been updated","date":"2010-03-02T11:46:14.000Z","_content":"\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.0\n\n[http://support.microsoft.com/kb/979702/en-us](http://support.microsoft.com/kb/979702/en-us)\n\nMicrosoft released an update rollup that is dated December 2009\\. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\n*   Hosted SharePoint 2007 Namespace\n*   Managed SharePoint 2007 Namespace\n*   Hosted SharePoint Web Service\n*   Managed SharePoint Web Service\n*   DNS Provider\n\n**This will enable HMC 4.0 to support Exchange 2007 SP2!**","source":"_posts/hmc-40-update-rollup-3-has-been-updated.md","raw":"---\ntitle: HMC 4.0 Update Rollup 3 has been updated\ntags:\n  - Exchange\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2010-03-02 19:46:14\n---\n\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.0\n\n[http://support.microsoft.com/kb/979702/en-us](http://support.microsoft.com/kb/979702/en-us)\n\nMicrosoft released an update rollup that is dated December 2009\\. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\n*   Hosted SharePoint 2007 Namespace\n*   Managed SharePoint 2007 Namespace\n*   Hosted SharePoint Web Service\n*   Managed SharePoint Web Service\n*   DNS Provider\n\n**This will enable HMC 4.0 to support Exchange 2007 SP2!**","slug":"hmc-40-update-rollup-3-has-been-updated","published":1,"updated":"2017-06-16T09:11:38.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxi000z4gyr6at0yxn3","content":"<p>Description of Update Rollup 3 for Hosted Messaging and Collaboration 4.0</p>\n<p><a href=\"http://support.microsoft.com/kb/979702/en-us\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/979702/en-us</a></p>\n<p>Microsoft released an update rollup that is dated December 2009. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:</p>\n<ul>\n<li>Exchange 2007 Resource Manager Namespace</li>\n<li>Exchange 2007 Resource Manager Web Services</li>\n<li>Hosted Email 2007 Namespace</li>\n<li>Hosted Email 2007 Web Services</li>\n<li>Managed Email 2007 Namespace</li>\n<li>Managed Email 2007 Web Services</li>\n<li>Exchange 2007 Mobility Provider</li>\n<li>Exchange 2007 Provider</li>\n<li>Unified Messaging 2007 Provider</li>\n<li>Hosted SharePoint 2007 Namespace</li>\n<li>Managed SharePoint 2007 Namespace</li>\n<li>Hosted SharePoint Web Service</li>\n<li>Managed SharePoint Web Service</li>\n<li>DNS Provider</li>\n</ul>\n<p><strong>This will enable HMC 4.0 to support Exchange 2007 SP2!</strong></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Description of Update Rollup 3 for Hosted Messaging and Collaboration 4.0</p>\n<p><a href=\"http://support.microsoft.com/kb/979702/en-us\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/979702/en-us</a></p>\n<p>Microsoft released an update rollup that is dated December 2009. This update fixes issues that may occur in the following components of Microsoft Solution for Hosted Messaging and Collaboration 4.0:</p>\n<ul>\n<li>Exchange 2007 Resource Manager Namespace</li>\n<li>Exchange 2007 Resource Manager Web Services</li>\n<li>Hosted Email 2007 Namespace</li>\n<li>Hosted Email 2007 Web Services</li>\n<li>Managed Email 2007 Namespace</li>\n<li>Managed Email 2007 Web Services</li>\n<li>Exchange 2007 Mobility Provider</li>\n<li>Exchange 2007 Provider</li>\n<li>Unified Messaging 2007 Provider</li>\n<li>Hosted SharePoint 2007 Namespace</li>\n<li>Managed SharePoint 2007 Namespace</li>\n<li>Hosted SharePoint Web Service</li>\n<li>Managed SharePoint Web Service</li>\n<li>DNS Provider</li>\n</ul>\n<p><strong>This will enable HMC 4.0 to support Exchange 2007 SP2!</strong></p>\n"},{"title":"HMC 4.0 Update Rollup 5 has been released","date":"2009-05-27T04:46:53.000Z","_content":"\nThis has been released a while ago but in case you missed this.\n\n[http://support.microsoft.com/?id=961991](http://support.microsoft.com/?id=961991)\n\nPlease take note that, this hotfix, although it is named as an rollup, it does not include RU4\\. Hence, you will need to first deploy RU4 before you deploy this hotfix.\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to **dynamic**, and if the mailstore that is selected has insufficient free space.\n*   OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.\n*   This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.\n*   The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.\n*   If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to **not provisionable** in Resource Manager. Only the complete server can be disabled.\n*   A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.\n*   When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.","source":"_posts/hmc-40-update-rollup-5-has-been-released.md","raw":"---\ntitle: HMC 4.0 Update Rollup 5 has been released\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-27 12:46:53\n---\n\nThis has been released a while ago but in case you missed this.\n\n[http://support.microsoft.com/?id=961991](http://support.microsoft.com/?id=961991)\n\nPlease take note that, this hotfix, although it is named as an rollup, it does not include RU4\\. Hence, you will need to first deploy RU4 before you deploy this hotfix.\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to **dynamic**, and if the mailstore that is selected has insufficient free space.\n*   OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.\n*   This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.\n*   The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.\n*   If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to **not provisionable** in Resource Manager. Only the complete server can be disabled.\n*   A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.\n*   When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.","slug":"hmc-40-update-rollup-5-has-been-released","published":1,"updated":"2017-06-16T09:11:46.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxk00114gyrxu170g0u","content":"<p>This has been released a while ago but in case you missed this.</p>\n<p><a href=\"http://support.microsoft.com/?id=961991\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=961991</a></p>\n<p>Please take note that, this hotfix, although it is named as an rollup, it does not include RU4. Hence, you will need to first deploy RU4 before you deploy this hotfix.</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to <strong>dynamic</strong>, and if the mailstore that is selected has insufficient free space.</li>\n<li>OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.</li>\n<li>This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.</li>\n<li>The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.</li>\n<li>If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to <strong>not provisionable</strong> in Resource Manager. Only the complete server can be disabled.</li>\n<li>A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.</li>\n<li>When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>This has been released a while ago but in case you missed this.</p>\n<p><a href=\"http://support.microsoft.com/?id=961991\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=961991</a></p>\n<p>Please take note that, this hotfix, although it is named as an rollup, it does not include RU4. Hence, you will need to first deploy RU4 before you deploy this hotfix.</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>An exception is thrown when a new user mailbox is created: An arithmetic overflow occurred, the resource capacity specified was too large.This issue occurs if the ResourceManager Allocation Algorithm is set to <strong>dynamic</strong>, and if the mailstore that is selected has insufficient free space.</li>\n<li>OAB generation fails if the Domain Controller that is identified in the config file becomes unavailable. This fix removes the setting from the config file and adds automatic Domain Controller discovery to the functionality of the HeOABUpdate.exe tool.</li>\n<li>This update rollup updates SharePoint Web Service code to catch SPException errors when one content database is down or is failed over to another node in the cluster. In this case, all other site collections in other content databases can still be access by the provisioning system.</li>\n<li>The Microsoft Provisioning Server (MPS) DNS provider client does not run on a 64-bit operating system.</li>\n<li>If a Mailbox Store on an Exchange back-end server is unavailable, you cannot set only this store to <strong>not provisionable</strong> in Resource Manager. Only the complete server can be disabled.</li>\n<li>A memory leak occurs in the AddCustomerSite and ModifyCustomerSite procedures. When you create and modify many SharePoint Sites by using MPS, the SharePoint2007 Provider develops a slow memory leak that slowly depletes resources on the MPS Engine Server.</li>\n<li>When you move a mailbox by using the MoveMailbox API on the Exchange 2007 provider, the ShowInAddressBook property can be reset to the Exchange default values. This can prevent the user from seeing the global address list (GAL) or the Offline AddressBook of the organization.</li>\n</ul>\n"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 1 - Overview and Active Directory","date":"2009-05-06T09:06:36.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nOne of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC) is this, \"What do you do to Exchange to make HMC work?\" So, here I will attempt to demystify this.\n\nHMC started long way back but the concept has not deviated much. I want to note that this specific blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.\n\nThere are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,\n\n*   Part #1: Overview and Active Directory\n*   Part #2: Address Lists Segregation\n*   Part #3: Offline Address Book generations\n*   Part #4: Internal and External Out of Office\n*   Part #5: Autodiscover in the Multi-tenancy environment\n*   Part #6: Conclusion\n\n**What does HMC mean to Exchange 2007?**\n\nLet me start by asking this, what exactly is HMC? Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about **Multi-tenant enablement**.\n\nYes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn't designed with that as the focus.\n\nWhat is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor's servers, serving multiple client organizations (tenants).\n\nThink of it like a condominium with hundreds of different individual units living in it, that's what multi-tenant is. Instead of having only one company _(note: I tend to use company and tenant interchangeably)_ to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)\n\nLet me continue with the condominium analogy. Now that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.\n\nSo what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,\n\n1.  **Active Directory Partitioning and Permission** - think of it like partitioning each floor to different unit. Every company will have their own separate 'space' and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.\n\n2.  **Address List Segregation** - access to the contact information in each company should only be limited to users in that company. Other tenants shouldn't know have access to that information.\n\n3.  **Outlook Experience **- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook, such as Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.\n\n4.  **Shared Components** - as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.\n\nNow that we have listed them down, it doesn't look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren't doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.\n\nThose who has been dealing with Exchange 2007 probably realize that we have a white paper that talks about the similar thing, which is [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"). I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.\n\nThe above white paper explained how you can come up with your homebrew version of hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.\n\n**Active Directory Partitioning and Permission**\n\nFirstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the Provisioning Deployment Tool that comes with the HMC Solution ISO file.\n\n(1) List Object Mode (**dsHeuristics**)\n\nThis is the first thing that the Deployment Tool will do. This is about controlling the object visibility. By default in Active Directory, we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.\n\nObviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,\n\n* Fabrikam.com (Windows Domain)\n    * Hosting (Hosting Container)\n        * ConsolidatedMessenger (Reseller)\n             * Company1\n                  * [User1@Company1]\n                  * [User2@Company1\n                  * [User3@Company1]\n             * Company2\n\t\t\t   * [User1@Company2]\n\t\t\t   * [User2@Company2]\n\t\t\t   * [User3@Company2]\n             * [User1@ConsolidatedMessenger]\n             * [User2@ConsolidatedMessenger]\n\nIf I grant [User1@Company1](mailto:User1@Company1) List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it stops someone looking at what lives under the object or container. However, granting it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing. This is where \"List Object\" mode comes in.\n\nIn this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.\n\nThe availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.\n\n(2) Active Directory Partitioning - Hosting Container\n\nNow, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,\n\n*   HMC does not support deployment in a child domain. While it is technically possible, it hasn't be well tested and hence it is not a supported model.\n*   By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in _Hosting Platform - Initialize Default Services - Initialize Active Directory_ for Hosting in the Deployment Tool.\n\nThat is only the creation of the master hosting container. You will then need to follow the Deployment Walkthrough in the Help File to create the Reseller container and also the Tenant container. From the Exchange perspective, you only need to know the following,\n\n*   **HMC Resellers** - Each Reseller is fully contained within its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is_ConsolidatedMessenger.com_. The Reseller OU will usually contain the following objects\n\n    *   HMC Tenants\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;Reseller&gt; group\n\n*   **HMC Tenants** - Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is _AlpineSkiHouse.com_. The Tenant OU will usually contain the following objects,\n\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin\n    *   Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)\n\n*   **HMC Users** - Users objects within AD are the security principal.\n*   **HMC Mailboxes** - An HMC mailbox is a user object that has been Exchange Mailbox Enabled.\nHere is an example of the Active Directory Hosting Container structure in HMC\n\n*   Fabrikam.com (Domain)\n\n    *   Hosting (Hosting OU)\n\n            *   _Private\n        *   ConsolidatedMessenger.com (HMC Reseller)\n\n                    *   _Private\n            *   [admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) (Admins group for HMC Reseller)\n            *   [administrator@ConsolidatedMessenger.com](mailto:administrator@ConsolidatedMessenger.com) (Administrator for the HMC Reseller)\n            *   AlpineSkiHouse.com (HMC Tenant)\n\n                            *   _Private\n                *   [admins@alpineskihouse.com](mailto:admins@alpineskihouse.com) (Admins group for HMC Tenant)\n                *   [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) (HMC Users/Mailboxes)\nObviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.) and properly assign the appropriate membership and permissions in different containers.\n\nPermission Inheritance is not blocked specifically. For example,[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.\n\nFor the purpose of this blog, I think that's all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)\n\n(3) User Logon\n\nI want to touch a little bit about User Logon here. Most of you who are familiar with Active Directory will know what a _samAccountName _is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.\n\nI can login to the environment using either username@domain or DOMAIN\\&lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.\n\nIn order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is [username@domain](mailto:username@domain) such as [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com). You will notice in HMC allows that by modifying the **upnSuffixes attribute **of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.\n\nWith that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can't have more than 20 characters, it will get truncated if it is more than 20 characters. For example,\n\n*   Logon Name: [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) will have the samAccountName of johnc_AlpineSkiHouse\n*   Logon Name: [bob@alpineskihouse.com](mailto:bob@alpineskihouse.com) will have the samAccountName of bob_AlpineSkiHouse.c\nSo, hopefully that will help to explain the naming convention of the user object.\n\n(4) Active Directory Attributes\n\nHMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn't. Instead, it uses what I would call the poor man's schema extension, the **otherWellknownObjects** attribute.\n\nFrom the Exchange standpoint, this attribute is not used but for the provisioning process (MPS) to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.\n\nHere is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.\n\n12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;**B:32:D22DFCC5B73645E99E16C9AD3D61F34F**:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:9E444526CB6F4D5C9A59C9A84E26B627**:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:89FB25B7DF784FC198A493E2E8A0EE7E**:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;\n\nAs you can see from above, we have a unique GUID number to identify a specific category of relationship.\n\n&lt;GUID name=\"GlobalAddressList\"&gt;**89FB25B7DF784FC198A493E2E8A0EE7E**&lt;/GUID&gt;\n&lt;GUID name=\"AddressList\"&gt;**9E444526CB6F4D5C9A59C9A84E26B627**&lt;/GUID&gt;\n&lt;GUID name=\"OfflineAddressList\"&gt;**D22DFCC5B73645E99E16C9AD3D61F34F**&lt;/GUID&gt;\n\nIn addition, here are some of the _Key attributes to Exchange:_\n\n*   **homeMDB**: DN of the users mailbox store - no customizations for HMC.\n*   **mailNickname**: This is the HMC Users mailbox alias. - no customizations for HMC.\n*   **msExchMailboxFolderSet**: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans. ** **\n*   **msExchQueryBaseDN**: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.\n*   **protocolSettings**: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans\n*   **showInAddressBook**: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL'd correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list. ** **\n*   **msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\nLet's briefly talk about the e-mail address stamping here too. In Exchange 2003, we have this process called Recipient Update Services. In Exchange 2007, this whole process has been embedded into the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the **EmailAddressPolicyEnabled** attribute to **False**. This means,\n\n*   It does not rely on the Email Address Policy at all. That's why you will see that HMC will not create any Email Address Policy at all.\n\n*   HMC will use its own mechanism to stamp the SMTP addresses.\nSo, that's it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.","source":"_posts/hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 1 - Overview and Active Directory\ntags:\n  - Exchange\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-06 17:06:36\n---\n\n转自 http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nOne of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC) is this, \"What do you do to Exchange to make HMC work?\" So, here I will attempt to demystify this.\n\nHMC started long way back but the concept has not deviated much. I want to note that this specific blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.\n\nThere are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,\n\n*   Part #1: Overview and Active Directory\n*   Part #2: Address Lists Segregation\n*   Part #3: Offline Address Book generations\n*   Part #4: Internal and External Out of Office\n*   Part #5: Autodiscover in the Multi-tenancy environment\n*   Part #6: Conclusion\n\n**What does HMC mean to Exchange 2007?**\n\nLet me start by asking this, what exactly is HMC? Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about **Multi-tenant enablement**.\n\nYes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn't designed with that as the focus.\n\nWhat is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor's servers, serving multiple client organizations (tenants).\n\nThink of it like a condominium with hundreds of different individual units living in it, that's what multi-tenant is. Instead of having only one company _(note: I tend to use company and tenant interchangeably)_ to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)\n\nLet me continue with the condominium analogy. Now that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.\n\nSo what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,\n\n1.  **Active Directory Partitioning and Permission** - think of it like partitioning each floor to different unit. Every company will have their own separate 'space' and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.\n\n2.  **Address List Segregation** - access to the contact information in each company should only be limited to users in that company. Other tenants shouldn't know have access to that information.\n\n3.  **Outlook Experience **- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook, such as Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.\n\n4.  **Shared Components** - as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.\n\nNow that we have listed them down, it doesn't look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren't doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.\n\nThose who has been dealing with Exchange 2007 probably realize that we have a white paper that talks about the similar thing, which is [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"). I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.\n\nThe above white paper explained how you can come up with your homebrew version of hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.\n\n**Active Directory Partitioning and Permission**\n\nFirstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the Provisioning Deployment Tool that comes with the HMC Solution ISO file.\n\n(1) List Object Mode (**dsHeuristics**)\n\nThis is the first thing that the Deployment Tool will do. This is about controlling the object visibility. By default in Active Directory, we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.\n\nObviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,\n\n* Fabrikam.com (Windows Domain)\n    * Hosting (Hosting Container)\n        * ConsolidatedMessenger (Reseller)\n             * Company1\n                  * [User1@Company1]\n                  * [User2@Company1\n                  * [User3@Company1]\n             * Company2\n\t\t\t   * [User1@Company2]\n\t\t\t   * [User2@Company2]\n\t\t\t   * [User3@Company2]\n             * [User1@ConsolidatedMessenger]\n             * [User2@ConsolidatedMessenger]\n\nIf I grant [User1@Company1](mailto:User1@Company1) List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it stops someone looking at what lives under the object or container. However, granting it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing. This is where \"List Object\" mode comes in.\n\nIn this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.\n\nThe availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.\n\n(2) Active Directory Partitioning - Hosting Container\n\nNow, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,\n\n*   HMC does not support deployment in a child domain. While it is technically possible, it hasn't be well tested and hence it is not a supported model.\n*   By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in _Hosting Platform - Initialize Default Services - Initialize Active Directory_ for Hosting in the Deployment Tool.\n\nThat is only the creation of the master hosting container. You will then need to follow the Deployment Walkthrough in the Help File to create the Reseller container and also the Tenant container. From the Exchange perspective, you only need to know the following,\n\n*   **HMC Resellers** - Each Reseller is fully contained within its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is_ConsolidatedMessenger.com_. The Reseller OU will usually contain the following objects\n\n    *   HMC Tenants\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;Reseller&gt; group\n\n*   **HMC Tenants** - Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is _AlpineSkiHouse.com_. The Tenant OU will usually contain the following objects,\n\n    *   HMC Users\n    *   A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.\n    *   An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin\n    *   Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)\n\n*   **HMC Users** - Users objects within AD are the security principal.\n*   **HMC Mailboxes** - An HMC mailbox is a user object that has been Exchange Mailbox Enabled.\nHere is an example of the Active Directory Hosting Container structure in HMC\n\n*   Fabrikam.com (Domain)\n\n    *   Hosting (Hosting OU)\n\n            *   _Private\n        *   ConsolidatedMessenger.com (HMC Reseller)\n\n                    *   _Private\n            *   [admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) (Admins group for HMC Reseller)\n            *   [administrator@ConsolidatedMessenger.com](mailto:administrator@ConsolidatedMessenger.com) (Administrator for the HMC Reseller)\n            *   AlpineSkiHouse.com (HMC Tenant)\n\n                            *   _Private\n                *   [admins@alpineskihouse.com](mailto:admins@alpineskihouse.com) (Admins group for HMC Tenant)\n                *   [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) (HMC Users/Mailboxes)\nObviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.) and properly assign the appropriate membership and permissions in different containers.\n\nPermission Inheritance is not blocked specifically. For example,[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the[admins@ConsolidatedMessenger.com](mailto:admins@ConsolidatedMessenger.com) group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.\n\nFor the purpose of this blog, I think that's all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)\n\n(3) User Logon\n\nI want to touch a little bit about User Logon here. Most of you who are familiar with Active Directory will know what a _samAccountName _is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.\n\nI can login to the environment using either username@domain or DOMAIN\\&lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.\n\nIn order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is [username@domain](mailto:username@domain) such as [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com). You will notice in HMC allows that by modifying the **upnSuffixes attribute **of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.\n\nWith that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can't have more than 20 characters, it will get truncated if it is more than 20 characters. For example,\n\n*   Logon Name: [johnc@alpineskihouse.com](mailto:johnc@alpineskihouse.com) will have the samAccountName of johnc_AlpineSkiHouse\n*   Logon Name: [bob@alpineskihouse.com](mailto:bob@alpineskihouse.com) will have the samAccountName of bob_AlpineSkiHouse.c\nSo, hopefully that will help to explain the naming convention of the user object.\n\n(4) Active Directory Attributes\n\nHMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn't. Instead, it uses what I would call the poor man's schema extension, the **otherWellknownObjects** attribute.\n\nFrom the Exchange standpoint, this attribute is not used but for the provisioning process (MPS) to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.\n\nHere is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.\n\n12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;**B:32:D22DFCC5B73645E99E16C9AD3D61F34F**:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:9E444526CB6F4D5C9A59C9A84E26B627**:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;**B:32:89FB25B7DF784FC198A493E2E8A0EE7E**:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;\n\nAs you can see from above, we have a unique GUID number to identify a specific category of relationship.\n\n&lt;GUID name=\"GlobalAddressList\"&gt;**89FB25B7DF784FC198A493E2E8A0EE7E**&lt;/GUID&gt;\n&lt;GUID name=\"AddressList\"&gt;**9E444526CB6F4D5C9A59C9A84E26B627**&lt;/GUID&gt;\n&lt;GUID name=\"OfflineAddressList\"&gt;**D22DFCC5B73645E99E16C9AD3D61F34F**&lt;/GUID&gt;\n\nIn addition, here are some of the _Key attributes to Exchange:_\n\n*   **homeMDB**: DN of the users mailbox store - no customizations for HMC.\n*   **mailNickname**: This is the HMC Users mailbox alias. - no customizations for HMC.\n*   **msExchMailboxFolderSet**: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans. ** **\n*   **msExchQueryBaseDN**: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.\n*   **protocolSettings**: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans\n*   **showInAddressBook**: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL'd correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list. ** **\n*   **msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\nLet's briefly talk about the e-mail address stamping here too. In Exchange 2003, we have this process called Recipient Update Services. In Exchange 2007, this whole process has been embedded into the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the **EmailAddressPolicyEnabled** attribute to **False**. This means,\n\n*   It does not rely on the Email Address Policy at all. That's why you will see that HMC will not create any Email Address Policy at all.\n\n*   HMC will use its own mechanism to stamp the SMTP addresses.\nSo, that's it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.","slug":"hmc-45-and-exchange-2007-sp1-part1-overview-and-active-directory","published":1,"updated":"2017-06-16T09:11:56.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxm00154gyrrspifbik","content":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>One of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC) is this, “What do you do to Exchange to make HMC work?” So, here I will attempt to demystify this.</p>\n<p>HMC started long way back but the concept has not deviated much. I want to note that this specific blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.</p>\n<p>There are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,</p>\n<ul>\n<li>Part #1: Overview and Active Directory</li>\n<li>Part #2: Address Lists Segregation</li>\n<li>Part #3: Offline Address Book generations</li>\n<li>Part #4: Internal and External Out of Office</li>\n<li>Part #5: Autodiscover in the Multi-tenancy environment</li>\n<li>Part #6: Conclusion</li>\n</ul>\n<p><strong>What does HMC mean to Exchange 2007?</strong></p>\n<p>Let me start by asking this, what exactly is HMC? Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about <strong>Multi-tenant enablement</strong>.</p>\n<p>Yes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn’t designed with that as the focus.</p>\n<p>What is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor’s servers, serving multiple client organizations (tenants).</p>\n<p>Think of it like a condominium with hundreds of different individual units living in it, that’s what multi-tenant is. Instead of having only one company <em>(note: I tend to use company and tenant interchangeably)</em> to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)</p>\n<p>Let me continue with the condominium analogy. Now that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.</p>\n<p>So what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,</p>\n<ol>\n<li><p><strong>Active Directory Partitioning and Permission</strong> - think of it like partitioning each floor to different unit. Every company will have their own separate ‘space’ and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.</p>\n</li>\n<li><p><strong>Address List Segregation</strong> - access to the contact information in each company should only be limited to users in that company. Other tenants shouldn’t know have access to that information.</p>\n</li>\n<li><p><strong>Outlook Experience </strong>- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook, such as Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.</p>\n</li>\n<li><p><strong>Shared Components</strong> - as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.</p>\n</li>\n</ol>\n<p>Now that we have listed them down, it doesn’t look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren’t doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.</p>\n<p>Those who has been dealing with Exchange 2007 probably realize that we have a white paper that talks about the similar thing, which is <a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \" target=\"_blank\" rel=\"external\">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 </a>. I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.</p>\n<p>The above white paper explained how you can come up with your homebrew version of hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.</p>\n<p><strong>Active Directory Partitioning and Permission</strong></p>\n<p>Firstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the Provisioning Deployment Tool that comes with the HMC Solution ISO file.</p>\n<p>(1) List Object Mode (<strong>dsHeuristics</strong>)</p>\n<p>This is the first thing that the Deployment Tool will do. This is about controlling the object visibility. By default in Active Directory, we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.</p>\n<p>Obviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,</p>\n<ul>\n<li>Fabrikam.com (Windows Domain)<ul>\n<li>Hosting (Hosting Container)<ul>\n<li>ConsolidatedMessenger (Reseller)<ul>\n<li>Company1<ul>\n<li>[User1@Company1]</li>\n<li>[User2@Company1</li>\n<li>[User3@Company1]</li>\n</ul>\n</li>\n<li>Company2<ul>\n<li>[User1@Company2]</li>\n<li>[User2@Company2]</li>\n<li>[User3@Company2]</li>\n</ul>\n</li>\n<li>[User1@ConsolidatedMessenger]</li>\n<li>[User2@ConsolidatedMessenger]</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>If I grant <a href=\"mailto:User1@Company1\" target=\"_blank\" rel=\"external\">User1@Company1</a> List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it stops someone looking at what lives under the object or container. However, granting it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing. This is where “List Object” mode comes in.</p>\n<p>In this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.</p>\n<p>The availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.</p>\n<p>(2) Active Directory Partitioning - Hosting Container</p>\n<p>Now, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,</p>\n<ul>\n<li>HMC does not support deployment in a child domain. While it is technically possible, it hasn’t be well tested and hence it is not a supported model.</li>\n<li>By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in <em>Hosting Platform - Initialize Default Services - Initialize Active Directory</em> for Hosting in the Deployment Tool.</li>\n</ul>\n<p>That is only the creation of the master hosting container. You will then need to follow the Deployment Walkthrough in the Help File to create the Reseller container and also the Tenant container. From the Exchange perspective, you only need to know the following,</p>\n<ul>\n<li><p><strong>HMC Resellers</strong> - Each Reseller is fully contained within its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is<em>ConsolidatedMessenger.com</em>. The Reseller OU will usually contain the following objects</p>\n<ul>\n<li>HMC Tenants</li>\n<li>HMC Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;Reseller&gt; group</li>\n</ul>\n</li>\n<li><p><strong>HMC Tenants</strong> - Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is <em>AlpineSkiHouse.com</em>. The Tenant OU will usually contain the following objects,</p>\n<ul>\n<li>HMC Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin</li>\n<li>Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)</li>\n</ul>\n</li>\n<li><p><strong>HMC Users</strong> - Users objects within AD are the security principal.</p>\n</li>\n<li><p><strong>HMC Mailboxes</strong> - An HMC mailbox is a user object that has been Exchange Mailbox Enabled.<br>Here is an example of the Active Directory Hosting Container structure in HMC</p>\n</li>\n<li><p>Fabrikam.com (Domain)</p>\n<ul>\n<li><p>Hosting (Hosting OU)</p>\n<pre><code>*   _Private\n</code></pre><ul>\n<li><p>ConsolidatedMessenger.com (HMC Reseller)</p>\n<pre><code>*   _Private\n</code></pre><ul>\n<li><a href=\"mailto:admins@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">admins@ConsolidatedMessenger.com</a> (Admins group for HMC Reseller)</li>\n<li><a href=\"mailto:administrator@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">administrator@ConsolidatedMessenger.com</a> (Administrator for the HMC Reseller)</li>\n<li><p>AlpineSkiHouse.com (HMC Tenant)</p>\n<pre><code>*   _Private\n</code></pre><ul>\n<li><a href=\"mailto:admins@alpineskihouse.com\" target=\"_blank\" rel=\"external\">admins@alpineskihouse.com</a> (Admins group for HMC Tenant)</li>\n<li><a href=\"mailto:johnc@alpineskihouse.com\" target=\"_blank\" rel=\"external\">johnc@alpineskihouse.com</a> (HMC Users/Mailboxes)<br>Obviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.) and properly assign the appropriate membership and permissions in different containers.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Permission Inheritance is not blocked specifically. For example,<a href=\"mailto:admins@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">admins@ConsolidatedMessenger.com</a> group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the<a href=\"mailto:admins@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">admins@ConsolidatedMessenger.com</a> group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.</p>\n<p>For the purpose of this blog, I think that’s all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)</p>\n<p>(3) User Logon</p>\n<p>I want to touch a little bit about User Logon here. Most of you who are familiar with Active Directory will know what a _samAccountName _is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.</p>\n<p>I can login to the environment using either username@domain or DOMAIN\\&lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.</p>\n<p>In order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is <a href=\"mailto:username@domain\" target=\"_blank\" rel=\"external\">username@domain</a> such as <a href=\"mailto:johnc@alpineskihouse.com\" target=\"_blank\" rel=\"external\">johnc@alpineskihouse.com</a>. You will notice in HMC allows that by modifying the <strong>upnSuffixes attribute </strong>of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.</p>\n<p>With that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can’t have more than 20 characters, it will get truncated if it is more than 20 characters. For example,</p>\n<ul>\n<li>Logon Name: <a href=\"mailto:johnc@alpineskihouse.com\" target=\"_blank\" rel=\"external\">johnc@alpineskihouse.com</a> will have the samAccountName of johnc_AlpineSkiHouse</li>\n<li>Logon Name: <a href=\"mailto:bob@alpineskihouse.com\" target=\"_blank\" rel=\"external\">bob@alpineskihouse.com</a> will have the samAccountName of bob_AlpineSkiHouse.c<br>So, hopefully that will help to explain the naming convention of the user object.</li>\n</ul>\n<p>(4) Active Directory Attributes</p>\n<p>HMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn’t. Instead, it uses what I would call the poor man’s schema extension, the <strong>otherWellknownObjects</strong> attribute.</p>\n<p>From the Exchange standpoint, this attribute is not used but for the provisioning process (MPS) to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.</p>\n<p>Here is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.</p>\n<p>12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;<strong>B:32:D22DFCC5B73645E99E16C9AD3D61F34F</strong>:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:9E444526CB6F4D5C9A59C9A84E26B627</strong>:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:89FB25B7DF784FC198A493E2E8A0EE7E</strong>:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;</p>\n<p>As you can see from above, we have a unique GUID number to identify a specific category of relationship.</p>\n<p>&lt;GUID name=”GlobalAddressList”&gt;<strong>89FB25B7DF784FC198A493E2E8A0EE7E</strong>&lt;/GUID&gt;<br>&lt;GUID name=”AddressList”&gt;<strong>9E444526CB6F4D5C9A59C9A84E26B627</strong>&lt;/GUID&gt;<br>&lt;GUID name=”OfflineAddressList”&gt;<strong>D22DFCC5B73645E99E16C9AD3D61F34F</strong>&lt;/GUID&gt;</p>\n<p>In addition, here are some of the <em>Key attributes to Exchange:</em></p>\n<ul>\n<li><strong>homeMDB</strong>: DN of the users mailbox store - no customizations for HMC.</li>\n<li><strong>mailNickname</strong>: This is the HMC Users mailbox alias. - no customizations for HMC.</li>\n<li><strong>msExchMailboxFolderSet</strong>: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans. <strong> </strong></li>\n<li><strong>msExchQueryBaseDN</strong>: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.</li>\n<li><strong>protocolSettings</strong>: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans</li>\n<li><strong>showInAddressBook</strong>: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL’d correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list. <strong> </strong></li>\n<li><p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.<br>Let’s briefly talk about the e-mail address stamping here too. In Exchange 2003, we have this process called Recipient Update Services. In Exchange 2007, this whole process has been embedded into the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the <strong>EmailAddressPolicyEnabled</strong> attribute to <strong>False</strong>. This means,</p>\n</li>\n<li><p>It does not rely on the Email Address Policy at all. That’s why you will see that HMC will not create any Email Address Policy at all.</p>\n</li>\n<li><p>HMC will use its own mechanism to stamp the SMTP addresses.<br>So, that’s it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>One of the frequently asked questions about Hosted Messaging &amp; Collaboration (HMC) is this, “What do you do to Exchange to make HMC work?” So, here I will attempt to demystify this.</p>\n<p>HMC started long way back but the concept has not deviated much. I want to note that this specific blog focuses mainly on HMC 4.5 and Exchange 2007 SP1 and it should be noted that things discussed here probably is applicable to this specific version only unless mentioned otherwise.</p>\n<p>There are quite a few customizations that we set in Exchange 2007 for HMC and it is probably too much to do it in one blog, so, I will split this into a few parts,</p>\n<ul>\n<li>Part #1: Overview and Active Directory</li>\n<li>Part #2: Address Lists Segregation</li>\n<li>Part #3: Offline Address Book generations</li>\n<li>Part #4: Internal and External Out of Office</li>\n<li>Part #5: Autodiscover in the Multi-tenancy environment</li>\n<li>Part #6: Conclusion</li>\n</ul>\n<p><strong>What does HMC mean to Exchange 2007?</strong></p>\n<p>Let me start by asking this, what exactly is HMC? Yes, yes, there are quite a fair bit of things in HMC such as tools for flexible business modeling for service providers, resource management so that service providers can offer a broad range of services that go from basic e-mail up to higher-value services like providing additional storage and hosting personal domains and shared calendars and contacts. However, if I have to use one to two words to explain it, I will say HMC is about <strong>Multi-tenant enablement</strong>.</p>\n<p>Yes, I think there is no mystery that Exchange 2003 and Exchange 2007 were not really packaged or designed to cater for multi-tenant. Not that it is not capable to do so, just that it wasn’t designed with that as the focus.</p>\n<p>What is multi-tenancy? Multitenancy refers to a principle in software architecture where a single instance of the software runs on a software-as-a-service (SaaS) vendor’s servers, serving multiple client organizations (tenants).</p>\n<p>Think of it like a condominium with hundreds of different individual units living in it, that’s what multi-tenant is. Instead of having only one company <em>(note: I tend to use company and tenant interchangeably)</em> to live in one Exchange environment (1:1), multi-tenant enablement for Exchange 2007 means we want to enable the same Exchange environment to cater for multiple individual and separate companies and like a unit in the condominium, each company should have their own space and privacy (m:1)</p>\n<p>Let me continue with the condominium analogy. Now that we know we need to build a condominium, we also need to figure out what we need to build each unit in the condominium. We need to make sure that each floor will be partitioned nicely and that the tenants will have their own kitchen, doors, parking space and enjoy their home and privacy. Likewise with Exchange 2007, we need to make sure that each tenant will enjoy the full messaging features and capabilities but yet do not compromise privacy and security.</p>\n<p>So what do we need to multi-tenant enable Exchange 2007? Here is what needed to be done,</p>\n<ol>\n<li><p><strong>Active Directory Partitioning and Permission</strong> - think of it like partitioning each floor to different unit. Every company will have their own separate ‘space’ and the users in that company should only have access to what they are allowed to. I will discuss more on this later on how we can achieve that.</p>\n</li>\n<li><p><strong>Address List Segregation</strong> - access to the contact information in each company should only be limited to users in that company. Other tenants shouldn’t know have access to that information.</p>\n</li>\n<li><p><strong>Outlook Experience </strong>- Outlook experience should not be compromised. The users in each company should enjoy all the features available in Outlook, such as Outlook Anywhere with cached mode and Offline Address Book, Calendaring and resource management, using Free/busy feature, Internal and External Out of Office feature in Exchange 2007, Autodiscover, Outlook rules, mailbox delegation, mailbox quota and etc. Some of the above mentioned features will required to be tweaked for multi-tenancy and some do not. I will walk through them as we go.</p>\n</li>\n<li><p><strong>Shared Components</strong> - as much as we try to make sure everything is segregated, there will be some information and shared components here. Just like living in a condominium, everyone will share the same garage and elevator.</p>\n</li>\n</ol>\n<p>Now that we have listed them down, it doesn’t look that bad, does it? In fact, once we walk through how we do this in HMC, you may realize that we aren’t doing that much customization to Exchange at all. HMC, however, is more than just doing these customizations, of course. It is also a tool that allows you to better manage your resource and also allow you to automate a number of things, but that discussion will be for a separate blog. I will briefly touch on this at the end of this series.</p>\n<p>Those who has been dealing with Exchange 2007 probably realize that we have a white paper that talks about the similar thing, which is <a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \" target=\"_blank\" rel=\"external\">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 </a>. I strongly recommend anyone who wants to know more about the Exchange 2007 HMC customization to also read this white paper and try setting it up in your test environment for your own learning.</p>\n<p>The above white paper explained how you can come up with your homebrew version of hosted solution by making a whole list of manual tweaking. It also provides good explanations on some of those customizations executed. HMC, for most parts are doing the same thing but there are a few things that we did quite differently and also we have a Deployment Tool to help you to make those customization instead of having you manually go through those permission setting of various OU containers, removal of address lists and etc.</p>\n<p><strong>Active Directory Partitioning and Permission</strong></p>\n<p>Firstly, let me start with how we do the Active Directory partitioning and permission in HMC for Exchange. The process of deploying a HMC is quite straightforward. Everything is done through the Provisioning Deployment Tool that comes with the HMC Solution ISO file.</p>\n<p>(1) List Object Mode (<strong>dsHeuristics</strong>)</p>\n<p>This is the first thing that the Deployment Tool will do. This is about controlling the object visibility. By default in Active Directory, we control an object using List Contents permissions on the parent object. The concept is quite simple; it means an object that will only be visible to a user if the user has been granted List Contents permissions on the parent object. When a user has List Contents permission on a parent node, he or she can see and browse all objects that are children of that node without any further selectivity.</p>\n<p>Obviously this can be a problem in a Hosted Environment, for example, if in my Active Directory, I have the following structure,</p>\n<ul>\n<li>Fabrikam.com (Windows Domain)<ul>\n<li>Hosting (Hosting Container)<ul>\n<li>ConsolidatedMessenger (Reseller)<ul>\n<li>Company1<ul>\n<li>[User1@Company1]</li>\n<li>[User2@Company1</li>\n<li>[User3@Company1]</li>\n</ul>\n</li>\n<li>Company2<ul>\n<li>[User1@Company2]</li>\n<li>[User2@Company2]</li>\n<li>[User3@Company2]</li>\n</ul>\n</li>\n<li>[User1@ConsolidatedMessenger]</li>\n<li>[User2@ConsolidatedMessenger]</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>If I grant <a href=\"mailto:User1@Company1\" target=\"_blank\" rel=\"external\">User1@Company1</a> List Contents permission say on Compmany1 OU, I will also have to do it on all the parent OUs above it. Without that, it stops someone looking at what lives under the object or container. However, granting it lets whoever has the permission the ability to go through the content, including Company2 OU, which is obviously a bad thing. This is where “List Object” mode comes in.</p>\n<p>In this special mode, even if the user has not explicitly been granted or explicitly been denied List Contents permission on the parent object, the object will still be visible to the user if the user is granted List Object permission on both the parent object and the object itself.</p>\n<p>The availability and setting of this mode is very important to multi-tenant enablement and this is deployed as part of Core Platform in the Deployment Tool. Essentially, this form the basis of security control and Active Directory partitioning in HMC.</p>\n<p>(2) Active Directory Partitioning - Hosting Container</p>\n<p>Now, I want to briefly walk through the structure that HMC will be creating in Active Directory. Here are a few things that you should know,</p>\n<ul>\n<li>HMC does not support deployment in a child domain. While it is technically possible, it hasn’t be well tested and hence it is not a supported model.</li>\n<li>By default in HMC, it will create an OU called Hosting right under the Domain. This can be changed by setting the procedure parameter in <em>Hosting Platform - Initialize Default Services - Initialize Active Directory</em> for Hosting in the Deployment Tool.</li>\n</ul>\n<p>That is only the creation of the master hosting container. You will then need to follow the Deployment Walkthrough in the Help File to create the Reseller container and also the Tenant container. From the Exchange perspective, you only need to know the following,</p>\n<ul>\n<li><p><strong>HMC Resellers</strong> - Each Reseller is fully contained within its own Organizational Unit (OU) in Active Directory. The administrator from this OU will have permission to manage the HMC Tenants in it. Example in the Deployment Walkthrough is<em>ConsolidatedMessenger.com</em>. The Reseller OU will usually contain the following objects</p>\n<ul>\n<li>HMC Tenants</li>\n<li>HMC Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;Reseller&gt; group</li>\n</ul>\n</li>\n<li><p><strong>HMC Tenants</strong> - Each Tenant is fully contain within its own Organizational Unit (OU) in Active Directory, this Organizational Unit is a child of an HMC Reseller. Example in the Deployment Walkthrough is <em>AlpineSkiHouse.com</em>. The Tenant OU will usually contain the following objects,</p>\n<ul>\n<li>HMC Users</li>\n<li>A _Private OU //you should for the most part ignore the contents of this OU its contents are primarily in place to support provisioning actions.</li>\n<li>An Admins@&lt;TenantOrg&gt; group // This group contains all of the Tenant Admin</li>\n<li>Custom or service specific groups (such as FolderAdmins, FolderUsers for Public Folder service)</li>\n</ul>\n</li>\n<li><p><strong>HMC Users</strong> - Users objects within AD are the security principal.</p>\n</li>\n<li><p><strong>HMC Mailboxes</strong> - An HMC mailbox is a user object that has been Exchange Mailbox Enabled.<br>Here is an example of the Active Directory Hosting Container structure in HMC</p>\n</li>\n<li><p>Fabrikam.com (Domain)</p>\n<ul>\n<li><p>Hosting (Hosting OU)</p>\n<pre><code>*   _Private\n</code></pre><ul>\n<li><p>ConsolidatedMessenger.com (HMC Reseller)</p>\n<pre><code>*   _Private\n</code></pre><ul>\n<li><a href=\"mailto:admins@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">admins@ConsolidatedMessenger.com</a> (Admins group for HMC Reseller)</li>\n<li><a href=\"mailto:administrator@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">administrator@ConsolidatedMessenger.com</a> (Administrator for the HMC Reseller)</li>\n<li><p>AlpineSkiHouse.com (HMC Tenant)</p>\n<pre><code>*   _Private\n</code></pre><ul>\n<li><a href=\"mailto:admins@alpineskihouse.com\" target=\"_blank\" rel=\"external\">admins@alpineskihouse.com</a> (Admins group for HMC Tenant)</li>\n<li><a href=\"mailto:johnc@alpineskihouse.com\" target=\"_blank\" rel=\"external\">johnc@alpineskihouse.com</a> (HMC Users/Mailboxes)<br>Obviously, I have simplified quite a few things here, for example, in this whole Active Directory Partitioning process; the HMC Deployment Tool will also create a number of groups (such as AllUsers, AllCustomers, AllCustomers, AdminsGroups and etc.) and properly assign the appropriate membership and permissions in different containers.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<p>Permission Inheritance is not blocked specifically. For example,<a href=\"mailto:admins@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">admins@ConsolidatedMessenger.com</a> group is granted with Write, Create and Delete Child Objects to ConsolidatedMessenger.com OU. And that permission is also inherited downward to AlpineSkiHouse.com. This allows users in the<a href=\"mailto:admins@ConsolidatedMessenger.com\" target=\"_blank\" rel=\"external\">admins@ConsolidatedMessenger.com</a> group the capability to manage all the HMC Tenants in the ConsolidatedMessenger.com OU.</p>\n<p>For the purpose of this blog, I think that’s all you need to know about the Active Directory partitioning in HMC for Exchange. If not, this blog may end up to be a novel. :)</p>\n<p>(3) User Logon</p>\n<p>I want to touch a little bit about User Logon here. Most of you who are familiar with Active Directory will know what a _samAccountName _is. This is the logon name we carried forward from the old NT world. It has to be unique in a Windows domain. Even though we have revolved to allow longer logon name in later version of Windows, we still need to specify a samAccountName, a mandatory attribute. It usually follow the logon name. If my logon name is John, then my samAccountName is also John.</p>\n<p>I can login to the environment using either username@domain or DOMAIN\\&lt;samAccountName&gt;. This is not a big problem in a normal corporate environment. When it comes to a multi-tenant environment, this maybe a bit of a problem because we may have John in AlpineSkiHouse.com and we may also have John in Contoso.com.</p>\n<p>In order to achieve the uniqueness, HMC recommends users to logon using the UPN as a start, which is <a href=\"mailto:username@domain\" target=\"_blank\" rel=\"external\">username@domain</a> such as <a href=\"mailto:johnc@alpineskihouse.com\" target=\"_blank\" rel=\"external\">johnc@alpineskihouse.com</a>. You will notice in HMC allows that by modifying the <strong>upnSuffixes attribute </strong>of the Tenant OU. Now, all these things are done automatically when you create a HMC Tenant through the Microsoft Provisioning System.</p>\n<p>With that, it solves the user logon uniqueness problem. However, it does not resolve the samAccountName uniqueness. To ensure that the samAccountName is also unique, HMC appends the domain of the Tenant to the logon name but because samAccountName can’t have more than 20 characters, it will get truncated if it is more than 20 characters. For example,</p>\n<ul>\n<li>Logon Name: <a href=\"mailto:johnc@alpineskihouse.com\" target=\"_blank\" rel=\"external\">johnc@alpineskihouse.com</a> will have the samAccountName of johnc_AlpineSkiHouse</li>\n<li>Logon Name: <a href=\"mailto:bob@alpineskihouse.com\" target=\"_blank\" rel=\"external\">bob@alpineskihouse.com</a> will have the samAccountName of bob_AlpineSkiHouse.c<br>So, hopefully that will help to explain the naming convention of the user object.</li>\n</ul>\n<p>(4) Active Directory Attributes</p>\n<p>HMC did not introduce any schema change to Active Directory. Sometimes, I wish it does because it would have made things little bit easier but it didn’t. Instead, it uses what I would call the poor man’s schema extension, the <strong>otherWellknownObjects</strong> attribute.</p>\n<p>From the Exchange standpoint, this attribute is not used but for the provisioning process (MPS) to work properly, understanding this attribute is essential. And at times, I also think it is important to know this because it can tell you the Global Address List, Address List, Offline Address List that the specific HMC Tenant is using.</p>\n<p>Here is a LDP dump of the otherWellKnownObjects attribute of one of the HMC Tenant.</p>\n<p>12&gt; otherWellKnownObjects: B:32:3841BDA6D81C4095B9BBB838808F5A55:CN=Services,CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;<strong>B:32:D22DFCC5B73645E99E16C9AD3D61F34F</strong>:CN=AlpineSkiHouse OAL,CN=Offline Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:9E444526CB6F4D5C9A59C9A84E26B627</strong>:CN=AlpineSkiHouse AL,CN=All Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com;<strong>B:32:89FB25B7DF784FC198A493E2E8A0EE7E</strong>:CN=AlpineSkiHouse GAL,CN=All Global Address Lists,CN=Address Lists Container,CN=HMC45,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=hmc45,DC=com; B:32:7DEF010C6019A1458068D74AD1A3C1FA:CN=FolderUsers@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:4619BE598BF441DB8C9DB0482E62E386:CN=_Private,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:EA755D448CE64157A20E82B7CCBE14B0:CN=customer,CN=WatOrgTypes,CN=_Private,OU=Hosting,DC=hmc45,DC=com; B:32:3B6FF4FA8AA248039AD8F9493A43B704:CN=CSRAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:65F37ECB46704F0E9300E1FB48E1096E:CN=Admins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:58888CFC8F7F430C8183102CD5758D81:OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:CC016CF08DEF4EA4A05C9C54B198785A:OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com; B:32:A276E3A170F0C24699770F593818501E:CN=FolderAdmins@AlpineSkiHouse,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=hmc45,DC=com;</p>\n<p>As you can see from above, we have a unique GUID number to identify a specific category of relationship.</p>\n<p>&lt;GUID name=”GlobalAddressList”&gt;<strong>89FB25B7DF784FC198A493E2E8A0EE7E</strong>&lt;/GUID&gt;<br>&lt;GUID name=”AddressList”&gt;<strong>9E444526CB6F4D5C9A59C9A84E26B627</strong>&lt;/GUID&gt;<br>&lt;GUID name=”OfflineAddressList”&gt;<strong>D22DFCC5B73645E99E16C9AD3D61F34F</strong>&lt;/GUID&gt;</p>\n<p>In addition, here are some of the <em>Key attributes to Exchange:</em></p>\n<ul>\n<li><strong>homeMDB</strong>: DN of the users mailbox store - no customizations for HMC.</li>\n<li><strong>mailNickname</strong>: This is the HMC Users mailbox alias. - no customizations for HMC.</li>\n<li><strong>msExchMailboxFolderSet</strong>: Defines the folders available to the user through OWA, this attribute is controlled by the HMC User Plans. <strong> </strong></li>\n<li><strong>msExchQueryBaseDN</strong>: Provides a baseDN from which LDAP Searches are performed, in HMC this attribute is set to the DN of the Tenant effectively limiting LDAP searches in OWA, ActiveSynch etc to the Tenant OU.</li>\n<li><strong>protocolSettings</strong>: Defines which protocols a user can use to access Exchange, this attribute is controlled by the HMC user Plans</li>\n<li><strong>showInAddressBook</strong>: Multi-valued attribute includes the DNs for the Tenant specific GAL and AL as well as the Default GAL, this attribute must be set correctly and the GALs ACL’d correctly in order for a user to logon to Outlook as well as for them to be restricted to the appropriate address list. <strong> </strong></li>\n<li><p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.<br>Let’s briefly talk about the e-mail address stamping here too. In Exchange 2003, we have this process called Recipient Update Services. In Exchange 2007, this whole process has been embedded into the cmdlets and Email Address Policy is being used to determine the e-mail address of those users during the creation. It should be noted that, in HMC, right after it created an email user, a distribution group or an Exchange resource, HMC immediately performs another task to set the <strong>EmailAddressPolicyEnabled</strong> attribute to <strong>False</strong>. This means,</p>\n</li>\n<li><p>It does not rely on the Email Address Policy at all. That’s why you will see that HMC will not create any Email Address Policy at all.</p>\n</li>\n<li><p>HMC will use its own mechanism to stamp the SMTP addresses.<br>So, that’s it. It is straightforward so far, eh? We will talk more about other customizations introduced by HMC for Exchange in the new few parts.</p>\n</li>\n</ul>\n"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 2 - Address Lists Segregation","date":"2009-05-07T09:32:58.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn part [#1](https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/), I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.\n\nSo far, there wasn't anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.\n\nLet's look at what address lists we need to segregate and why. Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,\n\n*   **Contacts folder** - this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don't use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.\n\n*   **Personal Address Book (PAB)** - Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact's name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.\n\n*   **Server-side Address Lists **- in Exchange 2007 environment, you have 2 types of address lists,\n\n    *   _Global Address List (GAL)_ - The GAL contains information for <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.\n\n*   _Other Address Lists _- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the **All Address Lists** group in the **Show Names from the** drop-down list in the Outlook Address Book.\n\nFrom the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are 'not shared' and are private by default.\n\nServer-side address lists however are slightly different. The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let's take a closer look at what HMC will change in order to segregate the address lists so that every company will only see what they are supposed to see.\n\nBefore that, I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That's not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.\n\n**What is HMC trying to do? **\n\nSo, let's look at what HMC intends to achieve here,\n\n*   **Global Address List** - By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources in the whole environment. That is not &nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.\n&nbsp;\n\n*   **Other Address List** - If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.\nSo, with the above objectives in mind, let's take a closer look.\n\n**Global Address List Segregation**\n\nOutlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.\n\nOnce we have different GALs for different companies, we need to address the following,\n\n<span style=\"text-decoration: underline;\">(1) What's the limitation of Global Address List?</span>\n\nThe default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the **MakeGalLinked** tool to extend this limit.\n\nThis is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.\n\n<span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span>\n\nIf you refer to the following article, [http://support.microsoft.com/kb/312287](http://support.microsoft.com/kb/312287), you will realize that Outlook displays the global address list that meets the following criteria:\n\n*   The user has permissions to access this global address list.\n*   The user is a member of this global address list.\n*   This global address list is the largest of all of the other global address lists.\nThe above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.\n\nBecause of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn't very different as compared to the steps documented in [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \").\n\nWith the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.\n\nWhat HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;) in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn't stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,\n\n_Get-ADPermission \"AlpineSkiHouse GAL\" | FL_\n\n<span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span>\n\nIn [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"), the article uses **customattribute1** and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.\n\nThis is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the **RecipientFilter** and **LdapRecipientFilter** attributes are empty.\n\nThese attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.\n\nSo, why does HMC not have any value on those attributes then? The answers are,\n\n*   HMC mechanism - HMC has its own mechanism to retrieve the company GAL and perform the membership stamping. How? Remember the otherWellKnownObjects attribute I talked about in part #1?\n*   It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.\nYou may ask, what about when I query this from Outlook? Does it use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership during mailbox creation.\n\nThere you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.\n\n**Address List Segregation**\n\nAddress List Segregation isn't very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.\n\nFirstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.\n\nNext, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don't really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can't even create an Outlook profile for that user.\n\nHowever, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).\n\nLike the GAL membership stamping process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.\n\n**Wait the minute, what about Outlook Web Access?**\n\nSo far, we have been discussing about the Outlook experience of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.\n\nThere is some permission that applies only to specific clients. For example, Outlook Web Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group's recipients, due to how OWA works. This is where attribute**msExchQueryBaseDN** comes in.\n\nIn order for us to control or restrict the search results to include only the members of the appropriate address list in Outlook Web Access, we must set the attribute**msExchQueryBaseDN** on each user object to the _distinguishedname_ (DN) of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.\n\n**What about LDAP? I have clients needing this access.**\n\nIf I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don't.\n\nHowever if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don't want to put your Active Directory server out and exposed them to the Internet just like that.\n\nAlso, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 ([http://support.microsoft.com/kb/943864/en-us](http://support.microsoft.com/kb/943864/en-us)), to properly lock it down before allow your users to use it.\n\n**What are some of the usual problems that you may face with Address Lists?**\n\n<span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span>\n\nThe most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the **RecipientFilter** and **LdapRecipientFilter** means that you can't run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.\n\nWhen an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.\n\nTo resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.\n\nHere is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;  and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.\n```xml\n<request>\n<data>\n<preferredDomainController>AD02.Fabrikam.Com</preferredDomainController>\n<user>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com </user>\n<alias>User1</alias>\n<emailAddresses>\n<value>User1@alpineskihouse.com </value>\n</emailAddresses>\n</data>\n<procedure>\n<execute namespace=\"Hosted Email 2007\" procedure=\"ModifyMailbox\" impersonate=\"1\" >\n<before source=\"data\" destination=\"executeData\" mode=\"merge\" />\n<after source=\"executeData\" destination=\"data\" mode=\"merge\" />\n</execute>\n</procedure>\n</request>\n```\nThis functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.","source":"_posts/hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 2 - Address Lists Segregation\ntags:\n  - Exchange\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 17:32:58\n---\n\n转自 http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn part [#1](https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/), I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.\n\nSo far, there wasn't anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.\n\nLet's look at what address lists we need to segregate and why. Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,\n\n*   **Contacts folder** - this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don't use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.\n\n*   **Personal Address Book (PAB)** - Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact's name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.\n\n*   **Server-side Address Lists **- in Exchange 2007 environment, you have 2 types of address lists,\n\n    *   _Global Address List (GAL)_ - The GAL contains information for <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.\n\n*   _Other Address Lists _- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the **All Address Lists** group in the **Show Names from the** drop-down list in the Outlook Address Book.\n\nFrom the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are 'not shared' and are private by default.\n\nServer-side address lists however are slightly different. The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let's take a closer look at what HMC will change in order to segregate the address lists so that every company will only see what they are supposed to see.\n\nBefore that, I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That's not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.\n\n**What is HMC trying to do? **\n\nSo, let's look at what HMC intends to achieve here,\n\n*   **Global Address List** - By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources in the whole environment. That is not &nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.\n&nbsp;\n\n*   **Other Address List** - If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.\nSo, with the above objectives in mind, let's take a closer look.\n\n**Global Address List Segregation**\n\nOutlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.\n\nOnce we have different GALs for different companies, we need to address the following,\n\n<span style=\"text-decoration: underline;\">(1) What's the limitation of Global Address List?</span>\n\nThe default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the **MakeGalLinked** tool to extend this limit.\n\nThis is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.\n\n<span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span>\n\nIf you refer to the following article, [http://support.microsoft.com/kb/312287](http://support.microsoft.com/kb/312287), you will realize that Outlook displays the global address list that meets the following criteria:\n\n*   The user has permissions to access this global address list.\n*   The user is a member of this global address list.\n*   This global address list is the largest of all of the other global address lists.\nThe above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.\n\nBecause of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn't very different as compared to the steps documented in [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \").\n\nWith the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.\n\nWhat HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;) in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn't stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,\n\n_Get-ADPermission \"AlpineSkiHouse GAL\" | FL_\n\n<span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span>\n\nIn [White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 ](http://technet.microsoft.com/en-us/exchange/bb936719.aspx \"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \"), the article uses **customattribute1** and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.\n\nThis is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the **RecipientFilter** and **LdapRecipientFilter** attributes are empty.\n\nThese attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.\n\nSo, why does HMC not have any value on those attributes then? The answers are,\n\n*   HMC mechanism - HMC has its own mechanism to retrieve the company GAL and perform the membership stamping. How? Remember the otherWellKnownObjects attribute I talked about in part #1?\n*   It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.\nYou may ask, what about when I query this from Outlook? Does it use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership during mailbox creation.\n\nThere you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.\n\n**Address List Segregation**\n\nAddress List Segregation isn't very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.\n\nFirstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.\n\nNext, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don't really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can't even create an Outlook profile for that user.\n\nHowever, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).\n\nLike the GAL membership stamping process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.\n\n**Wait the minute, what about Outlook Web Access?**\n\nSo far, we have been discussing about the Outlook experience of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.\n\nThere is some permission that applies only to specific clients. For example, Outlook Web Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group's recipients, due to how OWA works. This is where attribute**msExchQueryBaseDN** comes in.\n\nIn order for us to control or restrict the search results to include only the members of the appropriate address list in Outlook Web Access, we must set the attribute**msExchQueryBaseDN** on each user object to the _distinguishedname_ (DN) of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.\n\n**What about LDAP? I have clients needing this access.**\n\nIf I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don't.\n\nHowever if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don't want to put your Active Directory server out and exposed them to the Internet just like that.\n\nAlso, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 ([http://support.microsoft.com/kb/943864/en-us](http://support.microsoft.com/kb/943864/en-us)), to properly lock it down before allow your users to use it.\n\n**What are some of the usual problems that you may face with Address Lists?**\n\n<span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span>\n\nThe most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the **RecipientFilter** and **LdapRecipientFilter** means that you can't run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.\n\nWhen an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.\n\nTo resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.\n\nHere is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;  and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.\n```xml\n<request>\n<data>\n<preferredDomainController>AD02.Fabrikam.Com</preferredDomainController>\n<user>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com </user>\n<alias>User1</alias>\n<emailAddresses>\n<value>User1@alpineskihouse.com </value>\n</emailAddresses>\n</data>\n<procedure>\n<execute namespace=\"Hosted Email 2007\" procedure=\"ModifyMailbox\" impersonate=\"1\" >\n<before source=\"data\" destination=\"executeData\" mode=\"merge\" />\n<after source=\"executeData\" destination=\"data\" mode=\"merge\" />\n</execute>\n</procedure>\n</request>\n```\nThis functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.","slug":"hmc-45-and-exchange-2007-sp1-part2-address-lists-segregation","published":1,"updated":"2017-06-16T09:12:04.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxn00184gyrykd7d1tl","content":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In part <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/\" target=\"_blank\" rel=\"external\">#1</a>, I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.</p>\n<p>So far, there wasn’t anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.</p>\n<p>Let’s look at what address lists we need to segregate and why. Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,</p>\n<ul>\n<li><p><strong>Contacts folder</strong> - this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don’t use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.</p>\n</li>\n<li><p><strong>Personal Address Book (PAB)</strong> - Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact’s name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.</p>\n</li>\n<li><p><strong>Server-side Address Lists </strong>- in Exchange 2007 environment, you have 2 types of address lists,</p>\n<ul>\n<li><em>Global Address List (GAL)</em> - The GAL contains information for <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.</li>\n</ul>\n</li>\n<li><p><em>Other Address Lists </em>- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the <strong>All Address Lists</strong> group in the <strong>Show Names from the</strong> drop-down list in the Outlook Address Book.</p>\n</li>\n</ul>\n<p>From the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are ‘not shared’ and are private by default.</p>\n<p>Server-side address lists however are slightly different. The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let’s take a closer look at what HMC will change in order to segregate the address lists so that every company will only see what they are supposed to see.</p>\n<p>Before that, I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That’s not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.</p>\n<p><strong>What is HMC trying to do? </strong></p>\n<p>So, let’s look at what HMC intends to achieve here,</p>\n<ul>\n<li><p><strong>Global Address List</strong> - By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources in the whole environment. That is not &nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.<br>&nbsp;</p>\n</li>\n<li><p><strong>Other Address List</strong> - If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.<br>So, with the above objectives in mind, let’s take a closer look.</p>\n</li>\n</ul>\n<p><strong>Global Address List Segregation</strong></p>\n<p>Outlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.</p>\n<p>Once we have different GALs for different companies, we need to address the following,</p>\n<p><span style=\"text-decoration: underline;\">(1) What’s the limitation of Global Address List?</span></p>\n<p>The default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the <strong>MakeGalLinked</strong> tool to extend this limit.</p>\n<p>This is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.</p>\n<p><span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span></p>\n<p>If you refer to the following article, <a href=\"http://support.microsoft.com/kb/312287\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/312287</a>, you will realize that Outlook displays the global address list that meets the following criteria:</p>\n<ul>\n<li>The user has permissions to access this global address list.</li>\n<li>The user is a member of this global address list.</li>\n<li>This global address list is the largest of all of the other global address lists.<br>The above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.</li>\n</ul>\n<p>Because of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn’t very different as compared to the steps documented in <a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \" target=\"_blank\" rel=\"external\">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007</a>.</p>\n<p>With the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.</p>\n<p>What HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;) in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn’t stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,</p>\n<p><em>Get-ADPermission “AlpineSkiHouse GAL” | FL</em></p>\n<p><span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span></p>\n<p>In <a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \" target=\"_blank\" rel=\"external\">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 </a>, the article uses <strong>customattribute1</strong> and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.</p>\n<p>This is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the <strong>RecipientFilter</strong> and <strong>LdapRecipientFilter</strong> attributes are empty.</p>\n<p>These attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.</p>\n<p>So, why does HMC not have any value on those attributes then? The answers are,</p>\n<ul>\n<li>HMC mechanism - HMC has its own mechanism to retrieve the company GAL and perform the membership stamping. How? Remember the otherWellKnownObjects attribute I talked about in part #1?</li>\n<li>It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.<br>You may ask, what about when I query this from Outlook? Does it use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership during mailbox creation.</li>\n</ul>\n<p>There you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.</p>\n<p><strong>Address List Segregation</strong></p>\n<p>Address List Segregation isn’t very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.</p>\n<p>Firstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.</p>\n<p>Next, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don’t really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can’t even create an Outlook profile for that user.</p>\n<p>However, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).</p>\n<p>Like the GAL membership stamping process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.</p>\n<p><strong>Wait the minute, what about Outlook Web Access?</strong></p>\n<p>So far, we have been discussing about the Outlook experience of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.</p>\n<p>There is some permission that applies only to specific clients. For example, Outlook Web Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group’s recipients, due to how OWA works. This is where attribute<strong>msExchQueryBaseDN</strong> comes in.</p>\n<p>In order for us to control or restrict the search results to include only the members of the appropriate address list in Outlook Web Access, we must set the attribute<strong>msExchQueryBaseDN</strong> on each user object to the <em>distinguishedname</em> (DN) of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.</p>\n<p><strong>What about LDAP? I have clients needing this access.</strong></p>\n<p>If I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don’t.</p>\n<p>However if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don’t want to put your Active Directory server out and exposed them to the Internet just like that.</p>\n<p>Also, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 (<a href=\"http://support.microsoft.com/kb/943864/en-us\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/943864/en-us</a>), to properly lock it down before allow your users to use it.</p>\n<p><strong>What are some of the usual problems that you may face with Address Lists?</strong></p>\n<p><span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span></p>\n<p>The most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the <strong>RecipientFilter</strong> and <strong>LdapRecipientFilter</strong> means that you can’t run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.</p>\n<p>When an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.</p>\n<p>To resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.</p>\n<p>Here is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;  and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">data</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>AD02.Fabrikam.Com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com <span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">alias</span>&gt;</span>User1<span class=\"tag\">&lt;/<span class=\"name\">alias</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">emailAddresses</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>User1@alpineskihouse.com <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">emailAddresses</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">data</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">procedure</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Email 2007\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyMailbox\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span> &gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">after</span> <span class=\"attr\">source</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>This functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/12/10/hmc-4-5-and-exchange-2007-sp1-part-2.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In part <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/04/hmc-4-5-and-exchange-2007-sp1-part-1-overview-and-active-directory/\" target=\"_blank\" rel=\"external\">#1</a>, I spent a fair bit of time explaining how HMC was introduced into Exchange as part of the multi-tenant enablement process for service provider. I also spent some time discussing about how the Active Directory was partitioned and what the primary attributes that are essential to the Exchange 2007 SP1 multi-tenant enablement.</p>\n<p>So far, there wasn’t anything complicated about it. Now, I am going to move on to the 2nd part of the customizations, which is probably one of the more important ones, that is the Address List Segregation.</p>\n<p>Let’s look at what address lists we need to segregate and why. Address list is about contact information which is very important because it makes managing and finding your contacts (internal as well as external) easier and hence makes communication easier. There are a few places where you will use Outlook to locate the contact information,</p>\n<ul>\n<li><p><strong>Contacts folder</strong> - this folder is created within the mailbox itself if you have an Exchange account. Think of this folder like a normal Inbox or Calendar folder in your mailbox. This is a private folder. If you don’t use a Microsoft Exchange Server e-mail account, Outlook stores your Contacts with the rest of your Outlook data in a Personal Folders file that has a PST file extension.</p>\n</li>\n<li><p><strong>Personal Address Book (PAB)</strong> - Outlook also supports Personal Address Books (PAB). Like Contacts, a Personal Address Book can store a contact’s name, address, e-mail address, phone, and other information. Outlook stores the Personal Address Book in a file with a PAB file extension. The PAB is completely separate from your other Outlook data stored in your PST file (or in an Exchange Server store). You can add more than one PAB to an Outlook profile.</p>\n</li>\n<li><p><strong>Server-side Address Lists </strong>- in Exchange 2007 environment, you have 2 types of address lists,</p>\n<ul>\n<li><em>Global Address List (GAL)</em> - The GAL contains information for <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources. Outlook needs this to work and Outlook can only see one GAL at a time.</li>\n</ul>\n</li>\n<li><p><em>Other Address Lists </em>- Sometimes, Exchange Server administrator might create other address lists to organize Exchange users by department, surname, or other criteria. These additional address lists show up under the <strong>All Address Lists</strong> group in the <strong>Show Names from the</strong> drop-down list in the Outlook Address Book.</p>\n</li>\n</ul>\n<p>From the above, I think it is pretty obvious that Contacts folder is a private folder, like the Inbox folder in a mailbox, is only accessible to the mailbox owner. PAB is really an offline file that store contact information. There is really nothing required to be done on these contact stores for a multi-tenant environment because those are ‘not shared’ and are private by default.</p>\n<p>Server-side address lists however are slightly different. The address lists are shared and because of how we designed Exchange and Outlook, the address lists in Exchange, out of the box is accessible by everyone in the environment. That obviously is a problem for multi-tenancy because it means users in company A will be able to see the users in company B. So, let’s take a closer look at what HMC will change in order to segregate the address lists so that every company will only see what they are supposed to see.</p>\n<p>Before that, I think it is important to highlight that address list in Exchange is really nothing more than an Active Directory object containing query logic or filter that specify what mail enabled objects in Active Directory should be included in that list. It is not an actual list or a table or store that consists of all the contact information. It is a filter or I like to call it query logic. That’s not all, what is more important to understand is that this query logic is only essential when creating the mailbox, but not so much for the actual Outlook query. As we walk through the blog, the statement above will become clearer to you and you will why HMC does what it does.</p>\n<p><strong>What is HMC trying to do? </strong></p>\n<p>So, let’s look at what HMC intends to achieve here,</p>\n<ul>\n<li><p><strong>Global Address List</strong> - By default when you install Exchange 2007, it assumes that it is only meant for one company; hence it comes with a Default Global Address List which lists of <span style=\"text-decoration: underline;\">all</span> email users, distribution groups, and Exchange resources in the whole environment. That is not &nbsp;something a multi-tenant environment would like to have. Therefore, the primary objective here is NOT to have one GAL that will display everyone in the environment but different GALs for different companies.<br>&nbsp;</p>\n</li>\n<li><p><strong>Other Address List</strong> - If there is any other address list being used by a company in the environment, those address lists have to be only accessible and visible to users in that company only.<br>So, with the above objectives in mind, let’s take a closer look.</p>\n</li>\n</ul>\n<p><strong>Global Address List Segregation</strong></p>\n<p>Outlook needs GAL to work and as we know, Outlook can only see one GAL at a time. In order to provide each company their own Global Address List, we need to create different GAL objects for different companies, having specific query logic that scope to just users, distribution groups and resources in the company.</p>\n<p>Once we have different GALs for different companies, we need to address the following,</p>\n<p><span style=\"text-decoration: underline;\">(1) What’s the limitation of Global Address List?</span></p>\n<p>The default configuration of the global address list (GAL) class object allows only 1000 address lists. This presents a clear problem because we do expect most hosters to have at least more than that. To make sure that the environment can support more than 1000, you need to use the <strong>MakeGalLinked</strong> tool to extend this limit.</p>\n<p>This is documented in the deployment walkthrough. I am not going to spend time to cover that as I am quite sure you can find other blogs cover this better.</p>\n<p><span style=\"text-decoration: underline;\">(2) How to make sure that Outlook clients access the correct global address list if there is more than one global address list?</span></p>\n<p>If you refer to the following article, <a href=\"http://support.microsoft.com/kb/312287\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/312287</a>, you will realize that Outlook displays the global address list that meets the following criteria:</p>\n<ul>\n<li>The user has permissions to access this global address list.</li>\n<li>The user is a member of this global address list.</li>\n<li>This global address list is the largest of all of the other global address lists.<br>The above Outlook logic means that the Default Global Address List will always be used because all the users created will always be a member of this GAL and it is obviously the largest GAL of all because it consists of everyone in the environment.</li>\n</ul>\n<p>Because of the above Outlook logic, we need to either make sure the user is not a member of the Default GAL or we make sure that the user has no permission to it. HMC has selected the latter. We deny almost everyone except Exchange Servers and Domain Admins permission to Open Address List for Default GAL. You may notice that this isn’t very different as compared to the steps documented in <a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \" target=\"_blank\" rel=\"external\">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007</a>.</p>\n<p>With the default GAL not accessible to all the users, we need to now create different GAL for different companies so that Outlook will actually work.</p>\n<p>What HMC did is this, when you create a company and the user with Outlook plan, it will automatically create a company GAL. HMC also ensures that only users (AllUsers@&lt;company&gt;) in that company/tenant will have the Open Address Lists permission their GAL. I am not going to list down all the permissions that we set in there but it shouldn’t stop you from finding out yourself, right? If you want to know the exact permissions being granted, just run Get-ADPermission cmdlet, for example,</p>\n<p><em>Get-ADPermission “AlpineSkiHouse GAL” | FL</em></p>\n<p><span style=\"text-decoration: underline;\">(3) What query logic or filter should we use for the company GAL?</span></p>\n<p>In <a href=\"http://technet.microsoft.com/en-us/exchange/bb936719.aspx\" title=\"White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 \" target=\"_blank\" rel=\"external\">White Paper: Configuring Virtual Organizations and Address List Segregation in Exchange 2007 </a>, the article uses <strong>customattribute1</strong> and they make sure that mailboxes or resources created must have that attribute, if not, it will not be included in that GAL.</p>\n<p>This is where HMC 4.5 does things slightly differently. If you perform a Get-GlobalAddressList on one of the GALs created by HMC, you will find the query logic/filter, which is the <strong>RecipientFilter</strong> and <strong>LdapRecipientFilter</strong> attributes are empty.</p>\n<p>These attributes are essential if you want to make sure a newly created mailbox will be included as a member of this GAL. Only if the user is a member of the GAL, it can access the GAL and that it can show up in the GAL. These attributes are being read during the creation of the mailboxes and if the mailbox falls under the query logic, the appropriate membership will be stamped.</p>\n<p>So, why does HMC not have any value on those attributes then? The answers are,</p>\n<ul>\n<li>HMC mechanism - HMC has its own mechanism to retrieve the company GAL and perform the membership stamping. How? Remember the otherWellKnownObjects attribute I talked about in part #1?</li>\n<li>It is faster. Just imagine if the environment hosts 20,000 domains in the environment, how long do you think it will take to walk through those query each time I create a mailbox? Having HMC to accurately retrieve the correct GAL will be more effective.<br>You may ask, what about when I query this from Outlook? Does it use those query logic? The answer is no. When you query from Outlook, it retrieves the objects based on Address List Membership (showInAddressBook) attribute in each objects. In short, the query logic in the GAL itself is only used for stamping the membership during mailbox creation.</li>\n</ul>\n<p>There you go, Global Address List segregation, not really a difficult concept but can be confusing sometimes.</p>\n<p><strong>Address List Segregation</strong></p>\n<p>Address List Segregation isn’t very different as compared to the GAL Segregation. However, there are a few things worth mentioning here.</p>\n<p>Firstly, out of the box, Exchange 2007 installation comes with a few default address lists, All Contacts, All Groups, All Rooms, All Users, and Public Folders. Those will be removed during HMC 4.5 deployment. So, a clean HMC deployment will have an empty All Address Lists container.</p>\n<p>Next, like the GAL segregation, the permission of the All Address Lists container has been properly locked down. Now, in theory, we don’t really need to be part of any Address Lists for Outlook to work. Being part of the GAL is more essential because if you are not, you can’t even create an Outlook profile for that user.</p>\n<p>However, some processes in Exchange, such as the Offline Address Book generation prefers using Address List than Global Address List when generating the OAB (I will cover the OAB generation process in my next part). For those reasons, we need to make sure each company will also have company Address List where every mail enabled objects in the company will be part of that address list (yes, there is no difference compared to GAL).</p>\n<p>Like the GAL membership stamping process, the Address List membership stamping process is the same, it is done by HMC mechanism. Hence you will see the query logic/filter for all the Address Lists created by HMC are also empty.</p>\n<p><strong>Wait the minute, what about Outlook Web Access?</strong></p>\n<p>So far, we have been discussing about the Outlook experience of the Global Address List and Address Lists. I think it is important to highlight that things work a little bit differently in Outlook Web Access.</p>\n<p>There is some permission that applies only to specific clients. For example, Outlook Web Access does not incorporate user permission sets when doing searches. The permissions set on OUs do not prevent search results from including other segregated group’s recipients, due to how OWA works. This is where attribute<strong>msExchQueryBaseDN</strong> comes in.</p>\n<p>In order for us to control or restrict the search results to include only the members of the appropriate address list in Outlook Web Access, we must set the attribute<strong>msExchQueryBaseDN</strong> on each user object to the <em>distinguishedname</em> (DN) of the OU or an address list containing the correct group of users. In the case of HMC, when a mailbox user is created, HMC will also populate this attribute with the OU of the company/tenant.</p>\n<p><strong>What about LDAP? I have clients needing this access.</strong></p>\n<p>If I have a group of users using other clients and needs LDAP access so that they can query the users of in their company/tenant, what happen then? Well, the way I look at it is this, as much as possible, don’t.</p>\n<p>However if you have to do it, make sure that the client has to at least go through some form of VPN or something because you really don’t want to put your Active Directory server out and exposed them to the Internet just like that.</p>\n<p>Also, if you are having HMC 4.0, you should look at this article, Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0 (<a href=\"http://support.microsoft.com/kb/943864/en-us\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/943864/en-us</a>), to properly lock it down before allow your users to use it.</p>\n<p><strong>What are some of the usual problems that you may face with Address Lists?</strong></p>\n<p><span style=\"text-decoration: underline;\">(1) Incorrect Address List membership</span></p>\n<p>The most common issue that I have seen with address lists issues are membership problem. Based on the above, you kind of understand how some of the things could have gone wrong. The fact that HMC does not use the <strong>RecipientFilter</strong> and <strong>LdapRecipientFilter</strong> means that you can’t run Update-GlobalAddressList or Update-AddressList because, That two cmdlets will rebuild (there is no update process in Exchange 2007, only rebuild) the address list, which means when it finds that it is empty, it may reset those accounts that currently are supposed to be in the address list.</p>\n<p>When an account lost the GAL or AL membership, you may notice that you may not be able to create an Outlook profile for that user, and the user may have other problems too.</p>\n<p>To resolve that, you can either use ADSIEdit to manually slot those membership back or you can use the hosted Email 2007::ModifyMailbox to reset this attribute to its correct values without having to know the address list DNs. This procedure resets the showInAddressBook attribute on each call.</p>\n<p>Here is a sample, assuming that you supply the original values for &lt;emailAddresses&gt;  and &lt;alias&gt; the procedure will only reset the showInAddressBook value without modifying any other attributes.<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">data</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>AD02.Fabrikam.Com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>LDAP://CN=User1,OU=AlpineSkiHouse,OU=ConsolidatedMessenger,OU=Hosting,DC=fabrikam,DC=com <span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">alias</span>&gt;</span>User1<span class=\"tag\">&lt;/<span class=\"name\">alias</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">emailAddresses</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>User1@alpineskihouse.com <span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">emailAddresses</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">data</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">procedure</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Email 2007\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyMailbox\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span> &gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">after</span> <span class=\"attr\">source</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>This functionality was added to account for the fact that the Exchange Cmdlets like to reset showInAddressBook value during most mailbox operations.</p>\n"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 3 - Offline Address Book Generations","date":"2009-05-07T09:38:47.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment. It is my belief that if you understand that clearly, you have understood 70% of the Hosted Exchange concept in HMC. The rest will be just easy. :)\n\nIn this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don't intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman's web log has covered most of them ([http://blogs.msdn.com/dgoldman/default.aspx](http://blogs.msdn.com/dgoldman/default.aspx)). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn't changed much)\n\nOverview of the OABgen process\n[http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx)\n\nMy primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.\n\n**What has been introduced by HMC?**\n\nHMC does not change the OAB component in Exchange 2007 SP1 much. It does make a few changes in terms of how it works to make sure that things will run better in a service provider environment. So, let's take a closer look,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Process</span>\n\nThis is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.\n\nInstead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update will be called or triggered for that company.\n\nTo do that, HMC does the following,\n\n*   **No Schedule **- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.\n*   **HmOABUpdate** - HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).\nThis application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.\n\nThe application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.\n\nNow, for each Offline Address List object, there are a couple of interesting items to look at,\n\n*   The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).\n*   PublicFolderDistributionEnabled - Depending on the Organization Plan (&lt;features/ outlookClient&gt;) you use to create the company/tenant, this may be True or False.\n*   PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.\nIf all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.\n\n<span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span>\n\nThere are a few unique challenges that a Hosted Exchange environment like HMC may face that are generally not faced by a corporate environment.\n\n*   **High number of OABs**, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists ([http://technet.microsoft.com/en-us/library/cc539031.aspx](http://technet.microsoft.com/en-us/library/cc539031.aspx)).\n> In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.\n\n*   **Dedicated OAB Distribution Server**, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).\nIf you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn't mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).\n\n*   **Other behaviour that you should take note**, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.\n\n    *   OAB public folder expiration. This actually trace back to Exchange Server 2003, Update to modify the OAB public folder expiration in Exchange Server 2003 ([http://support.microsoft.com/kb/832761](http://support.microsoft.com/kb/832761)).\n> Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what's going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the \"OAL Folder Lifetime\" registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.\n> > \n> > HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters\n> > \n> > Value name: OAL Folder Lifetime (days)\n> > Value type: REG_DWORD\n> > Value data: 0\n\n*   OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent, [http://support.microsoft.com/?id=834315](http://support.microsoft.com/?id=834315). While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.\n\n<span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span>\n\nEven though HMC puts in tweaks here and there, creation of the Offline Address List is nothing more than calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight one thing,\n\n_SkipPublicFolderInitialization_ parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the_SkipPublicFolderInitialization_ parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the_SkipPublicFolderInitialization_ parameter. If you do not skip this initialization, it may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.\n\nSo, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.\n\n<span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span>\n\nNow that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs  should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,\n\n**msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\n\nThis attribute is populated when the mailbox user is created in HMC.\n\n<span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span>\n\nBy far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.\n\nHMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.\n\nIn order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.\n\nThe concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.\n\nThen when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That's why the specification of the CAS pool is on creating mailbox.\n\nEverything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called**UpdateOABProvision.exe**.\n\nThe **UpdateOABProvision.exe** tool is used to update all existing Offline Address Books (OAB's) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.\n\nFor example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB's associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB's associated with that pool should be updated so that the removed server is no longer set as a distribution point.\n\nThe command-line syntax for running the UpdateOABProvision.exe tool is:\n\n\n`UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError`\n\nI also like to highlight one thing here which is in HMC 4.5, it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128 servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we have when we are using Public Folder OAB distribution.\n\n**Troubleshooting OAB download Issues in HMC**\n\nProblem downloading OABs is one of the most common issues raised to us for newly setup HMC environment. Most of the time, the problems can be categorized into 2 types,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span>\n\nThis is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,\n\n*   Confirm that the company OAB root folder exists. If not, you need to find out,\n\n    *   If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server\n    *   If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.\n    *   If you can't find the root folder anywhere, you may want to find out how the OAB was created in the first place.\n\n*   If you can find the company OAB root folder, confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.\n*   HmOABUpdate application isn't working because it was not setup properly. This could be due to permission not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what's going on to get started.\n*   Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,[http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx). Turning up the Diagnostic logging will usually lead you to the source of the problem.\nIf you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.\n\n<span style=\"text-decoration: underline;\">(2) Locating OABs</span>\n\nI will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book\n[http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx](http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx)\n\nIn addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn't working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can't download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.\n\nI will also cover how Autodiscover work in the HMC environment in part #5.","source":"_posts/hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 3 - Offline Address Book Generations\ntags:\n  - HMC\n  - Exchange\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 17:38:47\n---\n\n转自 http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nIn the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment. It is my belief that if you understand that clearly, you have understood 70% of the Hosted Exchange concept in HMC. The rest will be just easy. :)\n\nIn this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don't intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman's web log has covered most of them ([http://blogs.msdn.com/dgoldman/default.aspx](http://blogs.msdn.com/dgoldman/default.aspx)). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn't changed much)\n\nOverview of the OABgen process\n[http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx)\n\nMy primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.\n\n**What has been introduced by HMC?**\n\nHMC does not change the OAB component in Exchange 2007 SP1 much. It does make a few changes in terms of how it works to make sure that things will run better in a service provider environment. So, let's take a closer look,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Process</span>\n\nThis is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.\n\nInstead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update will be called or triggered for that company.\n\nTo do that, HMC does the following,\n\n*   **No Schedule **- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.\n*   **HmOABUpdate** - HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).\nThis application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.\n\nThe application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.\n\nNow, for each Offline Address List object, there are a couple of interesting items to look at,\n\n*   The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).\n*   PublicFolderDistributionEnabled - Depending on the Organization Plan (&lt;features/ outlookClient&gt;) you use to create the company/tenant, this may be True or False.\n*   PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.\nIf all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.\n\n<span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span>\n\nThere are a few unique challenges that a Hosted Exchange environment like HMC may face that are generally not faced by a corporate environment.\n\n*   **High number of OABs**, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists ([http://technet.microsoft.com/en-us/library/cc539031.aspx](http://technet.microsoft.com/en-us/library/cc539031.aspx)).\n> In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.\n\n*   **Dedicated OAB Distribution Server**, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).\nIf you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn't mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).\n\n*   **Other behaviour that you should take note**, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.\n\n    *   OAB public folder expiration. This actually trace back to Exchange Server 2003, Update to modify the OAB public folder expiration in Exchange Server 2003 ([http://support.microsoft.com/kb/832761](http://support.microsoft.com/kb/832761)).\n> Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what's going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the \"OAL Folder Lifetime\" registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.\n> > \n> > HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters\n> > \n> > Value name: OAL Folder Lifetime (days)\n> > Value type: REG_DWORD\n> > Value data: 0\n\n*   OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent, [http://support.microsoft.com/?id=834315](http://support.microsoft.com/?id=834315). While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.\n\n<span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span>\n\nEven though HMC puts in tweaks here and there, creation of the Offline Address List is nothing more than calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight one thing,\n\n_SkipPublicFolderInitialization_ parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the_SkipPublicFolderInitialization_ parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the_SkipPublicFolderInitialization_ parameter. If you do not skip this initialization, it may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.\n\nSo, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.\n\n<span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span>\n\nNow that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs  should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,\n\n**msExchUseOAB**: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.\n\nThis attribute is populated when the mailbox user is created in HMC.\n\n<span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span>\n\nBy far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.\n\nHMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.\n\nIn order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.\n\nThe concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.\n\nThen when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That's why the specification of the CAS pool is on creating mailbox.\n\nEverything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called**UpdateOABProvision.exe**.\n\nThe **UpdateOABProvision.exe** tool is used to update all existing Offline Address Books (OAB's) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.\n\nFor example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB's associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB's associated with that pool should be updated so that the removed server is no longer set as a distribution point.\n\nThe command-line syntax for running the UpdateOABProvision.exe tool is:\n\n\n`UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError`\n\nI also like to highlight one thing here which is in HMC 4.5, it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128 servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we have when we are using Public Folder OAB distribution.\n\n**Troubleshooting OAB download Issues in HMC**\n\nProblem downloading OABs is one of the most common issues raised to us for newly setup HMC environment. Most of the time, the problems can be categorized into 2 types,\n\n<span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span>\n\nThis is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,\n\n*   Confirm that the company OAB root folder exists. If not, you need to find out,\n\n    *   If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server\n    *   If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.\n    *   If you can't find the root folder anywhere, you may want to find out how the OAB was created in the first place.\n\n*   If you can find the company OAB root folder, confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.\n*   HmOABUpdate application isn't working because it was not setup properly. This could be due to permission not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what's going on to get started.\n*   Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,[http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx](http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx). Turning up the Diagnostic logging will usually lead you to the source of the problem.\nIf you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.\n\n<span style=\"text-decoration: underline;\">(2) Locating OABs</span>\n\nI will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book\n[http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx](http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx)\n\nIn addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn't working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can't download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.\n\nI will also cover how Autodiscover work in the HMC environment in part #5.","slug":"hmc-45-and-exchange-2007-sp1-part3-offline-address-book-generations","published":1,"updated":"2017-06-16T09:12:42.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxp001d4gyrr2ylh31c","content":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment. It is my belief that if you understand that clearly, you have understood 70% of the Hosted Exchange concept in HMC. The rest will be just easy. :)</p>\n<p>In this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don’t intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman’s web log has covered most of them (<a href=\"http://blogs.msdn.com/dgoldman/default.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/default.aspx</a>). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn’t changed much)</p>\n<p>Overview of the OABgen process<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx</a></p>\n<p>My primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.</p>\n<p><strong>What has been introduced by HMC?</strong></p>\n<p>HMC does not change the OAB component in Exchange 2007 SP1 much. It does make a few changes in terms of how it works to make sure that things will run better in a service provider environment. So, let’s take a closer look,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Process</span></p>\n<p>This is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.</p>\n<p>Instead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update will be called or triggered for that company.</p>\n<p>To do that, HMC does the following,</p>\n<ul>\n<li><strong>No Schedule </strong>- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.</li>\n<li><strong>HmOABUpdate</strong> - HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).<br>This application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.</li>\n</ul>\n<p>The application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.</p>\n<p>Now, for each Offline Address List object, there are a couple of interesting items to look at,</p>\n<ul>\n<li>The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).</li>\n<li>PublicFolderDistributionEnabled - Depending on the Organization Plan (&lt;features/ outlookClient&gt;) you use to create the company/tenant, this may be True or False.</li>\n<li>PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.<br>If all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span></p>\n<p>There are a few unique challenges that a Hosted Exchange environment like HMC may face that are generally not faced by a corporate environment.</p>\n<ul>\n<li><p><strong>High number of OABs</strong>, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists (<a href=\"http://technet.microsoft.com/en-us/library/cc539031.aspx\" target=\"_blank\" rel=\"external\">http://technet.microsoft.com/en-us/library/cc539031.aspx</a>).</p>\n<blockquote>\n<p>In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.</p>\n</blockquote>\n</li>\n<li><p><strong>Dedicated OAB Distribution Server</strong>, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).<br>If you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn’t mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).</p>\n</li>\n<li><p><strong>Other behaviour that you should take note</strong>, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.</p>\n<ul>\n<li>OAB public folder expiration. This actually trace back to Exchange Server 2003, Update to modify the OAB public folder expiration in Exchange Server 2003 (<a href=\"http://support.microsoft.com/kb/832761\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/832761</a>).<blockquote>\n<p>Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what’s going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the “OAL Folder Lifetime” registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.</p>\n<blockquote>\n<p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters</p>\n<p>Value name: OAL Folder Lifetime (days)<br>Value type: REG_DWORD<br>Value data: 0</p>\n</blockquote>\n</blockquote>\n</li>\n</ul>\n</li>\n<li><p>OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent, <a href=\"http://support.microsoft.com/?id=834315\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=834315</a>. While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.</p>\n</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span></p>\n<p>Even though HMC puts in tweaks here and there, creation of the Offline Address List is nothing more than calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight one thing,</p>\n<p><em>SkipPublicFolderInitialization</em> parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the<em>SkipPublicFolderInitialization</em> parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the<em>SkipPublicFolderInitialization</em> parameter. If you do not skip this initialization, it may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.</p>\n<p>So, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.</p>\n<p><span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span></p>\n<p>Now that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs  should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,</p>\n<p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.</p>\n<p>This attribute is populated when the mailbox user is created in HMC.</p>\n<p><span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span></p>\n<p>By far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.</p>\n<p>HMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.</p>\n<p>In order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.</p>\n<p>The concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.</p>\n<p>Then when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That’s why the specification of the CAS pool is on creating mailbox.</p>\n<p>Everything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called<strong>UpdateOABProvision.exe</strong>.</p>\n<p>The <strong>UpdateOABProvision.exe</strong> tool is used to update all existing Offline Address Books (OAB’s) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.</p>\n<p>For example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB’s associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB’s associated with that pool should be updated so that the removed server is no longer set as a distribution point.</p>\n<p>The command-line syntax for running the UpdateOABProvision.exe tool is:</p>\n<p><code>UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError</code></p>\n<p>I also like to highlight one thing here which is in HMC 4.5, it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128 servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we have when we are using Public Folder OAB distribution.</p>\n<p><strong>Troubleshooting OAB download Issues in HMC</strong></p>\n<p>Problem downloading OABs is one of the most common issues raised to us for newly setup HMC environment. Most of the time, the problems can be categorized into 2 types,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span></p>\n<p>This is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,</p>\n<ul>\n<li><p>Confirm that the company OAB root folder exists. If not, you need to find out,</p>\n<ul>\n<li>If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server</li>\n<li>If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.</li>\n<li>If you can’t find the root folder anywhere, you may want to find out how the OAB was created in the first place.</li>\n</ul>\n</li>\n<li><p>If you can find the company OAB root folder, confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.</p>\n</li>\n<li>HmOABUpdate application isn’t working because it was not setup properly. This could be due to permission not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what’s going on to get started.</li>\n<li>Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,<a href=\"http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx</a>. Turning up the Diagnostic logging will usually lead you to the source of the problem.<br>If you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) Locating OABs</span></p>\n<p>I will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx</a></p>\n<p>In addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn’t working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can’t download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.</p>\n<p>I will also cover how Autodiscover work in the HMC environment in part #5.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/12/18/hmc-4-5-and-exchange-2007-sp1-part-3-offline-address-book-generations.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>In the last part, we discussed about Address List segregation, which is an important concept to understand in Hosted Exchange environment. It is my belief that if you understand that clearly, you have understood 70% of the Hosted Exchange concept in HMC. The rest will be just easy. :)</p>\n<p>In this part, we will continue to discuss about Offline Address Book (OAB) Generations in a HMC environment. I don’t intend to talk about the OAB generation process in Exchange 2007 because I think Dave Goldman’s web log has covered most of them (<a href=\"http://blogs.msdn.com/dgoldman/default.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/default.aspx</a>). Now, for those who are interested to know more, I think the following is a good starting point (although the content is mainly Exchange 2003, the whole OAB generation process hasn’t changed much)</p>\n<p>Overview of the OABgen process<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/archive/2005/03/31/Overview-of-the-OABgen-process.aspx</a></p>\n<p>My primary objective in this blog is to discuss about the customization of OAB components in Exchange 2007 SP1 done by HMC.</p>\n<p><strong>What has been introduced by HMC?</strong></p>\n<p>HMC does not change the OAB component in Exchange 2007 SP1 much. It does make a few changes in terms of how it works to make sure that things will run better in a service provider environment. So, let’s take a closer look,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Process</span></p>\n<p>This is probably one of the parts in HMC that confuses messaging engineers the most. Typically, when an Exchange engineer troubleshoots the OAB generation (OABgen) process, they will look at the event log and also look at the OAB generation schedule. What they will see is that in a HMC environment is that the schedules for the all the OALs have been set to nothing, meaning Never Run.</p>\n<p>Instead of using the normal OABgen schedule which will scan through all OABs and update each one of them (which in a Hosted environment, you could be talking about 30-50k OABs, that can take a long time), HMC changes things a little bit here by making the process to be triggered by changes instead of by time. Meaning, if there is no changes made to users or contacts in the company, no offline address book update will be called or triggered for that company.</p>\n<p>To do that, HMC does the following,</p>\n<ul>\n<li><strong>No Schedule </strong>- When creating an Offline Address List object, HMC will set the schedule of that Offline Address List object to Never Run.</li>\n<li><strong>HmOABUpdate</strong> - HMC introduces a separate components called Hosted E-mail Offline Address Book (OAB) Update Batch Application (HmOABUpdate), installed on one of the Microsoft Provisioning Servers (MPS).<br>This application will query the MPS SQL Server (which keeps track of all the creations, deletions, modifications and changes made to the environment through HMC) and based on those changes; it will call the Update-OfflineAddressBook only on the specific company that has been changed.</li>\n</ul>\n<p>The application will also generate a set of logs to log any success of failures in a log folder in the same directory of the application, by default, which is &lt;drive&gt;:\\Program Files\\Microsoft Hosting\\Provisioning\\ Exchange OAB Update\\log folder.</p>\n<p>Now, for each Offline Address List object, there are a couple of interesting items to look at,</p>\n<ul>\n<li>The Address Lists - Generally it should be pointing to the company address list (NOT the company global address list).</li>\n<li>PublicFolderDistributionEnabled - Depending on the Organization Plan (&lt;features/ outlookClient&gt;) you use to create the company/tenant, this may be True or False.</li>\n<li>PublicFolderDatabase - This will determine which Exchange server will be performing the OAB generation. If the distribution is primarily on Public Folder, then it is important to make sure that the number of OAB hosted by the server does not exceed the MaxPageSize specified in the Active Directory LDAP Policies. If it does, you may have OAB generation issues. I will cover this in the troubleshooting section later.<br>If all things are well, the generation process should be just like any other corporate Exchange environment, except it is being triggered from another application.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) OAB Limit and Distribution</span></p>\n<p>There are a few unique challenges that a Hosted Exchange environment like HMC may face that are generally not faced by a corporate environment.</p>\n<ul>\n<li><p><strong>High number of OABs</strong>, when will you see a corporate environment have more than 1000 OABs? Almost never. However, this could be common in a HMC environment. When Microsoft released HMC 4.0, it provided a recommendation that each Microsoft Exchange Server is limited to supporting a maximum of 1000 Exchange Server Offline Address Lists (<a href=\"http://technet.microsoft.com/en-us/library/cc539031.aspx\" target=\"_blank\" rel=\"external\">http://technet.microsoft.com/en-us/library/cc539031.aspx</a>).</p>\n<blockquote>\n<p>In HMC 4.5, we have raised it to 10,000 per server instead. The Knowledge Base article KB 945629 updates the sizing guidance for Exchange Offline Address Book (OAB) servers. This ten-fold increase compared to Hosted Messaging and Collaboration version 4.0 allows service providers to save on hardware, software licensing, and maintenance cost. However, it should be noted that after raising the limit in an environment, service providers should monitor Active Directory performance carefully to ensure the change has no negative impact. Service providers should also ensure the existing hardware for the OAB servers are capable of handling the increase to ensure that customers are still able to quickly download updates to their OABs, even during peak working hours.</p>\n</blockquote>\n</li>\n<li><p><strong>Dedicated OAB Distribution Server</strong>, depending on what version of Outlook Client you intend to support. If you intend to support anything below Outlook 2007, then you have to have Public Folder as the distribution point and the recommendation is that, you should have dedicated OAB servers and each server should not have more than 10,000 OABs in it (as mentioned above).<br>If you have only Outlook 2007 Clients, you may be using primarily just the web distribution method, it doesn’t mean you have no issue too because it means the load of download will be shifted to the CAS server and you should also monitor the performance of the CAS to see if there is a need to have dedicated CAS just to be a OAB distribution point (Deployment Walkthrough will walk you through on how to setup a dedicated CAS for Web Distribution).</p>\n</li>\n<li><p><strong>Other behaviour that you should take note</strong>, OAB generation process actually has some interesting implication that is not generally encountered by a corporate environment.</p>\n<ul>\n<li>OAB public folder expiration. This actually trace back to Exchange Server 2003, Update to modify the OAB public folder expiration in Exchange Server 2003 (<a href=\"http://support.microsoft.com/kb/832761\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/832761</a>).<blockquote>\n<p>Because HMC moved the generation process out to an application and only touches the changed OAB, you may potentially have an OAB that may not have any change for a while. OABgen sets the default expiration time of 30 days. So what’s going to happen is that, when it expires, it will remove the content in those folders and the user will not be able to download the OAB. The trick is to assign a value of 0 (zero) to the “OAL Folder Lifetime” registry entry, messages in the public folder do not expire. If you set this registry entry to a value other than zero, messages in the public folder expire in the number of days that correspond to the value that you assign. After you create this registry value, every time that OABgen runs, OABgen reads the registry entry and stamps it on the public folders that it uses.</p>\n<blockquote>\n<p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSExchangeSA\\Parameters</p>\n<p>Value name: OAL Folder Lifetime (days)<br>Value type: REG_DWORD<br>Value data: 0</p>\n</blockquote>\n</blockquote>\n</li>\n</ul>\n</li>\n<li><p>OABScan task is not required. This article should explain it. CPU usage by the Exchange System Attendant service on offline address list servers in a hosting environment increases to 50 percent, <a href=\"http://support.microsoft.com/?id=834315\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=834315</a>. While the article is written specifically for Exchange 2003, it is also applicable to Exchange 2007 if Public Folder OAB distribution is heavily used.</p>\n</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(3) OAB Creation and Maintenance</span></p>\n<p>Even though HMC puts in tweaks here and there, creation of the Offline Address List is nothing more than calling the New-OfflineAddressBook cmdlet. Here, I just want to highlight one thing,</p>\n<p><em>SkipPublicFolderInitialization</em> parameter. This parameter was introduced in Exchange 2007 SP1 and the appropriate namespace and procedures have been updated to allow for this parameter. If you are creating an OAB that uses public folder distribution, use the<em>SkipPublicFolderInitialization</em> parameter to skip the immediate creation of the OAB public folders. The OAB will not be available for download until the next site folder maintenance cycle has completed. You do not have to specify a value with the<em>SkipPublicFolderInitialization</em> parameter. If you do not skip this initialization, it may cause the task to pause while it contacts the responsible public folder server to create the necessary public folders. If the server is presently unreachable, or is otherwise costly to contact, the pause could be significant.</p>\n<p>So, it is a decision of the service providers whether they want to immediately create the OAB root folder or they want to wait till the next day.</p>\n<p><span style=\"text-decoration: underline;\">(4) How does user know which OAB to use?</span></p>\n<p>Now that we understand the OAB generation process is triggered from a separate HMC application and also that there are some tweaks required to make things work more suitable for a service provider environment, the next thing we need to sort out is that how Exchange knows which of those 10,000 OABs  should it send the user to retrieve. The answer lies in one of the user object Active Directory attributes that we mentioned in part #1,</p>\n<p><strong>msExchUseOAB</strong>: DN of the Tenant specific OAL object, this attribute directs Outlook to the appropriate OAB to download for this user.</p>\n<p>This attribute is populated when the mailbox user is created in HMC.</p>\n<p><span style=\"text-decoration: underline;\">(5) A Web-based Offline Address Book (OAB) Server</span></p>\n<p>By far, the discussions have been mostly around the Public Folder distribution for OAB. In HMC 4.0, the only method of distribution of OAB is through Public Folder even though Exchange 2007 has the capacity to do both Public Folder and Web Distribution.</p>\n<p>HMC 4.5 has lifted that limitation, allowing service providers to deploy web distribution for OAB. Of course, introduction of this new feature requires some additional configurations.</p>\n<p>In order to enable a specific Offline Address List to be distributed through web, each OAB has to be enabled for Web-based distribution and that it must have at least one OAB distribution virtual directory specified. Hence, it means from the MPS perspective, when MPS needs to create a new OAB, there must be some logic to assign the appropriate CAS server as the OAB distribution point. To do that, HMC introduces the concept of CAS Pool.</p>\n<p>The concept is quite straightforward. What we really need to do is to create a pool of CAS servers that will be used as distribution server. The steps are documented in the Deployment Walkthrough. We must first create the pool by using CreateOABCASPool.xml. Next, we have to add each OAB Web Distribution server into the pool using AddOABCAS.xml.</p>\n<p>Then when create the mailbox, we have to specify the CAS Pool that will be used by the company or tenant. I like to note that this is during the process of create mailbox rather than create organization or email plan subscription. The reason is that the creation of the OAB really happens on the first MAPI user creation. That’s why the specification of the CAS pool is on creating mailbox.</p>\n<p>Everything sounds simple enough so far, now what will happen when we decided to add a new OAB web distribution server to the CAS pool? You may realize that only the new company may get all the web distribution servers listed in the OAL whereas the OAL created in the past may not have that updated. This is where HMC 4.5 also introduces a new tool called<strong>UpdateOABProvision.exe</strong>.</p>\n<p>The <strong>UpdateOABProvision.exe</strong> tool is used to update all existing Offline Address Books (OAB’s) when the list of Web-based OAB CAS servers that exist in an OAB CAS Pool has changed.</p>\n<p>For example, if a new server is added to the OAB CAS Pool, the orchestration logic will need to update all OAB’s associated with that pool so that they have an accurate list of distribution points, including the new server. Similarly, if an OAB CAS server is removed from the pool, all OAB’s associated with that pool should be updated so that the removed server is no longer set as a distribution point.</p>\n<p>The command-line syntax for running the UpdateOABProvision.exe tool is:</p>\n<p><code>UpdateOABProvision.EXE -OABCASPool -Errorlog -MaxError</code></p>\n<p>I also like to highlight one thing here which is in HMC 4.5, it really uses just the default CAS Pool. Each CAS Pool can cater for up to 128 servers, which is quite a big number, consider the fact that there is no 1,000 OAB limit like what we have when we are using Public Folder OAB distribution.</p>\n<p><strong>Troubleshooting OAB download Issues in HMC</strong></p>\n<p>Problem downloading OABs is one of the most common issues raised to us for newly setup HMC environment. Most of the time, the problems can be categorized into 2 types,</p>\n<p><span style=\"text-decoration: underline;\">(1) OAB Generation Issues</span></p>\n<p>This is probably the first thing you want to find out, that is if the OAB generation is successful. I will generally start with the following,</p>\n<ul>\n<li><p>Confirm that the company OAB root folder exists. If not, you need to find out,</p>\n<ul>\n<li>If you are looking at the right Public Folder Server, if you are not, please try to locate the right Public Folder Server</li>\n<li>If you can find the root folder on some of the OAB Public Folder Server but not on others, then you may need to find out if you have a Public Folder Replication issue.</li>\n<li>If you can’t find the root folder anywhere, you may want to find out how the OAB was created in the first place.</li>\n</ul>\n</li>\n<li><p>If you can find the company OAB root folder, confirm that the OAB Version folders are there and that the contents are there. You can do that by using MFCMAPI, OWA or the Exchange Management Console.</p>\n</li>\n<li>HmOABUpdate application isn’t working because it was not setup properly. This could be due to permission not properly setup, problem connecting to the SQL server and etc. I would first review the HMOBUpdate log to find out what’s going on to get started.</li>\n<li>Actual OAB Generation Issues, this could be due to various reasons. I will try some of the steps in this article to start with, How to troubleshoot the OAB Generation process,<a href=\"http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/archive/2005/07/16/How-to-troubleshoot-the-OAB-Generation-process.aspx</a>. Turning up the Diagnostic logging will usually lead you to the source of the problem.<br>If you can confirm that the OAB is there (that is it has been properly generated) and that the hierarchy has been properly replicated, then you problem will be more on locating the OABs.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(2) Locating OABs</span></p>\n<p>I will start with this, Outlook 2003 and 2007 clients receive error 0x8004010f when downloading the Offline Address Book<br><a href=\"http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/dgoldman/archive/2007/04/26/outlook-clients-receive-error-0x8004010f-when-downloading-the-offline-address-book.aspx</a></p>\n<p>In addition to this, I also like to take note that Outlook 2007 uses Autodiscover to find out where the OAB is. If the Autodiscover isn’t working well, Outlook 2007 may get the same common 0x8004010f error as well. So, if you can’t download OAB using Outlook 2007 but you can do it through Outlook 2003, I would start looking at Autodiscover.</p>\n<p>I will also cover how Autodiscover work in the HMC environment in part #5.</p>\n"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 4 Internal and External Out of Office","date":"2009-05-07T10:50:18.000Z","_content":"\n转自 https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/ 很好的文章,贴过来收藏,hehe.\n\n***\n\n**Internal and External OOF in HMC Environment**\n\nSo, the 4th main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, \"The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.\" Now, I don't intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.\n\nHere, I want to briefly explain how Exchange 2007 OOF, out of the box isn't really working complete in a HMC environment and how we make it work.\n\n**What's not working, really?**\n\nExchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn't packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.\n\nIf a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007 believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.\n\nFor example,\n\n1.  Hoster A has a HMC environment that hosts both company A and company B.\n2.  John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.\n3.  Alice from company B sends an e-mail to John from company A. Instead of getting John's external OOF, she got his internal OOF.\n**How do we make it work then?**\n\nTo support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here ([http://technet.microsoft.com/en-us/library/cc545931.aspx](http://technet.microsoft.com/en-us/library/cc545931.aspx)), the OOF agent includes two utilities:\n\n*   **Categorizer Override Agent**: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.\n\n*   **SMTP Domain Cache Task**: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.\nSo, how do these utilities work? It is quite simple as a matter of fact. Let's talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent. The agent checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and <span style=\"text-decoration: underline;\">bypass</span> suppression of the external OOF message for external and inter-company recipients.\n\nNext it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.\n\nFor performance reason, that's where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.\n\nThis file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.\n\nSo, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.\n\nThe OOF agent was first introduced in HMC 4.5 and Microsoft has also back ported this agent to HMC 4.0 environment, ([http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx](http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx))\n**What are some of the usual problems that you may face while installing this OOF agent?**\n\nThe installation of the OOF agent is clearly documented [here](http://technet.microsoft.com/en-us/library/cc545931.aspx \"Install OOF Aent\"). However, there are a few areas that you may encounter issues,\n\nThe OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented, C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.\n\nAnother thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService must have permission to it.\n\nAlso, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.\n\nAnother common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a '&amp;' may result in failure with strange error.\n\n**More about OOF?**\n\nIn case you want to know more about the working of OOF, here are 2 articles that you may want to read,\n\nExchange Server 2007 Out of Office (OOF)\n[http://msexchangeteam.com/archive/2006/10/06/429115.aspx](http://msexchangeteam.com/archive/2006/10/06/429115.aspx)\n\nLegacy client and Out of Office (OOF) interoperability\n[http://msexchangeteam.com/archive/2007/04/04/437544.aspx](http://msexchangeteam.com/archive/2007/04/04/437544.aspx)","source":"_posts/hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 4 Internal and External Out of Office\ntags:\n  - Exchange\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 18:50:18\n---\n\n转自 https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/ 很好的文章,贴过来收藏,hehe.\n\n***\n\n**Internal and External OOF in HMC Environment**\n\nSo, the 4th main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, \"The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.\" Now, I don't intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.\n\nHere, I want to briefly explain how Exchange 2007 OOF, out of the box isn't really working complete in a HMC environment and how we make it work.\n\n**What's not working, really?**\n\nExchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn't packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.\n\nIf a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007 believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.\n\nFor example,\n\n1.  Hoster A has a HMC environment that hosts both company A and company B.\n2.  John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.\n3.  Alice from company B sends an e-mail to John from company A. Instead of getting John's external OOF, she got his internal OOF.\n**How do we make it work then?**\n\nTo support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here ([http://technet.microsoft.com/en-us/library/cc545931.aspx](http://technet.microsoft.com/en-us/library/cc545931.aspx)), the OOF agent includes two utilities:\n\n*   **Categorizer Override Agent**: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.\n\n*   **SMTP Domain Cache Task**: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.\nSo, how do these utilities work? It is quite simple as a matter of fact. Let's talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent. The agent checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and <span style=\"text-decoration: underline;\">bypass</span> suppression of the external OOF message for external and inter-company recipients.\n\nNext it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.\n\nFor performance reason, that's where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.\n\nThis file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.\n\nSo, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.\n\nThe OOF agent was first introduced in HMC 4.5 and Microsoft has also back ported this agent to HMC 4.0 environment, ([http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx](http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx))\n**What are some of the usual problems that you may face while installing this OOF agent?**\n\nThe installation of the OOF agent is clearly documented [here](http://technet.microsoft.com/en-us/library/cc545931.aspx \"Install OOF Aent\"). However, there are a few areas that you may encounter issues,\n\nThe OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented, C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.\n\nAnother thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService must have permission to it.\n\nAlso, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.\n\nAnother common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a '&amp;' may result in failure with strange error.\n\n**More about OOF?**\n\nIn case you want to know more about the working of OOF, here are 2 articles that you may want to read,\n\nExchange Server 2007 Out of Office (OOF)\n[http://msexchangeteam.com/archive/2006/10/06/429115.aspx](http://msexchangeteam.com/archive/2006/10/06/429115.aspx)\n\nLegacy client and Out of Office (OOF) interoperability\n[http://msexchangeteam.com/archive/2007/04/04/437544.aspx](http://msexchangeteam.com/archive/2007/04/04/437544.aspx)","slug":"hmc-45-and-exchange-2007-sp1-part4-internal-and-external-out-of-office","published":1,"updated":"2017-06-16T09:13:16.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxq001g4gyra1ux0f4z","content":"<p>转自 <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/\" target=\"_blank\" rel=\"external\">https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/</a> 很好的文章,贴过来收藏,hehe.</p>\n<hr>\n<p><strong>Internal and External OOF in HMC Environment</strong></p>\n<p>So, the 4th main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, “The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.” Now, I don’t intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.</p>\n<p>Here, I want to briefly explain how Exchange 2007 OOF, out of the box isn’t really working complete in a HMC environment and how we make it work.</p>\n<p><strong>What’s not working, really?</strong></p>\n<p>Exchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn’t packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.</p>\n<p>If a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007 believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.</p>\n<p>For example,</p>\n<ol>\n<li>Hoster A has a HMC environment that hosts both company A and company B.</li>\n<li>John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.</li>\n<li>Alice from company B sends an e-mail to John from company A. Instead of getting John’s external OOF, she got his internal OOF.<br><strong>How do we make it work then?</strong></li>\n</ol>\n<p>To support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here (<a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\" target=\"_blank\" rel=\"external\">http://technet.microsoft.com/en-us/library/cc545931.aspx</a>), the OOF agent includes two utilities:</p>\n<ul>\n<li><p><strong>Categorizer Override Agent</strong>: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.</p>\n</li>\n<li><p><strong>SMTP Domain Cache Task</strong>: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.<br>So, how do these utilities work? It is quite simple as a matter of fact. Let’s talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent. The agent checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and <span style=\"text-decoration: underline;\">bypass</span> suppression of the external OOF message for external and inter-company recipients.</p>\n</li>\n</ul>\n<p>Next it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.</p>\n<p>For performance reason, that’s where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.</p>\n<p>This file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.</p>\n<p>So, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.</p>\n<p>The OOF agent was first introduced in HMC 4.5 and Microsoft has also back ported this agent to HMC 4.0 environment, (<a href=\"http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx</a>)<br><strong>What are some of the usual problems that you may face while installing this OOF agent?</strong></p>\n<p>The installation of the OOF agent is clearly documented <a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\" title=\"Install OOF Aent\" target=\"_blank\" rel=\"external\">here</a>. However, there are a few areas that you may encounter issues,</p>\n<p>The OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented, C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.</p>\n<p>Another thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService must have permission to it.</p>\n<p>Also, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.</p>\n<p>Another common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a ‘&amp;’ may result in failure with strange error.</p>\n<p><strong>More about OOF?</strong></p>\n<p>In case you want to know more about the working of OOF, here are 2 articles that you may want to read,</p>\n<p>Exchange Server 2007 Out of Office (OOF)<br><a href=\"http://msexchangeteam.com/archive/2006/10/06/429115.aspx\" target=\"_blank\" rel=\"external\">http://msexchangeteam.com/archive/2006/10/06/429115.aspx</a></p>\n<p>Legacy client and Out of Office (OOF) interoperability<br><a href=\"http://msexchangeteam.com/archive/2007/04/04/437544.aspx\" target=\"_blank\" rel=\"external\">http://msexchangeteam.com/archive/2007/04/04/437544.aspx</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>转自 <a href=\"https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/\" target=\"_blank\" rel=\"external\">https://blogs.technet.microsoft.com/provtest/2008/12/26/hmc-4-5-and-exchange-2007-sp1-part-4-internal-and-external-out-of-office/</a> 很好的文章,贴过来收藏,hehe.</p>\n<hr>\n<p><strong>Internal and External OOF in HMC Environment</strong></p>\n<p>So, the 4th main customization that HMC introduces to Exchange 2007 is the OOF Transport Agent. What is OOF? Here is the text book definition, “The Out-of-Office (OOF) feature is commonly used by end-users to let other people know when they are not available to respond to e-mail.” Now, I don’t intend to go into the working of OOF in Exchange 2007 because I think there are better articles out there that talk about it.</p>\n<p>Here, I want to briefly explain how Exchange 2007 OOF, out of the box isn’t really working complete in a HMC environment and how we make it work.</p>\n<p><strong>What’s not working, really?</strong></p>\n<p>Exchange 2007 introduces the concept of Internal and External OOF. This is something that a lot of our customers have been waiting for. Now, we all know Exchange 2007 wasn’t packaged with multi-tenancy enabled out of the box. The problem is this, the identification of what is considered internal and what is external.</p>\n<p>If a mail is sent from one user to another (even though they are of different tenants) within the same Exchange Organization, it is considered internal. In another word, a hoster may hold both company A and company B, however, Exchange 2007 believes that both company A and company B are internal, and hence company A will never use External OOF to company B. This breaks the concept of internal and external OOF notification as in Exchange 2007 in HMC environment.</p>\n<p>For example,</p>\n<ol>\n<li>Hoster A has a HMC environment that hosts both company A and company B.</li>\n<li>John from company A set an internal and external OOF. The internal OOF is only intended for users in company A.</li>\n<li>Alice from company B sends an e-mail to John from company A. Instead of getting John’s external OOF, she got his internal OOF.<br><strong>How do we make it work then?</strong></li>\n</ol>\n<p>To support Out of Office (OOF) feature for tenants among different organizations within the same Windows domain, HMC introduces a customized OOF transport agent on all Exchange Hub Transport servers. As highlighted over here (<a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\" target=\"_blank\" rel=\"external\">http://technet.microsoft.com/en-us/library/cc545931.aspx</a>), the OOF agent includes two utilities:</p>\n<ul>\n<li><p><strong>Categorizer Override Agent</strong>: A transport agent to override the categorizer behavior on Hub Transport servers. This agent sits in Submission Queue and to be more specific, OnSubmittedMessage in the Exchange 2007 Transport pipeline.</p>\n</li>\n<li><p><strong>SMTP Domain Cache Task</strong>: A scheduled task to generate cache files for categorizer override agent to filter the OOF messages. Based on the deployment document, the interval recommended is 60 minutes.<br>So, how do these utilities work? It is quite simple as a matter of fact. Let’s talk about the Categorizer Override Agent first. When a mail comes into the Hub Transport server, it hits the OnSubmittedMessage; it fires up the Categorizer Override Agent. The agent checks to see if the mail is sent using an external OOF template, if yes, then it expands the recipients to check and <span style=\"text-decoration: underline;\">bypass</span> suppression of the external OOF message for external and inter-company recipients.</p>\n</li>\n</ul>\n<p>Next it checks to see if it is an internal OOF template, if it is, it will then expand the recipients and suppress the internal OOF message for external and inter-company recipients.</p>\n<p>For performance reason, that’s where the SMTP Domain cache task comes in. The task read from the MPS SQL server for all the domains that have been provisioned and generate a .cache file with all the domains hosted by the environment periodically.</p>\n<p>This file is used by the categorizer override agent to find out if it is part of this Exchange organization. Having it cached as a local text file, is obviously a big performance gain compared to going to Active Directory to make the query every time especially if the environment has large number of hosted domains.</p>\n<p>So, there you go, with the above, it overrides the logic of Internal and External OOF when dealing with different companies in the same Exchange organization.</p>\n<p>The OOF agent was first introduced in HMC 4.5 and Microsoft has also back ported this agent to HMC 4.0 environment, (<a href=\"http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2008/11/19/oof-agent-is-now-available-in-hmc-4-0.aspx</a>)<br><strong>What are some of the usual problems that you may face while installing this OOF agent?</strong></p>\n<p>The installation of the OOF agent is clearly documented <a href=\"http://technet.microsoft.com/en-us/library/cc545931.aspx\" title=\"Install OOF Aent\" target=\"_blank\" rel=\"external\">here</a>. However, there are a few areas that you may encounter issues,</p>\n<p>The OOF agent included in the deployment ISO is a 32-bit agent. Hence, the default path, instead of the documented, C:\\Program Files\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent, it will be C:\\Program Files (x86)\\Microsoft\\Exchange Server\\TransportRoles\\Agents\\CategorizerOverrideAgent instead.</p>\n<p>Another thing you should know is that, the Microsoft Exchange Transport service runs as a NT_AUTHORITY\\NetworkService account. Hence, you need to make sure whichever directory that you are installing this agent in, the NT_AUTHORITY\\NetworkService must have permission to it.</p>\n<p>Also, it is my recommendation to Install HMC 4.5 Rollup 1 instead as this rollup includes a 64-bit binaries.</p>\n<p>Another common mistake that most people may have is not setting the path correctly in SmtpDomainCacheTask.exe.config file. A simple mistake there may, like removing a ‘&amp;’ may result in failure with strange error.</p>\n<p><strong>More about OOF?</strong></p>\n<p>In case you want to know more about the working of OOF, here are 2 articles that you may want to read,</p>\n<p>Exchange Server 2007 Out of Office (OOF)<br><a href=\"http://msexchangeteam.com/archive/2006/10/06/429115.aspx\" target=\"_blank\" rel=\"external\">http://msexchangeteam.com/archive/2006/10/06/429115.aspx</a></p>\n<p>Legacy client and Out of Office (OOF) interoperability<br><a href=\"http://msexchangeteam.com/archive/2007/04/04/437544.aspx\" target=\"_blank\" rel=\"external\">http://msexchangeteam.com/archive/2007/04/04/437544.aspx</a></p>\n"},{"title":"HMC 4.5 and Exchange 2007 SP1 - Part 5 - Autodiscover in the Multi-tenancy environment","date":"2009-05-07T10:52:04.000Z","_content":"\n转自 http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nSo, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn't work completely out of the box in a hosted Exchange environment and what HMC has introduced to make it work better.\n\nSo, what's next?\n\n**Shared Infrastructure in HMC?**\n\nNow that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.\n\nFor Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some 'legacy' parameter that cause the configuration of Outlook more complicated than desired.\n\nFor example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That's not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.\n\nIf that doesn't sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to know more URLs or configurations to access those services.\n\nNow, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?\n\nWhile the above sounded complicated, we do have some good news for you.\n\n*   Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the shared infrastructure) and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).\n*   Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.\nThe not good news is this, Autodiscover doesn't just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.\n\n<span style=\"text-decoration: underline;\">(1) Outlook 2003</span>\n\nOutlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven't changed much. It looks almost the same since the birth of Outlook.\n\nThe Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn't need to access any other URLs (such as Availability Services, Web Distribution OABs and etc.).\n\nThe Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.\n\nSolutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with all the information they need to configure their Outlook.\n\n<span style=\"text-decoration: underline;\">(2) Outlook 2007</span>\n\nOutlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.\n\nAutodiscover has changed things quite a fair bit and for those are interested to know more, you can read this [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx) as I don't intend to spend much time talking about the working which has been well covered by this white paper.\n\nIn a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren't part of the HMC Windows domain and also they are accessing the service from the Internet.\n\nFor Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user johnc@alpineskihouse.com, Outlook 2007 will automatically try to connect to the following URLs in turn:\n\n*   [https://alpineskihouse.com/autodiscover/autodiscover.xml](https://alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service [http://support.microsoft.com/kb/940881](http://support.microsoft.com/kb/940881)\nThe logic to form the URLs above is built into Outlook 2007, we can't really change that and it has to go according to that sequence. Now, obviously that can present a problem in a HMC environment. Why?\n\nThe first 2 URLs are SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.\n\nThis is where the 3rd URL, which is only a HTTP redirection, comes in. It redirects the Outlook to another HTTPS Autodiscover URL. That's the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.\n\nThere are some customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be properly validated. A redirection is a must.\n\nIn order for Outlook to go to[http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml) and get redirected, you must do 2 things,\n\n*   **DNS** - Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.\n*   **Autodiscover.xml** - your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.\nOf course, you can also do the SRV record. The only concerns for this is that the Outlook 2007 has to be properly updated before it can enjoy this new features and also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.\n\nOne thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.\n\n<span style=\"text-decoration: underline;\">(3) Other Clients</span>\n\nWhat about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.\n\n**Troubleshooting tips for Autodiscover in Multi-tenancy environment**\n\nI find that most of the Autodiscover problems in HMC can be categorized into the following,\n\n*   Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.\n*   Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services. Currently, the best reference is this, [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx)\n*   DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.\n*   Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.","source":"_posts/hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment.md","raw":"---\ntitle: HMC 4.5 and Exchange 2007 SP1 - Part 5 - Autodiscover in the Multi-tenancy environment\ntags:\n  - Autodiscover\n  - Exchange\n  - HMC\n  - MultiTenancy\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-07 18:52:04\n---\n\n转自 http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx 很好的文章,贴过来收藏,hehe.\n\n**Introduction**\n\nSo, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn't work completely out of the box in a hosted Exchange environment and what HMC has introduced to make it work better.\n\nSo, what's next?\n\n**Shared Infrastructure in HMC?**\n\nNow that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.\n\nFor Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some 'legacy' parameter that cause the configuration of Outlook more complicated than desired.\n\nFor example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That's not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.\n\nIf that doesn't sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to know more URLs or configurations to access those services.\n\nNow, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?\n\nWhile the above sounded complicated, we do have some good news for you.\n\n*   Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the shared infrastructure) and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).\n*   Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.\nThe not good news is this, Autodiscover doesn't just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.\n\n<span style=\"text-decoration: underline;\">(1) Outlook 2003</span>\n\nOutlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven't changed much. It looks almost the same since the birth of Outlook.\n\nThe Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn't need to access any other URLs (such as Availability Services, Web Distribution OABs and etc.).\n\nThe Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.\n\nSolutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with all the information they need to configure their Outlook.\n\n<span style=\"text-decoration: underline;\">(2) Outlook 2007</span>\n\nOutlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.\n\nAutodiscover has changed things quite a fair bit and for those are interested to know more, you can read this [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx) as I don't intend to spend much time talking about the working which has been well covered by this white paper.\n\nIn a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren't part of the HMC Windows domain and also they are accessing the service from the Internet.\n\nFor Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user johnc@alpineskihouse.com, Outlook 2007 will automatically try to connect to the following URLs in turn:\n\n*   [https://alpineskihouse.com/autodiscover/autodiscover.xml](https://alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   [http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml)\n*   And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service [http://support.microsoft.com/kb/940881](http://support.microsoft.com/kb/940881)\nThe logic to form the URLs above is built into Outlook 2007, we can't really change that and it has to go according to that sequence. Now, obviously that can present a problem in a HMC environment. Why?\n\nThe first 2 URLs are SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.\n\nThis is where the 3rd URL, which is only a HTTP redirection, comes in. It redirects the Outlook to another HTTPS Autodiscover URL. That's the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.\n\nThere are some customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be properly validated. A redirection is a must.\n\nIn order for Outlook to go to[http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml](http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml) and get redirected, you must do 2 things,\n\n*   **DNS** - Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.\n*   **Autodiscover.xml** - your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.\nOf course, you can also do the SRV record. The only concerns for this is that the Outlook 2007 has to be properly updated before it can enjoy this new features and also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.\n\nOne thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.\n\n<span style=\"text-decoration: underline;\">(3) Other Clients</span>\n\nWhat about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.\n\n**Troubleshooting tips for Autodiscover in Multi-tenancy environment**\n\nI find that most of the Autodiscover problems in HMC can be categorized into the following,\n\n*   Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.\n*   Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services. Currently, the best reference is this, [White Paper: Exchange 2007 Autodiscover Service](http://technet.microsoft.com/en-us/library/bb332063.aspx)\n*   DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.\n*   Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.","slug":"hmc-45-and-exchange-2007-sp1-part5-autodiscover-in-the-multi-tenancy-environment","published":1,"updated":"2017-06-16T09:13:54.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxs001l4gyrspj8dxa9","content":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>So, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn’t work completely out of the box in a hosted Exchange environment and what HMC has introduced to make it work better.</p>\n<p>So, what’s next?</p>\n<p><strong>Shared Infrastructure in HMC?</strong></p>\n<p>Now that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.</p>\n<p>For Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some ‘legacy’ parameter that cause the configuration of Outlook more complicated than desired.</p>\n<p>For example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That’s not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.</p>\n<p>If that doesn’t sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to know more URLs or configurations to access those services.</p>\n<p>Now, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?</p>\n<p>While the above sounded complicated, we do have some good news for you.</p>\n<ul>\n<li>Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the shared infrastructure) and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).</li>\n<li>Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.<br>The not good news is this, Autodiscover doesn’t just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(1) Outlook 2003</span></p>\n<p>Outlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven’t changed much. It looks almost the same since the birth of Outlook.</p>\n<p>The Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn’t need to access any other URLs (such as Availability Services, Web Distribution OABs and etc.).</p>\n<p>The Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.</p>\n<p>Solutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with all the information they need to configure their Outlook.</p>\n<p><span style=\"text-decoration: underline;\">(2) Outlook 2007</span></p>\n<p>Outlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.</p>\n<p>Autodiscover has changed things quite a fair bit and for those are interested to know more, you can read this <a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\" target=\"_blank\" rel=\"external\">White Paper: Exchange 2007 Autodiscover Service</a> as I don’t intend to spend much time talking about the working which has been well covered by this white paper.</p>\n<p>In a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren’t part of the HMC Windows domain and also they are accessing the service from the Internet.</p>\n<p>For Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user johnc@alpineskihouse.com, Outlook 2007 will automatically try to connect to the following URLs in turn:</p>\n<ul>\n<li><a href=\"https://alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">https://alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li>And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service <a href=\"http://support.microsoft.com/kb/940881\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/940881</a><br>The logic to form the URLs above is built into Outlook 2007, we can’t really change that and it has to go according to that sequence. Now, obviously that can present a problem in a HMC environment. Why?</li>\n</ul>\n<p>The first 2 URLs are SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.</p>\n<p>This is where the 3rd URL, which is only a HTTP redirection, comes in. It redirects the Outlook to another HTTPS Autodiscover URL. That’s the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.</p>\n<p>There are some customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be properly validated. A redirection is a must.</p>\n<p>In order for Outlook to go to<a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a> and get redirected, you must do 2 things,</p>\n<ul>\n<li><strong>DNS</strong> - Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.</li>\n<li><strong>Autodiscover.xml</strong> - your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.<br>Of course, you can also do the SRV record. The only concerns for this is that the Outlook 2007 has to be properly updated before it can enjoy this new features and also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.</li>\n</ul>\n<p>One thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.</p>\n<p><span style=\"text-decoration: underline;\">(3) Other Clients</span></p>\n<p>What about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.</p>\n<p><strong>Troubleshooting tips for Autodiscover in Multi-tenancy environment</strong></p>\n<p>I find that most of the Autodiscover problems in HMC can be categorized into the following,</p>\n<ul>\n<li>Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.</li>\n<li>Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services. Currently, the best reference is this, <a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\" target=\"_blank\" rel=\"external\">White Paper: Exchange 2007 Autodiscover Service</a></li>\n<li>DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.</li>\n<li>Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>转自 <a href=\"http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/01/01/hmc-4-5-and-exchange-2007-sp1-part-5-autodiscover-in-the-multi-tenancy-environment.aspx</a> 很好的文章,贴过来收藏,hehe.</p>\n<p><strong>Introduction</strong></p>\n<p>So, we have covered quite a fair bit by now. In part #1, we talked about how we can properly partition the Active Directory so that each company or tenant can coexist in the same environment but yet remain isolated and segregated. In part #2, we talked about how we have tweaked the address list so that each tenant will only see what they are supposed to see. In part #3, we further explore how Offline Address Book needs to be tweaked in to work in a multi-tenant environment and in part #4, we discussed about how Out-of-Office doesn’t work completely out of the box in a hosted Exchange environment and what HMC has introduced to make it work better.</p>\n<p>So, what’s next?</p>\n<p><strong>Shared Infrastructure in HMC?</strong></p>\n<p>Now that we have most of the things well setup at the service provider side, the HMC environment is ready to serve clients. For Outlook Web Access (OWA), it is easy; the users only need a web browser, the OWA URL, username and password. Most people can manage that without a problem.</p>\n<p>For Outlook client, unfortunately it is a little bit more complicated than we like. Outlook has come a long way and it still carries what I will call requirements for some ‘legacy’ parameter that cause the configuration of Outlook more complicated than desired.</p>\n<p>For example, to configure Outlook to access an Exchange mailbox, you have to create an Outlook profile and in that Outlook profile, you have to specify the Exchange Server name (which most users do not know), you have to specify username and password. That’s not all, because almost all the users in the HMC environment comes from Internet, the Exchange Server Name is not resolvable and that we have to provide the configuration of RPC over HTTP so that it can utilize the RPC Proxy to access the Exchange server from Internet.</p>\n<p>If that doesn’t sound complicated enough, Outlook 2007 and Exchange 2007 enhanced some of the features by introducing querying and accessing web services for some of the features such as Availability Services, Out-of-Office service and Unified Messaging service. OAB web distribution was also introduced to replace the old OAB distribution method through Public Folder. All these features mean Outlook 2007 now has to know more URLs or configurations to access those services.</p>\n<p>Now, this is only for Outlook, what about my Windows Mobile Devices? What about Entourage clients? What about devices that can utilize ActiveSync other than Windows Mobile, such as iPhone?</p>\n<p>While the above sounded complicated, we do have some good news for you.</p>\n<ul>\n<li>Firstly, those shared infrastructure such as Exchange Web Services for Availability Services, Out-of-Office, Unified Messaging services DO NOT need any isolation or segregation. So no tweaking is required. Out of the box, those services enforce authentication (making sure that only authorized users can access the shared infrastructure) and it knows what security context to use when retrieving information or setting information (making sure that users can make changes or retrieve information ONLY if they have been granted the permission).</li>\n<li>Secondly, for all the complications introduced by Outlook 2007, we now have a feature called Autodiscover that hide those complications and make things easier.<br>The not good news is this, Autodiscover doesn’t just work out of the box in HMC environment, it has to be configured for each domain introduced by the tenant and it may not work in some situations. We will explore that in this blog.</li>\n</ul>\n<p><span style=\"text-decoration: underline;\">(1) Outlook 2003</span></p>\n<p>Outlook has come a long way. However, if you look at Outlook profile creation and configurations, we haven’t changed much. It looks almost the same since the birth of Outlook.</p>\n<p>The Good: Once you have configured the Outlook client, it is pretty self-contained; all it needs is to access the mailbox server, it will then know where to locate the free/busy, set the OOF, and find the public folder and OABs. It doesn’t need to access any other URLs (such as Availability Services, Web Distribution OABs and etc.).</p>\n<p>The Bad: The client has no logic built in to automatically detect the client configuration needed to access the mailbox. In addition, it also does not have access to some of the new features introduced in Exchange 2007 like Internal and External OOF, UM and enjoy the real-time free/busy capability from Availability Services.</p>\n<p>Solutions for easier profile configurations: Install the RPC over HTTP Client Configuration Web site. This site will allow the user to authenticate and then download their PRF file that has been populated with all the information they need to configure their Outlook.</p>\n<p><span style=\"text-decoration: underline;\">(2) Outlook 2007</span></p>\n<p>Outlook 2007 becomes slightly more complicated. The fact that it introduces the concept of Exchange Web services being accessed by Outlook directly means that now Outlook 2007 needs to know how to get to those web services. The answer to all these is a feature called Autodiscover.</p>\n<p>Autodiscover has changed things quite a fair bit and for those are interested to know more, you can read this <a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\" target=\"_blank\" rel=\"external\">White Paper: Exchange 2007 Autodiscover Service</a> as I don’t intend to spend much time talking about the working which has been well covered by this white paper.</p>\n<p>In a corporate environment, Microsoft Office Outlook 2007 clients locate an Autodiscover service running on a Client Access Server by directly querying the Active Directory directory service and locating relevant Service Connection Points (SCPs). However, as we know most of the users in the HMC environment aren’t part of the HMC Windows domain and also they are accessing the service from the Internet.</p>\n<p>For Internet users, Outlook 2007 will attempt to locate and connect to an Autodiscover service based on the e-mail domain of the user. For example, for the user johnc@alpineskihouse.com, Outlook 2007 will automatically try to connect to the following URLs in turn:</p>\n<ul>\n<li><a href=\"https://alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">https://alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">https://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li><a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a></li>\n<li>And if all those failed, it will try to use DNS SRV records. However, this is only if the Outlook Clients have been updated with the appropriate rollup. A new feature is available that enables Outlook 2007 to use DNS Service Location (SRV) records to locate the Exchange Autodiscover service <a href=\"http://support.microsoft.com/kb/940881\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/940881</a><br>The logic to form the URLs above is built into Outlook 2007, we can’t really change that and it has to go according to that sequence. Now, obviously that can present a problem in a HMC environment. Why?</li>\n</ul>\n<p>The first 2 URLs are SSL. When SSL is required, we must make sure that a valid security certificate is installed for the Web site that matches the site name. So, this can be a problem for HMC environment because it will be madness and totally impractical to have 10,000 unique valid security certificate for all the 10,000 domains hosted by your environment. Not to mention you may need many IP addresses and website just to cater for that.</p>\n<p>This is where the 3rd URL, which is only a HTTP redirection, comes in. It redirects the Outlook to another HTTPS Autodiscover URL. That’s the reason why you see in the Deployment Guide, we have to create an additional Web site in IIS just to do this redirection.</p>\n<p>There are some customers who attempted to use CNAME rather than the redirect, meaning just point autodiscover.alpineskihouse.com to autodiscover.consolidatedmessenger.com, this will fail because the security certificate cannot be properly validated. A redirection is a must.</p>\n<p>In order for Outlook to go to<a href=\"http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml\" target=\"_blank\" rel=\"external\">http://autodiscover.alpineskihouse.com/autodiscover/autodiscover.xml</a> and get redirected, you must do 2 things,</p>\n<ul>\n<li><strong>DNS</strong> - Configure autodiscover.alpineskihouse to point to the HTTP redirect website or IP address.</li>\n<li><strong>Autodiscover.xml</strong> - your HTTP redirect website must be able to respond to /autodiscover/autodiscover.xml and then redirect them to actual HMC autodiscover HTTPS website.<br>Of course, you can also do the SRV record. The only concerns for this is that the Outlook 2007 has to be properly updated before it can enjoy this new features and also we have seen many customers do not do the SRV record correctly. I kind of like the idea that you put both the HTTP redirect as well as the DNS SRV record there so that in the event where the HTTP redirect website is down, Outlook 2007 could continue to function well.</li>\n</ul>\n<p>One thing you should also know is that Autodiscover is not only used during the profile setup, it is also being used each time you query any of the web services, such as availability services or OOF.</p>\n<p><span style=\"text-decoration: underline;\">(3) Other Clients</span></p>\n<p>What about other clients? As you can see, the deployment of the Autodiscover functions very much depends on the client. If the client does not support, say HTTP redirect or the SRV record, then Autodiscover in HMC environment will fail. One example is iPhone. IPhone does not support HTTP redirect or the SRV record. Hence, the auto account configuration may not work in those clients until they have updated the clients.</p>\n<p><strong>Troubleshooting tips for Autodiscover in Multi-tenancy environment</strong></p>\n<p>I find that most of the Autodiscover problems in HMC can be categorized into the following,</p>\n<ul>\n<li>Deployment problem - the Autodiscover not being configured correctly. It is extremely important that you set this correctly such as what the externalurl, the HTTP redirect and etc. Do run through the configurations again.</li>\n<li>Certificates problem - it is important to understand the usage of SSL certificate in Autodiscover and also other Exchange web services. Currently, the best reference is this, <a href=\"http://technet.microsoft.com/en-us/library/bb332063.aspx\" target=\"_blank\" rel=\"external\">White Paper: Exchange 2007 Autodiscover Service</a></li>\n<li>DNS configuration issue - because Outlook depends on DNS to locate the Autodiscover service, DNS needs to be configured correctly.</li>\n<li>Firewall or Network Connectivity Issues - Publishing the SSL, the Autodiscover service and etc. can be a challenge too sometimes.</li>\n</ul>\n"},{"title":"HMC4.5 is out!","date":"2008-06-15T05:38:45.000Z","_content":"\nFinally released!! Waiting so long...\nHere is the link for the docs and sample code etc\n\n[Solution for Hosted Messaging and Collaboration v4.5](https://technet.microsoft.com/en-us/library/cc526352.aspx)\n\nHere is the ~~[link](http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en)~~ for the updated SDK doc.\n\n**Use HMC 4.5 to address several critical customer scenarios, including:**\n\nMessaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.\n\nDirect, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way--for example, by instant messaging, a phone call, or a video conference.\n\nSecure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer's preferred avenue for effective teamwork and content exchange.\n\nThe table below highlights the advantages of the key elements of HMC 4.5.\n","source":"_posts/hmc-45-is-out.md","raw":"---\ntitle: HMC4.5 is out!\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-06-15 13:38:45\n---\n\nFinally released!! Waiting so long...\nHere is the link for the docs and sample code etc\n\n[Solution for Hosted Messaging and Collaboration v4.5](https://technet.microsoft.com/en-us/library/cc526352.aspx)\n\nHere is the ~~[link](http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en)~~ for the updated SDK doc.\n\n**Use HMC 4.5 to address several critical customer scenarios, including:**\n\nMessaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.\n\nDirect, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way--for example, by instant messaging, a phone call, or a video conference.\n\nSecure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer's preferred avenue for effective teamwork and content exchange.\n\nThe table below highlights the advantages of the key elements of HMC 4.5.\n","slug":"hmc-45-is-out","published":1,"updated":"2017-06-16T09:14:02.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxt001n4gyruleef59i","content":"<p>Finally released!! Waiting so long…<br>Here is the link for the docs and sample code etc</p>\n<p><a href=\"https://technet.microsoft.com/en-us/library/cc526352.aspx\" target=\"_blank\" rel=\"external\">Solution for Hosted Messaging and Collaboration v4.5</a></p>\n<p>Here is the <del><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en\" target=\"_blank\" rel=\"external\">link</a></del> for the updated SDK doc.</p>\n<p><strong>Use HMC 4.5 to address several critical customer scenarios, including:</strong></p>\n<p>Messaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.</p>\n<p>Direct, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way–for example, by instant messaging, a phone call, or a video conference.</p>\n<p>Secure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer’s preferred avenue for effective teamwork and content exchange.</p>\n<p>The table below highlights the advantages of the key elements of HMC 4.5.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Finally released!! Waiting so long…<br>Here is the link for the docs and sample code etc</p>\n<p><a href=\"https://technet.microsoft.com/en-us/library/cc526352.aspx\" target=\"_blank\" rel=\"external\">Solution for Hosted Messaging and Collaboration v4.5</a></p>\n<p>Here is the <del><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyId=CE3FC537-86AE-4802-9A05-43E2A27A4B45&amp;displaylang=en\" target=\"_blank\" rel=\"external\">link</a></del> for the updated SDK doc.</p>\n<p><strong>Use HMC 4.5 to address several critical customer scenarios, including:</strong></p>\n<p>Messaging and management of e-mail messages, attachments, and business tasks. HMC 4.5 lets you extend your reach to SMB customers, small office and home office customers, and even individuals. Services can range from reliable, scalable e-mail functionality to additional storage, shared calendars and contacts, and hosting of personal domains.</p>\n<p>Direct, multichannel communications. Using the contact information stored in Microsoft Active Directory®, Microsoft Office Communications Server 2007 manages all communications, including e-mail, instant messaging, audio, video, Web conferencing, and PC-to-PC calling. Office Communications Server 2007 enables presence, so people can determine whether others are available before contacting them in the most practical way–for example, by instant messaging, a phone call, or a video conference.</p>\n<p>Secure, productive collaboration and sharing of digital assets. Windows SharePoint Services gives you a way to host team Web sites that can become a customer’s preferred avenue for effective teamwork and content exchange.</p>\n<p>The table below highlights the advantages of the key elements of HMC 4.5.</p>\n"},{"title":"HMC 4.5 Rollup 1","date":"2008-11-20T13:31:10.000Z","_content":"\n[http://support.microsoft.com/kb/957583](http://support.microsoft.com/kb/957583)\n\nMicrosoft has released an update that is dated October 8, 2008\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   ActiveDirectoryProvider.msi\n*   Exchange2007Provider.msi\n*   DNSProvider.msi\n*   HostedActiveDirectoryNS.msi\n*   HostedActiveDirectoryWS.msi\n*   RPCHttpConfigTool.msi\n*   pwdb40ssis.msi\n*   DNSClient.msi\n\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   CategorizerOverrideAgent-x64.msi\n*   SmtpDomainCacheTask-x64.msi\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.\n*   An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a **Get-AcceptedDomain** command.\n*   Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.\n*   When you run an \"Import Data from PlanManager to PWDB40\" SQL agent job, some error messages are logged on the Log File viewer.\n*   When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the **DescriptiveText** property that is required to create a Microsoft DNS_TXT Type..\n*   The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.\n*   A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.","source":"_posts/hmc-45-rollup-1.md","raw":"---\ntitle: HMC 4.5 Rollup 1\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-11-20 21:31:10\n---\n\n[http://support.microsoft.com/kb/957583](http://support.microsoft.com/kb/957583)\n\nMicrosoft has released an update that is dated October 8, 2008\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   ActiveDirectoryProvider.msi\n*   Exchange2007Provider.msi\n*   DNSProvider.msi\n*   HostedActiveDirectoryNS.msi\n*   HostedActiveDirectoryWS.msi\n*   RPCHttpConfigTool.msi\n*   pwdb40ssis.msi\n*   DNSClient.msi\n\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   CategorizerOverrideAgent-x64.msi\n*   SmtpDomainCacheTask-x64.msi\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.\n*   An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a **Get-AcceptedDomain** command.\n*   Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.\n*   When you run an \"Import Data from PlanManager to PWDB40\" SQL agent job, some error messages are logged on the Log File viewer.\n*   When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the **DescriptiveText** property that is required to create a Microsoft DNS_TXT Type..\n*   The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.\n*   A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.","slug":"hmc-45-rollup-1","published":1,"updated":"2017-06-16T09:14:10.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxu001q4gyrlhnksfnd","content":"<p><a href=\"http://support.microsoft.com/kb/957583\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/957583</a></p>\n<p>Microsoft has released an update that is dated October 8, 2008. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li>ActiveDirectoryProvider.msi</li>\n<li>Exchange2007Provider.msi</li>\n<li>DNSProvider.msi</li>\n<li>HostedActiveDirectoryNS.msi</li>\n<li>HostedActiveDirectoryWS.msi</li>\n<li>RPCHttpConfigTool.msi</li>\n<li>pwdb40ssis.msi</li>\n<li>DNSClient.msi</li>\n</ul>\n<p>Additionally, this update also includes native 64-bit versions of the following components:</p>\n<ul>\n<li>CategorizerOverrideAgent-x64.msi</li>\n<li>SmtpDomainCacheTask-x64.msi</li>\n</ul>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.</li>\n<li>An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a <strong>Get-AcceptedDomain</strong> command.</li>\n<li>Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.</li>\n<li>When you run an “Import Data from PlanManager to PWDB40” SQL agent job, some error messages are logged on the Log File viewer.</li>\n<li>When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the <strong>DescriptiveText</strong> property that is required to create a Microsoft DNS_TXT Type..</li>\n<li>The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.</li>\n<li>A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"http://support.microsoft.com/kb/957583\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/957583</a></p>\n<p>Microsoft has released an update that is dated October 8, 2008. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li>ActiveDirectoryProvider.msi</li>\n<li>Exchange2007Provider.msi</li>\n<li>DNSProvider.msi</li>\n<li>HostedActiveDirectoryNS.msi</li>\n<li>HostedActiveDirectoryWS.msi</li>\n<li>RPCHttpConfigTool.msi</li>\n<li>pwdb40ssis.msi</li>\n<li>DNSClient.msi</li>\n</ul>\n<p>Additionally, this update also includes native 64-bit versions of the following components:</p>\n<ul>\n<li>CategorizerOverrideAgent-x64.msi</li>\n<li>SmtpDomainCacheTask-x64.msi</li>\n</ul>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When more than one user has the same common name (CN) attribute, a server error is returned to the end-user from the RPCHTTPConfig Web site.</li>\n<li>An OutOfMemoryException exception is returned from the Exchange2007Provider component when you run a <strong>Get-AcceptedDomain</strong> command.</li>\n<li>Multiple issues occur with the Microsoft Exchange 2007 Out Of Office (OOF) agent.</li>\n<li>When you run an “Import Data from PlanManager to PWDB40” SQL agent job, some error messages are logged on the Log File viewer.</li>\n<li>When you try to create a TXT record by using the HMC DNS Provider, the HMC DNS Provider does not pass the <strong>DescriptiveText</strong> property that is required to create a Microsoft DNS_TXT Type..</li>\n<li>The Hosted Active Directory Web Service could not set the &lt;properties&gt; element of the CreateUser component through the Web Service class library.</li>\n<li>A Hosted Active Directory Web Service exception is thrown when the process reads the response of the CreateIIWResellerOrganization component by using the Web service proxy class.</li>\n</ul>\n"},{"title":"HMC 4.5 Update Rollup 3 has been released","date":"2009-05-27T04:49:43.000Z","_content":"\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/?id=969820](http://support.microsoft.com/?id=969820)\n\nHere is a brief description on what is included in this Rollup 3. This isn't a big update. It consists of,\n\n*   All the updates in HMC 4.5 Rollup 2 and,\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.\n*   Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5","source":"_posts/hmc-45-update-rollup-3-has-been-released.md","raw":"---\ntitle: HMC 4.5 Update Rollup 3 has been released\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-05-27 12:49:43\n---\n\nDescription of Update Rollup 3 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/?id=969820](http://support.microsoft.com/?id=969820)\n\nHere is a brief description on what is included in this Rollup 3. This isn't a big update. It consists of,\n\n*   All the updates in HMC 4.5 Rollup 2 and,\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.\n*   Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5","slug":"hmc-45-update-rollup-3-has-been-released","published":1,"updated":"2017-06-16T09:14:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jxw001u4gyrt3bdxxx2","content":"<p>Description of Update Rollup 3 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/?id=969820\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=969820</a></p>\n<p>Here is a brief description on what is included in this Rollup 3. This isn’t a big update. It consists of,</p>\n<ul>\n<li><p>All the updates in HMC 4.5 Rollup 2 and,<br>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n</li>\n<li><p>When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.</p>\n</li>\n<li>Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Description of Update Rollup 3 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/?id=969820\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=969820</a></p>\n<p>Here is a brief description on what is included in this Rollup 3. This isn’t a big update. It consists of,</p>\n<ul>\n<li><p>All the updates in HMC 4.5 Rollup 2 and,<br>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n</li>\n<li><p>When you create a Public folder, useDatabaseQuotaDefaults is automatically set to true.</p>\n</li>\n<li>Exchange 2007 Resource Manager::DeallocateConsumerUserMailbox did not flush all candidates in HMC 4.5</li>\n</ul>\n"},{"title":"HMC 4.5 Update Rollup 5 has been released","date":"2010-03-02T11:06:18.000Z","_content":"\nDescription of Update Rollup 5 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/977174/en-us](http://support.microsoft.com/kb/977174/en-us)\n\nMicrosoft has released an update that is dated October 30, 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.\n\n*   ResourceManageDatabase.msi\n*   Exchange2007ResourceManagerWS.msi\n*   HostedSharePoint2007WS.msi\n*   Exchange2007ResourceManagerNS.msi\n*   HostedSharePoint2007NS.msi\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.\n*   The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.\n*   The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.\n*   The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.\n*   The CreateUser procedure in the Hosted Active Directory namespace may return the error \" there is no such object on the server\" if the Organization is renamed.\n*   Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.\n*   SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.\n*   Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.\n*   Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.\n*   Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the 'level' algorithm for 'not shared' mail stores.\n*   Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter 'shared.'","source":"_posts/hmc-45-update-rollup-5-has-been-released.md","raw":"---\ntitle: HMC 4.5 Update Rollup 5 has been released\ntags:\n  - Exchange\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2010-03-02 19:06:18\n---\n\nDescription of Update Rollup 5 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/977174/en-us](http://support.microsoft.com/kb/977174/en-us)\n\nMicrosoft has released an update that is dated October 30, 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.\n\n*   ResourceManageDatabase.msi\n*   Exchange2007ResourceManagerWS.msi\n*   HostedSharePoint2007WS.msi\n*   Exchange2007ResourceManagerNS.msi\n*   HostedSharePoint2007NS.msi\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.\n*   The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.\n*   The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.\n*   The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.\n*   The CreateUser procedure in the Hosted Active Directory namespace may return the error \" there is no such object on the server\" if the Organization is renamed.\n*   Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.\n*   SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.\n*   Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.\n*   Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.\n*   Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the 'level' algorithm for 'not shared' mail stores.\n*   Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter 'shared.'","slug":"hmc-45-update-rollup-5-has-been-released","published":1,"updated":"2017-06-16T09:14:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jy2001y4gyr189uw56n","content":"<p>Description of Update Rollup 5 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/977174/en-us\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/977174/en-us</a></p>\n<p>Microsoft has released an update that is dated October 30, 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.</p>\n<ul>\n<li>ResourceManageDatabase.msi</li>\n<li>Exchange2007ResourceManagerWS.msi</li>\n<li>HostedSharePoint2007WS.msi</li>\n<li>Exchange2007ResourceManagerNS.msi</li>\n<li>HostedSharePoint2007NS.msi</li>\n</ul>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.</li>\n<li>The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.</li>\n<li>The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.</li>\n<li>The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.</li>\n<li>The CreateUser procedure in the Hosted Active Directory namespace may return the error “ there is no such object on the server” if the Organization is renamed.</li>\n<li>Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.</li>\n<li>SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.</li>\n<li>Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.</li>\n<li>Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.</li>\n<li>Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the ‘level’ algorithm for ‘not shared’ mail stores.</li>\n<li>Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter ‘shared.’</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Description of Update Rollup 5 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/977174/en-us\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/977174/en-us</a></p>\n<p>Microsoft has released an update that is dated October 30, 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.5 and includes all fixes released in previous rollup packages RU1, RU2, RU3 andRU4.</p>\n<ul>\n<li>ResourceManageDatabase.msi</li>\n<li>Exchange2007ResourceManagerWS.msi</li>\n<li>HostedSharePoint2007WS.msi</li>\n<li>Exchange2007ResourceManagerNS.msi</li>\n<li>HostedSharePoint2007NS.msi</li>\n</ul>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>The SetUMServer procedure in the Unified Messaging 2007 Provider may fail if you specify more than one value in the dialPlans property (it only fails if at least one of the dialPlan values contains a space character.</li>\n<li>The DeleteResourceRecord procedure in the DNS Provider may run for a long time or time out if there arelots of records in the zone.</li>\n<li>The GetDNSZone procedure in the DNS Providerreturns the zone properties only The GetDNSZone procedure does not return the Resource Records.</li>\n<li>The Active Directory Collector job may throw an exception if it finds lots of records to return. This might occur if for example, there are lots of new entries in Active Directory since the PWDB was last updated.</li>\n<li>The CreateUser procedure in the Hosted Active Directory namespace may return the error “ there is no such object on the server” if the Organization is renamed.</li>\n<li>Documentation Issue: In the deployment walkthrough for Server 2008 the procedure DW08-DWHE.70 states an incorrect autodiscovery URL.</li>\n<li>SharePoint Service Pointer in AD can be orphaned if a Site Collection Administrator deletes a site or sub-site from the SharePoint Administration Interface instead of using MPS.</li>\n<li>Exchange2007Resource Manager: Excessive Run Times When Calling FindAutoAllocateOrgMailStores_ With a Large Number of Mail Stores.</li>\n<li>Exchange2007ResourceManager:Allocate cannot use level algorithm for the first mailbox as specified in the organization Plan.</li>\n<li>Exchange2007ResourceManager:ReallocateOrganizationMailNoMove cannot reallocate organization correctly when you use the ‘level’ algorithm for ‘not shared’ mail stores.</li>\n<li>Exchange2007ResourceManager:AllocateOrganization fail when you use optional parameter ‘shared.’</li>\n</ul>\n"},{"title":"HMC 4.5 Update Rollup 6 has been released","date":"2010-03-02T11:10:50.000Z","_content":"\nDescription of Update Rollup 6 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/979704](http://support.microsoft.com/kb/979704)\n\nMicrosoft has released an update that is dated December 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   Exchange 2007 Mobility Provider\n**In order to get Exchange 2007 SP2 supported, do install this UR.**\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.\n*   When a public folder is created by using the \"-StorageQuota\" and \"-postStorageQuota\", the operation fail.This is because the two parameters was replaced by the parameters \"-IssueWarningQuota\" and \"-ProhibitPostQuota\" in the Exchange SP2.\n*   An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.\n*   If an organization allocated a \"not shared\" mailstore, it cannot reallocate on the same mailstore.\n\n#### Prerequisites\n\n*   Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.\n*   The logon user should be a member of the Domain Admins Group.\n*   The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.\n*   **Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.**\nHotfix replacement information\nThis rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.","source":"_posts/hmc-45-update-rollup-6-has-been-released.md","raw":"---\ntitle: HMC 4.5 Update Rollup 6 has been released\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2010-03-02 19:10:50\n---\n\nDescription of Update Rollup 6 for Hosted Messaging and Collaboration 4.5\n\n[http://support.microsoft.com/kb/979704](http://support.microsoft.com/kb/979704)\n\nMicrosoft has released an update that is dated December 2009\\. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.\n\n*   Exchange 2007 Resource Manager Namespace\n*   Exchange 2007 Resource Manager Web Services\n*   Hosted Email 2007 Namespace\n*   Hosted Email 2007 Web Services\n*   Managed Email 2007 Namespace\n*   Managed Email 2007 Web Services\n*   Exchange 2007 Mobility Provider\n*   Exchange 2007 Provider\n*   Unified Messaging 2007 Provider\nAdditionally, this update also includes native 64-bit versions of the following components:\n\n*   Exchange 2007 Mobility Provider\n**In order to get Exchange 2007 SP2 supported, do install this UR.**\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.\n*   When a public folder is created by using the \"-StorageQuota\" and \"-postStorageQuota\", the operation fail.This is because the two parameters was replaced by the parameters \"-IssueWarningQuota\" and \"-ProhibitPostQuota\" in the Exchange SP2.\n*   An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.\n*   If an organization allocated a \"not shared\" mailstore, it cannot reallocate on the same mailstore.\n\n#### Prerequisites\n\n*   Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.\n*   The logon user should be a member of the Domain Admins Group.\n*   The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.\n*   **Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.**\nHotfix replacement information\nThis rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.","slug":"hmc-45-update-rollup-6-has-been-released","published":1,"updated":"2017-06-16T09:14:54.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jy800224gyrs5zvas0a","content":"<p>Description of Update Rollup 6 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/979704\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/979704</a></p>\n<p>Microsoft has released an update that is dated December 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li>Exchange 2007 Resource Manager Namespace</li>\n<li>Exchange 2007 Resource Manager Web Services</li>\n<li>Hosted Email 2007 Namespace</li>\n<li>Hosted Email 2007 Web Services</li>\n<li>Managed Email 2007 Namespace</li>\n<li>Managed Email 2007 Web Services</li>\n<li>Exchange 2007 Mobility Provider</li>\n<li>Exchange 2007 Provider</li>\n<li><p>Unified Messaging 2007 Provider<br>Additionally, this update also includes native 64-bit versions of the following components:</p>\n</li>\n<li><p>Exchange 2007 Mobility Provider<br><strong>In order to get Exchange 2007 SP2 supported, do install this UR.</strong></p>\n</li>\n</ul>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.</li>\n<li>When a public folder is created by using the “-StorageQuota” and “-postStorageQuota”, the operation fail.This is because the two parameters was replaced by the parameters “-IssueWarningQuota” and “-ProhibitPostQuota” in the Exchange SP2.</li>\n<li>An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.</li>\n<li>If an organization allocated a “not shared” mailstore, it cannot reallocate on the same mailstore.</li>\n</ul>\n<h4 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h4><ul>\n<li>Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.</li>\n<li>The logon user should be a member of the Domain Admins Group.</li>\n<li>The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.</li>\n<li><strong>Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.</strong><br>Hotfix replacement information<br>This rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Description of Update Rollup 6 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/979704\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/979704</a></p>\n<p>Microsoft has released an update that is dated December 2009. This update fixes issues in the following components in Microsoft Solution for Hosted Messaging and Collaboration 4.5.</p>\n<ul>\n<li>Exchange 2007 Resource Manager Namespace</li>\n<li>Exchange 2007 Resource Manager Web Services</li>\n<li>Hosted Email 2007 Namespace</li>\n<li>Hosted Email 2007 Web Services</li>\n<li>Managed Email 2007 Namespace</li>\n<li>Managed Email 2007 Web Services</li>\n<li>Exchange 2007 Mobility Provider</li>\n<li>Exchange 2007 Provider</li>\n<li><p>Unified Messaging 2007 Provider<br>Additionally, this update also includes native 64-bit versions of the following components:</p>\n</li>\n<li><p>Exchange 2007 Mobility Provider<br><strong>In order to get Exchange 2007 SP2 supported, do install this UR.</strong></p>\n</li>\n</ul>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>When a folder is created, the value of folder allocation is not consistent with StorageQuota calculation result.</li>\n<li>When a public folder is created by using the “-StorageQuota” and “-postStorageQuota”, the operation fail.This is because the two parameters was replaced by the parameters “-IssueWarningQuota” and “-ProhibitPostQuota” in the Exchange SP2.</li>\n<li>An overflow exception occurs when allocating 2Terra bytes or above mailbox space to an organization. This is because the maximum mailbox space that can be allocated to an organization lower than 2Terra bytes.</li>\n<li>If an organization allocated a “not shared” mailstore, it cannot reallocate on the same mailstore.</li>\n</ul>\n<h4 id=\"Prerequisites\"><a href=\"#Prerequisites\" class=\"headerlink\" title=\"Prerequisites\"></a>Prerequisites</h4><ul>\n<li>Hosted Messaging and Collaboration version 4.5 must be installed before you apply this update.</li>\n<li>The logon user should be a member of the Domain Admins Group.</li>\n<li>The HMC Deployment Tool must be installed on the first Microsoft Provisioning Server (MPS) Engine server.</li>\n<li><strong>Microsoft Exchange Server 2007 Service Pack 2 must be installed before you apply this update.</strong><br>Hotfix replacement information<br>This rollup replaces the previously released RU1, RU2, RU3, RU4 and RU5.</li>\n</ul>\n"},{"title":"HMC 4.5 UR 2 has been released.","date":"2009-02-18T14:53:47.000Z","_content":"\n**Description of Update Rollup 2 for Hosted Messaging and Collaboration 4.5**\n\n[http://support.microsoft.com/?id=957584](http://support.microsoft.com/?id=957584)\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues:\n\n[957583](http://support.microsoft.com/kb/957583/) Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5\n\n[957003 ](http://support.microsoft.com/kb/957003/) The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0\n\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   You receive the following failure exception when you attempt to create a Resource Mailbox:\n* The recipient '&lt;UPN of Recipient&gt;' does not have access permission to the specified resource mailbox.\n*   The ChangeOrganizationPlan\n*   Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\nUnable to create 'cn=FolderAdmins@Hostedorg...', object already exists\n\nThis error may occur if the hosted organization uses Public Folders.\n*   The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\n\n`E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND`\n\n*   The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the **NumberOfDigitsInExtension** parameter to the range of 3 to 7\\. The correct range is 1 to 20.\n*   A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.\n*   The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.\n*   Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.\n*   The health of a server may not be accurately updated by the Hosted Service Monitor procedures.","source":"_posts/hmc-45-ur-2-has-been-released.md","raw":"---\ntitle: HMC 4.5 UR 2 has been released.\ntags:\n  - HMC\n  - Rollup\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-02-18 22:53:47\n---\n\n**Description of Update Rollup 2 for Hosted Messaging and Collaboration 4.5**\n\n[http://support.microsoft.com/?id=957584](http://support.microsoft.com/?id=957584)\n\n### Issues that the update rollup fixes\n\nThis update rollup fixes the following issues:\n\n[957583](http://support.microsoft.com/kb/957583/) Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5\n\n[957003 ](http://support.microsoft.com/kb/957003/) The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0\n\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n*   You receive the following failure exception when you attempt to create a Resource Mailbox:\n* The recipient '&lt;UPN of Recipient&gt;' does not have access permission to the specified resource mailbox.\n*   The ChangeOrganizationPlan\n*   Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\nUnable to create 'cn=FolderAdmins@Hostedorg...', object already exists\n\nThis error may occur if the hosted organization uses Public Folders.\n*   The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:\n\n`E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND`\n\n*   The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the **NumberOfDigitsInExtension** parameter to the range of 3 to 7\\. The correct range is 1 to 20.\n*   A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.\n*   The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.\n*   Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.\n*   The health of a server may not be accurately updated by the Hosted Service Monitor procedures.","slug":"hmc-45-ur-2-has-been-released","published":1,"updated":"2017-06-16T09:15:04.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jy900264gyr5p05wzrc","content":"<p><strong>Description of Update Rollup 2 for Hosted Messaging and Collaboration 4.5</strong></p>\n<p><a href=\"http://support.microsoft.com/?id=957584\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=957584</a></p>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues:</p>\n<p><a href=\"http://support.microsoft.com/kb/957583/\" target=\"_blank\" rel=\"external\">957583</a> Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/957003/\" target=\"_blank\" rel=\"external\">957003 </a> The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>You receive the following failure exception when you attempt to create a Resource Mailbox:</li>\n<li>The recipient ‘&lt;UPN of Recipient&gt;’ does not have access permission to the specified resource mailbox.</li>\n<li>The ChangeOrganizationPlan</li>\n<li>Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:<br>Unable to create ‘cn=FolderAdmins@Hostedorg…’, object already exists</li>\n</ul>\n<p>This error may occur if the hosted organization uses Public Folders.</p>\n<ul>\n<li>The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:</li>\n</ul>\n<p><code>E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND</code></p>\n<ul>\n<li>The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the <strong>NumberOfDigitsInExtension</strong> parameter to the range of 3 to 7. The correct range is 1 to 20.</li>\n<li>A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.</li>\n<li>The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.</li>\n<li>Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.</li>\n<li>The health of a server may not be accurately updated by the Hosted Service Monitor procedures.</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>Description of Update Rollup 2 for Hosted Messaging and Collaboration 4.5</strong></p>\n<p><a href=\"http://support.microsoft.com/?id=957584\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/?id=957584</a></p>\n<h3 id=\"Issues-that-the-update-rollup-fixes\"><a href=\"#Issues-that-the-update-rollup-fixes\" class=\"headerlink\" title=\"Issues that the update rollup fixes\"></a>Issues that the update rollup fixes</h3><p>This update rollup fixes the following issues:</p>\n<p><a href=\"http://support.microsoft.com/kb/957583/\" target=\"_blank\" rel=\"external\">957583</a> Description of Update Rollup 1 for Hosted Messaging and Collaboration 4.5</p>\n<p><a href=\"http://support.microsoft.com/kb/957003/\" target=\"_blank\" rel=\"external\">957003 </a> The RenameUser method does not change the samAccountName attribute in Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<ul>\n<li>You receive the following failure exception when you attempt to create a Resource Mailbox:</li>\n<li>The recipient ‘&lt;UPN of Recipient&gt;’ does not have access permission to the specified resource mailbox.</li>\n<li>The ChangeOrganizationPlan</li>\n<li>Assignment procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:<br>Unable to create ‘cn=FolderAdmins@Hostedorg…’, object already exists</li>\n</ul>\n<p>This error may occur if the hosted organization uses Public Folders.</p>\n<ul>\n<li>The CreateMailbox procedure in the Hosted Email 2007 Namespace fails with an error message that resembles the following:</li>\n</ul>\n<p><code>E_BLOCKMODEL_NO_RANKED_RESOURCES_FOUND</code></p>\n<ul>\n<li>The NewUMDialPlan procedure in the Managed Unified Messaging 2007 Namespace restricts the value of the <strong>NumberOfDigitsInExtension</strong> parameter to the range of 3 to 7. The correct range is 1 to 20.</li>\n<li>A failure in a CreateMailbox procedure may result in inaccurate data in Exchange Resource Manager.</li>\n<li>The SmtpDomainCache task logs a success (0x0) status in Scheduled Tasks even if it fails.</li>\n<li>Some of the memory that the Exchange 2007 Provider consumes is not released as quickly as it should be.</li>\n<li>The health of a server may not be accurately updated by the Hosted Service Monitor procedures.</li>\n</ul>\n"},{"title":"HMC Resource Management - Part 1 - PlanManager and ResourceManager - Overall Concept","date":"2009-10-25T04:07:28.000Z","_content":"\nThis article was original posted by Kip.Ng on http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\n\nI believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.\n\nSince then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,\n\n1. PlanManager and ResourceManager - Overall Concept\n2. HMC Resource Management and Active Directory\n3. HMC Resource Management and Exchange\n4. HMC Resource Management and Windows SharePoint Services\n5.  HMC Resource Management and Office Communication Servers\n\nThe aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.\n\nMy objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.\n\nLet's get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.\n\nWhen you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.\n\nThe first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.\n\nFor now, we will discuss about the last 2 databases, PlanManager and ResourceManager.\n\n**PlanManager Database**\n\nPlanManager used to be called HeCustomerDB in HMC 3.5\\. While, the concept hasn't changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.\n\nPlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,\n\n1.  Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.\n2. Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.\n3. Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.\n4. Plan Assignment. It also consists of what plans are those organizations assigned to.\n \nI think it should also be noted that you can further 'extend' the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.\n\n**ResourceManager Database**\n\nResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.\n\nAs I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.\n\nResourceManager, on a high level has the following,\n\n1. Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.\n2. Public Folder Stores and their sizes.\n3. OAB Servers.\n4. Public Folder allocation for each organization.\n5. Organization's OAB assignment\n6. Organizations and their allocated size.\n7. Organizations and their assigned mail stores.\n8. Individual mailbox and the mailbox size assigned to them.\n\nNow, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month ([http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)](http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)\n\nThere you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.  I believe once you understand what's in the databases, you will find that it isn't that bad at all.","source":"_posts/hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept.md","raw":"---\ntitle: HMC Resource Management - Part 1 - PlanManager and ResourceManager - Overall Concept\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-10-25 12:07:28\n---\n\nThis article was original posted by Kip.Ng on http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\n\nI believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.\n\nSince then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,\n\n1. PlanManager and ResourceManager - Overall Concept\n2. HMC Resource Management and Active Directory\n3. HMC Resource Management and Exchange\n4. HMC Resource Management and Windows SharePoint Services\n5.  HMC Resource Management and Office Communication Servers\n\nThe aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.\n\nMy objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.\n\nLet's get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.\n\nWhen you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.\n\nThe first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.\n\nFor now, we will discuss about the last 2 databases, PlanManager and ResourceManager.\n\n**PlanManager Database**\n\nPlanManager used to be called HeCustomerDB in HMC 3.5\\. While, the concept hasn't changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.\n\nPlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,\n\n1.  Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.\n2. Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.\n3. Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.\n4. Plan Assignment. It also consists of what plans are those organizations assigned to.\n \nI think it should also be noted that you can further 'extend' the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.\n\n**ResourceManager Database**\n\nResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.\n\nAs I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.\n\nResourceManager, on a high level has the following,\n\n1. Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.\n2. Public Folder Stores and their sizes.\n3. OAB Servers.\n4. Public Folder allocation for each organization.\n5. Organization's OAB assignment\n6. Organizations and their allocated size.\n7. Organizations and their assigned mail stores.\n8. Individual mailbox and the mailbox size assigned to them.\n\nNow, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month ([http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)](http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)\n\nThere you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.  I believe once you understand what's in the databases, you will find that it isn't that bad at all.","slug":"hmc-resource-management-part1-planmanager-and-resourcemanager-overall-concept","published":1,"updated":"2017-06-16T12:42:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyb00294gyrhh781qhy","content":"<p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a></p>\n<p>I believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.</p>\n<p>Since then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,</p>\n<ol>\n<li>PlanManager and ResourceManager - Overall Concept</li>\n<li>HMC Resource Management and Active Directory</li>\n<li>HMC Resource Management and Exchange</li>\n<li>HMC Resource Management and Windows SharePoint Services</li>\n<li>HMC Resource Management and Office Communication Servers</li>\n</ol>\n<p>The aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.</p>\n<p>My objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.</p>\n<p>Let’s get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.</p>\n<p>When you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.</p>\n<p>The first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.</p>\n<p>For now, we will discuss about the last 2 databases, PlanManager and ResourceManager.</p>\n<p><strong>PlanManager Database</strong></p>\n<p>PlanManager used to be called HeCustomerDB in HMC 3.5. While, the concept hasn’t changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.</p>\n<p>PlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,</p>\n<ol>\n<li>Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.</li>\n<li>Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.</li>\n<li>Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.</li>\n<li>Plan Assignment. It also consists of what plans are those organizations assigned to.</li>\n</ol>\n<p>I think it should also be noted that you can further ‘extend’ the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.</p>\n<p><strong>ResourceManager Database</strong></p>\n<p>ResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.</p>\n<p>As I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.</p>\n<p>ResourceManager, on a high level has the following,</p>\n<ol>\n<li>Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.</li>\n<li>Public Folder Stores and their sizes.</li>\n<li>OAB Servers.</li>\n<li>Public Folder allocation for each organization.</li>\n<li>Organization’s OAB assignment</li>\n<li>Organizations and their allocated size.</li>\n<li>Organizations and their assigned mail stores.</li>\n<li>Individual mailbox and the mailbox size assigned to them.</li>\n</ol>\n<p>Now, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month (<a href=\"http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)</a></p>\n<p>There you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.  I believe once you understand what’s in the databases, you will find that it isn’t that bad at all.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a></p>\n<p>I believe one of the most mysterious parts of HMC is about the MPS engine and the Resource Management databases. Between last December and January, I blogged about how different products (Exchange, SharePoint and OCS) integrate in a HMC Solution. However, understanding just the integration points without knowing the resource management portion definitely does not paint a complete picture of what HMC is.</p>\n<p>Since then, I have received requests to discuss a bit about the resource management in HMC and what those databases that shipped with HMC are storing and being used. So, in my next few entries, I intend to spend some time talking about the following,</p>\n<ol>\n<li>PlanManager and ResourceManager - Overall Concept</li>\n<li>HMC Resource Management and Active Directory</li>\n<li>HMC Resource Management and Exchange</li>\n<li>HMC Resource Management and Windows SharePoint Services</li>\n<li>HMC Resource Management and Office Communication Servers</li>\n</ol>\n<p>The aim for this is not to go crazily in-depth nor is it meant to discuss the full database schema and etc. I realize most of our HMC administrators come from an infrastructure background (in fact, mostly from AD and Exchange) and find it difficult to manage the environment (or sometime even fearful to do anything) because there has been very little about how those databases work in the HMC environment.</p>\n<p>My objective is to help the HMC administrators to better understand the relationship and hence able to better plan for recovery, database integrity checking, have better process on how to troubleshoot and handling issues and not blindly go into a HMC environment doing things that may potentially mess up the environment. For example, moving mailbox from one database to another using cmdlets, reconnecting a mailbox to another user, re-enabling sip user and etc.</p>\n<p>Let’s get started. This introduction is going to be something extremely light. I want to talk briefly about the purposes of these databases and what things are being stored in it on a very high level.</p>\n<p>When you install HMC 4.5, it creates 5 databases. They are MPFConfig, MPFAudit, MPFTranLogData, PlanManager and ResourceManager databases.</p>\n<p>The first 3 are used by the MPF engine and I will talk about that some other time as there are tons to talk about too on those. Some of those databases can be used to better analyze the history of all the transactions, used for better performance analysis and also to configure some advance configurations not shown in the interface.</p>\n<p>For now, we will discuss about the last 2 databases, PlanManager and ResourceManager.</p>\n<p><strong>PlanManager Database</strong></p>\n<p>PlanManager used to be called HeCustomerDB in HMC 3.5. While, the concept hasn’t changed much since HMC 3.5, I am going to refer to just the PlanManager which is what HMC 4.5 is using today. There is obviously a big change from HMC 3.5 to HMC 4.5 such as introduction of organization and user plans in HMC 4.5 and also support of different version of the hosted products. So those have resulted in additional categories and features and etc.</p>\n<p>PlanManager stores more than just plans (I personally think it should be named something else). On a high level, it has the following,</p>\n<ol>\n<li>Active Directory Object reference. It consists of all the references to all the objects created in AD. Such as, OUs, Users, Contacts, Groups, SMTP domains. Something that I will go into greater depth in when I discuss about the Resource Management and Active Directory.</li>\n<li>Mailbox assignment. It also consists of information of mailbox GUID linkage to the respective AD objects. I will also discuss that further in the Resource Management and Exchange later.</li>\n<li>Plans information. It consists of all the plan information, including all the features of each plan. For example what mail feature or quota is tied to which plan. Different product tends to be slightly different and I will discuss that accordingly when I discuss about different products.</li>\n<li>Plan Assignment. It also consists of what plans are those organizations assigned to.</li>\n</ol>\n<p>I think it should also be noted that you can further ‘extend’ the capability of the database yourself. Such as you can add additional feature, add in additional customer type or asset type and etc. which your control panel can use if needed.</p>\n<p><strong>ResourceManager Database</strong></p>\n<p>ResourceManager database right now is primarily used by Hosted Exchange only. The complexity and the need of tracking the resource allocation for individual organization, for public folder, for OAB, for individual mailbox user, for different mailbox store created has created the need to track that on a separate database.</p>\n<p>As I walk through different products in the next few entries, you may realize that WSS and OCS are not using the ResourceManager database as they are less complex in terms of the needs for resource allocation and management.</p>\n<p>ResourceManager, on a high level has the following,</p>\n<ol>\n<li>Mailbox Stores and their sizes. It consists of all the mailbox stores and their available size.</li>\n<li>Public Folder Stores and their sizes.</li>\n<li>OAB Servers.</li>\n<li>Public Folder allocation for each organization.</li>\n<li>Organization’s OAB assignment</li>\n<li>Organizations and their allocated size.</li>\n<li>Organizations and their assigned mail stores.</li>\n<li>Individual mailbox and the mailbox size assigned to them.</li>\n</ol>\n<p>Now, I should also highlight that the reference to AD objects are often using GUID and I also blogged about this earlier this month (<a href=\"http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/07/15/matching-the-guid-from-ad-with-mps.aspx)</a></p>\n<p>There you go; this is a simple overview of the 2 mysterious databases that has so often make HMC looks more complicated than it really is.  I believe once you understand what’s in the databases, you will find that it isn’t that bad at all.</p>\n"},{"title":"HMC Resource Management - Part 2 - HMC Resource Management and Active Directory","date":"2009-10-25T04:37:24.000Z","_content":"\nThings have been busy for me and i haven't had the time to complete this series in a timely fashion. In part #1](http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx), we briefly talked about what's in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.\n\nBefore we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn't the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.\n\nThis article was original posted by Kip.Ng on [http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx](http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx)\n\nThe best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.\n\nAs you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).\n\nSo, let's take a closer look and see what is being inserted into the database. Note:\n\n**Creating Organization**\n\nProcedure: To create an organization, you called Hosted Active Directory::CreateOrganization.\n\n  1.  What is created in Active Directory? When this procedure is called,\n     * It creates the Organization OU container in the Hosting container.\n     * it will also create some of the system container and objects such as,\n       -  _Private<\n           * Allusers@&lt;org&gt;\n       - Admins@<org>\n       - CSRAdmins@<org>\n\n * AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.\n\n  2. What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to 'extend' the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.\n> Note: You should know that however Allusers@&lt;org&gt; are not 'linked' in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.\n\n  3. What is in the database then? There aren't many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won't any record of those admins account in the database.\n\nPlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,\n```sql\nSELECT * FROM [PlanManager].[dbo].[Customers] WHERE CommonName = 'TestOrg'\n```\nYou will one record being retrieved showing you the following fields,\n\nCustomerID -&gt; This will match it to the objectGUID of the OU container or the object.\n\nParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU\n\nStatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.\n\nCustomerTypeCode -&gt; This will tell you the type of Object is this. For example,\n   - BU is business user\n   - BZ is business organization\n   - CT is contact object\n   - GP is group object\n   - CU is consumer user\n   - RO is Reseller organization\n   - IR is Information Worker\n  \nCommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.\n> Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.\n\nAlso, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.\n\nThe above doesn't cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.\n\nIn short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won't touch ResourceManager database at all.\n\n**Creating a User**\n\n  1.  What is created in Active Directory? When this procedure is called,\n      - It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n      - It doesn't create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n      - It will then perform the appropriate permissions hardening.\n\n  2. What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Group**\n\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n    - It will create a group object in the Active Directory.\n    - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Contact**\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n     - It doesn't create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n     - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.\n\nSo, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS's PlanManager database.","source":"_posts/hmc-resource-management-part2-hmc-resource-management-and-active-directory.md","raw":"---\ntitle: HMC Resource Management - Part 2 - HMC Resource Management and Active Directory\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-10-25 12:37:24\n---\n\nThings have been busy for me and i haven't had the time to complete this series in a timely fashion. In part #1](http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx), we briefly talked about what's in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.\n\nBefore we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn't the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.\n\nThis article was original posted by Kip.Ng on [http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx](http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx)\n\nThe best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.\n\nAs you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).\n\nSo, let's take a closer look and see what is being inserted into the database. Note:\n\n**Creating Organization**\n\nProcedure: To create an organization, you called Hosted Active Directory::CreateOrganization.\n\n  1.  What is created in Active Directory? When this procedure is called,\n     * It creates the Organization OU container in the Hosting container.\n     * it will also create some of the system container and objects such as,\n       -  _Private<\n           * Allusers@&lt;org&gt;\n       - Admins@<org>\n       - CSRAdmins@<org>\n\n * AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.\n\n  2. What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to 'extend' the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.\n> Note: You should know that however Allusers@&lt;org&gt; are not 'linked' in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.\n\n  3. What is in the database then? There aren't many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won't any record of those admins account in the database.\n\nPlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,\n```sql\nSELECT * FROM [PlanManager].[dbo].[Customers] WHERE CommonName = 'TestOrg'\n```\nYou will one record being retrieved showing you the following fields,\n\nCustomerID -&gt; This will match it to the objectGUID of the OU container or the object.\n\nParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU\n\nStatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.\n\nCustomerTypeCode -&gt; This will tell you the type of Object is this. For example,\n   - BU is business user\n   - BZ is business organization\n   - CT is contact object\n   - GP is group object\n   - CU is consumer user\n   - RO is Reseller organization\n   - IR is Information Worker\n  \nCommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.\n> Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.\n\nAlso, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.\n\nThe above doesn't cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.\n\nIn short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won't touch ResourceManager database at all.\n\n**Creating a User**\n\n  1.  What is created in Active Directory? When this procedure is called,\n      - It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n      - It doesn't create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n      - It will then perform the appropriate permissions hardening.\n\n  2. What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Group**\n\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n    - It will create a group object in the Active Directory.\n    - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.\n\n**Creating a Contact**\n  1. What is created in Active Directory? When this procedure is called,\n    - It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.\n     - It doesn't create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.\n     - It will then perform the appropriate permissions hardening.\n  2. What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.\n\nSo, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS's PlanManager database.","slug":"hmc-resource-management-part2-hmc-resource-management-and-active-directory","published":1,"updated":"2017-06-16T12:43:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyc002c4gyrjhbojl7u","content":"<p>Things have been busy for me and i haven’t had the time to complete this series in a timely fashion. In part #1](<a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a>), we briefly talked about what’s in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.</p>\n<p>Before we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn’t the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.</p>\n<p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx</a></p>\n<p>The best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.</p>\n<p>As you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).</p>\n<p>So, let’s take a closer look and see what is being inserted into the database. Note:</p>\n<p><strong>Creating Organization</strong></p>\n<p>Procedure: To create an organization, you called Hosted Active Directory::CreateOrganization.</p>\n<ol>\n<li><p>What is created in Active Directory? When this procedure is called,</p>\n<ul>\n<li>It creates the Organization OU container in the Hosting container.</li>\n<li><p>it will also create some of the system container and objects such as,</p>\n<ul>\n<li>_Private&lt;<ul>\n<li>Allusers@&lt;org&gt;</li>\n</ul>\n</li>\n<li>Admins@<org></org></li>\n<li>CSRAdmins@<org></org></li>\n</ul>\n</li>\n<li><p>AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.</p>\n</li>\n</ul>\n</li>\n<li><p>What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to ‘extend’ the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.</p>\n<blockquote>\n<p>Note: You should know that however Allusers@&lt;org&gt; are not ‘linked’ in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.</p>\n</blockquote>\n</li>\n<li><p>What is in the database then? There aren’t many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won’t any record of those admins account in the database.</p>\n</li>\n</ol>\n<p>PlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> [PlanManager].[dbo].[Customers] <span class=\"keyword\">WHERE</span> CommonName = <span class=\"string\">'TestOrg'</span></div></pre></td></tr></table></figure></p>\n<p>You will one record being retrieved showing you the following fields,</p>\n<p>CustomerID -&gt; This will match it to the objectGUID of the OU container or the object.</p>\n<p>ParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU</p>\n<p>StatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.</p>\n<p>CustomerTypeCode -&gt; This will tell you the type of Object is this. For example,</p>\n<ul>\n<li>BU is business user</li>\n<li>BZ is business organization</li>\n<li>CT is contact object</li>\n<li>GP is group object</li>\n<li>CU is consumer user</li>\n<li>RO is Reseller organization</li>\n<li>IR is Information Worker</li>\n</ul>\n<p>CommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.</p>\n<blockquote>\n<p>Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.</p>\n</blockquote>\n<p>Also, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.</p>\n<p>The above doesn’t cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.</p>\n<p>In short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won’t touch ResourceManager database at all.</p>\n<p><strong>Creating a User</strong></p>\n<ol>\n<li><p>What is created in Active Directory? When this procedure is called,</p>\n<ul>\n<li>It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It doesn’t create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li><p>What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.</p>\n</li>\n</ol>\n<p><strong>Creating a Group</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<ul>\n<li>It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It will create a group object in the Active Directory.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li>What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p><strong>Creating a Contact</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<ul>\n<li>It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It doesn’t create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li>What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p>So, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS’s PlanManager database.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Things have been busy for me and i haven’t had the time to complete this series in a timely fashion. In part #1](<a href=\"http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/07/20/planmanager-and-resourcemanager-part-1.aspx</a>), we briefly talked about what’s in the PlanManager and ResourceManager databases from a very high level. In the next few parts, we will go in a little bit further to discuss how HMC manage the resource allocation in Exchange, SharePoint and also OCS.</p>\n<p>Before we get into that, I think it is essential to talk about how HMC database, PlanManager is linked with the Active Directory. It is important to understand that it isn’t the purpose of this article to discuss about the database schema but I will discuss briefly how they are linked.</p>\n<p>This article was original posted by Kip.Ng on <a href=\"http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx\" target=\"_blank\" rel=\"external\">http://blogs.technet.com/provtest/archive/2009/09/28/hmc-resource-management-part-2-hmc-resource-management-and-active-directory.aspx</a></p>\n<p>The best way to explain this, in my humble opinion is to walk through the provisioning process. As we walk through them, I will explain how the data is being stored in the database and then I will provide some examples and discuss about some of the tables and their purpose.</p>\n<p>As you all know, the first thing you need to do before mailbox enable a user, or enabling the user for OCS or creating the appropriate SharePoint site for the organization is to create the organization itself and the appropriate users for that organization. In the HMC world, an Organization means a company and all the users and groups in that organization are grouped under an Active Directory container or Organizational Unit (OU).</p>\n<p>So, let’s take a closer look and see what is being inserted into the database. Note:</p>\n<p><strong>Creating Organization</strong></p>\n<p>Procedure: To create an organization, you called Hosted Active Directory::CreateOrganization.</p>\n<ol>\n<li><p>What is created in Active Directory? When this procedure is called,</p>\n<ul>\n<li>It creates the Organization OU container in the Hosting container.</li>\n<li><p>it will also create some of the system container and objects such as,</p>\n<ul>\n<li>_Private&lt;<ul>\n<li>Allusers@&lt;org&gt;</li>\n</ul>\n</li>\n<li>Admins@<org></org></li>\n<li>CSRAdmins@<org></org></li>\n</ul>\n</li>\n<li><p>AD object creation is one thing; the procedure will also stamp the appropriate permissions to ensure that only users in this Org should have access to objects underneath this OU.</p>\n</li>\n</ul>\n</li>\n<li><p>What you should know about otherWellKnownObjects? OtherWellKnownObjects are heavily used in HMC to ‘extend’ the Active Directory schema to link with other objects. For example, MPS will use otherWellKnownObjects to link the _Private folder, the Admins, the CSRAdmins, the parent folder to this organization. This is important to know because a number of the procedures in MPS will use this reference.</p>\n<blockquote>\n<p>Note: You should know that however Allusers@&lt;org&gt; are not ‘linked’ in this otherWellKnownObjects. This is one of the common issues where renaming of Org will cause problem.</p>\n</blockquote>\n</li>\n<li><p>What is in the database then? There aren’t many things being put into the database during Org creation. Because otherWellKnownObjects are used to link most of the things like Admins, CSRAdmins and _Private folder, there is no reason to keep any one of those in the database. Hence, you won’t any record of those admins account in the database.</p>\n</li>\n</ol>\n<p>PlanManager is the only database that you need to look at this point. When an organization is created, it will create a record in the Customers table in the PlanManager database. Say if you create a new Organization called TestOrg, if you perform a query like this,<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> * <span class=\"keyword\">FROM</span> [PlanManager].[dbo].[Customers] <span class=\"keyword\">WHERE</span> CommonName = <span class=\"string\">'TestOrg'</span></div></pre></td></tr></table></figure></p>\n<p>You will one record being retrieved showing you the following fields,</p>\n<p>CustomerID -&gt; This will match it to the objectGUID of the OU container or the object.</p>\n<p>ParentID -&gt; This will match it to the object GUID of the Parent OU or holding OU</p>\n<p>StatusTypeCode -&gt; This will tell you if this Org or object is still active or enabled.</p>\n<p>CustomerTypeCode -&gt; This will tell you the type of Object is this. For example,</p>\n<ul>\n<li>BU is business user</li>\n<li>BZ is business organization</li>\n<li>CT is contact object</li>\n<li>GP is group object</li>\n<li>CU is consumer user</li>\n<li>RO is Reseller organization</li>\n<li>IR is Information Worker</li>\n</ul>\n<p>CommonName -&gt; This stores the name of the organization. If it is a user, it will store the user email or contact email for Contact object or group name if it is a group object.</p>\n<blockquote>\n<p>Note: You should know that Customer table does not just contain the Organization OU object. It consists of almost everything that is created in the Active Directory, such as OU, User, Contact, Distribution Groups.</p>\n</blockquote>\n<p>Also, the database has been designed to cater for customization and extension. You can define your own type if necessary and you can find out all the types that are available from the CustomerTypes table.</p>\n<p>The above doesn’t cover in detail everything is being executed by the procedure and it also does not cover some of the hidden things written into the database. For example, there is difference between creating a reseller organization and a normal business organization. A consumer organization is also different compared to a business organization. You can see they are being differentiated by the CustomerTypeCode. You should also know when you create a Business Org for example, it will also subscribe the Organization to a BusinessPlan which is a default plan for Business.</p>\n<p>In short, the mapping is by GUID and it creates only the OU record and subscribed the OU to a business plan if it is a business Org. Now, in the later parts, I will also go a little bit deeper into the plans in the database and how each service like Exchange has Org plan as well as user plan. For now, from Active Directory standpoint, it is quite straightforward and it won’t touch ResourceManager database at all.</p>\n<p><strong>Creating a User</strong></p>\n<ol>\n<li><p>What is created in Active Directory? When this procedure is called,</p>\n<ul>\n<li>It creates the user object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It doesn’t create anything else other than the user object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li><p>What is in the database then? Creation of the AD user object will create a record on the Customer table in the PlanManager database.</p>\n</li>\n</ol>\n<p><strong>Creating a Group</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<ul>\n<li>It creates the group object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It will create a group object in the Active Directory.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li>What is in the database then? Creation of the AD group object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p><strong>Creating a Contact</strong></p>\n<ol>\n<li>What is created in Active Directory? When this procedure is called,<ul>\n<li>It creates the contact object in the Organization OU. Obviously prior to executing the creation, it will perform some checks such as whether the path being passed in is correct or not.</li>\n<li>It doesn’t create anything else other than the contact object but what it does do is that will insert this user to the appropriate security groups such as the AllUsers group created during the Org creation.</li>\n<li>It will then perform the appropriate permissions hardening.</li>\n</ul>\n</li>\n<li>What is in the database then? Creation of the AD contact object will create a record on the Customer table in the PlanManager database.</li>\n</ol>\n<p>So, there you go. I think it is pretty straightforward. As you can see, creation of objects in Active Directory, from MPS standpoint does not create anything outside of PlanManager database. It does not touch the ResourceManager database at all. You should also see that all the records created, uses the Active Directory object GUID as the primary reference in the MPS’s PlanManager database.</p>\n"},{"title":"How to add Send On Behalf permission to users with MPS","date":"2008-11-25T17:11:10.000Z","_content":"\nUsing **Hosted Active Directory::ModifyUser** to set **publicDelegates **property can do this.  \nSample:\n```xml\n<request xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><procedure xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>\n<execute namespace=\"Hosted Active Directory\" procedure=\n\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<path>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</path>\n<properties>\n<property name=\"publicDelegates\">\n<value>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</value>\n</property>\n</properties>\n<preferredDomainController>ad01.fabrikam.com</preferredDomainController>\n</executeData>\n</execute>\n</procedure>\n</request>\n```","source":"_posts/how-to-add-send-on-behalf-permission-to-users-with-mps.md","raw":"---\ntitle: How to add Send On Behalf permission to users with MPS\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-11-26 01:11:10\n---\n\nUsing **Hosted Active Directory::ModifyUser** to set **publicDelegates **property can do this.  \nSample:\n```xml\n<request xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\"><procedure xmlns:xsl='http://www.w3.org/1999/XSL/Transform'>\n<execute namespace=\"Hosted Active Directory\" procedure=\n\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<path>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</path>\n<properties>\n<property name=\"publicDelegates\">\n<value>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com</value>\n</property>\n</properties>\n<preferredDomainController>ad01.fabrikam.com</preferredDomainController>\n</executeData>\n</execute>\n</procedure>\n</request>\n```","slug":"how-to-add-send-on-behalf-permission-to-users-with-mps","published":1,"updated":"2017-06-16T12:43:10.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyd002e4gyrvegq9ggw","content":"<p>Using <strong>Hosted Active Directory::ModifyUser</strong> to set <strong>publicDelegates </strong>property can do this.<br>Sample:<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">\"http://www.w3.org/1999/XSL/Transform\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">procedure</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">'http://www.w3.org/1999/XSL/Transform'</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Active Directory\"</span> <span class=\"attr\">procedure</span>=</span></div><div class=\"line\"><span class=\"tag\">\"<span class=\"attr\">ModifyUser</span>\" <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">path</span>&gt;</span>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">path</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"publicDelegates\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>ad01.fabrikam.com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Using <strong>Hosted Active Directory::ModifyUser</strong> to set <strong>publicDelegates </strong>property can do this.<br>Sample:<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">request</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">\"http://www.w3.org/1999/XSL/Transform\"</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">procedure</span> <span class=\"attr\">xmlns:xsl</span>=<span class=\"string\">'http://www.w3.org/1999/XSL/Transform'</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Hosted Active Directory\"</span> <span class=\"attr\">procedure</span>=</span></div><div class=\"line\"><span class=\"tag\">\"<span class=\"attr\">ModifyUser</span>\" <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">path</span>&gt;</span>LDAP://CN=jack@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">path</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"publicDelegates\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>mike@litware.com,OU=litware.com,OU=OrgA,OU=Hosting,DC=fabrikam,DC=com<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">preferredDomainController</span>&gt;</span>ad01.fabrikam.com<span class=\"tag\">&lt;/<span class=\"name\">preferredDomainController</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">procedure</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">request</span>&gt;</span></div></pre></td></tr></table></figure></p>\n"},{"title":"如何从Maxmind的CSV数据源生成 GeoIP 的二进制数据库","date":"2015-06-25T02:40:09.000Z","_content":"\n所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。\n\n网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)\n\n#### 1. 环境准备\n\n我们需要一台 Linux, 这里我们使用 Ubuntu\n\n然后再安装基本的编译工具\n\n`apt-get install build-essential zip`\n\n#### 2. 下载最新的 GeoIP 数据库并将其解压缩\n```bash\nwget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip\nunzip GeoIPCountryCSV.zip\n```\n#### 3. 下载 gcsv2bin 的转换工具\n```bash\nwget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz\ntar xzvf gcsv2bin.tar.gz\n```\n\n#### 4. 修改源码，编译工具\n\n```bash\ncd gcsvbin\nnano gcsvbin.c #找到 COUNTRYCOUNT，将其改到 275或者更大\nmake\n```\n![Change_Countrycount](how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg)\n\n#### 5. 生成 geoipdb.bin 和geoipdb.bin\n```bash\n./gcsv2bin ../GeoIPCountryWhois.csv\n```","source":"_posts/how-to-build-geoip-database-from-maxmind-csv-format.md","raw":"---\ntitle: 如何从Maxmind的CSV数据源生成 GeoIP 的二进制数据库\ntags:\n  - GeoIP\n  - MaxMind\ncategories:\n  - '*Nix'\ndate: 2015-06-25 10:40:09\n---\n\n所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。\n\n网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)\n\n#### 1. 环境准备\n\n我们需要一台 Linux, 这里我们使用 Ubuntu\n\n然后再安装基本的编译工具\n\n`apt-get install build-essential zip`\n\n#### 2. 下载最新的 GeoIP 数据库并将其解压缩\n```bash\nwget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip\nunzip GeoIPCountryCSV.zip\n```\n#### 3. 下载 gcsv2bin 的转换工具\n```bash\nwget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz\ntar xzvf gcsv2bin.tar.gz\n```\n\n#### 4. 修改源码，编译工具\n\n```bash\ncd gcsvbin\nnano gcsvbin.c #找到 COUNTRYCOUNT，将其改到 275或者更大\nmake\n```\n![Change_Countrycount](how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg)\n\n#### 5. 生成 geoipdb.bin 和geoipdb.bin\n```bash\n./gcsv2bin ../GeoIPCountryWhois.csv\n```","slug":"how-to-build-geoip-database-from-maxmind-csv-format","published":1,"updated":"2017-06-16T12:43:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyf002i4gyrs7q2lfqv","content":"<p>所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。</p>\n<p>网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)</p>\n<h4 id=\"1-环境准备\"><a href=\"#1-环境准备\" class=\"headerlink\" title=\"1. 环境准备\"></a>1. 环境准备</h4><p>我们需要一台 Linux, 这里我们使用 Ubuntu</p>\n<p>然后再安装基本的编译工具</p>\n<p><code>apt-get install build-essential zip</code></p>\n<h4 id=\"2-下载最新的-GeoIP-数据库并将其解压缩\"><a href=\"#2-下载最新的-GeoIP-数据库并将其解压缩\" class=\"headerlink\" title=\"2. 下载最新的 GeoIP 数据库并将其解压缩\"></a>2. 下载最新的 GeoIP 数据库并将其解压缩</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip</div><div class=\"line\">unzip GeoIPCountryCSV.zip</div></pre></td></tr></table></figure>\n<h4 id=\"3-下载-gcsv2bin-的转换工具\"><a href=\"#3-下载-gcsv2bin-的转换工具\" class=\"headerlink\" title=\"3. 下载 gcsv2bin 的转换工具\"></a>3. 下载 gcsv2bin 的转换工具</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz</div><div class=\"line\">tar xzvf gcsv2bin.tar.gz</div></pre></td></tr></table></figure>\n<h4 id=\"4-修改源码，编译工具\"><a href=\"#4-修改源码，编译工具\" class=\"headerlink\" title=\"4. 修改源码，编译工具\"></a>4. 修改源码，编译工具</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> gcsvbin</div><div class=\"line\">nano gcsvbin.c <span class=\"comment\">#找到 COUNTRYCOUNT，将其改到 275或者更大</span></div><div class=\"line\">make</div></pre></td></tr></table></figure>\n<p><img src=\"/2015/06/25/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg\" alt=\"Change_Countrycount\"></p>\n<h4 id=\"5-生成-geoipdb-bin-和geoipdb-bin\"><a href=\"#5-生成-geoipdb-bin-和geoipdb-bin\" class=\"headerlink\" title=\"5. 生成 geoipdb.bin 和geoipdb.bin\"></a>5. 生成 geoipdb.bin 和geoipdb.bin</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./gcsv2bin ../GeoIPCountryWhois.csv</div></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>所谓GeoIP，就是通过来访者的IP， 定位他的经纬度，国家/地区，省市，甚至街道等位置信息。</p>\n<p>网上能下载到的 geoip 可能都比较旧了，下面我们来自己生成最新的GeoIP 的二进制数据库 (geoipdb.bin, geoipdb.bin)</p>\n<h4 id=\"1-环境准备\"><a href=\"#1-环境准备\" class=\"headerlink\" title=\"1. 环境准备\"></a>1. 环境准备</h4><p>我们需要一台 Linux, 这里我们使用 Ubuntu</p>\n<p>然后再安装基本的编译工具</p>\n<p><code>apt-get install build-essential zip</code></p>\n<h4 id=\"2-下载最新的-GeoIP-数据库并将其解压缩\"><a href=\"#2-下载最新的-GeoIP-数据库并将其解压缩\" class=\"headerlink\" title=\"2. 下载最新的 GeoIP 数据库并将其解压缩\"></a>2. 下载最新的 GeoIP 数据库并将其解压缩</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://www.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip</div><div class=\"line\">unzip GeoIPCountryCSV.zip</div></pre></td></tr></table></figure>\n<h4 id=\"3-下载-gcsv2bin-的转换工具\"><a href=\"#3-下载-gcsv2bin-的转换工具\" class=\"headerlink\" title=\"3. 下载 gcsv2bin 的转换工具\"></a>3. 下载 gcsv2bin 的转换工具</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">wget http://people.netfilter.org/acidfu/geoip/tools/gcsv2bin.tar.gz</div><div class=\"line\">tar xzvf gcsv2bin.tar.gz</div></pre></td></tr></table></figure>\n<h4 id=\"4-修改源码，编译工具\"><a href=\"#4-修改源码，编译工具\" class=\"headerlink\" title=\"4. 修改源码，编译工具\"></a>4. 修改源码，编译工具</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"built_in\">cd</span> gcsvbin</div><div class=\"line\">nano gcsvbin.c <span class=\"comment\">#找到 COUNTRYCOUNT，将其改到 275或者更大</span></div><div class=\"line\">make</div></pre></td></tr></table></figure>\n<p><img src=\"/2015/06/25/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg\" alt=\"Change_Countrycount\"></p>\n<h4 id=\"5-生成-geoipdb-bin-和geoipdb-bin\"><a href=\"#5-生成-geoipdb-bin-和geoipdb-bin\" class=\"headerlink\" title=\"5. 生成 geoipdb.bin 和geoipdb.bin\"></a>5. 生成 geoipdb.bin 和geoipdb.bin</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">./gcsv2bin ../GeoIPCountryWhois.csv</div></pre></td></tr></table></figure>"},{"title":"配置OCS XMPP网关以支持OC和Gmail联系人的通讯","date":"2010-06-23T08:15:45.000Z","_content":"\n是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。\n\n微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步[http://communicationsserverteam.com/archive/2009/10/01/599.aspx](http://communicationsserverteam.com/archive/2009/10/01/599.aspx) 查看。\n\n另外本文也参考了MVP- [Jeff Schertz](http://blogs.pointbridge.com/Blogs/schertz_jeff) 的博文\n\n[http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91](http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91)\n\n基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。\n\n下面我也说说我自己的经验和步骤:\n\n**一、拓扑图**\n\n我们先来看看微软官方文档中的一幅图：\n\n![Fig_1](how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg)\n\n*   **Gmail**\n> Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。\n*   xmpp-server.l.google.com,  74.125.45.125\n*   xmpp-server1.l.google.com, 74.125.155.125\n*   xmpp-server2.l.google.com, 74.125.47.125\n*   xmpp-server3.l.google.com, 74.125.45.125\n*   xmpp-server4.l.google.com, 74.125.45.125\n\n*   **OCS边缘服务器**\n> 一台运行良好的 OCS 2007 R2 Edge 服务器\n\n*   **XMPP 网关**\n> 一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。\n> 支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。\n好了，说了这么久，那你也许会问，什么是 XMPP 呢？\n\n**XMPP **是 E**x**tensible **M**essaging and **P**resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是 **Jabber**。**XMPP **经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。\n\nJabber / XMPP 历史\n\nJeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。\n\nJabber Logo\n\n标准化的Jabber已经由IETF XMPP协议（RFC3920）。\nJabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。\n\n2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。\n2007年的 Jabber 软件基金会已经成为XMPP标准基金会。\n\n而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。\n\n**二、XMPP 网关服务器安装**\n\n系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。\n\n软件需求：\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td valign=\"top\" width=\"242\">.NET Framework</td>\n<td valign=\"top\" width=\"254\">3.5</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">操作系统</td>\n<td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">MMC控制台</td>\n<td valign=\"top\" width=\"254\">3.0</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td>\n<td valign=\"top\" width=\"254\"></td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td>\n<td valign=\"top\" width=\"254\">安装补丁**<span style=\"color: #ff0000;\">KB968802</span>**</td>\n</tr>\n</tbody>\n</table>\n* 微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，**<span style=\"color: #ff0000;\">2008 R2</span>**是支持的\n\n支持的服务端\n\n· Microsoft Office Communications Server 2007 R2\n\n· Microsoft Office Communications Server 2007\n\n· Jabber XCP Server version 5.4\n\n· Google Talk\n\n支持的客户端\n\n· Microsoft Office Communicator 2007 R2\n\n· Microsoft Office Communicator 2007\n\n· Microsoft Office Communicator 2005\n\n· Jabber MomentIM Client version 5.2.1\n\n· Google Talk\n\n下载地址：\n\n1. Microsoft Office Communications Server 2007 R2 XMPP Gateway\n\n[http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4)\n\n2. Hotfix\n\n[http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en)\n\n安装过程，典型的 Next to Next，不过这还只是解压：\n\n![Fig_2](how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg) ![Fig_3](how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg) ![Fig_4](how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg) ![Fig_5](how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg)\n\n这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe\n\n![Fig_6](how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg)\n\n点 Install 进行安装，完毕后我们开始配置。\n\n**需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：**\n\n**http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp**\n\n![Fig_7](how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg)\n\n\n**三、XMPP 网关配置**\n\n**A. 要使 XMPP 网关能正常和 Gtalk 通讯，得满足下面四个条件：**\n\n1. 你的环境中的 OCS 2007 R2 运行良好。\n\n2. 你的 OCS 有安装边缘 Edge 角色。\n\n3. 一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。\n\n4. 需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。\n\n接下来我们再来详细看看 Gmail 和 OCS 的通讯过程\n\n![Fig_8](how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg)\n\n\n看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:\n\n1. GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录 **__xmpp-server._tcp.contoso.com_**_。_ 这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如 **_xmpp.contoso.com_**_。_\n\n2. 得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和 **_xmpp.contoso.com_**的**5269 **端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。\n\n3. 在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP **5269** 端口映射给 **XMPP**。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。\n\n4. 当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (_sip.contoso.com_)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。\n\n5. 在与边缘访问的 Edge 服务器的联盟监听端口 **5061 **建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。\n\n6. OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是**_xmpp.jds.local_**\n\n这里有几个重点要注意下:\n\n第一，在 XMPP 网关上的证书一定要安装配置好。\n* 该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。\n* 证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。\n\n第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。\n\n* 因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如 **jds.local**。\n* XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是**真实的**** FQDN ****名称**，并且要保持**一致**。\n\n最后, 防火墙规则的设定:\n* XMPP 网关的 TCP **5061**，需要和 Edge 的 TCP **5061** 端口进行双向通信\n* XMPP 网关的 TCP **5269**，需要接受来自外部的 Google Talk 的请求\n\n**B.  DNS 记录的创建**\n* 创建 A 记录：**xmpp.contoso.com** - 12.34.56.78\n* 创建 SRV 记录：**__xmpp-server._tcp.contoso.com_** - **xmpp.contoso.com，Port 5269**\n\n参照微软的图\n\n![Fig_9](how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg)\n\n\n**C.说了很多，下面开始配置 XMPP :**\n\n· 修改 **TGWConsoleGUI.dll.config** 文件\n\n默认位置在 **C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway** 下面，这里需要改到的部分是 _SipIP_ 和 _XmppIP _两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!\n\n![Fig_10](how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg)\n\n###### SIP 配置\n\n在 XMPP Gateway 的配置界面中点击 SIP Configuration:\n\n1. **Domain** 标签卡, Domain 一栏指定你的域名，本例中我们用 **litwareinc.com**。\n2. **Host Name** 一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用**srv.litewareinc.com **。\n![Fig_11](how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg)\n3. **TLS Certificate**，选择之前通过自建 CA 申请的内部证书\n![Fig_12](how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg)\n4. **Validate Connection** 在下拉列表中选择 **litwareinc.com**，验证是否配置正确。\n\n##### XMPP 配置\n\n选择 **XMPP Configuration** 节点\n\n1. 在 **Allow List** 标签卡中, 点击 **Add **添加。\n\n2. 在弹出的 **Federated XMPP Domain names** 对话框中,  **Domain Name** 一栏填_gmail.com__，_选择 **TCP Dialback** (required)，其它留空，确定保存。\n\n![Fig_13](how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg)\n\n3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。\n\n4. 验证 Gmail。\n\n##### 启动XMPP 服务\n\n![Fig_14](how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg)\n\n**D. Edge 服务器的配置**\n\n这里非常简单，就是把 gmail.com 作为联盟域添加:\n\n1. 打开 OCS Edge 的属性配置对话框。\n\n![Fig_15](how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg)\n\n\n2. 转到 **Allow** 标签页, 点击 **Add**, 按图中所示添加。\n\nFederated partner domain name - **_gmail.com_**,\n\nFederated partner Access Edge Server - **srv_xmpp.litewareinc.com**\n\n3. 为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如\n\n**192.168.1.20 srv_xmpp.litwareinc.com**\n\n**四、添加 Gmail 用户并验证**\n\n添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟\n\n![Fig_16](how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg)\n\n成功!\n\n![Fig_17](how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg)![Fig_18](how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg)","source":"_posts/how-to-configure-ocsr2-xmpp-to-gmail.md","raw":"---\ntitle: 配置OCS XMPP网关以支持OC和Gmail联系人的通讯\ntags:\n  - XMPP\n  - Gmail\ncategories:\n  - 沟通协作\ndate: 2010-06-23 16:15:45\n---\n\n是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。\n\n微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步[http://communicationsserverteam.com/archive/2009/10/01/599.aspx](http://communicationsserverteam.com/archive/2009/10/01/599.aspx) 查看。\n\n另外本文也参考了MVP- [Jeff Schertz](http://blogs.pointbridge.com/Blogs/schertz_jeff) 的博文\n\n[http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91](http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91)\n\n基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。\n\n下面我也说说我自己的经验和步骤:\n\n**一、拓扑图**\n\n我们先来看看微软官方文档中的一幅图：\n\n![Fig_1](how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg)\n\n*   **Gmail**\n> Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。\n*   xmpp-server.l.google.com,  74.125.45.125\n*   xmpp-server1.l.google.com, 74.125.155.125\n*   xmpp-server2.l.google.com, 74.125.47.125\n*   xmpp-server3.l.google.com, 74.125.45.125\n*   xmpp-server4.l.google.com, 74.125.45.125\n\n*   **OCS边缘服务器**\n> 一台运行良好的 OCS 2007 R2 Edge 服务器\n\n*   **XMPP 网关**\n> 一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。\n> 支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。\n好了，说了这么久，那你也许会问，什么是 XMPP 呢？\n\n**XMPP **是 E**x**tensible **M**essaging and **P**resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是 **Jabber**。**XMPP **经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。\n\nJabber / XMPP 历史\n\nJeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。\n\nJabber Logo\n\n标准化的Jabber已经由IETF XMPP协议（RFC3920）。\nJabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。\n\n2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。\n2007年的 Jabber 软件基金会已经成为XMPP标准基金会。\n\n而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。\n\n**二、XMPP 网关服务器安装**\n\n系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。\n\n软件需求：\n<table border=\"1\" cellspacing=\"0\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td valign=\"top\" width=\"242\">.NET Framework</td>\n<td valign=\"top\" width=\"254\">3.5</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">操作系统</td>\n<td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">MMC控制台</td>\n<td valign=\"top\" width=\"254\">3.0</td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td>\n<td valign=\"top\" width=\"254\"></td>\n</tr>\n<tr>\n<td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td>\n<td valign=\"top\" width=\"254\">安装补丁**<span style=\"color: #ff0000;\">KB968802</span>**</td>\n</tr>\n</tbody>\n</table>\n* 微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，**<span style=\"color: #ff0000;\">2008 R2</span>**是支持的\n\n支持的服务端\n\n· Microsoft Office Communications Server 2007 R2\n\n· Microsoft Office Communications Server 2007\n\n· Jabber XCP Server version 5.4\n\n· Google Talk\n\n支持的客户端\n\n· Microsoft Office Communicator 2007 R2\n\n· Microsoft Office Communicator 2007\n\n· Microsoft Office Communicator 2005\n\n· Jabber MomentIM Client version 5.2.1\n\n· Google Talk\n\n下载地址：\n\n1. Microsoft Office Communications Server 2007 R2 XMPP Gateway\n\n[http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4](http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4)\n\n2. Hotfix\n\n[http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en](http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en)\n\n安装过程，典型的 Next to Next，不过这还只是解压：\n\n![Fig_2](how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg) ![Fig_3](how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg) ![Fig_4](how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg) ![Fig_5](how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg)\n\n这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe\n\n![Fig_6](how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg)\n\n点 Install 进行安装，完毕后我们开始配置。\n\n**需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：**\n\n**http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp**\n\n![Fig_7](how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg)\n\n\n**三、XMPP 网关配置**\n\n**A. 要使 XMPP 网关能正常和 Gtalk 通讯，得满足下面四个条件：**\n\n1. 你的环境中的 OCS 2007 R2 运行良好。\n\n2. 你的 OCS 有安装边缘 Edge 角色。\n\n3. 一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。\n\n4. 需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。\n\n接下来我们再来详细看看 Gmail 和 OCS 的通讯过程\n\n![Fig_8](how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg)\n\n\n看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:\n\n1. GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录 **__xmpp-server._tcp.contoso.com_**_。_ 这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如 **_xmpp.contoso.com_**_。_\n\n2. 得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和 **_xmpp.contoso.com_**的**5269 **端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。\n\n3. 在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP **5269** 端口映射给 **XMPP**。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。\n\n4. 当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (_sip.contoso.com_)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。\n\n5. 在与边缘访问的 Edge 服务器的联盟监听端口 **5061 **建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。\n\n6. OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是**_xmpp.jds.local_**\n\n这里有几个重点要注意下:\n\n第一，在 XMPP 网关上的证书一定要安装配置好。\n* 该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。\n* 证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。\n\n第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。\n\n* 因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如 **jds.local**。\n* XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是**真实的**** FQDN ****名称**，并且要保持**一致**。\n\n最后, 防火墙规则的设定:\n* XMPP 网关的 TCP **5061**，需要和 Edge 的 TCP **5061** 端口进行双向通信\n* XMPP 网关的 TCP **5269**，需要接受来自外部的 Google Talk 的请求\n\n**B.  DNS 记录的创建**\n* 创建 A 记录：**xmpp.contoso.com** - 12.34.56.78\n* 创建 SRV 记录：**__xmpp-server._tcp.contoso.com_** - **xmpp.contoso.com，Port 5269**\n\n参照微软的图\n\n![Fig_9](how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg)\n\n\n**C.说了很多，下面开始配置 XMPP :**\n\n· 修改 **TGWConsoleGUI.dll.config** 文件\n\n默认位置在 **C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway** 下面，这里需要改到的部分是 _SipIP_ 和 _XmppIP _两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!\n\n![Fig_10](how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg)\n\n###### SIP 配置\n\n在 XMPP Gateway 的配置界面中点击 SIP Configuration:\n\n1. **Domain** 标签卡, Domain 一栏指定你的域名，本例中我们用 **litwareinc.com**。\n2. **Host Name** 一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用**srv.litewareinc.com **。\n![Fig_11](how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg)\n3. **TLS Certificate**，选择之前通过自建 CA 申请的内部证书\n![Fig_12](how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg)\n4. **Validate Connection** 在下拉列表中选择 **litwareinc.com**，验证是否配置正确。\n\n##### XMPP 配置\n\n选择 **XMPP Configuration** 节点\n\n1. 在 **Allow List** 标签卡中, 点击 **Add **添加。\n\n2. 在弹出的 **Federated XMPP Domain names** 对话框中,  **Domain Name** 一栏填_gmail.com__，_选择 **TCP Dialback** (required)，其它留空，确定保存。\n\n![Fig_13](how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg)\n\n3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。\n\n4. 验证 Gmail。\n\n##### 启动XMPP 服务\n\n![Fig_14](how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg)\n\n**D. Edge 服务器的配置**\n\n这里非常简单，就是把 gmail.com 作为联盟域添加:\n\n1. 打开 OCS Edge 的属性配置对话框。\n\n![Fig_15](how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg)\n\n\n2. 转到 **Allow** 标签页, 点击 **Add**, 按图中所示添加。\n\nFederated partner domain name - **_gmail.com_**,\n\nFederated partner Access Edge Server - **srv_xmpp.litewareinc.com**\n\n3. 为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如\n\n**192.168.1.20 srv_xmpp.litwareinc.com**\n\n**四、添加 Gmail 用户并验证**\n\n添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟\n\n![Fig_16](how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg)\n\n成功!\n\n![Fig_17](how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg)![Fig_18](how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg)","slug":"how-to-configure-ocsr2-xmpp-to-gmail","published":1,"updated":"2017-06-16T12:44:10.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyj002l4gyry5kp4bvw","content":"<p>是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。</p>\n<p>微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步<a href=\"http://communicationsserverteam.com/archive/2009/10/01/599.aspx\" target=\"_blank\" rel=\"external\">http://communicationsserverteam.com/archive/2009/10/01/599.aspx</a> 查看。</p>\n<p>另外本文也参考了MVP- <a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff\" target=\"_blank\" rel=\"external\">Jeff Schertz</a> 的博文</p>\n<p><a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91\" target=\"_blank\" rel=\"external\">http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91</a></p>\n<p>基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。</p>\n<p>下面我也说说我自己的经验和步骤:</p>\n<p><strong>一、拓扑图</strong></p>\n<p>我们先来看看微软官方文档中的一幅图：</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg\" alt=\"Fig_1\"></p>\n<ul>\n<li><strong>Gmail</strong><blockquote>\n<p>Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。</p>\n</blockquote>\n</li>\n<li>xmpp-server.l.google.com,  74.125.45.125</li>\n<li>xmpp-server1.l.google.com, 74.125.155.125</li>\n<li>xmpp-server2.l.google.com, 74.125.47.125</li>\n<li>xmpp-server3.l.google.com, 74.125.45.125</li>\n<li><p>xmpp-server4.l.google.com, 74.125.45.125</p>\n</li>\n<li><p><strong>OCS边缘服务器</strong></p>\n<blockquote>\n<p>一台运行良好的 OCS 2007 R2 Edge 服务器</p>\n</blockquote>\n</li>\n<li><p><strong>XMPP 网关</strong></p>\n<blockquote>\n<p>一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。<br>支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。<br>好了，说了这么久，那你也许会问，什么是 XMPP 呢？</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>XMPP </strong>是 E<strong>x</strong>tensible <strong>M</strong>essaging and <strong>P</strong>resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是 <strong>Jabber</strong>。<strong>XMPP </strong>经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。</p>\n<p>Jabber / XMPP 历史</p>\n<p>Jeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。</p>\n<p>Jabber Logo</p>\n<p>标准化的Jabber已经由IETF XMPP协议（RFC3920）。<br>Jabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。</p>\n<p>2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。<br>2007年的 Jabber 软件基金会已经成为XMPP标准基金会。</p>\n<p>而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。</p>\n<p><strong>二、XMPP 网关服务器安装</strong></p>\n<p>系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。</p>\n<p>软件需求：</p>\n<p><table border=\"1\" cellspacing=\"0\" cellpadding=\"0\"></table></p>\n<p><tbody></tbody></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">.NET Framework</td></p>\n<p><td valign=\"top\" width=\"254\">3.5</td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">操作系统</td></p>\n<p><td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">MMC控制台</td></p>\n<p><td valign=\"top\" width=\"254\">3.0</td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td></p>\n<p><td valign=\"top\" width=\"254\"></td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td></p>\n<p><td valign=\"top\" width=\"254\">安装补丁<strong><span style=\"color: #ff0000;\">KB968802</span></strong></td><br><br><br></p>\n<ul>\n<li>微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，<strong><span style=\"color: #ff0000;\">2008 R2</span></strong>是支持的</li>\n</ul>\n<p>支持的服务端</p>\n<p>· Microsoft Office Communications Server 2007 R2</p>\n<p>· Microsoft Office Communications Server 2007</p>\n<p>· Jabber XCP Server version 5.4</p>\n<p>· Google Talk</p>\n<p>支持的客户端</p>\n<p>· Microsoft Office Communicator 2007 R2</p>\n<p>· Microsoft Office Communicator 2007</p>\n<p>· Microsoft Office Communicator 2005</p>\n<p>· Jabber MomentIM Client version 5.2.1</p>\n<p>· Google Talk</p>\n<p>下载地址：</p>\n<ol>\n<li>Microsoft Office Communications Server 2007 R2 XMPP Gateway</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4</a></p>\n<ol>\n<li>Hotfix</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en</a></p>\n<p>安装过程，典型的 Next to Next，不过这还只是解压：</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg\" alt=\"Fig_2\"> <img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg\" alt=\"Fig_3\"> <img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg\" alt=\"Fig_4\"> <img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg\" alt=\"Fig_5\"></p>\n<p>这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg\" alt=\"Fig_6\"></p>\n<p>点 Install 进行安装，完毕后我们开始配置。</p>\n<p><strong>需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：</strong></p>\n<p><strong><a href=\"http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp\" target=\"_blank\" rel=\"external\">http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp</a></strong></p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg\" alt=\"Fig_7\"></p>\n<p><strong>三、XMPP 网关配置</strong></p>\n<p><strong>A. 要使 XMPP 网关能正常和 Gtalk 通讯，得满足下面四个条件：</strong></p>\n<ol>\n<li><p>你的环境中的 OCS 2007 R2 运行良好。</p>\n</li>\n<li><p>你的 OCS 有安装边缘 Edge 角色。</p>\n</li>\n<li><p>一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。</p>\n</li>\n<li><p>需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。</p>\n</li>\n</ol>\n<p>接下来我们再来详细看看 Gmail 和 OCS 的通讯过程</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg\" alt=\"Fig_8\"></p>\n<p>看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:</p>\n<ol>\n<li><p>GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录 <strong>__xmpp-server.<em>tcp.contoso.com</em></strong><em>。</em> 这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如 <strong><em>xmpp.contoso.com</em></strong><em>。</em></p>\n</li>\n<li><p>得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和 <strong><em>xmpp.contoso.com</em></strong>的<strong>5269 </strong>端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。</p>\n</li>\n<li><p>在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP <strong>5269</strong> 端口映射给 <strong>XMPP</strong>。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。</p>\n</li>\n<li><p>当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (<em>sip.contoso.com</em>)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。</p>\n</li>\n<li><p>在与边缘访问的 Edge 服务器的联盟监听端口 <strong>5061 </strong>建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。</p>\n</li>\n<li><p>OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是<strong><em>xmpp.jds.local</em></strong></p>\n</li>\n</ol>\n<p>这里有几个重点要注意下:</p>\n<p>第一，在 XMPP 网关上的证书一定要安装配置好。</p>\n<ul>\n<li>该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。</li>\n<li>证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。</li>\n</ul>\n<p>第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。</p>\n<ul>\n<li>因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如 <strong>jds.local</strong>。</li>\n<li>XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是<strong>真实的**</strong> FQDN <strong>**名称</strong>，并且要保持<strong>一致</strong>。</li>\n</ul>\n<p>最后, 防火墙规则的设定:</p>\n<ul>\n<li>XMPP 网关的 TCP <strong>5061</strong>，需要和 Edge 的 TCP <strong>5061</strong> 端口进行双向通信</li>\n<li>XMPP 网关的 TCP <strong>5269</strong>，需要接受来自外部的 Google Talk 的请求</li>\n</ul>\n<p><strong>B.  DNS 记录的创建</strong></p>\n<ul>\n<li>创建 A 记录：<strong>xmpp.contoso.com</strong> - 12.34.56.78</li>\n<li>创建 SRV 记录：<strong>__xmpp-server.<em>tcp.contoso.com</em></strong> - <strong>xmpp.contoso.com，Port 5269</strong></li>\n</ul>\n<p>参照微软的图</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg\" alt=\"Fig_9\"></p>\n<p><strong>C.说了很多，下面开始配置 XMPP :</strong></p>\n<p>· 修改 <strong>TGWConsoleGUI.dll.config</strong> 文件</p>\n<p>默认位置在 <strong>C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway</strong> 下面，这里需要改到的部分是 <em>SipIP</em> 和 <em>XmppIP </em>两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg\" alt=\"Fig_10\"></p>\n<h6 id=\"SIP-配置\"><a href=\"#SIP-配置\" class=\"headerlink\" title=\"SIP 配置\"></a>SIP 配置</h6><p>在 XMPP Gateway 的配置界面中点击 SIP Configuration:</p>\n<ol>\n<li><strong>Domain</strong> 标签卡, Domain 一栏指定你的域名，本例中我们用 <strong>litwareinc.com</strong>。</li>\n<li><strong>Host Name</strong> 一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用<strong>srv.litewareinc.com </strong>。<br><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg\" alt=\"Fig_11\"></li>\n<li><strong>TLS Certificate</strong>，选择之前通过自建 CA 申请的内部证书<br><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg\" alt=\"Fig_12\"></li>\n<li><strong>Validate Connection</strong> 在下拉列表中选择 <strong>litwareinc.com</strong>，验证是否配置正确。</li>\n</ol>\n<h5 id=\"XMPP-配置\"><a href=\"#XMPP-配置\" class=\"headerlink\" title=\"XMPP 配置\"></a>XMPP 配置</h5><p>选择 <strong>XMPP Configuration</strong> 节点</p>\n<ol>\n<li><p>在 <strong>Allow List</strong> 标签卡中, 点击 <strong>Add </strong>添加。</p>\n</li>\n<li><p>在弹出的 <strong>Federated XMPP Domain names</strong> 对话框中,  <strong>Domain Name</strong> 一栏填<em>gmail.com__，</em>选择 <strong>TCP Dialback</strong> (required)，其它留空，确定保存。</p>\n</li>\n</ol>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg\" alt=\"Fig_13\"></p>\n<p>3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。</p>\n<ol>\n<li>验证 Gmail。</li>\n</ol>\n<h5 id=\"启动XMPP-服务\"><a href=\"#启动XMPP-服务\" class=\"headerlink\" title=\"启动XMPP 服务\"></a>启动XMPP 服务</h5><p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg\" alt=\"Fig_14\"></p>\n<p><strong>D. Edge 服务器的配置</strong></p>\n<p>这里非常简单，就是把 gmail.com 作为联盟域添加:</p>\n<ol>\n<li>打开 OCS Edge 的属性配置对话框。</li>\n</ol>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg\" alt=\"Fig_15\"></p>\n<ol>\n<li>转到 <strong>Allow</strong> 标签页, 点击 <strong>Add</strong>, 按图中所示添加。</li>\n</ol>\n<p>Federated partner domain name - <strong><em>gmail.com</em></strong>,</p>\n<p>Federated partner Access Edge Server - <strong>srv_xmpp.litewareinc.com</strong></p>\n<ol>\n<li>为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如</li>\n</ol>\n<p><strong>192.168.1.20 srv_xmpp.litwareinc.com</strong></p>\n<p><strong>四、添加 Gmail 用户并验证</strong></p>\n<p>添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg\" alt=\"Fig_16\"></p>\n<p>成功!</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg\" alt=\"Fig_17\"><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg\" alt=\"Fig_18\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>是的，您没有看错，我也没有写错！现在通过安装配置 XMPP 网关，您可以在 Office Communicator 中添加 Gmail （Google Talk）用户作为联系人，查看对方的忙/闲状态，并即时聊天。</p>\n<p>微软的OCS团队早在去年就在其团队博客上面发布了配置指南，请移步<a href=\"http://communicationsserverteam.com/archive/2009/10/01/599.aspx\" target=\"_blank\" rel=\"external\">http://communicationsserverteam.com/archive/2009/10/01/599.aspx</a> 查看。</p>\n<p>另外本文也参考了MVP- <a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff\" target=\"_blank\" rel=\"external\">Jeff Schertz</a> 的博文</p>\n<p><a href=\"http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91\" target=\"_blank\" rel=\"external\">http://blogs.pointbridge.com/Blogs/schertz_jeff/Pages/Post.aspx?_ID=91</a></p>\n<p>基本上，您需要在现有运行良好的 OCS 2007 R2环境中添置至少一台 XMPP 网关服务器，通过配置其相关设定，来支持和Gmail用户的连接。</p>\n<p>下面我也说说我自己的经验和步骤:</p>\n<p><strong>一、拓扑图</strong></p>\n<p>我们先来看看微软官方文档中的一幅图：</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg\" alt=\"Fig_1\"></p>\n<ul>\n<li><strong>Gmail</strong><blockquote>\n<p>Gmail 云部分是由Google提供的XMPP网关服务器，目前有5个不同的Gtalk主机名，其名称和IP如下所示。</p>\n</blockquote>\n</li>\n<li>xmpp-server.l.google.com,  74.125.45.125</li>\n<li>xmpp-server1.l.google.com, 74.125.155.125</li>\n<li>xmpp-server2.l.google.com, 74.125.47.125</li>\n<li>xmpp-server3.l.google.com, 74.125.45.125</li>\n<li><p>xmpp-server4.l.google.com, 74.125.45.125</p>\n</li>\n<li><p><strong>OCS边缘服务器</strong></p>\n<blockquote>\n<p>一台运行良好的 OCS 2007 R2 Edge 服务器</p>\n</blockquote>\n</li>\n<li><p><strong>XMPP 网关</strong></p>\n<blockquote>\n<p>一台运行在 Windows Server 上面的 XMPP 网关服务器。 一般来说，单网卡就够了，可以同时处理来自外部（Gmail）和内部（OCS边缘）的请求。如果根据您的实际情况需要配置两片网卡，当然也是支持的。<br>支持网络地址转换 (NAT)，在本例中我们用的就是NAT。如果你有单独的公网地址能直接分配给XMPP的话,当然更好。<br>好了，说了这么久，那你也许会问，什么是 XMPP 呢？</p>\n</blockquote>\n</li>\n</ul>\n<p><strong>XMPP </strong>是 E<strong>x</strong>tensible <strong>M</strong>essaging and <strong>P</strong>resence Protocol 的简称，是一种以 XML 为基础的分布式和开放式即时通讯协议，听起来很熟悉？没错，其前身就是 <strong>Jabber</strong>。<strong>XMPP </strong>经由 IETF 小组制订，后因为被 Google Talk 采用而被大家所接触。</p>\n<p>Jabber / XMPP 历史</p>\n<p>Jeremie Miller于1998年开始了Jabber这个项目。第一个公开版本于2000年5月发行。这个项目的主要产品是jabberd，XMPP的服务器端软件。它既可以创建私人的XMPP网络，也可以加入全球的公共XMPP网络。 XMPP的关键特色是，分散式的即时通讯系统，以及使用XML流。</p>\n<p>Jabber Logo</p>\n<p>标准化的Jabber已经由IETF XMPP协议（RFC3920）。<br>Jabber是一个开放源码形式组织产生的网络即时通信协议。 XMPP原本是为Instant Messenger而量身定制，但由于XML Stanza本身是XML元素，在基于XML灵活发展的特性下，使得XMPP也可以适用其他方面，已经得到了IETF的批准。 XMPP与IMPP、PRIM、SIP（SIMPLE）合称四大IM协议主流，在此4大协议中，XMPP是最灵活的。</p>\n<p>2005年，Google 发布了 Google Talk，这是一个IP电话及即时通讯的服务，即时通讯功能采用了开放的 XMPP 。预计这将对XMPP社区起很大的推动作用。初期此服务不支持服务器到服务器的通讯功能，所以未能完全发挥XMPP的分散式特色；虽然任何XMPP客户端都能连接到 Google Talk ，但是用户想要登录 Google Talk ，必须拥有 Google Talk 帐号（即 Gmail 帐号），而用户也无法与公共XMPP网络的用户通信。自2006年1月17日起，Google 宣布支持服务器到服务器的通讯，Google Talk 用户可与其他XMPP公共网络的用户聊天。<br>2007年的 Jabber 软件基金会已经成为XMPP标准基金会。</p>\n<p>而微软在去年10月发布的 Office Communications Server 2007 R2 XMPP 网关实现了 Office Communications Server 2007 R2 与指定的基于 XMPP 的 IM 和状态提供程序间的 IM 和状态通信，这里指定的 IM 就是指 Jabber XCP 和 Google Talk 。本文先讨论和 Gmail 通讯的部分， Jabber XCP 放到下篇中再讲。</p>\n<p><strong>二、XMPP 网关服务器安装</strong></p>\n<p>系统需求和 OCS Edge 服务器类似，只是说 XMPP 不能和 Edge 安装在一起。</p>\n<p>软件需求：</p>\n<p><table border=\"1\" cellspacing=\"0\" cellpadding=\"0\"></table></p>\n<p><tbody></tbody></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">.NET Framework</td></p>\n<p><td valign=\"top\" width=\"254\">3.5</td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">操作系统</td></p>\n<p><td valign=\"top\" width=\"254\">Windows Server 2003 SP2 64位标准版/企业版Windows Server 2008 64位标准版/企业版Windows Server 2008 R2 标准版/企业版*</td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">MMC控制台</td></p>\n<p><td valign=\"top\" width=\"254\">3.0</td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">Microsoft Visual C ++® 2005 Redistributable or Visual C++ 2008 Redistributable</td></p>\n<p><td valign=\"top\" width=\"254\"></td><br></p>\n<p><tr></tr></p>\n<p><td valign=\"top\" width=\"242\">Unified Communications Managed API (UCMA)</td></p>\n<p><td valign=\"top\" width=\"254\">安装补丁<strong><span style=\"color: #ff0000;\">KB968802</span></strong></td><br><br><br></p>\n<ul>\n<li>微软OCS团队的博文上面说 Windows 2008 R2 暂不支持，但是我测试了，<strong><span style=\"color: #ff0000;\">2008 R2</span></strong>是支持的</li>\n</ul>\n<p>支持的服务端</p>\n<p>· Microsoft Office Communications Server 2007 R2</p>\n<p>· Microsoft Office Communications Server 2007</p>\n<p>· Jabber XCP Server version 5.4</p>\n<p>· Google Talk</p>\n<p>支持的客户端</p>\n<p>· Microsoft Office Communicator 2007 R2</p>\n<p>· Microsoft Office Communicator 2007</p>\n<p>· Microsoft Office Communicator 2005</p>\n<p>· Jabber MomentIM Client version 5.2.1</p>\n<p>· Google Talk</p>\n<p>下载地址：</p>\n<ol>\n<li>Microsoft Office Communications Server 2007 R2 XMPP Gateway</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?displaylang=zh-cn&amp;FamilyID=aa560bfe-9960-473a-bfb8-53bff678cec4</a></p>\n<ol>\n<li>Hotfix</li>\n</ol>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/downloads/details.aspx?familyid=80B4E42D-6548-46F4-87B1-7FA0FAF80B82&amp;displaylang=en</a></p>\n<p>安装过程，典型的 Next to Next，不过这还只是解压：</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg\" alt=\"Fig_2\"> <img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg\" alt=\"Fig_3\"> <img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg\" alt=\"Fig_4\"> <img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg\" alt=\"Fig_5\"></p>\n<p>这里安装程序会把安装文件解压至 C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway Installer 目录，运行 setup.exe</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg\" alt=\"Fig_6\"></p>\n<p>点 Install 进行安装，完毕后我们开始配置。</p>\n<p><strong>需要注意的是，一开始你会看到 Install Files for XMPP Gateway 这一步是正常的，但是当你退出后下次再进入该页面时，你也许会看到如下提示，尤其是在 Windows 2008 R2 中安装时，那么你还需要安装这个更新（包含在KB968802中）：</strong></p>\n<p><strong><a href=\"http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp\" target=\"_blank\" rel=\"external\">http://download.microsoft.com/download/D/9/6/D967F77F-D0BD-43FB-987B-6FBF7C82251B/UcmaRedist.msp</a></strong></p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg\" alt=\"Fig_7\"></p>\n<p><strong>三、XMPP 网关配置</strong></p>\n<p><strong>A. 要使 XMPP 网关能正常和 Gtalk 通讯，得满足下面四个条件：</strong></p>\n<ol>\n<li><p>你的环境中的 OCS 2007 R2 运行良好。</p>\n</li>\n<li><p>你的 OCS 有安装边缘 Edge 角色。</p>\n</li>\n<li><p>一张用来和内部边缘服务器通讯的证书，私有或者商业的都行（和Gmail的通信，私有就够了）。</p>\n</li>\n<li><p>需要在你的公网域名下面创建一条 A 记录 和 SRV 记录。</p>\n</li>\n</ol>\n<p>接下来我们再来详细看看 Gmail 和 OCS 的通讯过程</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg\" alt=\"Fig_8\"></p>\n<p>看看一个 Gtalk 用户如何发送一个即时消息到 contoso.com 这个域中的OCS 用户:</p>\n<ol>\n<li><p>GoogleTalk 服务器场中的任意一个 XMPP 服务器向 DNS 请求查询 contoso.com 的 XMPP 服务记录 <strong>__xmpp-server.<em>tcp.contoso.com</em></strong><em>。</em> 这条记录应该指向 contoso.com 组织中 XMPP 网关服务器的公网 A 记录的FQDN地址，A记录的名字任意取，比如 <strong><em>xmpp.contoso.com</em></strong><em>。</em></p>\n</li>\n<li><p>得到A记录的地址后，GoogleTalk 服务器会使用标准 TCP 连接去和 <strong><em>xmpp.contoso.com</em></strong>的<strong>5269 </strong>端口发送请求。这个过程是非加密的，所以在这里我们并不需要证书。</p>\n</li>\n<li><p>在 contoso 组织的防火墙接到 Gtalk 的请求后，会将其路由给 XMPP 网关的，当然，在这之前，contoso 的管理员需要把 TCP <strong>5269</strong> 端口映射给 <strong>XMPP</strong>。在上面的图例中，XMPP 网关的内部接口地址是 10.11.12.40。 这一步也是非加密的。</p>\n</li>\n<li><p>当 XMPP 网关接到请求后，它会查看自己的 SIP 配置来确定下一跳怎么走，那么在我们的例子中，这个下一跳就是 OCS 的边缘访问服务器了 (<em>sip.contoso.com</em>)。要注意的是，这里是使用的 Edge 的外部FQDN地址，所以当你的 XMPP 网关和 Edge 在同一个防火墙后面时，也许 XMPP 会得到 Edge 的公网地址，从而连不到 Edge（除非在防火墙上开启了 DNS 别名- DNS Alias or DNS Doctor）。所以这时你需要在 XMPP 网关的本地 Hosts 文件中添加 Edge 的外部接口的内网地址 (10.11.12.33)。多啰嗦一句，在 Edge 的经典配置中，外部接口指的是 Edge 用来监听外部 SIP 通讯和联盟的那张网卡，不是用来和 OCS Pool 通信的那个内部接口。</p>\n</li>\n<li><p>在与边缘访问的 Edge 服务器的联盟监听端口 <strong>5061 </strong>建立连接后，XMPP 网关需要一张证书来做 MTLS 的加密通讯。 同样的，XMPP 必须要连接到 Edge 的外部接口上的联盟监听端口。很多朋友在此碰到的问题大多是把 XMPP 网关去连 Edge 的内部接口地址。到这一步，Gtalk的消息就发到了OCS用户那里。</p>\n</li>\n<li><p>OCS 用户回消息给 Gtalk 用户过程 - Edge 服务器收到来自 OCS 前端服务器的请求后，会将 gmail.com 当做一个联盟的域来处理，就和OCS连接 Yahoo/MSN 等一样，通讯请求将会把去到 gmail.com 的通讯交给 Gmail 的联盟服务器 - XMPP 网关去处理，在上面的图例中就是<strong><em>xmpp.jds.local</em></strong></p>\n</li>\n</ol>\n<p>这里有几个重点要注意下:</p>\n<p>第一，在 XMPP 网关上的证书一定要安装配置好。</p>\n<ul>\n<li>该证书只是用在 XMPP 和 Edge 服务器的内部通信中间，并不用来和 Google Talk 服务器通信，所以我们可以使用自建 CA 来颁发证书。证书的SN名称应该和 XMPP 网关的内部 FQDN 名称一致，另外，自建 CA 的根证书链应该要导入到 XMPP 网关的计算机账户下受信任的根证书颁发机构中。</li>\n<li>证书的申请，你可以通过边缘服务器 Edge 上面的证书向导来做（因为 XMPP 上面没有这个向导），或者使用 lcscmd.exe。注意的是，该证书的导出和导入必须要包含私钥（Private Key）。</li>\n</ul>\n<p>第二， 证书的必须颁发给 XMPP 服务器的 FQDN 名称。</p>\n<ul>\n<li>因为 XMPP 网关服务器和 Edge 一样，没有加入域，工作组环境，所以我们需要添加相应的 DNS 后缀，比如 <strong>jds.local</strong>。</li>\n<li>XMPP 网关服务器的 FQDN， 证书的 CN (或者 SAN 记录) 以及在 Edge 服务器中的 Gmail 联盟服务器的允许列表中，设定的都应该是<strong>真实的**</strong> FQDN <strong>**名称</strong>，并且要保持<strong>一致</strong>。</li>\n</ul>\n<p>最后, 防火墙规则的设定:</p>\n<ul>\n<li>XMPP 网关的 TCP <strong>5061</strong>，需要和 Edge 的 TCP <strong>5061</strong> 端口进行双向通信</li>\n<li>XMPP 网关的 TCP <strong>5269</strong>，需要接受来自外部的 Google Talk 的请求</li>\n</ul>\n<p><strong>B.  DNS 记录的创建</strong></p>\n<ul>\n<li>创建 A 记录：<strong>xmpp.contoso.com</strong> - 12.34.56.78</li>\n<li>创建 SRV 记录：<strong>__xmpp-server.<em>tcp.contoso.com</em></strong> - <strong>xmpp.contoso.com，Port 5269</strong></li>\n</ul>\n<p>参照微软的图</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg\" alt=\"Fig_9\"></p>\n<p><strong>C.说了很多，下面开始配置 XMPP :</strong></p>\n<p>· 修改 <strong>TGWConsoleGUI.dll.config</strong> 文件</p>\n<p>默认位置在 <strong>C:\\Program Files\\Microsoft Office Communications Server 2007 R2\\XMPP Gateway</strong> 下面，这里需要改到的部分是 <em>SipIP</em> 和 <em>XmppIP </em>两行，这里一定要改，本例中 SipIP 和 XmppIP 都是用的 XMPP 的内部地址。这里如果改的不对或者没有改而留空的话，会导致 XMPP Gateway 服务一启动就马上自动停止!</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg\" alt=\"Fig_10\"></p>\n<h6 id=\"SIP-配置\"><a href=\"#SIP-配置\" class=\"headerlink\" title=\"SIP 配置\"></a>SIP 配置</h6><p>在 XMPP Gateway 的配置界面中点击 SIP Configuration:</p>\n<ol>\n<li><strong>Domain</strong> 标签卡, Domain 一栏指定你的域名，本例中我们用 <strong>litwareinc.com</strong>。</li>\n<li><strong>Host Name</strong> 一栏，填上 Edge 边缘服务器的外部 FQDN 名称，本例中我们用<strong>srv.litewareinc.com </strong>。<br><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg\" alt=\"Fig_11\"></li>\n<li><strong>TLS Certificate</strong>，选择之前通过自建 CA 申请的内部证书<br><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg\" alt=\"Fig_12\"></li>\n<li><strong>Validate Connection</strong> 在下拉列表中选择 <strong>litwareinc.com</strong>，验证是否配置正确。</li>\n</ol>\n<h5 id=\"XMPP-配置\"><a href=\"#XMPP-配置\" class=\"headerlink\" title=\"XMPP 配置\"></a>XMPP 配置</h5><p>选择 <strong>XMPP Configuration</strong> 节点</p>\n<ol>\n<li><p>在 <strong>Allow List</strong> 标签卡中, 点击 <strong>Add </strong>添加。</p>\n</li>\n<li><p>在弹出的 <strong>Federated XMPP Domain names</strong> 对话框中,  <strong>Domain Name</strong> 一栏填<em>gmail.com__，</em>选择 <strong>TCP Dialback</strong> (required)，其它留空，确定保存。</p>\n</li>\n</ol>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg\" alt=\"Fig_13\"></p>\n<p>3.之前提到过，Gmail不使用加密连接，所以这里不需要配置证书。</p>\n<ol>\n<li>验证 Gmail。</li>\n</ol>\n<h5 id=\"启动XMPP-服务\"><a href=\"#启动XMPP-服务\" class=\"headerlink\" title=\"启动XMPP 服务\"></a>启动XMPP 服务</h5><p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg\" alt=\"Fig_14\"></p>\n<p><strong>D. Edge 服务器的配置</strong></p>\n<p>这里非常简单，就是把 gmail.com 作为联盟域添加:</p>\n<ol>\n<li>打开 OCS Edge 的属性配置对话框。</li>\n</ol>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg\" alt=\"Fig_15\"></p>\n<ol>\n<li>转到 <strong>Allow</strong> 标签页, 点击 <strong>Add</strong>, 按图中所示添加。</li>\n</ol>\n<p>Federated partner domain name - <strong><em>gmail.com</em></strong>,</p>\n<p>Federated partner Access Edge Server - <strong>srv_xmpp.litewareinc.com</strong></p>\n<ol>\n<li>为了保证 OCS Edge 服务器能和 XMPP 网关正常通信，你需要在内部 DNS 中添加 XMPP 的记录或者是在本地 Hosts 文件中指定，比如</li>\n</ol>\n<p><strong>192.168.1.20 srv_xmpp.litwareinc.com</strong></p>\n<p><strong>四、添加 Gmail 用户并验证</strong></p>\n<p>添加 Gmail 用户之前，得保证你的 OCS 用户策略里面有启用联盟</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg\" alt=\"Fig_16\"></p>\n<p>成功!</p>\n<p><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg\" alt=\"Fig_17\"><img src=\"/2010/06/23/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg\" alt=\"Fig_18\"></p>\n"},{"title":"CentOS 下解包 RPM","date":"2013-04-30T03:45:46.000Z","_content":"\n一句话记录\n```bash\nrpm2cpio rpm包名.rpm|cpio -id\n```","source":"_posts/how-to-extract-rpm-package-on-centos.md","raw":"---\ntitle: CentOS 下解包 RPM\ntags:\n  - CentOS\ncategories:\n  - '*Nix'\ndate: 2013-04-30 11:45:46\n---\n\n一句话记录\n```bash\nrpm2cpio rpm包名.rpm|cpio -id\n```","slug":"how-to-extract-rpm-package-on-centos","published":1,"updated":"2017-06-16T12:44:22.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyl002p4gyrlsh7kv0a","content":"<p>一句话记录<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm2cpio rpm包名.rpm|cpio -id</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>一句话记录<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rpm2cpio rpm包名.rpm|cpio -id</div></pre></td></tr></table></figure></p>\n"},{"title":"解决 SQL 2008 Reporting Service 的 TeraData 扩展错误","date":"2010-07-02T08:29:24.000Z","_content":"\n新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：\n> Log Name:      Application\n> Source:        Report Server (MSSQLSERVER)\n> Date:          7/2/2010 12:48:21 AM\n> Event ID:      108\n> Task Category: Extension\n> Level:         Error\n> Keywords:      Classic\n> User:          N/A\n> Computer:      M2AHKCRMWEB01.mail2any.local\n> Description:\n> Report Server (MSSQLSERVER) cannot load the TERADATA extension.\n\n发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。\n\n##### 解决方案：\n大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service  所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。\n比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件\n```xml\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /> -->\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\">\n<Configuration>\n<EnableMathOpCasting>True</EnableMathOpCasting>\n<ReplaceFunctionName>oREPLACE</ReplaceFunctionName>\n</Configuration>\n</Extension> -->\n```\n\n第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx","source":"_posts/how-to-fix-sql2008-ssrs-teradata-extension-load-error.md","raw":"---\ntitle: 解决 SQL 2008 Reporting Service 的 TeraData 扩展错误\ntags:\n  - MSSQL\n  - SSRS\n  - TeraData\ncategories:\n  - Microsoft\n  - MSSQL\ndate: 2010-07-02 16:29:24\n---\n\n新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：\n> Log Name:      Application\n> Source:        Report Server (MSSQLSERVER)\n> Date:          7/2/2010 12:48:21 AM\n> Event ID:      108\n> Task Category: Extension\n> Level:         Error\n> Keywords:      Classic\n> User:          N/A\n> Computer:      M2AHKCRMWEB01.mail2any.local\n> Description:\n> Report Server (MSSQLSERVER) cannot load the TERADATA extension.\n\n发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。\n\n##### 解决方案：\n大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service  所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。\n比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件\n```xml\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /> -->\n<!-- <Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\">\n<Configuration>\n<EnableMathOpCasting>True</EnableMathOpCasting>\n<ReplaceFunctionName>oREPLACE</ReplaceFunctionName>\n</Configuration>\n</Extension> -->\n```\n\n第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx","slug":"how-to-fix-sql2008-ssrs-teradata-extension-load-error","published":1,"updated":"2017-06-16T12:45:50.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jym002r4gyrw51tg3jv","content":"<p>新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：</p>\n<blockquote>\n<p>Log Name:      Application<br>Source:        Report Server (MSSQLSERVER)<br>Date:          7/2/2010 12:48:21 AM<br>Event ID:      108<br>Task Category: Extension<br>Level:         Error<br>Keywords:      Classic<br>User:          N/A<br>Computer:      M2AHKCRMWEB01.mail2any.local<br>Description:<br>Report Server (MSSQLSERVER) cannot load the TERADATA extension.</p>\n</blockquote>\n<p>发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。</p>\n<h5 id=\"解决方案：\"><a href=\"#解决方案：\" class=\"headerlink\" title=\"解决方案：\"></a>解决方案：</h5><p>大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service  所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。<br>比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /&gt; --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\"&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;Configuration&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;EnableMathOpCasting&gt;True&lt;/EnableMathOpCasting&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;ReplaceFunctionName&gt;oREPLACE&lt;/ReplaceFunctionName&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;/Configuration&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;/Extension&gt; --&gt;</span></div></pre></td></tr></table></figure></p>\n<p>第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 <a href=\"http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx\" target=\"_blank\" rel=\"external\">http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>新装的一台 SQL Server 2008 SP1， 上面有跑数据库引擎和报表服务，新装后不久在事件管理器中频繁出现以下错误：</p>\n<blockquote>\n<p>Log Name:      Application<br>Source:        Report Server (MSSQLSERVER)<br>Date:          7/2/2010 12:48:21 AM<br>Event ID:      108<br>Task Category: Extension<br>Level:         Error<br>Keywords:      Classic<br>User:          N/A<br>Computer:      M2AHKCRMWEB01.mail2any.local<br>Description:<br>Report Server (MSSQLSERVER) cannot load the TERADATA extension.</p>\n</blockquote>\n<p>发生这个的原因是在2008的报表服务中,默认开启了 TeraData 的扩展，而2008的安装文件是不包含这个扩展的文件的，所以就会找不到扩展所需要的文件。</p>\n<h5 id=\"解决方案：\"><a href=\"#解决方案：\" class=\"headerlink\" title=\"解决方案：\"></a>解决方案：</h5><p>大多数情况下应该是没有用到 TeraData 的，所以可以打开 Reporting Service  所在的目录下的 RSReportServer.config 文件，注释掉 TeraData 相关部分即可。<br>比如 C:\\Program Files\\Microsoft SQL Server\\MSRS10.MSSQLSERVER\\Reporting Services\\ReportServer\\RSReportServer.config 文件<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.DataExtensions.TeradataConnectionWrapper,Microsoft.ReportingServices.DataExtensions\" /&gt; --&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!-- &lt;Extension Name=\"TERADATA\" Type=\"Microsoft.ReportingServices.SemanticQueryEngine.Sql.Teradata.TdSqlSQCommand,Microsoft.ReportingServices.SemanticQueryEngine\"&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;Configuration&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;EnableMathOpCasting&gt;True&lt;/EnableMathOpCasting&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;ReplaceFunctionName&gt;oREPLACE&lt;/ReplaceFunctionName&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;/Configuration&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;/Extension&gt; --&gt;</span></div></pre></td></tr></table></figure></p>\n<p>第二：如果有用到 TeraData，那就去其网站下载 TeraData .Net Data Provider，注意要安装版本12以上的，比如 <a href=\"http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx\" target=\"_blank\" rel=\"external\">http://www.teradata.com/DownloadCenter/Topic9541-152-1.aspx</a></p>\n"},{"title":"WordPress后台无法登录，显示空白的解决方法","date":"2013-04-10T10:08:25.000Z","_content":"\n我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。\n\n整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 `wp-config.php` 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。\n\nGoogle了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了`wp-config.php` 文件的编码上面，官方源文件是 **“UTF-8 without BOM”**，现在我的成了 **“UTF-8格式编码”**，使用 NotePad++ 转换编码后另存上传覆盖解决。","source":"_posts/how-to-fix-wordpress-admin-blank-white-screen.md","raw":"---\ntitle: WordPress后台无法登录，显示空白的解决方法\ntags:\n  - WordPress\ncategories:\n  - 网站相关\ndate: 2013-04-10 18:08:25\n---\n\n我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。\n\n整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 `wp-config.php` 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。\n\nGoogle了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了`wp-config.php` 文件的编码上面，官方源文件是 **“UTF-8 without BOM”**，现在我的成了 **“UTF-8格式编码”**，使用 NotePad++ 转换编码后另存上传覆盖解决。","slug":"how-to-fix-wordpress-admin-blank-white-screen","published":1,"updated":"2017-06-16T12:46:12.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyn002w4gyruwqrstal","content":"<p>我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。</p>\n<p>整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 <code>wp-config.php</code> 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。</p>\n<p>Google了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了<code>wp-config.php</code> 文件的编码上面，官方源文件是 <strong>“UTF-8 without BOM”</strong>，现在我的成了 <strong>“UTF-8格式编码”</strong>，使用 NotePad++ 转换编码后另存上传覆盖解决。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>我在香港的托管机房很快就要到期了，于是乎在 BlueHost 买了空间，打算把手头几个网站都迁移过去。</p>\n<p>整个 WordPress 的目录我已经打包下来并上传到了 BlueHost 的服务器上面，MySQL 数据库也顺利地导入，在 Windows 下面用记事本编辑原来的 <code>wp-config.php</code> 文件，修改好新空间所用的主机名，数据库名，用户和密码等信息，保存再上传，待域名的 DNS 记录更新以后，可以正常打开前台页面，速度还不错，可是等登录后台的时候，可以出来登录页面，但是输入用户名和密码后，立即转入了空白，查看页面源码也是空白，这可傻眼了。</p>\n<p>Google了一会，什么删除 themes 啦，把 plugins 目录改名啦，等等，都不管用，最后重装都依旧，最后发现问题出在了<code>wp-config.php</code> 文件的编码上面，官方源文件是 <strong>“UTF-8 without BOM”</strong>，现在我的成了 <strong>“UTF-8格式编码”</strong>，使用 NotePad++ 转换编码后另存上传覆盖解决。</p>\n"},{"title":"How to remember your OC and Outlook password","date":"2010-10-13T07:12:44.000Z","_content":"\nHow to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)\n\n我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连\"保存密码\"的复选框都看不到，怎么办？\n\n#### A. Outlook 2007 (同样适用于 Outlook 2003/2010)\n1. 退出 Outlook（如果在运行的话）。\n2. 控制面板 -&gt; 邮件 -&gt; 邮件账户..., 点击 \"更改...\"。\n![ol_step_1](how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg)\n3. 在 \"更改电子邮件账户\" 对话框, 点击 \"更多设置\"。![ol_step_2](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n4. 转到 \"连接\" 标签卡, 点击 \"Exchange 代理设置\"。\n![ol_step_3](how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg)\n5. 在代理认证这里，将认证方式从基本认证改为 NTLM 认证。\n![ol_step_4](how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg)\n6. 点击 \"OK\" 两次确认。\n7. 接着点击下一步和完成按钮。\n8. 重新打开 Outlook , 你就能看到那 \"记住密码\" 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。\n9. 这一步是关键！点击开始-&gt; 运行, 输入 `control Keymgr.dll`\n![ol_step_5](how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg)\n10. 确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 \"属性\"。\n![ol_step_6](how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg)\n![ol_step_7](how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg)\n11. 将服务器属性从 \"EXMBX01.company.local\" 改成 \"\\*.company.local\", 点击 **OK** 确定。\n![ol_step_8](how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg)\n\n#### B. Communicator\n1. 打开注册表，找到 `HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator`，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 \n2. 关闭并完全退出 communicator ， 然后重新打开, 你会看到 \"保存我的密码\", 选中后点击登入。\n![ol_step_9](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n\n注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。","source":"_posts/how-to-remember-your-oc-and-outlook-password.md","raw":"---\ntitle: How to remember your OC and Outlook password\ntags:\n  - XMPP\n  - Communicator\ncategories:\n  - 沟通协作\ndate: 2010-10-13 15:12:44\n---\n\nHow to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)\n\n我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连\"保存密码\"的复选框都看不到，怎么办？\n\n#### A. Outlook 2007 (同样适用于 Outlook 2003/2010)\n1. 退出 Outlook（如果在运行的话）。\n2. 控制面板 -&gt; 邮件 -&gt; 邮件账户..., 点击 \"更改...\"。\n![ol_step_1](how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg)\n3. 在 \"更改电子邮件账户\" 对话框, 点击 \"更多设置\"。![ol_step_2](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n4. 转到 \"连接\" 标签卡, 点击 \"Exchange 代理设置\"。\n![ol_step_3](how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg)\n5. 在代理认证这里，将认证方式从基本认证改为 NTLM 认证。\n![ol_step_4](how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg)\n6. 点击 \"OK\" 两次确认。\n7. 接着点击下一步和完成按钮。\n8. 重新打开 Outlook , 你就能看到那 \"记住密码\" 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。\n9. 这一步是关键！点击开始-&gt; 运行, 输入 `control Keymgr.dll`\n![ol_step_5](how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg)\n10. 确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 \"属性\"。\n![ol_step_6](how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg)\n![ol_step_7](how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg)\n11. 将服务器属性从 \"EXMBX01.company.local\" 改成 \"\\*.company.local\", 点击 **OK** 确定。\n![ol_step_8](how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg)\n\n#### B. Communicator\n1. 打开注册表，找到 `HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator`，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 \n2. 关闭并完全退出 communicator ， 然后重新打开, 你会看到 \"保存我的密码\", 选中后点击登入。\n![ol_step_9](how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg)\n\n注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。","slug":"how-to-remember-your-oc-and-outlook-password","published":1,"updated":"2017-06-16T12:46:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyp002y4gyrhe7dhcgq","content":"<p>How to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)</p>\n<p>我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连”保存密码”的复选框都看不到，怎么办？</p>\n<h4 id=\"A-Outlook-2007-同样适用于-Outlook-2003-2010\"><a href=\"#A-Outlook-2007-同样适用于-Outlook-2003-2010\" class=\"headerlink\" title=\"A. Outlook 2007 (同样适用于 Outlook 2003/2010)\"></a>A. Outlook 2007 (同样适用于 Outlook 2003/2010)</h4><ol>\n<li>退出 Outlook（如果在运行的话）。</li>\n<li>控制面板 -&gt; 邮件 -&gt; 邮件账户…, 点击 “更改…”。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg\" alt=\"ol_step_1\"></li>\n<li>在 “更改电子邮件账户” 对话框, 点击 “更多设置”。<img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_2\"></li>\n<li>转到 “连接” 标签卡, 点击 “Exchange 代理设置”。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg\" alt=\"ol_step_3\"></li>\n<li>在代理认证这里，将认证方式从基本认证改为 NTLM 认证。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg\" alt=\"ol_step_4\"></li>\n<li>点击 “OK” 两次确认。</li>\n<li>接着点击下一步和完成按钮。</li>\n<li>重新打开 Outlook , 你就能看到那 “记住密码” 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。</li>\n<li>这一步是关键！点击开始-&gt; 运行, 输入 <code>control Keymgr.dll</code><br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg\" alt=\"ol_step_5\"></li>\n<li>确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 “属性”。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg\" alt=\"ol_step_6\"><br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg\" alt=\"ol_step_7\"></li>\n<li>将服务器属性从 “EXMBX01.company.local” 改成 “*.company.local”, 点击 <strong>OK</strong> 确定。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg\" alt=\"ol_step_8\"></li>\n</ol>\n<h4 id=\"B-Communicator\"><a href=\"#B-Communicator\" class=\"headerlink\" title=\"B. Communicator\"></a>B. Communicator</h4><ol>\n<li>打开注册表，找到 <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator</code>，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 </li>\n<li>关闭并完全退出 communicator ， 然后重新打开, 你会看到 “保存我的密码”, 选中后点击登入。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_9\"></li>\n</ol>\n<p>注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>How to make your computer remember your Microsoft Communicator 2007 R2 and Outlook 2007 password (如何让你的电脑在非域环境中记住 OC 2007 R2 和 Outlook 的密码)</p>\n<p>我们知道，在域的环境中，使用 OC 和 Outlook 都可以使用 Windows 的集成验证来完成用户验证过程，也能很方便的记住密码自动登录，但是如果你的电脑没有在域环境中或者工作站所在的域与 Exchange/OCS 所在的域没有联系呢？ 这个时候，你甚至连”保存密码”的复选框都看不到，怎么办？</p>\n<h4 id=\"A-Outlook-2007-同样适用于-Outlook-2003-2010\"><a href=\"#A-Outlook-2007-同样适用于-Outlook-2003-2010\" class=\"headerlink\" title=\"A. Outlook 2007 (同样适用于 Outlook 2003/2010)\"></a>A. Outlook 2007 (同样适用于 Outlook 2003/2010)</h4><ol>\n<li>退出 Outlook（如果在运行的话）。</li>\n<li>控制面板 -&gt; 邮件 -&gt; 邮件账户…, 点击 “更改…”。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg\" alt=\"ol_step_1\"></li>\n<li>在 “更改电子邮件账户” 对话框, 点击 “更多设置”。<img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_2\"></li>\n<li>转到 “连接” 标签卡, 点击 “Exchange 代理设置”。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg\" alt=\"ol_step_3\"></li>\n<li>在代理认证这里，将认证方式从基本认证改为 NTLM 认证。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg\" alt=\"ol_step_4\"></li>\n<li>点击 “OK” 两次确认。</li>\n<li>接着点击下一步和完成按钮。</li>\n<li>重新打开 Outlook , 你就能看到那 “记住密码” 选项又出来了，输入你的邮件地址和密码, 选中记住密码功能。</li>\n<li>这一步是关键！点击开始-&gt; 运行, 输入 <code>control Keymgr.dll</code><br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg\" alt=\"ol_step_5\"></li>\n<li>确认你选择的是 Exchange 邮箱角色服务器地址，比如 EXMBX01.company.local ， 然后点击 “属性”。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg\" alt=\"ol_step_6\"><br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg\" alt=\"ol_step_7\"></li>\n<li>将服务器属性从 “EXMBX01.company.local” 改成 “*.company.local”, 点击 <strong>OK</strong> 确定。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg\" alt=\"ol_step_8\"></li>\n</ol>\n<h4 id=\"B-Communicator\"><a href=\"#B-Communicator\" class=\"headerlink\" title=\"B. Communicator\"></a>B. Communicator</h4><ol>\n<li>打开注册表，找到 <code>HKEY_CURRENT_USER\\Software\\Microsoft\\Communicator</code>，新建一个 DWORD 记录，名字为 SavePassword ， 修改其值为 1 。当然，你也可以去到微软站点下载OCS的组策略模板，导入AD中，实现批量修改。 </li>\n<li>关闭并完全退出 communicator ， 然后重新打开, 你会看到 “保存我的密码”, 选中后点击登入。<br><img src=\"/2010/10/13/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg\" alt=\"ol_step_9\"></li>\n</ol>\n<p>注意: 如果你以后修改了你的 Exchange 或者 OC 的密码，要记得再重复第10步。</p>\n"},{"title":"How to remove a VMHost from SCVMM 2008 R2 forcefully","id":"107","date":"2010-04-13T14:17:03.000Z","_content":"\n这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：\n> Error (801)\n> \n> VMM cannot find ISO object .\n> \n> Recommended Action\n> \n> Ensure the library object is valid, and then try the operation again.\n\n移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:\nGet-VMHost -Computername Hostname | Remove-VMHost -Force\n一样的提示。\n一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。\n\n##### 步骤：\n1. 停止 VMMService 服务；\n2. 用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:**MICROSOFT$VMM$**，数据库名称是 **VirtualManagerDB**)，保险起见，先备份；\n3. 查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 `'68899616-fdc8-4f85-a702-979a4251f766'`；\n4. 打开查询窗口，执行以下 SQL 语句:\n```sql\nDELETE FROM tbl_ADHC_HostNetworkAdapter WHERE (HostID='68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_VirtualNetwork WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostVolume WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostDisk WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_PhysicalObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_VObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_Host WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\n```\n5. 再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除\n\n6. 如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录\n```sql\nDELETE FROM tbl_ADHC_ClusterDisk WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\nDELETE FROM tbl_ADHC_HostCluster WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\n```\n\nPS. 用下面这条命令可以重置 Failed Job 状态\n```sql\nUPDATE tbl_TR_TaskTrail SET IsVisible = 0 WHERE TaskState = 'Failed'\n```","source":"_posts/how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully.md","raw":"---\ntitle: How to remove a VMHost from SCVMM 2008 R2 forcefully\ntags:\n  - SCVMM\n  - VMHost\nid: 107\ncategories:\n  - 虚拟化\ndate: 2010-04-13 22:17:03\n---\n\n这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：\n> Error (801)\n> \n> VMM cannot find ISO object .\n> \n> Recommended Action\n> \n> Ensure the library object is valid, and then try the operation again.\n\n移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:\nGet-VMHost -Computername Hostname | Remove-VMHost -Force\n一样的提示。\n一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。\n\n##### 步骤：\n1. 停止 VMMService 服务；\n2. 用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:**MICROSOFT$VMM$**，数据库名称是 **VirtualManagerDB**)，保险起见，先备份；\n3. 查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 `'68899616-fdc8-4f85-a702-979a4251f766'`；\n4. 打开查询窗口，执行以下 SQL 语句:\n```sql\nDELETE FROM tbl_ADHC_HostNetworkAdapter WHERE (HostID='68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_VirtualNetwork WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostVolume WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_HostDisk WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_PhysicalObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_WLC_VObject WHERE (HostId = '68899616-fdc8-4f85-a702-979a4251f766')\nDELETE FROM tbl_ADHC_Host WHERE (HostID = '68899616-fdc8-4f85-a702-979a4251f766')\n```\n5. 再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除\n\n6. 如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录\n```sql\nDELETE FROM tbl_ADHC_ClusterDisk WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\nDELETE FROM tbl_ADHC_HostCluster WHERE (ClusterID = '1149953c-cde3-45d2-82ee-b79a259d6a79')\n```\n\nPS. 用下面这条命令可以重置 Failed Job 状态\n```sql\nUPDATE tbl_TR_TaskTrail SET IsVisible = 0 WHERE TaskState = 'Failed'\n```","slug":"how-to-remove-a-vmhost-from-scvmm-2008-r2-forcefully","published":1,"updated":"2017-06-14T09:21:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyq00324gyrnacjtfbx","content":"<p>这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：</p>\n<blockquote>\n<p>Error (801)</p>\n<p>VMM cannot find ISO object .</p>\n<p>Recommended Action</p>\n<p>Ensure the library object is valid, and then try the operation again.</p>\n</blockquote>\n<p>移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:<br>Get-VMHost -Computername Hostname | Remove-VMHost -Force<br>一样的提示。<br>一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。</p>\n<h5 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h5><ol>\n<li>停止 VMMService 服务；</li>\n<li>用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:<strong>MICROSOFT$VMM$</strong>，数据库名称是 <strong>VirtualManagerDB</strong>)，保险起见，先备份；</li>\n<li>查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 <code>&#39;68899616-fdc8-4f85-a702-979a4251f766&#39;</code>；</li>\n<li><p>打开查询窗口，执行以下 SQL 语句:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostNetworkAdapter <span class=\"keyword\">WHERE</span> (HostID=<span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_VirtualNetwork <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostVolume <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostDisk <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_PhysicalObject <span class=\"keyword\">WHERE</span> (HostId = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_VObject <span class=\"keyword\">WHERE</span> (HostId = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_Host <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div></pre></td></tr></table></figure>\n</li>\n<li><p>再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除</p>\n</li>\n<li><p>如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_ClusterDisk <span class=\"keyword\">WHERE</span> (ClusterID = <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostCluster <span class=\"keyword\">WHERE</span> (ClusterID = <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>PS. 用下面这条命令可以重置 Failed Job 状态<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">UPDATE</span> tbl_TR_TaskTrail <span class=\"keyword\">SET</span> IsVisible = <span class=\"number\">0</span> <span class=\"keyword\">WHERE</span> TaskState = <span class=\"string\">'Failed'</span></div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>这几天碰到个问题，有个服务器原来安装的是 2008 Server Core系统,上面跑 Hyper-V，已经将其导入 SCVMM 2008 R2 来管理。最近实在是嫌 Server Core 管理太不方便，于是想把系统换成带图形界面的，也没在 SCVMM 里面把主机删除，直接就重装了，IP和计算机名什么的都没变，结果问题来了，再打开 SCVMM 的控制台，发现这台主机联系不上(当然，因为重装的没有了 Agent)，就想删掉再重加，结果删除过程报错：</p>\n<blockquote>\n<p>Error (801)</p>\n<p>VMM cannot find ISO object .</p>\n<p>Recommended Action</p>\n<p>Ensure the library object is valid, and then try the operation again.</p>\n</blockquote>\n<p>移除任务的进度一直停留在99% 而主机就是保持在 Pending 状态，结果就是旧的删不掉，新的加不了。后来试过用 PowerShell 来删:<br>Get-VMHost -Computername Hostname | Remove-VMHost -Force<br>一样的提示。<br>一番研究和搜索之后，终于发现直接操作 SCVMM 的数据库可以搞定此问题。</p>\n<h5 id=\"步骤：\"><a href=\"#步骤：\" class=\"headerlink\" title=\"步骤：\"></a>步骤：</h5><ol>\n<li>停止 VMMService 服务；</li>\n<li>用 SQL Management Studio 连接到 SCVMM 的数据库 (默认应该是 SQL Express 的实例:<strong>MICROSOFT$VMM$</strong>，数据库名称是 <strong>VirtualManagerDB</strong>)，保险起见，先备份；</li>\n<li>查询 tbl_ADHC_Host， 可以看到原来这台旧的 Hyper-V 主机的记录，记下其对应的 HostID, 比如 <code>&#39;68899616-fdc8-4f85-a702-979a4251f766&#39;</code>；</li>\n<li><p>打开查询窗口，执行以下 SQL 语句:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostNetworkAdapter <span class=\"keyword\">WHERE</span> (HostID=<span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_VirtualNetwork <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostVolume <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostDisk <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_PhysicalObject <span class=\"keyword\">WHERE</span> (HostId = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_WLC_VObject <span class=\"keyword\">WHERE</span> (HostId = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_Host <span class=\"keyword\">WHERE</span> (HostID = <span class=\"string\">'68899616-fdc8-4f85-a702-979a4251f766'</span>)</div></pre></td></tr></table></figure>\n</li>\n<li><p>再查看表 tbl_ADHC_AgentServerRelation 和 tbl_ADHC_AgentServer，如果有对应的主机记录也相应删除</p>\n</li>\n<li><p>如果是 Hyper-V 群集的话，每个节点都要跑一次上面的删除语句，还得删除 Cluster 的记录</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_ClusterDisk <span class=\"keyword\">WHERE</span> (ClusterID = <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</div><div class=\"line\"><span class=\"keyword\">DELETE</span> <span class=\"keyword\">FROM</span> tbl_ADHC_HostCluster <span class=\"keyword\">WHERE</span> (ClusterID = <span class=\"string\">'1149953c-cde3-45d2-82ee-b79a259d6a79'</span>)</div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>PS. 用下面这条命令可以重置 Failed Job 状态<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">UPDATE</span> tbl_TR_TaskTrail <span class=\"keyword\">SET</span> IsVisible = <span class=\"number\">0</span> <span class=\"keyword\">WHERE</span> TaskState = <span class=\"string\">'Failed'</span></div></pre></td></tr></table></figure></p>\n"},{"title":"如何设置使 HMC 4.0 创建的用户的密码永不过期","date":"2007-11-10T04:01:02.000Z","_content":"\nHMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 `userAccountControl` 的属性来达到默认就是密码永不过期的目的。\n\n1.  以管理员身份登陆 MPS (MPSSQL)，打开 **Provisioning Manager**\n2.  在名称空间 \"Hosted Active Directory\" 中打开  **CreateUser** 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser: \n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n```\n注释或者去掉以下的2句判断语句\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n3.  改完之后应该类似这样\n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<user/>\n<properties>\n<!-- sets the password to never expire -->\n<property name=\"userAccountControl\">\n<value>65536</value>\n</property>\n</properties>\n</executeData>\n<before source=\"procedureData\" sourcePath=\"path\" destination=\"executeData\" destinationPath=\"user\" mode=\"merge\"/>\n<before source=\"data\" sourcePath=\"preferredDomainController\" destination=\"executeData\" mode=\"insert\"/>\n</execute>\n```\n4.  点击 \"Apply\" 保存修改。\n> 解释：`userAccountControl` 属性中，值设置成 65536 表示设置密码永不过期\n\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。\n***\n参考的文章：\n* Microsoft KB:[http://support.microsoft.com/kb/305144](http://support.microsoft.com/kb/305144)\n* MSDN:User-Account-Control Attribute - [http://msdn2.microsoft.com/en-us/library/ms680832.aspx](http://msdn2.microsoft.com/en-us/library/ms680832.aspx)","source":"_posts/how-to-turn-off-password-expiration-in-hmc-40.md","raw":"---\ntitle: 如何设置使 HMC 4.0 创建的用户的密码永不过期\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2007-11-10 12:01:02\n---\n\nHMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 `userAccountControl` 的属性来达到默认就是密码永不过期的目的。\n\n1.  以管理员身份登陆 MPS (MPSSQL)，打开 **Provisioning Manager**\n2.  在名称空间 \"Hosted Active Directory\" 中打开  **CreateUser** 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser: \n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n```\n注释或者去掉以下的2句判断语句\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n3.  改完之后应该类似这样\n```xml\n<execute namespace=\"Managed Active Directory\" procedure=\"ModifyUser\" impersonate=\"1\">\n<executeData>\n<user/>\n<properties>\n<!-- sets the password to never expire -->\n<property name=\"userAccountControl\">\n<value>65536</value>\n</property>\n</properties>\n</executeData>\n<before source=\"procedureData\" sourcePath=\"path\" destination=\"executeData\" destinationPath=\"user\" mode=\"merge\"/>\n<before source=\"data\" sourcePath=\"preferredDomainController\" destination=\"executeData\" mode=\"insert\"/>\n</execute>\n```\n4.  点击 \"Apply\" 保存修改。\n> 解释：`userAccountControl` 属性中，值设置成 65536 表示设置密码永不过期\n\n```xml\n<when select=\"isAdmin\" case=\"1\" />\n<when select=\"isBiz\" case=\"0\" />\n```\n这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。\n***\n参考的文章：\n* Microsoft KB:[http://support.microsoft.com/kb/305144](http://support.microsoft.com/kb/305144)\n* MSDN:User-Account-Control Attribute - [http://msdn2.microsoft.com/en-us/library/ms680832.aspx](http://msdn2.microsoft.com/en-us/library/ms680832.aspx)","slug":"how-to-turn-off-password-expiration-in-hmc-40","published":1,"updated":"2017-06-16T12:47:16.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jys00354gyr2fhcgpnr","content":"<p>HMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 <code>userAccountControl</code> 的属性来达到默认就是密码永不过期的目的。</p>\n<ol>\n<li>以管理员身份登陆 MPS (MPSSQL)，打开 <strong>Provisioning Manager</strong></li>\n<li>在名称空间 “Hosted Active Directory” 中打开  <strong>CreateUser</strong> 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser: <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>注释或者去掉以下的2句判断语句<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></div></pre></td></tr></table></figure></p>\n<ol>\n<li><p>改完之后应该类似这样</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!-- sets the password to never expire --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"userAccountControl\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>65536<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"procedureData\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"path\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destinationPath</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"preferredDomainController\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"insert\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></div></pre></td></tr></table></figure>\n</li>\n<li><p>点击 “Apply” 保存修改。</p>\n<blockquote>\n<p>解释：<code>userAccountControl</code> 属性中，值设置成 65536 表示设置密码永不过期</p>\n</blockquote>\n</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></div></pre></td></tr></table></figure>\n<p>这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。</p>\n<hr>\n<p>参考的文章：</p>\n<ul>\n<li>Microsoft KB:<a href=\"http://support.microsoft.com/kb/305144\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/305144</a></li>\n<li>MSDN:User-Account-Control Attribute - <a href=\"http://msdn2.microsoft.com/en-us/library/ms680832.aspx\" target=\"_blank\" rel=\"external\">http://msdn2.microsoft.com/en-us/library/ms680832.aspx</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>HMC 4.0 创建的用户，默认的帐户属性里面没有设置密码永不过期，这样就会产生个问题，在用户密码过期后，用户无法通过 OWA 再去修改或者重置密码，将会导致用户无法访问邮箱，为了解决这一问题，我们需要修改 MPS 默认的创建用户的脚本，通过设置 <code>userAccountControl</code> 的属性来达到默认就是密码永不过期的目的。</p>\n<ol>\n<li>以管理员身份登陆 MPS (MPSSQL)，打开 <strong>Provisioning Manager</strong></li>\n<li>在名称空间 “Hosted Active Directory” 中打开  <strong>CreateUser</strong> 过程的属性，找到更改用户的调用脚本 - Managed Active Directory::ModifyUser: <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></div></pre></td></tr></table></figure>\n</li>\n</ol>\n<p>注释或者去掉以下的2句判断语句<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></div></pre></td></tr></table></figure></p>\n<ol>\n<li><p>改完之后应该类似这样</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">execute</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Managed Active Directory\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ModifyUser\"</span> <span class=\"attr\">impersonate</span>=<span class=\"string\">\"1\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">user</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"comment\">&lt;!-- sets the password to never expire --&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"userAccountControl\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">value</span>&gt;</span>65536<span class=\"tag\">&lt;/<span class=\"name\">value</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">property</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">executeData</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"procedureData\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"path\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">destinationPath</span>=<span class=\"string\">\"user\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"merge\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">before</span> <span class=\"attr\">source</span>=<span class=\"string\">\"data\"</span> <span class=\"attr\">sourcePath</span>=<span class=\"string\">\"preferredDomainController\"</span> <span class=\"attr\">destination</span>=<span class=\"string\">\"executeData\"</span> <span class=\"attr\">mode</span>=<span class=\"string\">\"insert\"</span>/&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">execute</span>&gt;</span></div></pre></td></tr></table></figure>\n</li>\n<li><p>点击 “Apply” 保存修改。</p>\n<blockquote>\n<p>解释：<code>userAccountControl</code> 属性中，值设置成 65536 表示设置密码永不过期</p>\n</blockquote>\n</li>\n</ol>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isAdmin\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"1\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">when</span> <span class=\"attr\">select</span>=<span class=\"string\">\"isBiz\"</span> <span class=\"attr\">case</span>=<span class=\"string\">\"0\"</span> /&gt;</span></div></pre></td></tr></table></figure>\n<p>这2句很好理解，就是如果创建的用户是管理员的，密码就永不过期，如果是一般用户，就是默认设置，有密码有效期的。</p>\n<hr>\n<p>参考的文章：</p>\n<ul>\n<li>Microsoft KB:<a href=\"http://support.microsoft.com/kb/305144\" target=\"_blank\" rel=\"external\">http://support.microsoft.com/kb/305144</a></li>\n<li>MSDN:User-Account-Control Attribute - <a href=\"http://msdn2.microsoft.com/en-us/library/ms680832.aspx\" target=\"_blank\" rel=\"external\">http://msdn2.microsoft.com/en-us/library/ms680832.aspx</a></li>\n</ul>\n"},{"title":"使用 URL Rewrite 重定向 Http 请求至 Https","date":"2010-10-21T01:48:37.000Z","_content":"\n公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 \"HTTP Redirect\" 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。\n\n1. [http://www.iis.net/download/URLRewrite](http://www.iis.net/download/URLRewrite) 到这里下载，有分 32 和 64 位版本。\n2. 安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。\n{% asset_img url-rewrite-1.jpg url-rewrite-1 %}\n3. 双击打开，你会看到一个规则配置的页面。\n{% asset_img url-rewrite-2.jpg url-rewrite-2 %}\n4. 点击 \"Add Rules\" 添加规则，选择默认的\"Blank Rule\" 作为模板。\n{% asset_img url-rewrite-3.jpg url-rewrite-3 %}\n5. 在规则名字这一栏输入 \"Redirect to HTTPS\"。\n{% asset_img url-rewrite-4.jpg url-rewrite-4 %}\n6. 展开 \"Match URL\" 这个小三角，按如下设定：\n**Requested URL:** Matches the Pattern\n**Using:** Regular Expressions\n**Pattern:** (.\\*)\n{% asset_img url-rewrite-5.jpg url-rewrite-5 %}\n7. 在 \"Conditions\" 这里，点击 \"Add...\"。\n{% asset_img url-rewrite-6.jpg url-rewrite-6 %}\n8. 按以下设定输入：\n**Condition Input**: {HTTPS}\n**Check if input string**: Matches the Pattern\n**Pattern**: ^OFF$\n{% asset_img url-rewrite-7.jpg url-rewrite-7 %}\n9. 完成后入下图所示。\n{% asset_img url-rewrite-8.jpg url-rewrite-8 %}\n10. 最后一步就是重定向的设置了。\n - **Action Type**: Redirect\n - **Redirect URL**: [https://{HTTP_HOST}/{R:1](https://%7Bhttp_host%7D/%7BR:1)}\n - **Redirect Type**: See Other (303)\n{% asset_img url-rewrite-9.jpg url-rewrite-9 %}\n\n11. 点击右边的 \"Apply\" 应用，设置完成。\n{% asset_img url-rewrite-10.jpg url-rewrite-10 %}\n{% asset_img url-rewrite-11.jpg url-rewrite-11 %}\n> 补充： 因为本地的 IIS 还有个 Web Service 需要调用http://localhost/directory/service.asmx， 如上设置后，会被重定向去 http://localhost/directory/service.asmx， 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。\n12. 在\"Conditions\"这里，点击 \"Add...\"。\n13. 按以下设定输入，然后点击 Move Up 使其成为第一个条件\n    - **Condition Input**: {HTTPS_HOST}\n    - **Check if input string**: Does Not Matches the Pattern\n    - **Pattern**: ^(localhost)\n{% asset_img url-rewrite-12.jpg url-rewrite-12 %}\n14. 最后设定完成如图。\n{% asset_img url-rewrite-13.jpg url-rewrite-13 %}\n15. 在 web.config 里面你也可以看到最终的设置结果\n{% asset_img url-rewrite-14.jpg url-rewrite-14 %}","source":"_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7.md","raw":"---\ntitle: 使用 URL Rewrite 重定向 Http 请求至 Https\ntags:\n  - IIS\n  - Rewrite\ncategories:\n  - Microsoft\ndate: 2010-10-21 09:48:37\n---\n\n公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 \"HTTP Redirect\" 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。\n\n1. [http://www.iis.net/download/URLRewrite](http://www.iis.net/download/URLRewrite) 到这里下载，有分 32 和 64 位版本。\n2. 安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。\n{% asset_img url-rewrite-1.jpg url-rewrite-1 %}\n3. 双击打开，你会看到一个规则配置的页面。\n{% asset_img url-rewrite-2.jpg url-rewrite-2 %}\n4. 点击 \"Add Rules\" 添加规则，选择默认的\"Blank Rule\" 作为模板。\n{% asset_img url-rewrite-3.jpg url-rewrite-3 %}\n5. 在规则名字这一栏输入 \"Redirect to HTTPS\"。\n{% asset_img url-rewrite-4.jpg url-rewrite-4 %}\n6. 展开 \"Match URL\" 这个小三角，按如下设定：\n**Requested URL:** Matches the Pattern\n**Using:** Regular Expressions\n**Pattern:** (.\\*)\n{% asset_img url-rewrite-5.jpg url-rewrite-5 %}\n7. 在 \"Conditions\" 这里，点击 \"Add...\"。\n{% asset_img url-rewrite-6.jpg url-rewrite-6 %}\n8. 按以下设定输入：\n**Condition Input**: {HTTPS}\n**Check if input string**: Matches the Pattern\n**Pattern**: ^OFF$\n{% asset_img url-rewrite-7.jpg url-rewrite-7 %}\n9. 完成后入下图所示。\n{% asset_img url-rewrite-8.jpg url-rewrite-8 %}\n10. 最后一步就是重定向的设置了。\n - **Action Type**: Redirect\n - **Redirect URL**: [https://{HTTP_HOST}/{R:1](https://%7Bhttp_host%7D/%7BR:1)}\n - **Redirect Type**: See Other (303)\n{% asset_img url-rewrite-9.jpg url-rewrite-9 %}\n\n11. 点击右边的 \"Apply\" 应用，设置完成。\n{% asset_img url-rewrite-10.jpg url-rewrite-10 %}\n{% asset_img url-rewrite-11.jpg url-rewrite-11 %}\n> 补充： 因为本地的 IIS 还有个 Web Service 需要调用http://localhost/directory/service.asmx， 如上设置后，会被重定向去 http://localhost/directory/service.asmx， 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。\n12. 在\"Conditions\"这里，点击 \"Add...\"。\n13. 按以下设定输入，然后点击 Move Up 使其成为第一个条件\n    - **Condition Input**: {HTTPS_HOST}\n    - **Check if input string**: Does Not Matches the Pattern\n    - **Pattern**: ^(localhost)\n{% asset_img url-rewrite-12.jpg url-rewrite-12 %}\n14. 最后设定完成如图。\n{% asset_img url-rewrite-13.jpg url-rewrite-13 %}\n15. 在 web.config 里面你也可以看到最终的设置结果\n{% asset_img url-rewrite-14.jpg url-rewrite-14 %}","slug":"how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7","published":1,"updated":"2017-06-16T12:47:36.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyt003a4gyr557pmw33","content":"<p>公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 “HTTP Redirect” 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。</p>\n<ol>\n<li><a href=\"http://www.iis.net/download/URLRewrite\" target=\"_blank\" rel=\"external\">http://www.iis.net/download/URLRewrite</a> 到这里下载，有分 32 和 64 位版本。</li>\n<li>安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg\" alt=\"url-rewrite-1\" title=\"url-rewrite-1\"></li>\n<li>双击打开，你会看到一个规则配置的页面。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg\" alt=\"url-rewrite-2\" title=\"url-rewrite-2\"></li>\n<li>点击 “Add Rules” 添加规则，选择默认的”Blank Rule” 作为模板。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg\" alt=\"url-rewrite-3\" title=\"url-rewrite-3\"></li>\n<li>在规则名字这一栏输入 “Redirect to HTTPS”。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg\" alt=\"url-rewrite-4\" title=\"url-rewrite-4\"></li>\n<li>展开 “Match URL” 这个小三角，按如下设定：<br><strong>Requested URL:</strong> Matches the Pattern<br><strong>Using:</strong> Regular Expressions<br><strong>Pattern:</strong> (.*)<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg\" alt=\"url-rewrite-5\" title=\"url-rewrite-5\"></li>\n<li>在 “Conditions” 这里，点击 “Add…”。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg\" alt=\"url-rewrite-6\" title=\"url-rewrite-6\"></li>\n<li>按以下设定输入：<br><strong>Condition Input</strong>: {HTTPS}<br><strong>Check if input string</strong>: Matches the Pattern<br><strong>Pattern</strong>: ^OFF$<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg\" alt=\"url-rewrite-7\" title=\"url-rewrite-7\"></li>\n<li>完成后入下图所示。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg\" alt=\"url-rewrite-8\" title=\"url-rewrite-8\"></li>\n<li><p>最后一步就是重定向的设置了。</p>\n<ul>\n<li><strong>Action Type</strong>: Redirect</li>\n<li><strong>Redirect URL</strong>: <a href=\"https://%7Bhttp_host%7D/%7BR:1\" target=\"_blank\" rel=\"external\">https://{HTTP_HOST}/{R:1</a>}</li>\n<li><strong>Redirect Type</strong>: See Other (303)<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg\" alt=\"url-rewrite-9\" title=\"url-rewrite-9\">\n</li>\n</ul>\n</li>\n<li><p>点击右边的 “Apply” 应用，设置完成。</p>\n<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg\" alt=\"url-rewrite-10\" title=\"url-rewrite-10\">\n<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg\" alt=\"url-rewrite-11\" title=\"url-rewrite-11\">\n<blockquote>\n<p>补充： 因为本地的 IIS 还有个 Web Service 需要调用<a href=\"http://localhost/directory/service.asmx，\" target=\"_blank\" rel=\"external\">http://localhost/directory/service.asmx，</a> 如上设置后，会被重定向去 <a href=\"http://localhost/directory/service.asmx，\" target=\"_blank\" rel=\"external\">http://localhost/directory/service.asmx，</a> 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。</p>\n</blockquote>\n</li>\n<li>在”Conditions”这里，点击 “Add…”。</li>\n<li>按以下设定输入，然后点击 Move Up 使其成为第一个条件<ul>\n<li><strong>Condition Input</strong>: {HTTPS_HOST}</li>\n<li><strong>Check if input string</strong>: Does Not Matches the Pattern</li>\n<li><strong>Pattern</strong>: ^(localhost)<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg\" alt=\"url-rewrite-12\" title=\"url-rewrite-12\"></li>\n</ul>\n</li>\n<li>最后设定完成如图。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg\" alt=\"url-rewrite-13\" title=\"url-rewrite-13\"></li>\n<li>在 web.config 里面你也可以看到最终的设置结果<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg\" alt=\"url-rewrite-14\" title=\"url-rewrite-14\"></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>公司部署了个新的 IIS 站点，需要强制在 Https 下面访问，但是又不希望关掉80端口的 Http 请求，这样对用户体验来讲不好，最好是能强制所有的 Http 请求都会被重定向到 Https 上面去，显然， IIS 自带的 “HTTP Redirect” 已经不能满足这个需求，我们这里使用 IIS 7.0 下面的重定向扩展 URL Rewrite Module 来做。</p>\n<ol>\n<li><a href=\"http://www.iis.net/download/URLRewrite\" target=\"_blank\" rel=\"external\">http://www.iis.net/download/URLRewrite</a> 到这里下载，有分 32 和 64 位版本。</li>\n<li>安装完后，可以在 IIS 站点管理的根目录下面看到多了个 URL Rewrite。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg\" alt=\"url-rewrite-1\" title=\"url-rewrite-1\"></li>\n<li>双击打开，你会看到一个规则配置的页面。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg\" alt=\"url-rewrite-2\" title=\"url-rewrite-2\"></li>\n<li>点击 “Add Rules” 添加规则，选择默认的”Blank Rule” 作为模板。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg\" alt=\"url-rewrite-3\" title=\"url-rewrite-3\"></li>\n<li>在规则名字这一栏输入 “Redirect to HTTPS”。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg\" alt=\"url-rewrite-4\" title=\"url-rewrite-4\"></li>\n<li>展开 “Match URL” 这个小三角，按如下设定：<br><strong>Requested URL:</strong> Matches the Pattern<br><strong>Using:</strong> Regular Expressions<br><strong>Pattern:</strong> (.*)<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg\" alt=\"url-rewrite-5\" title=\"url-rewrite-5\"></li>\n<li>在 “Conditions” 这里，点击 “Add…”。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg\" alt=\"url-rewrite-6\" title=\"url-rewrite-6\"></li>\n<li>按以下设定输入：<br><strong>Condition Input</strong>: {HTTPS}<br><strong>Check if input string</strong>: Matches the Pattern<br><strong>Pattern</strong>: ^OFF$<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg\" alt=\"url-rewrite-7\" title=\"url-rewrite-7\"></li>\n<li>完成后入下图所示。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg\" alt=\"url-rewrite-8\" title=\"url-rewrite-8\"></li>\n<li><p>最后一步就是重定向的设置了。</p>\n<ul>\n<li><strong>Action Type</strong>: Redirect</li>\n<li><strong>Redirect URL</strong>: <a href=\"https://%7Bhttp_host%7D/%7BR:1\" target=\"_blank\" rel=\"external\">https://{HTTP_HOST}/{R:1</a>}</li>\n<li><strong>Redirect Type</strong>: See Other (303)<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg\" alt=\"url-rewrite-9\" title=\"url-rewrite-9\">\n</li>\n</ul>\n</li>\n<li><p>点击右边的 “Apply” 应用，设置完成。</p>\n<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg\" alt=\"url-rewrite-10\" title=\"url-rewrite-10\">\n<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg\" alt=\"url-rewrite-11\" title=\"url-rewrite-11\">\n<blockquote>\n<p>补充： 因为本地的 IIS 还有个 Web Service 需要调用<a href=\"http://localhost/directory/service.asmx，\" target=\"_blank\" rel=\"external\">http://localhost/directory/service.asmx，</a> 如上设置后，会被重定向去 <a href=\"http://localhost/directory/service.asmx，\" target=\"_blank\" rel=\"external\">http://localhost/directory/service.asmx，</a> 而由于SSL证书匹配的关系，这个Web Service调用会出错，所以我后来又再加上了个例外条件，使得本地的 localhost 调用请求不再转向 HTTPS。</p>\n</blockquote>\n</li>\n<li>在”Conditions”这里，点击 “Add…”。</li>\n<li>按以下设定输入，然后点击 Move Up 使其成为第一个条件<ul>\n<li><strong>Condition Input</strong>: {HTTPS_HOST}</li>\n<li><strong>Check if input string</strong>: Does Not Matches the Pattern</li>\n<li><strong>Pattern</strong>: ^(localhost)<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg\" alt=\"url-rewrite-12\" title=\"url-rewrite-12\"></li>\n</ul>\n</li>\n<li>最后设定完成如图。<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg\" alt=\"url-rewrite-13\" title=\"url-rewrite-13\"></li>\n<li>在 web.config 里面你也可以看到最终的设置结果<img src=\"/2010/10/21/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg\" alt=\"url-rewrite-14\" title=\"url-rewrite-14\"></li>\n</ol>\n"},{"title":"Install Microsoft Dynamics CRM 4.0 Server on multiple computers","date":"2008-06-28T07:10:02.000Z","_content":"\n这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 `Web Services` 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段， **ADsdkRootDomain** 和**ADWebApplicationRootDomain**， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了\n\n后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多\n[http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx](http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx)","source":"_posts/install-microsoft-dynamics-crm-4-0-server-on-multiple-computers.md","raw":"---\ntitle: Install Microsoft Dynamics CRM 4.0 Server on multiple computers\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2008-06-28 15:10:02\n---\n\n这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 `Web Services` 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段， **ADsdkRootDomain** 和**ADWebApplicationRootDomain**， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了\n\n后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多\n[http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx](http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx)","slug":"install-microsoft-dynamics-crm-4-0-server-on-multiple-computers","published":1,"updated":"2017-06-16T12:48:38.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyv003d4gyrb7fzx7ic","content":"<p>这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 <code>Web Services</code> 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段， <strong>ADsdkRootDomain</strong> 和<strong>ADWebApplicationRootDomain</strong>， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了</p>\n<p>后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多<br><a href=\"http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx\" target=\"_blank\" rel=\"external\">http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>这次在中银国际的项目部署上碰到了好多问题，最变态的是这个有关 CRM4 安装在多台服务器上的问题，2台 APP 服务器配置成 Network Load Balancing，CRM4 自带页面什么的都没有问题，而我们自定义的页面调用 <code>Web Services</code> 的时候全部去找第一台机器，晕死了，找了大半天都没发现原因所在，最后迫不得已在注册表中启用了 Trace，这才找到点线索，原来是在数据库里面，MSCRM_CONFIG 里面的 DeploymentProperties 表，有2个字段， <strong>ADsdkRootDomain</strong> 和<strong>ADWebApplicationRootDomain</strong>， 这里记录下的是第一台CRM Application 的计算机名，所以即使配置了NLB, 所有的通过 CRM SDK 的自定制页面还是会去找第一台机器的 Web Services， 该死的微软，提都不提一下的，把这2个改成 Localhost 或者 NLB Cluster 的名字，重启 IIS 就好了</p>\n<p>后来，在网上又搜到了这篇文章，发布日期还挺新的，看来部署这种场景的人不多<br><a href=\"http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx\" target=\"_blank\" rel=\"external\">http://rc.crm.dynamics.com/rc/regcont/en_us/OP/articles/crm_server_nlb.aspx</a></p>\n"},{"title":"CentOS 6.4 安装 Lighttpd+PHP5(PHP-FPM)+MySQL","date":"2013-04-28T10:17:41.000Z","_content":"\n#### 1. 安装 MySQL 5.0\n```bash\nyum install mysql mysql-server\n```\n将 MySQL 服务设置成自动启动\n```bash\nchkconfig --levels 23 mysqld on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/mysqld start #启动 mysqld 服务\n```\n接下来要设置 MySQL 的 root 密码\n```bash\nmysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] y\nNew password:\nAborting!\n\nCleaning up...\n[root@m2ahkvpn01 tmp]# mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n]\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n]\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n]\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n]\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n```\n####  2. 安装 Lighttpd\n\nLighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库 Remi RPM + EPEL\n```bash\n# EPEL库\nrpm --import https://fedoraproject.org/static/0608B895.txt\nwget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -ivh epel-release-6-8.noarch.rpm\n\n# Remi库\nrpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n# yum 软件库调整\nyum install yum-priorities\n```\n接下来要编辑两个文件 /etc/yum.repos.d/epel.repo 和 /etc/yum.repos.d/remi.repo，添加\n`priority=10`\n```bash\n#/etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 6 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=$basearch\nfailovermethod=priority\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6\n[...]\n```\n```bash\n#/etc/yum.repos.d/remi.repo\n[remi]\nname=Les RPM de remi pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/remi/mirror\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\nfailovermethod=priority\n\n[remi-test]\nname=Les RPM de remi en test pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/test/mirror\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n```\n安装 Lighttpd\n```bash\nyum install lighttpd\n```\n接下来设置开机启动 lighttpd 并立即启动\n```bash\nchkconfig --levels 23 lighttpd on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/lighttpd start #启动 lighttpd 服务</pre>\n这个时候你有可能会碰到这样的错误\n```\n<span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span>\n\n<span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can't have more connections than fds/2: 1024 1024</span>\n\n第一个是 IPV6 的问题，编辑 `/etc/lighttpd/lighttpd.conf` 文件\n```apacheconf\n[...]\n##\n## Use IPv6?\n##\nserver.use-ipv6 = \"disable\"\n[...]\n```\n第二个报错，编辑 `/etc/lighttpd/lighttpd.conf` 文件，注释掉 `server.max-fds = 2048`\n```apacheconf\n## With SELinux enabled, this is denied by default and needs to be allowed\n## by running the following once : setsebool -P httpd_setrlimit on\nserver.max-fds = 2048\n```\n或者\n```apacheconf\nsetsebool -P httpd_setrlimit 1\n```\n这个是 CentOS 自带的 SELinux 的问题，参见[Bug 571924 - lighttpd's server.max-fds conflicts with SELinux policy](https://bugzilla.redhat.com/show_bug.cgi?id=571924 \"Bug 571924 - lighttpd\")\n\n当然，你也可以用这个命令来暂时禁掉 SELinux\n`setenforce 0`\n然后再运行 `/etc/init.d/lighttpd start` 就没有问题了\n\n#### 3. 安装PHP5 (PHP-FPM)\n\n我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP\n```bash\nyum install php-fpm lighttpd-fastcgi</pre>\n```\n#### 4. 配置 Lighttpd 和 PHP\n\n编辑 `/etc/php-fpm.d/www.conf`，把其中 user 和 group 设定的用户从 apache 改成 lighttpd\n```apacheconf\n[...]\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n; RPM: apache Choosed to be able to access some dir as httpd\nuser = lighttpd\n; RPM: Keep a group allowed to write in log dir.\ngroup = lighttpd\n[...]\n```\n设置开机启动 php-fpm 并立即启动\n```bash\nchkconfig --levels 23 php-fpm on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/php-fpm start #启动 mysqld 服务\n```\n首先我们打开`/etc/php.ini`并在文件尾加入 `cgi.fix_pathinfo = 1`。\n然后打开 /etc/lighttpd/modules.conf  文件并在server.modules块中取消 <span style=\"color: #ff0000\">include \"conf.d/fastcgi.conf\"</span> 的注释（即删除前面的“#”）：\n```apacheconf\n##\n## FastCGI (mod_fastcgi)\n##\ninclude \"conf.d/fastcgi.conf\"\n```\n接着在 `/etc/lighttpd/conf.d/fastcgi.conf` ，找到`fastcgi.server` 块，改成如下：\n```apacheconf\nfastcgi.server += ( \".php\" =&gt;\n        ((\n                \"socket\" =&gt; \"/tmp/php5-fpm.sock\",\n                \"broken-scriptfilename\" =&gt; \"enable\"\n        ))\n)\n```\n修改完成之后重启 lighttpd 服务以使其生效\n```bash\n/etc/init.d/lighttpd restart\n```\n\n#### 5. 测试 PHP\n```bash\nvi /var/www/lighttpd/info.php\n```\n```php\n<php phpinfo();\n?>\n```\n\n####  6. 让 PHP5 支持 MySQL\n```bash\nyum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc\nyum install php-pecl-apc # APC 是类似 eAccelerator 和 Xcache 的php加速组件\n/etc/init.d/php-fpm reload #重新加载 php-fpm\n```\n#### 7.让 PHP-FPM 以 Unix Socket 方式运行\n```bash\nvi /etc/php-fpm.d/www.conf\n```\n```apacheconf\n[...]\n;listen = 127.0.0.1:9000\nlisten = /tmp/php5-fpm.sock\n[...]\n```\nReload PHP-FPM\n\n`/etc/init.d/php-fpm reload`","source":"_posts/installing-lighttpd-php5-mysql-on-centos-64.md","raw":"---\ntitle: CentOS 6.4 安装 Lighttpd+PHP5(PHP-FPM)+MySQL\ntags:\n  - CentOS\n  - Lighttpd\n  - MySQL\n  - PHP\ncategories:\n  - '*Nix'\ndate: 2013-04-28 18:17:41\n---\n\n#### 1. 安装 MySQL 5.0\n```bash\nyum install mysql mysql-server\n```\n将 MySQL 服务设置成自动启动\n```bash\nchkconfig --levels 23 mysqld on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/mysqld start #启动 mysqld 服务\n```\n接下来要设置 MySQL 的 root 密码\n```bash\nmysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: YES)\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] y\nNew password:\nAborting!\n\nCleaning up...\n[root@m2ahkvpn01 tmp]# mysql_secure_installation\n\nNOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL\n      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!\n\nIn order to log into MySQL to secure it, we'll need the current\npassword for the root user.  If you've just installed MySQL, and\nyou haven't set the root password yet, the password will be blank,\nso you should just press enter here.\n\nEnter current password for root (enter for none):\nOK, successfully used password, moving on...\n\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\n\nSet root password? [Y/n] Y\nNew password:\nRe-enter new password:\nPassword updated successfully!\nReloading privilege tables..\n ... Success!\n\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created for\nthem.  This is intended only for testing, and to make the installation\ngo a bit smoother.  You should remove them before moving into a\nproduction environment.\n\nRemove anonymous users? [Y/n]\n ... Success!\n\nNormally, root should only be allowed to connect from 'localhost'.  This\nensures that someone cannot guess at the root password from the network.\n\nDisallow root login remotely? [Y/n]\n ... Success!\n\nBy default, MySQL comes with a database named 'test' that anyone can\naccess.  This is also intended only for testing, and should be removed\nbefore moving into a production environment.\n\nRemove test database and access to it? [Y/n]\n - Dropping test database...\n ... Success!\n - Removing privileges on test database...\n ... Success!\n\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\n\nReload privilege tables now? [Y/n]\n ... Success!\n\nCleaning up...\n\nAll done!  If you've completed all of the above steps, your MySQL\ninstallation should now be secure.\n\nThanks for using MySQL!\n```\n####  2. 安装 Lighttpd\n\nLighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库 Remi RPM + EPEL\n```bash\n# EPEL库\nrpm --import https://fedoraproject.org/static/0608B895.txt\nwget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm\nrpm -ivh epel-release-6-8.noarch.rpm\n\n# Remi库\nrpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi\nrpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm\n# yum 软件库调整\nyum install yum-priorities\n```\n接下来要编辑两个文件 /etc/yum.repos.d/epel.repo 和 /etc/yum.repos.d/remi.repo，添加\n`priority=10`\n```bash\n#/etc/yum.repos.d/epel.repo\n[epel]\nname=Extra Packages for Enterprise Linux 6 - $basearch\n#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch\nmirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;arch=$basearch\nfailovermethod=priority\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6\n[...]\n```\n```bash\n#/etc/yum.repos.d/remi.repo\n[remi]\nname=Les RPM de remi pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/remi/mirror\nenabled=1\npriority=10\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\nfailovermethod=priority\n\n[remi-test]\nname=Les RPM de remi en test pour Enterprise Linux $releasever - $basearch\n#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/\nmirrorlist=http://rpms.famillecollet.com/enterprise/$releasever/test/mirror\nenabled=0\ngpgcheck=1\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi\n```\n安装 Lighttpd\n```bash\nyum install lighttpd\n```\n接下来设置开机启动 lighttpd 并立即启动\n```bash\nchkconfig --levels 23 lighttpd on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/lighttpd start #启动 lighttpd 服务</pre>\n这个时候你有可能会碰到这样的错误\n```\n<span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span>\n\n<span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can't have more connections than fds/2: 1024 1024</span>\n\n第一个是 IPV6 的问题，编辑 `/etc/lighttpd/lighttpd.conf` 文件\n```apacheconf\n[...]\n##\n## Use IPv6?\n##\nserver.use-ipv6 = \"disable\"\n[...]\n```\n第二个报错，编辑 `/etc/lighttpd/lighttpd.conf` 文件，注释掉 `server.max-fds = 2048`\n```apacheconf\n## With SELinux enabled, this is denied by default and needs to be allowed\n## by running the following once : setsebool -P httpd_setrlimit on\nserver.max-fds = 2048\n```\n或者\n```apacheconf\nsetsebool -P httpd_setrlimit 1\n```\n这个是 CentOS 自带的 SELinux 的问题，参见[Bug 571924 - lighttpd's server.max-fds conflicts with SELinux policy](https://bugzilla.redhat.com/show_bug.cgi?id=571924 \"Bug 571924 - lighttpd\")\n\n当然，你也可以用这个命令来暂时禁掉 SELinux\n`setenforce 0`\n然后再运行 `/etc/init.d/lighttpd start` 就没有问题了\n\n#### 3. 安装PHP5 (PHP-FPM)\n\n我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP\n```bash\nyum install php-fpm lighttpd-fastcgi</pre>\n```\n#### 4. 配置 Lighttpd 和 PHP\n\n编辑 `/etc/php-fpm.d/www.conf`，把其中 user 和 group 设定的用户从 apache 改成 lighttpd\n```apacheconf\n[...]\n; Unix user/group of processes\n; Note: The user is mandatory. If the group is not set, the default user's group\n;       will be used.\n; RPM: apache Choosed to be able to access some dir as httpd\nuser = lighttpd\n; RPM: Keep a group allowed to write in log dir.\ngroup = lighttpd\n[...]\n```\n设置开机启动 php-fpm 并立即启动\n```bash\nchkconfig --levels 23 php-fpm on #我这里没有 X，所以 23 运行级别就可以了\n/etc/init.d/php-fpm start #启动 mysqld 服务\n```\n首先我们打开`/etc/php.ini`并在文件尾加入 `cgi.fix_pathinfo = 1`。\n然后打开 /etc/lighttpd/modules.conf  文件并在server.modules块中取消 <span style=\"color: #ff0000\">include \"conf.d/fastcgi.conf\"</span> 的注释（即删除前面的“#”）：\n```apacheconf\n##\n## FastCGI (mod_fastcgi)\n##\ninclude \"conf.d/fastcgi.conf\"\n```\n接着在 `/etc/lighttpd/conf.d/fastcgi.conf` ，找到`fastcgi.server` 块，改成如下：\n```apacheconf\nfastcgi.server += ( \".php\" =&gt;\n        ((\n                \"socket\" =&gt; \"/tmp/php5-fpm.sock\",\n                \"broken-scriptfilename\" =&gt; \"enable\"\n        ))\n)\n```\n修改完成之后重启 lighttpd 服务以使其生效\n```bash\n/etc/init.d/lighttpd restart\n```\n\n#### 5. 测试 PHP\n```bash\nvi /var/www/lighttpd/info.php\n```\n```php\n<php phpinfo();\n?>\n```\n\n####  6. 让 PHP5 支持 MySQL\n```bash\nyum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc\nyum install php-pecl-apc # APC 是类似 eAccelerator 和 Xcache 的php加速组件\n/etc/init.d/php-fpm reload #重新加载 php-fpm\n```\n#### 7.让 PHP-FPM 以 Unix Socket 方式运行\n```bash\nvi /etc/php-fpm.d/www.conf\n```\n```apacheconf\n[...]\n;listen = 127.0.0.1:9000\nlisten = /tmp/php5-fpm.sock\n[...]\n```\nReload PHP-FPM\n\n`/etc/init.d/php-fpm reload`","slug":"installing-lighttpd-php5-mysql-on-centos-64","published":1,"updated":"2017-06-16T12:47:46.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jyy003h4gyr8h9w0uds","content":"<h4 id=\"1-安装-MySQL-5-0\"><a href=\"#1-安装-MySQL-5-0\" class=\"headerlink\" title=\"1. 安装 MySQL 5.0\"></a>1. 安装 MySQL 5.0</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install mysql mysql-server</div></pre></td></tr></table></figure>\n<p>将 MySQL 服务设置成自动启动<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig --levels 23 mysqld on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></div><div class=\"line\">/etc/init.d/mysqld start <span class=\"comment\">#启动 mysqld 服务</span></div></pre></td></tr></table></figure></p>\n<p>接下来要设置 MySQL 的 root 密码<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div><div class=\"line\"></div><div class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div><div class=\"line\"></div><div class=\"line\">In order to <span class=\"built_in\">log</span> into MySQL to secure it, we<span class=\"string\">'ll need the current</span></div><div class=\"line\"><span class=\"string\">password for the root user.  If you'</span>ve just installed MySQL, and</div><div class=\"line\">you haven<span class=\"string\">'t set the root password yet, the password will be blank,</span></div><div class=\"line\"><span class=\"string\">so you should just press enter here.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></div><div class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></div><div class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></div><div class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></div><div class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></div><div class=\"line\"><span class=\"string\">OK, successfully used password, moving on...</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Setting the root password ensures that nobody can log into the MySQL</span></div><div class=\"line\"><span class=\"string\">root user without the proper authorisation.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Set root password? [Y/n] y</span></div><div class=\"line\"><span class=\"string\">New password:</span></div><div class=\"line\"><span class=\"string\">Aborting!</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Cleaning up...</span></div><div class=\"line\"><span class=\"string\">[root@m2ahkvpn01 tmp]# mysql_secure_installation</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</span></div><div class=\"line\"><span class=\"string\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">In order to log into MySQL to secure it, we'</span>ll need the current</div><div class=\"line\">password <span class=\"keyword\">for</span> the root user.  If you<span class=\"string\">'ve just installed MySQL, and</span></div><div class=\"line\"><span class=\"string\">you haven'</span>t <span class=\"built_in\">set</span> the root password yet, the password will be blank,</div><div class=\"line\">so you should just press enter here.</div><div class=\"line\"></div><div class=\"line\">Enter current password <span class=\"keyword\">for</span> root (enter <span class=\"keyword\">for</span> none):</div><div class=\"line\">OK, successfully used password, moving on...</div><div class=\"line\"></div><div class=\"line\">Setting the root password ensures that nobody can <span class=\"built_in\">log</span> into the MySQL</div><div class=\"line\">root user without the proper authorisation.</div><div class=\"line\"></div><div class=\"line\">Set root password? [Y/n] Y</div><div class=\"line\">New password:</div><div class=\"line\">Re-enter new password:</div><div class=\"line\">Password updated successfully!</div><div class=\"line\">Reloading privilege tables..</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class=\"line\">to <span class=\"built_in\">log</span> into MySQL without having to have a user account created <span class=\"keyword\">for</span></div><div class=\"line\">them.  This is intended only <span class=\"keyword\">for</span> testing, and to make the installation</div><div class=\"line\">go a bit smoother.  You should remove them before moving into a</div><div class=\"line\">production environment.</div><div class=\"line\"></div><div class=\"line\">Remove anonymous users? [Y/n]</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Normally, root should only be allowed to connect from <span class=\"string\">'localhost'</span>.  This</div><div class=\"line\">ensures that someone cannot guess at the root password from the network.</div><div class=\"line\"></div><div class=\"line\">Disallow root login remotely? [Y/n]</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, MySQL comes with a database named <span class=\"string\">'test'</span> that anyone can</div><div class=\"line\">access.  This is also intended only <span class=\"keyword\">for</span> testing, and should be removed</div><div class=\"line\">before moving into a production environment.</div><div class=\"line\"></div><div class=\"line\">Remove <span class=\"built_in\">test</span> database and access to it? [Y/n]</div><div class=\"line\"> - Dropping <span class=\"built_in\">test</span> database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"> - Removing privileges on <span class=\"built_in\">test</span> database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Reloading the privilege tables will ensure that all changes made so far</div><div class=\"line\">will take effect immediately.</div><div class=\"line\"></div><div class=\"line\">Reload privilege tables now? [Y/n]</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Cleaning up...</div><div class=\"line\"></div><div class=\"line\">All <span class=\"keyword\">done</span>!  If you<span class=\"string\">'ve completed all of the above steps, your MySQL</span></div><div class=\"line\"><span class=\"string\">installation should now be secure.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Thanks for using MySQL!</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"2-安装-Lighttpd\"><a href=\"#2-安装-Lighttpd\" class=\"headerlink\" title=\"2. 安装 Lighttpd\"></a>2. 安装 Lighttpd</h4><p>Lighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库 Remi RPM + EPEL<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># EPEL库</span></div><div class=\"line\">rpm --import https://fedoraproject.org/static/0608B895.txt</div><div class=\"line\">wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div><div class=\"line\">rpm -ivh epel-release-6-8.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Remi库</span></div><div class=\"line\">rpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi</div><div class=\"line\">rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div><div class=\"line\"><span class=\"comment\"># yum 软件库调整</span></div><div class=\"line\">yum install yum-priorities</div></pre></td></tr></table></figure></p>\n<p>接下来要编辑两个文件 /etc/yum.repos.d/epel.repo 和 /etc/yum.repos.d/remi.repo，添加<br><code>priority=10</code><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/epel.repo</span></div><div class=\"line\">[epel]</div><div class=\"line\">name=Extra Packages <span class=\"keyword\">for</span> Enterprise Linux 6 - <span class=\"variable\">$basearch</span></div><div class=\"line\"><span class=\"comment\">#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch</span></div><div class=\"line\">mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;amp;arch=<span class=\"variable\">$basearch</span></div><div class=\"line\">failovermethod=priority</div><div class=\"line\">enabled=1</div><div class=\"line\">priority=10</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</div><div class=\"line\">[...]</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/remi.repo</span></div><div class=\"line\">[remi]</div><div class=\"line\">name=Les RPM de remi pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></div><div class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/</span></div><div class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/remi/mirror</div><div class=\"line\">enabled=1</div><div class=\"line\">priority=10</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div><div class=\"line\">failovermethod=priority</div><div class=\"line\"></div><div class=\"line\">[remi-test]</div><div class=\"line\">name=Les RPM de remi en <span class=\"built_in\">test</span> pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></div><div class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/</span></div><div class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/<span class=\"built_in\">test</span>/mirror</div><div class=\"line\">enabled=0</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div></pre></td></tr></table></figure>\n<p>安装 Lighttpd<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install lighttpd</div></pre></td></tr></table></figure></p>\n<p>接下来设置开机启动 lighttpd 并立即启动<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig --levels 23 lighttpd on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></div><div class=\"line\">/etc/init.d/lighttpd start <span class=\"comment\">#启动 lighttpd 服务&lt;/pre&gt;</span></div><div class=\"line\">这个时候你有可能会碰到这样的错误</div></pre></td></tr></table></figure></p>\n<p><span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span></p>\n<p><span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can’t have more connections than fds/2: 1024 1024</span></p>\n<p>第一个是 IPV6 的问题，编辑 <code>/etc/lighttpd/lighttpd.conf</code> 文件<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[...]</div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"comment\">## Use IPv6?</span></div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"attribute\">server</span>.use-ipv6 = <span class=\"string\">\"disable\"</span></div><div class=\"line\">[...]</div></pre></td></tr></table></figure></p>\n<p>第二个报错，编辑 <code>/etc/lighttpd/lighttpd.conf</code> 文件，注释掉 <code>server.max-fds = 2048</code><br><figure class=\"highlight apacheconf\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">## With SELinux enabled, this is denied by default and needs to be allowed</span></div><div class=\"line\"><span class=\"comment\">## by running the following once : setsebool -P httpd_setrlimit on</span></div><div class=\"line\"><span class=\"attribute\">server</span>.max-fds = 2048</div></pre></td></tr></table></figure></p>\n<p>或者<br><figure class=\"highlight apacheconf\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attribute\">setsebool</span> -P httpd_setrlimit 1</div></pre></td></tr></table></figure></p>\n<p>这个是 CentOS 自带的 SELinux 的问题，参见<a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=571924\" title=\"Bug 571924 - lighttpd\" target=\"_blank\" rel=\"external\">Bug 571924 - lighttpd’s server.max-fds conflicts with SELinux policy</a></p>\n<p>当然，你也可以用这个命令来暂时禁掉 SELinux<br><code>setenforce 0</code><br>然后再运行 <code>/etc/init.d/lighttpd start</code> 就没有问题了</p>\n<h4 id=\"3-安装PHP5-PHP-FPM\"><a href=\"#3-安装PHP5-PHP-FPM\" class=\"headerlink\" title=\"3. 安装PHP5 (PHP-FPM)\"></a>3. 安装PHP5 (PHP-FPM)</h4><p>我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install php-fpm lighttpd-fastcgi&lt;/pre&gt;</div></pre></td></tr></table></figure></p>\n<h4 id=\"4-配置-Lighttpd-和-PHP\"><a href=\"#4-配置-Lighttpd-和-PHP\" class=\"headerlink\" title=\"4. 配置 Lighttpd 和 PHP\"></a>4. 配置 Lighttpd 和 PHP</h4><p>编辑 <code>/etc/php-fpm.d/www.conf</code>，把其中 user 和 group 设定的用户从 apache 改成 lighttpd<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[...]</div><div class=\"line\">; Unix user/group of processes</div><div class=\"line\">; Note: The user is mandatory. If the group is not set, the default user's group</div><div class=\"line\">;       will be used.</div><div class=\"line\">; RPM: apache Choosed to be able to access some dir as httpd</div><div class=\"line\"><span class=\"attribute\">user</span> = lighttpd</div><div class=\"line\">; RPM: Keep a group allowed to write in log dir.</div><div class=\"line\"><span class=\"attribute\">group</span> = lighttpd</div><div class=\"line\">[...]</div></pre></td></tr></table></figure></p>\n<p>设置开机启动 php-fpm 并立即启动<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig --levels 23 php-fpm on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></div><div class=\"line\">/etc/init.d/php-fpm start <span class=\"comment\">#启动 mysqld 服务</span></div></pre></td></tr></table></figure></p>\n<p>首先我们打开<code>/etc/php.ini</code>并在文件尾加入 <code>cgi.fix_pathinfo = 1</code>。<br>然后打开 /etc/lighttpd/modules.conf  文件并在server.modules块中取消 <span style=\"color: #ff0000\">include “conf.d/fastcgi.conf”</span> 的注释（即删除前面的“#”）：<br><figure class=\"highlight apacheconf\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"comment\">## FastCGI (mod_fastcgi)</span></div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"attribute\">include</span> <span class=\"string\">\"conf.d/fastcgi.conf\"</span></div></pre></td></tr></table></figure></p>\n<p>接着在 <code>/etc/lighttpd/conf.d/fastcgi.conf</code> ，找到<code>fastcgi.server</code> 块，改成如下：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attribute\">fastcgi</span>.server += ( <span class=\"string\">\".php\"</span> =&amp;gt;</div><div class=\"line\">        ((</div><div class=\"line\">                \"socket\" =&amp;gt; \"/tmp/php5-fpm.sock\",</div><div class=\"line\">                \"broken-scriptfilename\" =&amp;gt; \"enable\"</div><div class=\"line\">        ))</div><div class=\"line\">)</div></pre></td></tr></table></figure></p>\n<p>修改完成之后重启 lighttpd 服务以使其生效<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/init.d/lighttpd restart</div></pre></td></tr></table></figure></p>\n<h4 id=\"5-测试-PHP\"><a href=\"#5-测试-PHP\" class=\"headerlink\" title=\"5. 测试 PHP\"></a>5. 测试 PHP</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /var/www/lighttpd/info.php</div></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;php phpinfo();</div><div class=\"line\"><span class=\"meta\">?&gt;</span></div></pre></td></tr></table></figure>\n<h4 id=\"6-让-PHP5-支持-MySQL\"><a href=\"#6-让-PHP5-支持-MySQL\" class=\"headerlink\" title=\"6. 让 PHP5 支持 MySQL\"></a>6. 让 PHP5 支持 MySQL</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc</div><div class=\"line\">yum install php-pecl-apc <span class=\"comment\"># APC 是类似 eAccelerator 和 Xcache 的php加速组件</span></div><div class=\"line\">/etc/init.d/php-fpm reload <span class=\"comment\">#重新加载 php-fpm</span></div></pre></td></tr></table></figure>\n<h4 id=\"7-让-PHP-FPM-以-Unix-Socket-方式运行\"><a href=\"#7-让-PHP-FPM-以-Unix-Socket-方式运行\" class=\"headerlink\" title=\"7.让 PHP-FPM 以 Unix Socket 方式运行\"></a>7.让 PHP-FPM 以 Unix Socket 方式运行</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /etc/php-fpm.d/www.conf</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[...]</div><div class=\"line\">;listen = 127.0.0.1:9000</div><div class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">listen</span></span> = /tmp/php5-fpm.sock</div><div class=\"line\">[...]</div></pre></td></tr></table></figure>\n<p>Reload PHP-FPM</p>\n<p><code>/etc/init.d/php-fpm reload</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"1-安装-MySQL-5-0\"><a href=\"#1-安装-MySQL-5-0\" class=\"headerlink\" title=\"1. 安装 MySQL 5.0\"></a>1. 安装 MySQL 5.0</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install mysql mysql-server</div></pre></td></tr></table></figure>\n<p>将 MySQL 服务设置成自动启动<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig --levels 23 mysqld on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></div><div class=\"line\">/etc/init.d/mysqld start <span class=\"comment\">#启动 mysqld 服务</span></div></pre></td></tr></table></figure></p>\n<p>接下来要设置 MySQL 的 root 密码<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div><div class=\"line\">51</div><div class=\"line\">52</div><div class=\"line\">53</div><div class=\"line\">54</div><div class=\"line\">55</div><div class=\"line\">56</div><div class=\"line\">57</div><div class=\"line\">58</div><div class=\"line\">59</div><div class=\"line\">60</div><div class=\"line\">61</div><div class=\"line\">62</div><div class=\"line\">63</div><div class=\"line\">64</div><div class=\"line\">65</div><div class=\"line\">66</div><div class=\"line\">67</div><div class=\"line\">68</div><div class=\"line\">69</div><div class=\"line\">70</div><div class=\"line\">71</div><div class=\"line\">72</div><div class=\"line\">73</div><div class=\"line\">74</div><div class=\"line\">75</div><div class=\"line\">76</div><div class=\"line\">77</div><div class=\"line\">78</div><div class=\"line\">79</div><div class=\"line\">80</div><div class=\"line\">81</div><div class=\"line\">82</div><div class=\"line\">83</div><div class=\"line\">84</div><div class=\"line\">85</div></pre></td><td class=\"code\"><pre><div class=\"line\">mysql_secure_installation</div><div class=\"line\"></div><div class=\"line\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</div><div class=\"line\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</div><div class=\"line\"></div><div class=\"line\">In order to <span class=\"built_in\">log</span> into MySQL to secure it, we<span class=\"string\">'ll need the current</span></div><div class=\"line\"><span class=\"string\">password for the root user.  If you'</span>ve just installed MySQL, and</div><div class=\"line\">you haven<span class=\"string\">'t set the root password yet, the password will be blank,</span></div><div class=\"line\"><span class=\"string\">so you should just press enter here.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></div><div class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></div><div class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></div><div class=\"line\"><span class=\"string\">ERROR 1045 (28000): Access denied for user '</span>root<span class=\"string\">'@'</span>localhost<span class=\"string\">' (using password: YES)</span></div><div class=\"line\"><span class=\"string\">Enter current password for root (enter for none):</span></div><div class=\"line\"><span class=\"string\">OK, successfully used password, moving on...</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Setting the root password ensures that nobody can log into the MySQL</span></div><div class=\"line\"><span class=\"string\">root user without the proper authorisation.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Set root password? [Y/n] y</span></div><div class=\"line\"><span class=\"string\">New password:</span></div><div class=\"line\"><span class=\"string\">Aborting!</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Cleaning up...</span></div><div class=\"line\"><span class=\"string\">[root@m2ahkvpn01 tmp]# mysql_secure_installation</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MySQL</span></div><div class=\"line\"><span class=\"string\">      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">In order to log into MySQL to secure it, we'</span>ll need the current</div><div class=\"line\">password <span class=\"keyword\">for</span> the root user.  If you<span class=\"string\">'ve just installed MySQL, and</span></div><div class=\"line\"><span class=\"string\">you haven'</span>t <span class=\"built_in\">set</span> the root password yet, the password will be blank,</div><div class=\"line\">so you should just press enter here.</div><div class=\"line\"></div><div class=\"line\">Enter current password <span class=\"keyword\">for</span> root (enter <span class=\"keyword\">for</span> none):</div><div class=\"line\">OK, successfully used password, moving on...</div><div class=\"line\"></div><div class=\"line\">Setting the root password ensures that nobody can <span class=\"built_in\">log</span> into the MySQL</div><div class=\"line\">root user without the proper authorisation.</div><div class=\"line\"></div><div class=\"line\">Set root password? [Y/n] Y</div><div class=\"line\">New password:</div><div class=\"line\">Re-enter new password:</div><div class=\"line\">Password updated successfully!</div><div class=\"line\">Reloading privilege tables..</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, a MySQL installation has an anonymous user, allowing anyone</div><div class=\"line\">to <span class=\"built_in\">log</span> into MySQL without having to have a user account created <span class=\"keyword\">for</span></div><div class=\"line\">them.  This is intended only <span class=\"keyword\">for</span> testing, and to make the installation</div><div class=\"line\">go a bit smoother.  You should remove them before moving into a</div><div class=\"line\">production environment.</div><div class=\"line\"></div><div class=\"line\">Remove anonymous users? [Y/n]</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Normally, root should only be allowed to connect from <span class=\"string\">'localhost'</span>.  This</div><div class=\"line\">ensures that someone cannot guess at the root password from the network.</div><div class=\"line\"></div><div class=\"line\">Disallow root login remotely? [Y/n]</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">By default, MySQL comes with a database named <span class=\"string\">'test'</span> that anyone can</div><div class=\"line\">access.  This is also intended only <span class=\"keyword\">for</span> testing, and should be removed</div><div class=\"line\">before moving into a production environment.</div><div class=\"line\"></div><div class=\"line\">Remove <span class=\"built_in\">test</span> database and access to it? [Y/n]</div><div class=\"line\"> - Dropping <span class=\"built_in\">test</span> database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"> - Removing privileges on <span class=\"built_in\">test</span> database...</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Reloading the privilege tables will ensure that all changes made so far</div><div class=\"line\">will take effect immediately.</div><div class=\"line\"></div><div class=\"line\">Reload privilege tables now? [Y/n]</div><div class=\"line\"> ... Success!</div><div class=\"line\"></div><div class=\"line\">Cleaning up...</div><div class=\"line\"></div><div class=\"line\">All <span class=\"keyword\">done</span>!  If you<span class=\"string\">'ve completed all of the above steps, your MySQL</span></div><div class=\"line\"><span class=\"string\">installation should now be secure.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Thanks for using MySQL!</span></div></pre></td></tr></table></figure></p>\n<h4 id=\"2-安装-Lighttpd\"><a href=\"#2-安装-Lighttpd\" class=\"headerlink\" title=\"2. 安装 Lighttpd\"></a>2. 安装 Lighttpd</h4><p>Lighttpd并没有在 CentOS 6 的官方软件库里面，所以我们需要手动安装第三方软件库 Remi RPM + EPEL<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\"># EPEL库</span></div><div class=\"line\">rpm --import https://fedoraproject.org/static/0608B895.txt</div><div class=\"line\">wget http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm</div><div class=\"line\">rpm -ivh epel-release-6-8.noarch.rpm</div><div class=\"line\"></div><div class=\"line\"><span class=\"comment\"># Remi库</span></div><div class=\"line\">rpm --import http://rpms.famillecollet.com/RPM-GPG-KEY-remi</div><div class=\"line\">rpm -ivh http://rpms.famillecollet.com/enterprise/remi-release-6.rpm</div><div class=\"line\"><span class=\"comment\"># yum 软件库调整</span></div><div class=\"line\">yum install yum-priorities</div></pre></td></tr></table></figure></p>\n<p>接下来要编辑两个文件 /etc/yum.repos.d/epel.repo 和 /etc/yum.repos.d/remi.repo，添加<br><code>priority=10</code><br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/epel.repo</span></div><div class=\"line\">[epel]</div><div class=\"line\">name=Extra Packages <span class=\"keyword\">for</span> Enterprise Linux 6 - <span class=\"variable\">$basearch</span></div><div class=\"line\"><span class=\"comment\">#baseurl=http://download.fedoraproject.org/pub/epel/6/$basearch</span></div><div class=\"line\">mirrorlist=https://mirrors.fedoraproject.org/metalink?repo=epel-6&amp;amp;arch=<span class=\"variable\">$basearch</span></div><div class=\"line\">failovermethod=priority</div><div class=\"line\">enabled=1</div><div class=\"line\">priority=10</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6</div><div class=\"line\">[...]</div></pre></td></tr></table></figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">#/etc/yum.repos.d/remi.repo</span></div><div class=\"line\">[remi]</div><div class=\"line\">name=Les RPM de remi pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></div><div class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/remi/$basearch/</span></div><div class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/remi/mirror</div><div class=\"line\">enabled=1</div><div class=\"line\">priority=10</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div><div class=\"line\">failovermethod=priority</div><div class=\"line\"></div><div class=\"line\">[remi-test]</div><div class=\"line\">name=Les RPM de remi en <span class=\"built_in\">test</span> pour Enterprise Linux <span class=\"variable\">$releasever</span> - <span class=\"variable\">$basearch</span></div><div class=\"line\"><span class=\"comment\">#baseurl=http://rpms.famillecollet.com/enterprise/$releasever/test/$basearch/</span></div><div class=\"line\">mirrorlist=http://rpms.famillecollet.com/enterprise/<span class=\"variable\">$releasever</span>/<span class=\"built_in\">test</span>/mirror</div><div class=\"line\">enabled=0</div><div class=\"line\">gpgcheck=1</div><div class=\"line\">gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</div></pre></td></tr></table></figure>\n<p>安装 Lighttpd<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install lighttpd</div></pre></td></tr></table></figure></p>\n<p>接下来设置开机启动 lighttpd 并立即启动<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig --levels 23 lighttpd on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></div><div class=\"line\">/etc/init.d/lighttpd start <span class=\"comment\">#启动 lighttpd 服务&lt;/pre&gt;</span></div><div class=\"line\">这个时候你有可能会碰到这样的错误</div></pre></td></tr></table></figure></p>\n<p><span style=\"color: #0000ff\">Starting lighttpd: 2013-04-28 16:57:47: (network.c.260) warning: please use server.use-ipv6 only for hostnames, not without server.bind / empty address; your config will break if the kernel default for IPV6_V6ONLY changes</span></p>\n<p><span style=\"color: #0000ff\">2013-04-28 16:57:47: (server.c.915) can’t have more connections than fds/2: 1024 1024</span></p>\n<p>第一个是 IPV6 的问题，编辑 <code>/etc/lighttpd/lighttpd.conf</code> 文件<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">[...]</div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"comment\">## Use IPv6?</span></div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"attribute\">server</span>.use-ipv6 = <span class=\"string\">\"disable\"</span></div><div class=\"line\">[...]</div></pre></td></tr></table></figure></p>\n<p>第二个报错，编辑 <code>/etc/lighttpd/lighttpd.conf</code> 文件，注释掉 <code>server.max-fds = 2048</code><br><figure class=\"highlight apacheconf\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">## With SELinux enabled, this is denied by default and needs to be allowed</span></div><div class=\"line\"><span class=\"comment\">## by running the following once : setsebool -P httpd_setrlimit on</span></div><div class=\"line\"><span class=\"attribute\">server</span>.max-fds = 2048</div></pre></td></tr></table></figure></p>\n<p>或者<br><figure class=\"highlight apacheconf\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attribute\">setsebool</span> -P httpd_setrlimit 1</div></pre></td></tr></table></figure></p>\n<p>这个是 CentOS 自带的 SELinux 的问题，参见<a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=571924\" title=\"Bug 571924 - lighttpd\" target=\"_blank\" rel=\"external\">Bug 571924 - lighttpd’s server.max-fds conflicts with SELinux policy</a></p>\n<p>当然，你也可以用这个命令来暂时禁掉 SELinux<br><code>setenforce 0</code><br>然后再运行 <code>/etc/init.d/lighttpd start</code> 就没有问题了</p>\n<h4 id=\"3-安装PHP5-PHP-FPM\"><a href=\"#3-安装PHP5-PHP-FPM\" class=\"headerlink\" title=\"3. 安装PHP5 (PHP-FPM)\"></a>3. 安装PHP5 (PHP-FPM)</h4><p>我们需要 Lighttpd 通过加载 PHP-FPM 来解析PHP<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install php-fpm lighttpd-fastcgi&lt;/pre&gt;</div></pre></td></tr></table></figure></p>\n<h4 id=\"4-配置-Lighttpd-和-PHP\"><a href=\"#4-配置-Lighttpd-和-PHP\" class=\"headerlink\" title=\"4. 配置 Lighttpd 和 PHP\"></a>4. 配置 Lighttpd 和 PHP</h4><p>编辑 <code>/etc/php-fpm.d/www.conf</code>，把其中 user 和 group 设定的用户从 apache 改成 lighttpd<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[...]</div><div class=\"line\">; Unix user/group of processes</div><div class=\"line\">; Note: The user is mandatory. If the group is not set, the default user's group</div><div class=\"line\">;       will be used.</div><div class=\"line\">; RPM: apache Choosed to be able to access some dir as httpd</div><div class=\"line\"><span class=\"attribute\">user</span> = lighttpd</div><div class=\"line\">; RPM: Keep a group allowed to write in log dir.</div><div class=\"line\"><span class=\"attribute\">group</span> = lighttpd</div><div class=\"line\">[...]</div></pre></td></tr></table></figure></p>\n<p>设置开机启动 php-fpm 并立即启动<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">chkconfig --levels 23 php-fpm on <span class=\"comment\">#我这里没有 X，所以 23 运行级别就可以了</span></div><div class=\"line\">/etc/init.d/php-fpm start <span class=\"comment\">#启动 mysqld 服务</span></div></pre></td></tr></table></figure></p>\n<p>首先我们打开<code>/etc/php.ini</code>并在文件尾加入 <code>cgi.fix_pathinfo = 1</code>。<br>然后打开 /etc/lighttpd/modules.conf  文件并在server.modules块中取消 <span style=\"color: #ff0000\">include “conf.d/fastcgi.conf”</span> 的注释（即删除前面的“#”）：<br><figure class=\"highlight apacheconf\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"comment\">## FastCGI (mod_fastcgi)</span></div><div class=\"line\"><span class=\"comment\">##</span></div><div class=\"line\"><span class=\"attribute\">include</span> <span class=\"string\">\"conf.d/fastcgi.conf\"</span></div></pre></td></tr></table></figure></p>\n<p>接着在 <code>/etc/lighttpd/conf.d/fastcgi.conf</code> ，找到<code>fastcgi.server</code> 块，改成如下：<br><figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"attribute\">fastcgi</span>.server += ( <span class=\"string\">\".php\"</span> =&amp;gt;</div><div class=\"line\">        ((</div><div class=\"line\">                \"socket\" =&amp;gt; \"/tmp/php5-fpm.sock\",</div><div class=\"line\">                \"broken-scriptfilename\" =&amp;gt; \"enable\"</div><div class=\"line\">        ))</div><div class=\"line\">)</div></pre></td></tr></table></figure></p>\n<p>修改完成之后重启 lighttpd 服务以使其生效<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/init.d/lighttpd restart</div></pre></td></tr></table></figure></p>\n<h4 id=\"5-测试-PHP\"><a href=\"#5-测试-PHP\" class=\"headerlink\" title=\"5. 测试 PHP\"></a>5. 测试 PHP</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /var/www/lighttpd/info.php</div></pre></td></tr></table></figure>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;php phpinfo();</div><div class=\"line\"><span class=\"meta\">?&gt;</span></div></pre></td></tr></table></figure>\n<h4 id=\"6-让-PHP5-支持-MySQL\"><a href=\"#6-让-PHP5-支持-MySQL\" class=\"headerlink\" title=\"6. 让 PHP5 支持 MySQL\"></a>6. 让 PHP5 支持 MySQL</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">yum install php-mysql php-gd php-imap php-ldap php-odbc php-pear php-xml php-xmlrpc</div><div class=\"line\">yum install php-pecl-apc <span class=\"comment\"># APC 是类似 eAccelerator 和 Xcache 的php加速组件</span></div><div class=\"line\">/etc/init.d/php-fpm reload <span class=\"comment\">#重新加载 php-fpm</span></div></pre></td></tr></table></figure>\n<h4 id=\"7-让-PHP-FPM-以-Unix-Socket-方式运行\"><a href=\"#7-让-PHP-FPM-以-Unix-Socket-方式运行\" class=\"headerlink\" title=\"7.让 PHP-FPM 以 Unix Socket 方式运行\"></a>7.让 PHP-FPM 以 Unix Socket 方式运行</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">vi /etc/php-fpm.d/www.conf</div></pre></td></tr></table></figure>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">[...]</div><div class=\"line\">;listen = 127.0.0.1:9000</div><div class=\"line\"><span class=\"attribute\"><span class=\"nomarkup\">listen</span></span> = /tmp/php5-fpm.sock</div><div class=\"line\">[...]</div></pre></td></tr></table></figure>\n<p>Reload PHP-FPM</p>\n<p><code>/etc/init.d/php-fpm reload</code></p>\n"},{"title":"Installing MSCRM 4.0 without Internet Access","date":"2008-01-08T01:59:15.000Z","_content":"\nIf you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it's being 'manufactured') ships with these prerequisites but the downloads do not.\nThe simplest way is to install each of the Pre-Req's manually. The best place to search for these is [download.microsoft.com](http://download.microsoft.com/). I'll refrain from posting links as these redistributable packages are always being updated.\nThe Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it's installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:\n\n*   \\Redist\\i386\\VCRedist\\vcredist_x86.exe\n*   \\Redist\\i386\\VCRedist\\vcredist_x64.exe\n*   \\Redist\\amd64\\VCRedist\\vcredist_x64.exe\n*   \\Server\\i386\\SetupServer.exe\n*   \\Server\\amd64\\SetupServer.exe\n*   \\Client\\SetupClient.exe\n*   \\DMWizard\\SetupDMClient.exe\n*   \\Exchange\\i386\\setupexchange.exe\n*   \\Exchange\\amd64\\setupexchange.exe\nI added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.\n\n***\n中文版本 ：\n自己上 MS 的网站上去下载 VC++ Runtime\n新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span>\nMSCRM4\\Client\\SetupClient.exe\nMSCRM4\\DMWizard\\SetupDMClient.exe\nMSCRM4\\Exchange\\i386\\setupexchange.exe\nMSCRM4\\Exchange\\amd64\\setupexchange.exe\n\n> 红色的就是表示 VC++ runtime 文件所要放置的位置\n> 蓝色的表示 MS CRM4.0 Server 的安装程序所在位置\n\n因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。","source":"_posts/installing-mscrm-4-0-without-internet-access.md","raw":"---\ntitle: Installing MSCRM 4.0 without Internet Access\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2008-01-08 09:59:15\n---\n\nIf you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it's being 'manufactured') ships with these prerequisites but the downloads do not.\nThe simplest way is to install each of the Pre-Req's manually. The best place to search for these is [download.microsoft.com](http://download.microsoft.com/). I'll refrain from posting links as these redistributable packages are always being updated.\nThe Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it's installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:\n\n*   \\Redist\\i386\\VCRedist\\vcredist_x86.exe\n*   \\Redist\\i386\\VCRedist\\vcredist_x64.exe\n*   \\Redist\\amd64\\VCRedist\\vcredist_x64.exe\n*   \\Server\\i386\\SetupServer.exe\n*   \\Server\\amd64\\SetupServer.exe\n*   \\Client\\SetupClient.exe\n*   \\DMWizard\\SetupDMClient.exe\n*   \\Exchange\\i386\\setupexchange.exe\n*   \\Exchange\\amd64\\setupexchange.exe\nI added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.\n\n***\n中文版本 ：\n自己上 MS 的网站上去下载 VC++ Runtime\n新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span>\n<span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span>\nMSCRM4\\Client\\SetupClient.exe\nMSCRM4\\DMWizard\\SetupDMClient.exe\nMSCRM4\\Exchange\\i386\\setupexchange.exe\nMSCRM4\\Exchange\\amd64\\setupexchange.exe\n\n> 红色的就是表示 VC++ runtime 文件所要放置的位置\n> 蓝色的表示 MS CRM4.0 Server 的安装程序所在位置\n\n因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。","slug":"installing-mscrm-4-0-without-internet-access","published":1,"updated":"2017-06-16T12:48:02.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jz2003k4gyr4aujqffk","content":"<p>If you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it’s being ‘manufactured’) ships with these prerequisites but the downloads do not.<br>The simplest way is to install each of the Pre-Req’s manually. The best place to search for these is <a href=\"http://download.microsoft.com/\" target=\"_blank\" rel=\"external\">download.microsoft.com</a>. I’ll refrain from posting links as these redistributable packages are always being updated.<br>The Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it’s installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:</p>\n<ul>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x86.exe</li>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Server\\i386\\SetupServer.exe</li>\n<li>\\Server\\amd64\\SetupServer.exe</li>\n<li>\\Client\\SetupClient.exe</li>\n<li>\\DMWizard\\SetupDMClient.exe</li>\n<li>\\Exchange\\i386\\setupexchange.exe</li>\n<li>\\Exchange\\amd64\\setupexchange.exe<br>I added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.</li>\n</ul>\n<hr>\n<p>中文版本 ：<br>自己上 MS 的网站上去下载 VC++ Runtime<br>新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录<br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span><br>MSCRM4\\Client\\SetupClient.exe<br>MSCRM4\\DMWizard\\SetupDMClient.exe<br>MSCRM4\\Exchange\\i386\\setupexchange.exe<br>MSCRM4\\Exchange\\amd64\\setupexchange.exe</p>\n<blockquote>\n<p>红色的就是表示 VC++ runtime 文件所要放置的位置<br>蓝色的表示 MS CRM4.0 Server 的安装程序所在位置</p>\n</blockquote>\n<p>因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>If you are installing CRM 4.0 on a machine without Internet access (eg. a VPC running only on a Loopback Adapter) you might run into some problems when CRM tries to download pre-requisite packages. Our DVD version (not out yet - it’s being ‘manufactured’) ships with these prerequisites but the downloads do not.<br>The simplest way is to install each of the Pre-Req’s manually. The best place to search for these is <a href=\"http://download.microsoft.com/\" target=\"_blank\" rel=\"external\">download.microsoft.com</a>. I’ll refrain from posting links as these redistributable packages are always being updated.<br>The Visual C++ Redistributable Package presents us with a slightly different challenge. The package is unable to detect it’s installed state so CRM always installs it. So we need to create a Redist folder, subfolders for i386/amd64, a VCRedist folder and then place the VC++ install files there. Your full folder structure should look like this:</p>\n<ul>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x86.exe</li>\n<li>\\Redist\\i386\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</li>\n<li>\\Server\\i386\\SetupServer.exe</li>\n<li>\\Server\\amd64\\SetupServer.exe</li>\n<li>\\Client\\SetupClient.exe</li>\n<li>\\DMWizard\\SetupDMClient.exe</li>\n<li>\\Exchange\\i386\\setupexchange.exe</li>\n<li>\\Exchange\\amd64\\setupexchange.exe<br>I added this setup.exes to the list to show the folder structure for the Server, Client, DM and Router (the Exchange folder). Note that the Redist folder is a peer to the Server and Client.</li>\n</ul>\n<hr>\n<p>中文版本 ：<br>自己上 MS 的网站上去下载 VC++ Runtime<br>新建一个目录，比如 MSCRM4, 在该目录下再建立如下目录<br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x86.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\i386\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #ff0000\">MSCRM4\\Redist\\amd64\\VCRedist\\vcredist_x64.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\i386\\SetupServer.exe</span><br><span style=\"color: #0000ff\">MSCRM4\\Server\\amd64\\SetupServer.exe</span><br>MSCRM4\\Client\\SetupClient.exe<br>MSCRM4\\DMWizard\\SetupDMClient.exe<br>MSCRM4\\Exchange\\i386\\setupexchange.exe<br>MSCRM4\\Exchange\\amd64\\setupexchange.exe</p>\n<blockquote>\n<p>红色的就是表示 VC++ runtime 文件所要放置的位置<br>蓝色的表示 MS CRM4.0 Server 的安装程序所在位置</p>\n</blockquote>\n<p>因为CRM4的安装程序需要上网去更新一些组件，如果你的服务器不能上网的话，就请参照此目录结构建立文件夹和放置正确的文件，这样就能跳过网上下载安装。</p>\n"},{"title":"在 CentOS 中安装 VMware Tools","date":"2013-04-28T04:26:46.000Z","_content":"\n不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。\n\n在 VMware 中挂上 VMware Tools 的 ISO： VM -> Guest -> Install/Upgrade VMware Tools\n```bash\nmkdir /media/cdrom  #创建挂载点目录\nmount /dev/cdrom /media/cdrom #挂载光盘\ncp /media/cdrom/VMwareTools*.tar.gz /tmp #复制文件到 /tmp\ncd /tmp\ntar –xzvf VMwareTools*.tar.gz &amp;nbsp;# 解压缩\ncd vm* #注意这里的 vm 是小写\n./vmware-install.pl\n```\n基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools\n```bash\n/etc/init.d/networking stop\nrmmod pcnet32\nrmmod vmxnet\ndepmod -a\nmodprobe vmxnet\n/etc/init.d/networking start\n```","source":"_posts/installing-vmware-tools-on-centos.md","raw":"---\ntitle: 在 CentOS 中安装 VMware Tools\ntags:\n  - CentOS\n  - VMware\n  - VMware Tools\ncategories:\n  - '*Nix'\ndate: 2013-04-28 12:26:46\n---\n\n不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。\n\n在 VMware 中挂上 VMware Tools 的 ISO： VM -> Guest -> Install/Upgrade VMware Tools\n```bash\nmkdir /media/cdrom  #创建挂载点目录\nmount /dev/cdrom /media/cdrom #挂载光盘\ncp /media/cdrom/VMwareTools*.tar.gz /tmp #复制文件到 /tmp\ncd /tmp\ntar –xzvf VMwareTools*.tar.gz &amp;nbsp;# 解压缩\ncd vm* #注意这里的 vm 是小写\n./vmware-install.pl\n```\n基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools\n```bash\n/etc/init.d/networking stop\nrmmod pcnet32\nrmmod vmxnet\ndepmod -a\nmodprobe vmxnet\n/etc/init.d/networking start\n```","slug":"installing-vmware-tools-on-centos","published":1,"updated":"2017-06-16T12:48:24.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jz4003o4gyrj0emejek","content":"<p>不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。</p>\n<p>在 VMware 中挂上 VMware Tools 的 ISO： VM -&gt; Guest -&gt; Install/Upgrade VMware Tools<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /media/cdrom  <span class=\"comment\">#创建挂载点目录</span></div><div class=\"line\">mount /dev/cdrom /media/cdrom <span class=\"comment\">#挂载光盘</span></div><div class=\"line\">cp /media/cdrom/VMwareTools*.tar.gz /tmp <span class=\"comment\">#复制文件到 /tmp</span></div><div class=\"line\"><span class=\"built_in\">cd</span> /tmp</div><div class=\"line\">tar –xzvf VMwareTools*.tar.gz &amp;amp;nbsp;<span class=\"comment\"># 解压缩</span></div><div class=\"line\"><span class=\"built_in\">cd</span> vm* <span class=\"comment\">#注意这里的 vm 是小写</span></div><div class=\"line\">./vmware-install.pl</div></pre></td></tr></table></figure></p>\n<p>基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/init.d/networking stop</div><div class=\"line\">rmmod pcnet32</div><div class=\"line\">rmmod vmxnet</div><div class=\"line\">depmod -a</div><div class=\"line\">modprobe vmxnet</div><div class=\"line\">/etc/init.d/networking start</div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>不管在什么情况下，我们一般认为安装 VMware Tools 带来的好处要远远大于不安装，所以仅以此文记录下安装步骤。</p>\n<p>在 VMware 中挂上 VMware Tools 的 ISO： VM -&gt; Guest -&gt; Install/Upgrade VMware Tools<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">mkdir /media/cdrom  <span class=\"comment\">#创建挂载点目录</span></div><div class=\"line\">mount /dev/cdrom /media/cdrom <span class=\"comment\">#挂载光盘</span></div><div class=\"line\">cp /media/cdrom/VMwareTools*.tar.gz /tmp <span class=\"comment\">#复制文件到 /tmp</span></div><div class=\"line\"><span class=\"built_in\">cd</span> /tmp</div><div class=\"line\">tar –xzvf VMwareTools*.tar.gz &amp;amp;nbsp;<span class=\"comment\"># 解压缩</span></div><div class=\"line\"><span class=\"built_in\">cd</span> vm* <span class=\"comment\">#注意这里的 vm 是小写</span></div><div class=\"line\">./vmware-install.pl</div></pre></td></tr></table></figure></p>\n<p>基本上一步步按回车接受默认设置就好了，最后再运行一下命令启用 VMware Tools<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div></pre></td><td class=\"code\"><pre><div class=\"line\">/etc/init.d/networking stop</div><div class=\"line\">rmmod pcnet32</div><div class=\"line\">rmmod vmxnet</div><div class=\"line\">depmod -a</div><div class=\"line\">modprobe vmxnet</div><div class=\"line\">/etc/init.d/networking start</div></pre></td></tr></table></figure></p>\n"},{"title":"Internet Explorer Zonemapping failed due to the data is invalid (event ID: 7016)","date":"2013-03-11T07:53:58.000Z","_content":"\n今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：\n```msdos\nC:\\Users\\user>gpupdate /force Updating Policy...\n\nUser Policy update has completed successfully.\n\nThe following warnings were encountered during user policy processing:\n\nWindows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the \"More information\" link. Computer Policy update has completed successfully.\n\nFor more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.\n```\n运行 `gpresult /h gpreport.html`，打开这个html文件一看\n![GPReport](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg)\nInternet Explorer Zonemapping failed due to the error listed below.\nThe data is invalid.\n\n再来看看事件查看器中有没有相关日志，还真找到一条 Event ID:7016 的错误日志\n\nCompleted Internet Explorer Zonemapping Extension Processing in 343 milliseconds.\n\n![EventID-7016](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg)\n\n我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 **13**.\n\n现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志\n\nWindows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 [KB221833](http://support.microsoft.com/kb/221833 \"How to enable user environment debug logging in retail builds of Windows\")\n\n1.  在 %windir%\\debug\\下面创建 usermode 目录\n2.  打开注册表编辑器，找到\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion**\n3.  新建Key键值  Diagnostics\n4.  在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)\n5.  退出注册表编辑器\n6.  在命令行下再运行 gpupdate /force\n7.  在 %windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件\n打开 gpsvc.log 文件，查找 **ProcessGPOList: Extension Internet Explorer Zonemapping returned**\n\n你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned **<span style=\"color: #ff0000\">0xd</span>**\n\n**<span style=\"color: #ff0000\">0xd</span>** 这个错误代码换算成10进制就是上面日志中的 **ErrorCode: 13** 啦。\n\n接下来我们用 [Err.exe ](http://www.microsoft.com/en-us/download/details.aspx?id=985 \"Microsoft Exchange Server Error Code Look-up\")来看看查找结果：\n```\nERROR_INVALID_DATA winerror.h\n# The data is invalid.\n```\n果然，在查找到的29条符合的纪录中有一条是  The data is invalid\n\n那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 **RSOP.msc** 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：\n\n<span style=\"color: #ff0000\">**  网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。**</span>\n![GPO-IE-Zone-Assignments](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg)\n将这些缺少 Zone value 的条目一一更新之后，`gpupdate /force` 恢复正常！\n\n补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\">**Event ID: 1085** </span>的类似错误，处理方法和 Event ID:7106 的一样。\n\n**另外，还有可能的错误是站点名字使用诸如 192.168.\\* 或者 \\*.123.\\* 之类 \\* 号使用不当，也会导致报错。**\n","source":"_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016.md","raw":"---\ntitle: 'Internet Explorer Zonemapping failed due to the data is invalid (event ID: 7016)'\ntags:\n  - Event ID\n  - Group Policy\n  - Internet Explorer\n  - Zonemapping\ncategories:\n  - Microsoft\ndate: 2013-03-11 15:53:58\n---\n\n今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：\n```msdos\nC:\\Users\\user>gpupdate /force Updating Policy...\n\nUser Policy update has completed successfully.\n\nThe following warnings were encountered during user policy processing:\n\nWindows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the \"More information\" link. Computer Policy update has completed successfully.\n\nFor more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.\n```\n运行 `gpresult /h gpreport.html`，打开这个html文件一看\n![GPReport](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg)\nInternet Explorer Zonemapping failed due to the error listed below.\nThe data is invalid.\n\n再来看看事件查看器中有没有相关日志，还真找到一条 Event ID:7016 的错误日志\n\nCompleted Internet Explorer Zonemapping Extension Processing in 343 milliseconds.\n\n![EventID-7016](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg)\n\n我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 **13**.\n\n现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志\n\nWindows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 [KB221833](http://support.microsoft.com/kb/221833 \"How to enable user environment debug logging in retail builds of Windows\")\n\n1.  在 %windir%\\debug\\下面创建 usermode 目录\n2.  打开注册表编辑器，找到\n**HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion**\n3.  新建Key键值  Diagnostics\n4.  在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)\n5.  退出注册表编辑器\n6.  在命令行下再运行 gpupdate /force\n7.  在 %windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件\n打开 gpsvc.log 文件，查找 **ProcessGPOList: Extension Internet Explorer Zonemapping returned**\n\n你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned **<span style=\"color: #ff0000\">0xd</span>**\n\n**<span style=\"color: #ff0000\">0xd</span>** 这个错误代码换算成10进制就是上面日志中的 **ErrorCode: 13** 啦。\n\n接下来我们用 [Err.exe ](http://www.microsoft.com/en-us/download/details.aspx?id=985 \"Microsoft Exchange Server Error Code Look-up\")来看看查找结果：\n```\nERROR_INVALID_DATA winerror.h\n# The data is invalid.\n```\n果然，在查找到的29条符合的纪录中有一条是  The data is invalid\n\n那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 **RSOP.msc** 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：\n\n<span style=\"color: #ff0000\">**  网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。**</span>\n![GPO-IE-Zone-Assignments](internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg)\n将这些缺少 Zone value 的条目一一更新之后，`gpupdate /force` 恢复正常！\n\n补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\">**Event ID: 1085** </span>的类似错误，处理方法和 Event ID:7106 的一样。\n\n**另外，还有可能的错误是站点名字使用诸如 192.168.\\* 或者 \\*.123.\\* 之类 \\* 号使用不当，也会导致报错。**\n","slug":"internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016","published":1,"updated":"2017-08-16T03:37:21.903Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jz5003r4gyrkvevvyw0","content":"<p>今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">C:\\Users\\user&gt;gpupdate /force Updating Policy...</div><div class=\"line\"></div><div class=\"line\">User Policy update has completed successfully.</div><div class=\"line\"></div><div class=\"line\">The following warnings were encountered during user policy processing:</div><div class=\"line\"></div><div class=\"line\">Windows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the &quot;More information&quot; link. Computer Policy update has completed successfully.</div><div class=\"line\"></div><div class=\"line\">For more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.</div></pre></td></tr></table></figure></p>\n<p>运行 <code>gpresult /h gpreport.html</code>，打开这个html文件一看<br><img src=\"/2013/03/11/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg\" alt=\"GPReport\"><br>Internet Explorer Zonemapping failed due to the error listed below.<br>The data is invalid.</p>\n<p>再来看看事件查看器中有没有相关日志，还真找到一条 Event ID:7016 的错误日志</p>\n<p>Completed Internet Explorer Zonemapping Extension Processing in 343 milliseconds.</p>\n<p><img src=\"/2013/03/11/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg\" alt=\"EventID-7016\"></p>\n<p>我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 <strong>13</strong>.</p>\n<p>现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志</p>\n<p>Windows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 <a href=\"http://support.microsoft.com/kb/221833\" title=\"How to enable user environment debug logging in retail builds of Windows\" target=\"_blank\" rel=\"external\">KB221833</a></p>\n<ol>\n<li>在 %windir%\\debug\\下面创建 usermode 目录</li>\n<li>打开注册表编辑器，找到<br><strong>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion</strong></li>\n<li>新建Key键值  Diagnostics</li>\n<li>在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)</li>\n<li>退出注册表编辑器</li>\n<li>在命令行下再运行 gpupdate /force</li>\n<li>在 %windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件<br>打开 gpsvc.log 文件，查找 <strong>ProcessGPOList: Extension Internet Explorer Zonemapping returned</strong></li>\n</ol>\n<p>你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned <strong><span style=\"color: #ff0000\">0xd</span></strong></p>\n<p><strong><span style=\"color: #ff0000\">0xd</span></strong> 这个错误代码换算成10进制就是上面日志中的 <strong>ErrorCode: 13</strong> 啦。</p>\n<p>接下来我们用 <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=985\" title=\"Microsoft Exchange Server Error Code Look-up\" target=\"_blank\" rel=\"external\">Err.exe </a>来看看查找结果：<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ERROR_INVALID_DATA winerror.h</div><div class=\"line\"># The <span class=\"keyword\">data</span> <span class=\"keyword\">is</span> invalid.</div></pre></td></tr></table></figure></p>\n<p>果然，在查找到的29条符合的纪录中有一条是  The data is invalid</p>\n<p>那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 <strong>RSOP.msc</strong> 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：</p>\n<p><span style=\"color: #ff0000\"><strong>  网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。</strong></span><br><img src=\"/2013/03/11/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg\" alt=\"GPO-IE-Zone-Assignments\"><br>将这些缺少 Zone value 的条目一一更新之后，<code>gpupdate /force</code> 恢复正常！</p>\n<p>补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\"><strong>Event ID: 1085</strong> </span>的类似错误，处理方法和 Event ID:7106 的一样。</p>\n<p><strong>另外，还有可能的错误是站点名字使用诸如 192.168.* 或者 *.123.* 之类 * 号使用不当，也会导致报错。</strong></p>\n","site":{"data":{}},"excerpt":"","more":"<p>今天新建了个组策略，跑个 gpupdate /force 强制更新下，发现有警告信息：<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">C:\\Users\\user&gt;gpupdate /force Updating Policy...</div><div class=\"line\"></div><div class=\"line\">User Policy update has completed successfully.</div><div class=\"line\"></div><div class=\"line\">The following warnings were encountered during user policy processing:</div><div class=\"line\"></div><div class=\"line\">Windows failed to apply the Internet Explorer Zonemapping settings. Internet Explorer Zonemapping settings might have its own log file. Please click on the &quot;More information&quot; link. Computer Policy update has completed successfully.</div><div class=\"line\"></div><div class=\"line\">For more detailed information, review the event log or run GPRESULT /H GPReport. html from the command line to access information about Group Policy results.</div></pre></td></tr></table></figure></p>\n<p>运行 <code>gpresult /h gpreport.html</code>，打开这个html文件一看<br><img src=\"/2013/03/11/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg\" alt=\"GPReport\"><br>Internet Explorer Zonemapping failed due to the error listed below.<br>The data is invalid.</p>\n<p>再来看看事件查看器中有没有相关日志，还真找到一条 Event ID:7016 的错误日志</p>\n<p>Completed Internet Explorer Zonemapping Extension Processing in 343 milliseconds.</p>\n<p><img src=\"/2013/03/11/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg\" alt=\"EventID-7016\"></p>\n<p>我们看到这里的 <span style=\"color: #ff0000\">ErrorCode</span> 是 <strong>13</strong>.</p>\n<p>现在，收集到的信息还是不足以给我们提供判断依据，我们来启用 GPSvc 的调试日志来看看更详细的日志</p>\n<p>Windows 7/Vista/2008 请参照以下步骤，Widnows XP/2003 请参照微软 <a href=\"http://support.microsoft.com/kb/221833\" title=\"How to enable user environment debug logging in retail builds of Windows\" target=\"_blank\" rel=\"external\">KB221833</a></p>\n<ol>\n<li>在 %windir%\\debug\\下面创建 usermode 目录</li>\n<li>打开注册表编辑器，找到<br><strong>HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows NT\\CurrentVersion</strong></li>\n<li>新建Key键值  Diagnostics</li>\n<li>在该键值下面创建名为GPSvcDebugLevel的 DWORD 键值，并将其修改为16进制的 30002 (hex)</li>\n<li>退出注册表编辑器</li>\n<li>在命令行下再运行 gpupdate /force</li>\n<li>在 %windir%\\debug\\usermode 目录下面就可以找到 GPSvc.log 文件<br>打开 gpsvc.log 文件，查找 <strong>ProcessGPOList: Extension Internet Explorer Zonemapping returned</strong></li>\n</ol>\n<p>你会发现有一行 ProcessGPOList: Extension Internet Explorer Zonemapping returned <strong><span style=\"color: #ff0000\">0xd</span></strong></p>\n<p><strong><span style=\"color: #ff0000\">0xd</span></strong> 这个错误代码换算成10进制就是上面日志中的 <strong>ErrorCode: 13</strong> 啦。</p>\n<p>接下来我们用 <a href=\"http://www.microsoft.com/en-us/download/details.aspx?id=985\" title=\"Microsoft Exchange Server Error Code Look-up\" target=\"_blank\" rel=\"external\">Err.exe </a>来看看查找结果：<br><figure class=\"highlight kotlin\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\">ERROR_INVALID_DATA winerror.h</div><div class=\"line\"># The <span class=\"keyword\">data</span> <span class=\"keyword\">is</span> invalid.</div></pre></td></tr></table></figure></p>\n<p>果然，在查找到的29条符合的纪录中有一条是  The data is invalid</p>\n<p>那么，现在可以确定的是在配置 IE Zone 的 GPO 中应该存在非法的条目，我们用 <strong>RSOP.msc</strong> 来找到这个机遇用户的GPO策略，在众多的条目中通过排除法最终找到了这么几条：</p>\n<p><span style=\"color: #ff0000\"><strong>  网站名称是有指定，但是没有在 Zone Value 这里赋值，也就是说系统不知道你是想把这个站点分去哪个Zone，所以出来警告信息。</strong></span><br><img src=\"/2013/03/11/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg\" alt=\"GPO-IE-Zone-Assignments\"><br>将这些缺少 Zone value 的条目一一更新之后，<code>gpupdate /force</code> 恢复正常！</p>\n<p>补充一下，Windows XP 的系统有可能运行 gpupdate /force 不会报错，但是在日志中会出现 <span style=\"color: #ff0000\"><strong>Event ID: 1085</strong> </span>的类似错误，处理方法和 Event ID:7106 的一样。</p>\n<p><strong>另外，还有可能的错误是站点名字使用诸如 192.168.* 或者 *.123.* 之类 * 号使用不当，也会导致报错。</strong></p>\n"},{"title":"KB289949 - Items that you place in Outlook Today seem to be lost","date":"2014-02-13T02:55:56.000Z","_content":"\n[KB289949 - Items that you place in Outlook Today seem to be lost](http://support.microsoft.com/kb/289949 \"Items that you place in Outlook Today seem to be lost\")\n\n不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？\n\n你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 username@mail.com 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：\n\n![Outlook_Today](kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg)\n\n&nbsp;\n\n那么，我的邮件去哪儿了呢？\n\n其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。\n\n![Outlook_Today_HomePage](kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg)","source":"_posts/kb289949-items-place-outlook-today-seem-lost.md","raw":"---\ntitle: KB289949 - Items that you place in Outlook Today seem to be lost\ntags:\n  - Exchange\n  - Outlook\ncategories:\n  - Microsoft\n  - Office\ndate: 2014-02-13 10:55:56\n---\n\n[KB289949 - Items that you place in Outlook Today seem to be lost](http://support.microsoft.com/kb/289949 \"Items that you place in Outlook Today seem to be lost\")\n\n不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？\n\n你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 username@mail.com 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：\n\n![Outlook_Today](kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg)\n\n&nbsp;\n\n那么，我的邮件去哪儿了呢？\n\n其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。\n\n![Outlook_Today_HomePage](kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg)","slug":"kb289949-items-place-outlook-today-seem-lost","published":1,"updated":"2017-06-16T12:49:50.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jz6003u4gyrlbyafk1q","content":"<p><a href=\"http://support.microsoft.com/kb/289949\" title=\"Items that you place in Outlook Today seem to be lost\" target=\"_blank\" rel=\"external\">KB289949 - Items that you place in Outlook Today seem to be lost</a></p>\n<p>不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？</p>\n<p>你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 username@mail.com 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：</p>\n<p><img src=\"/2014/02/13/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg\" alt=\"Outlook_Today\"></p>\n<p>&nbsp;</p>\n<p>那么，我的邮件去哪儿了呢？</p>\n<p>其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。</p>\n<p><img src=\"/2014/02/13/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg\" alt=\"Outlook_Today_HomePage\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p><a href=\"http://support.microsoft.com/kb/289949\" title=\"Items that you place in Outlook Today seem to be lost\" target=\"_blank\" rel=\"external\">KB289949 - Items that you place in Outlook Today seem to be lost</a></p>\n<p>不知道有没有人注意到这个旧的 KB 文章，说的是啥事呢？</p>\n<p>你试着从 Outlook 里面选中一些邮件，然后鼠标右键，Move-Other Folder，选中顶级目录，也就是 username@mail.com 这个级别，然后你会发现这些邮件不见了！ 收件箱里面没有，只有用搜索功能才能找到，点到顶级目录，你也只能看到这个：</p>\n<p><img src=\"/2014/02/13/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg\" alt=\"Outlook_Today\"></p>\n<p>&nbsp;</p>\n<p>那么，我的邮件去哪儿了呢？</p>\n<p>其实，这些被移动的邮件去到了 邮箱的顶级目录，但是默认情况下，这里被 Outlook Today 所代替了，这个 KB 讲的就是如何关掉 Outlook Today, 然后让你“丢失”的邮件重见天日的。说的是 Outlook 2003，实际上从 Outlook 2003 一直到 2013 版本都适用。</p>\n<p><img src=\"/2014/02/13/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg\" alt=\"Outlook_Today_HomePage\"></p>\n"},{"title":"KB974571 Crypto-API Update may break Office Communications Server 2007 R2 installations","date":"2009-10-15T04:15:20.000Z","_content":"\nSecurity updates are important. And as we're currently an evaluation setup for OCS 2007 R2, i've decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.\n\nBelow are error message from event log:\n> Event source: OCS Server\n> Event id: 12290\n> Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.\n\ncheck this [article](http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx)\nUninstall KB [974571 ](http://support.microsoft.com/kb/974571/ \"http://support.microsoft.com/kb/974571/\")and OCS works again.","source":"_posts/kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations.md","raw":"---\ntitle: KB974571 Crypto-API Update may break Office Communications Server 2007 R2 installations\ntags:\n  - Communicator\ncategories:\n  - 沟通协作\ndate: 2009-10-15 12:15:20\n---\n\nSecurity updates are important. And as we're currently an evaluation setup for OCS 2007 R2, i've decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.\n\nBelow are error message from event log:\n> Event source: OCS Server\n> Event id: 12290\n> Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.\n\ncheck this [article](http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx)\nUninstall KB [974571 ](http://support.microsoft.com/kb/974571/ \"http://support.microsoft.com/kb/974571/\")and OCS works again.","slug":"kb974571-crypto-api-update-may-break-office-communications-server-2007-r2-installations","published":1,"updated":"2017-06-16T12:50:00.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jz9003x4gyrg1n6tfof","content":"<p>Security updates are important. And as we’re currently an evaluation setup for OCS 2007 R2, i’ve decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.</p>\n<p>Below are error message from event log:</p>\n<blockquote>\n<p>Event source: OCS Server<br>Event id: 12290<br>Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.</p>\n</blockquote>\n<p>check this <a href=\"http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx\" target=\"_blank\" rel=\"external\">article</a><br>Uninstall KB <a href=\"http://support.microsoft.com/kb/974571/\" title=\"http://support.microsoft.com/kb/974571/\" target=\"_blank\" rel=\"external\">974571 </a>and OCS works again.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Security updates are important. And as we’re currently an evaluation setup for OCS 2007 R2, i’ve decided to install todays batch of security updates on these lesser important machines first. And after a reboot, OCS 2007 R2 Front End Service is not running anymore.</p>\n<p>Below are error message from event log:</p>\n<blockquote>\n<p>Event source: OCS Server<br>Event id: 12290<br>Event text: The evaluation period for Microsoft Office Communications Server 2007 R2 has expired. Please upgrade from the evaluation version to the full released version of the product.</p>\n</blockquote>\n<p>check this <a href=\"http://blogs.technet.com/dodeitte/archive/2009/10/13/do-not-apply-kb974571-to-lcs-ocs-servers.aspx\" target=\"_blank\" rel=\"external\">article</a><br>Uninstall KB <a href=\"http://support.microsoft.com/kb/974571/\" title=\"http://support.microsoft.com/kb/974571/\" target=\"_blank\" rel=\"external\">974571 </a>and OCS works again.</p>\n"},{"title":"Lync Server 2010 发布架构报错","date":"2010-12-24T02:36:47.000Z","_content":"昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:\n```\nScript result: ERROR_VALIDATE_BAD_SQL_VERSION\n\nError: Script failed (code \"ERROR_VALIDATE_BAD_SQL_VERSION\") when installing \"CentralMgmtStore\" on \"LyncServer01.mail2any.local\". For details, see the following log file: \"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"\n\nError: An error occurred: \"Microsoft.Rtc.Common.Data.SqlConnectionException\" \"Cannot open database \"xds\" requested by the login. The login failed.\n\nLogin failed for user 'Mail2Any\\Administrator'.\"\n```\n看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:\n* Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3\n* Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1\n* Standard or Enterprise Edition of SQL Server 2008 R2","source":"_posts/lync-server-2010-publish-topology-error.md","raw":"---\ntitle: Lync Server 2010 发布架构报错\ntags:\n  - Lync\n  - OCS\n  - MSSQL\ncategories:\n  - 沟通协作\ndate: 2010-12-24 10:36:47\n---\n昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:\n```\nScript result: ERROR_VALIDATE_BAD_SQL_VERSION\n\nError: Script failed (code \"ERROR_VALIDATE_BAD_SQL_VERSION\") when installing \"CentralMgmtStore\" on \"LyncServer01.mail2any.local\". For details, see the following log file: \"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"\n\nError: An error occurred: \"Microsoft.Rtc.Common.Data.SqlConnectionException\" \"Cannot open database \"xds\" requested by the login. The login failed.\n\nLogin failed for user 'Mail2Any\\Administrator'.\"\n```\n看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:\n* Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3\n* Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1\n* Standard or Enterprise Edition of SQL Server 2008 R2","slug":"lync-server-2010-publish-topology-error","published":1,"updated":"2017-06-16T12:50:10.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzb00404gyr1z3v2hyf","content":"<p>昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:<br><figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">Script result: ERROR_VALIDATE_BAD_SQL_VERSION</div><div class=\"line\"></div><div class=\"line\">Error:<span class=\"built_in\"> Script </span>failed (code <span class=\"string\">\"ERROR_VALIDATE_BAD_SQL_VERSION\"</span>) when installing <span class=\"string\">\"CentralMgmtStore\"</span> on <span class=\"string\">\"LyncServer01.mail2any.local\"</span>. <span class=\"keyword\">For</span> details, see the following log file: <span class=\"string\">\"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"</span></div><div class=\"line\"></div><div class=\"line\">Error: An <span class=\"builtin-name\">error</span> occurred: <span class=\"string\">\"Microsoft.Rtc.Common.Data.SqlConnectionException\"</span> <span class=\"string\">\"Cannot open database \"</span>xds<span class=\"string\">\" requested by the login. The login failed.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Login failed for user 'Mail2Any\\Administrator'.\"</span></div></pre></td></tr></table></figure></p>\n<p>看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:</p>\n<ul>\n<li>Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 R2</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>昨天想试试在现有的 OCS 2007 R2 的基础上部署 Lync Server 2010 试试看，装好 Topology Builder 之后，新建了一个拓扑，然后把该填的都填了，发布的时候老是报SQL错，很是郁闷，后来终于在log中找到了错误原因:<br><figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div></pre></td><td class=\"code\"><pre><div class=\"line\">Script result: ERROR_VALIDATE_BAD_SQL_VERSION</div><div class=\"line\"></div><div class=\"line\">Error:<span class=\"built_in\"> Script </span>failed (code <span class=\"string\">\"ERROR_VALIDATE_BAD_SQL_VERSION\"</span>) when installing <span class=\"string\">\"CentralMgmtStore\"</span> on <span class=\"string\">\"LyncServer01.mail2any.local\"</span>. <span class=\"keyword\">For</span> details, see the following log file: <span class=\"string\">\"C:\\Users\\Administrator.Mail2any\\AppData\\Local\\Temp\\Create-CentralMgmtStore-LyncServer01.mail2any.local-[2010_12_22][16_11_55].log\"</span></div><div class=\"line\"></div><div class=\"line\">Error: An <span class=\"builtin-name\">error</span> occurred: <span class=\"string\">\"Microsoft.Rtc.Common.Data.SqlConnectionException\"</span> <span class=\"string\">\"Cannot open database \"</span>xds<span class=\"string\">\" requested by the login. The login failed.</span></div><div class=\"line\"><span class=\"string\"></span></div><div class=\"line\"><span class=\"string\">Login failed for user 'Mail2Any\\Administrator'.\"</span></div></pre></td></tr></table></figure></p>\n<p>看到这个 Bad Version 版本错误提示，我才想起来原来部署 OCS 2007 R2 的时候，后端数据库用的是 SQL Server 2008，而 Lync Server 2010需要至少 SQL Server 2008 SP1 才行，于是乎打上 SP1 补丁，顺利通过发布。SQL Server的版本需求:</p>\n<ul>\n<li>Standard or Enterprise Edition of SQL Server 2005 with Service Pack 3</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 with Service Pack 1</li>\n<li>Standard or Enterprise Edition of SQL Server 2008 R2</li>\n</ul>\n"},{"title":"VMWare vCenter 4.x 数据库由SQL Express 迁移至SQL Server 2008 R2","date":"2013-11-28T08:38:52.000Z","_content":"\n默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：\n\n1. 停止 VirtualCenter Server service服务，4.x 的服务名是 VMware VirtualCenter Server。\n2. 对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。\n3. 停止现有 SQL Express 的 SQL 服务。\n4. 在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选 Overwrite existing database with replace 选项以保证完全覆盖还原。\n5. 在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。\n6. 修改 vCenter 服务器上面的 System DSN，默认名称是 VMware VirtualCenter，将其连接改至新服务器。\n7. 修改 vCenter 的注册表,\n    1. **HKEY_LOCAL_MACHINE > SOFTWARE > VMware Inc, VMware VirtualCenter > DB**\n    2.  确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter\n    3.  确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User\n8. 更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3\n```msdos\nC:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p\n```\n9. 重建 rollup jobs。参考 http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\n10. 重启 vCenter 服务全文参考 [VMWare KB - Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)](http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579)","source":"_posts/migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2.md","raw":"---\ntitle: VMWare vCenter 4.x 数据库由SQL Express 迁移至SQL Server 2008 R2\ntags:\n  - MSSQL\n  - VMware\ncategories:\n  - 虚拟化\ndate: 2013-11-28 16:38:52\n---\n\n默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：\n\n1. 停止 VirtualCenter Server service服务，4.x 的服务名是 VMware VirtualCenter Server。\n2. 对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。\n3. 停止现有 SQL Express 的 SQL 服务。\n4. 在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选 Overwrite existing database with replace 选项以保证完全覆盖还原。\n5. 在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。\n6. 修改 vCenter 服务器上面的 System DSN，默认名称是 VMware VirtualCenter，将其连接改至新服务器。\n7. 修改 vCenter 的注册表,\n    1. **HKEY_LOCAL_MACHINE > SOFTWARE > VMware Inc, VMware VirtualCenter > DB**\n    2.  确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter\n    3.  确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User\n8. 更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3\n```msdos\nC:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p\n```\n9. 重建 rollup jobs。参考 http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\n10. 重启 vCenter 服务全文参考 [VMWare KB - Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)](http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579)","slug":"migrating-the-vcenter-server-4-database-from-sql-express-to-sql-server-2008-r2","published":1,"updated":"2017-06-16T12:50:18.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzc00434gyrvoq1fh3z","content":"<p>默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：</p>\n<ol>\n<li>停止 VirtualCenter Server service服务，4.x 的服务名是 VMware VirtualCenter Server。</li>\n<li>对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。</li>\n<li>停止现有 SQL Express 的 SQL 服务。</li>\n<li>在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选 Overwrite existing database with replace 选项以保证完全覆盖还原。</li>\n<li>在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。</li>\n<li>修改 vCenter 服务器上面的 System DSN，默认名称是 VMware VirtualCenter，将其连接改至新服务器。</li>\n<li>修改 vCenter 的注册表,<ol>\n<li><strong>HKEY_LOCAL_MACHINE &gt; SOFTWARE &gt; VMware Inc, VMware VirtualCenter &gt; DB</strong></li>\n<li>确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter</li>\n<li>确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User</li>\n</ol>\n</li>\n<li><p>更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">C:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p</div></pre></td></tr></table></figure>\n</li>\n<li><p>重建 rollup jobs。参考 <a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\" target=\"_blank\" rel=\"external\">http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824</a></p>\n</li>\n<li>重启 vCenter 服务全文参考 <a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579\" target=\"_blank\" rel=\"external\">VMWare KB - Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)</a></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>默认安装下的 VMware vCenter 4.x 会在本地安装 SQL Express 2005 版本，如果你有需要迁移至 Full SQL Server版本比如 SQL Server 2008 R2的话，可以参考以下步骤：</p>\n<ol>\n<li>停止 VirtualCenter Server service服务，4.x 的服务名是 VMware VirtualCenter Server。</li>\n<li>对现有的 SQL Express 数据库实例上的 vCenter 数据库做一次完全备份。</li>\n<li>停止现有 SQL Express 的 SQL 服务。</li>\n<li>在新的 SQL Server 2008 R2 服务器上面创建新数据库，并将之前备份的文件还原至改新建数据库。为了确保还原正确，最好还原的时候去到 Options ，勾选 Overwrite existing database with replace 选项以保证完全覆盖还原。</li>\n<li>在 SQL Server 2008 R2 上面创建 vCenter 的 SQL 用户，给其分配 DB Owner 和 dbo 角色。</li>\n<li>修改 vCenter 服务器上面的 System DSN，默认名称是 VMware VirtualCenter，将其连接改至新服务器。</li>\n<li>修改 vCenter 的注册表,<ol>\n<li><strong>HKEY_LOCAL_MACHINE &gt; SOFTWARE &gt; VMware Inc, VMware VirtualCenter &gt; DB</strong></li>\n<li>确认键值 1 是 System DSN 中指定的名字，比如 VMware VirtualCenter</li>\n<li>确认键值 2 用来连接新数据库的SQL用户名，比如 vCenter_User</li>\n</ol>\n</li>\n<li><p>更改注册表中所存储的SQL用户密码，也就是在上一步中的键值 3</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">C:\\Program Files\\VMware\\Infrastructure\\VirtualCenter Server\\vpxd.exe -p</div></pre></td></tr></table></figure>\n</li>\n<li><p>重建 rollup jobs。参考 <a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824\" target=\"_blank\" rel=\"external\">http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;docTypeID=DT_KB_1_1&amp;externalId=1029824</a></p>\n</li>\n<li>重启 vCenter 服务全文参考 <a href=\"http://kb.vmware.com/selfservice/microsites/search.do?cmd=displayKC&amp;docType=kc&amp;externalId=1028601&amp;sliceId=1&amp;docTypeID=DT_KB_1_1&amp;dialogID=100018749&amp;stateId=0%200%20111449579\" target=\"_blank\" rel=\"external\">VMWare KB - Migrating the vCenter Server database from SQL Express to full SQL Server (1028601)</a></li>\n</ol>\n"},{"title":"开新站，并迁移至 WordPress","date":"2013-01-22T17:48:36.000Z","_content":"\n伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 [www.powerk6.org](http://www.powerk6.org \"MT旧站 www.powerk6.org\") 上的部分内容迁移到了这个新站 [winotes.net](http://winotes.net \"新站 winotes.net\")，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。\n\n原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。","source":"_posts/movabletype-2-wordpress.md","raw":"---\ntitle: 开新站，并迁移至 WordPress\ntags:\n  - Movable Type\n  - WordPress\ncategories:\n  - 网站相关\ndate: 2013-01-23 01:48:36\n---\n\n伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 [www.powerk6.org](http://www.powerk6.org \"MT旧站 www.powerk6.org\") 上的部分内容迁移到了这个新站 [winotes.net](http://winotes.net \"新站 winotes.net\")，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。\n\n原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。","slug":"movabletype-2-wordpress","published":1,"updated":"2017-06-16T12:50:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzf00464gyri4pn9wc2","content":"<p>伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 <a href=\"http://www.powerk6.org\" title=\"MT旧站 www.powerk6.org\" target=\"_blank\" rel=\"external\">www.powerk6.org</a> 上的部分内容迁移到了这个新站 <a href=\"http://winotes.net\" title=\"新站 winotes.net\">winotes.net</a>，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。</p>\n<p>原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>伴随着 WordPress 的日益普及，Movable Type 日渐式微。看着越来越好看的WP主题和越来越多的插件，一直想建个WP的站点。最近刚好有点时间，于是乎把旧站 <a href=\"http://www.powerk6.org\" title=\"MT旧站 www.powerk6.org\" target=\"_blank\" rel=\"external\">www.powerk6.org</a> 上的部分内容迁移到了这个新站 <a href=\"http://winotes.net\" title=\"新站 winotes.net\">winotes.net</a>，新站主要关注于微软平台的技术，俗话说好记心不如烂笔头，在这记录下个人在工作学习中的点点滴滴，以便存档。</p>\n<p>原来的 MT 站点从2005年一直用到现在，可能会继续更新，但应该都是个人生活相关的东西了，留着做个纪念吧。</p>\n"},{"title":"本站博客迁移至 Hexo","date":"2017-06-10T06:40:11.000Z","_content":"\n在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 **GitHub Pages**，继续使用 http://winotes.net 来提供服务。\n\n由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。\n\nWordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。","source":"_posts/move-to-hexo.md","raw":"---\ntitle: 本站博客迁移至 Hexo\ntags:\n  - WordPress\n  - Hexo\n  - GitHub\ncategories:\n  - 网站相关\ndate: 2017-06-10 14:40:11\n---\n\n在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 **GitHub Pages**，继续使用 http://winotes.net 来提供服务。\n\n由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。\n\nWordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。","slug":"move-to-hexo","published":1,"updated":"2017-06-16T09:02:26.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzh00494gyr7aar1rh9","content":"<p>在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 <strong>GitHub Pages</strong>，继续使用 <a href=\"http://winotes.net\">http://winotes.net</a> 来提供服务。</p>\n<p>由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。</p>\n<p>WordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在 BlueHost 的服务到期之后，由于其夸张的续费价格，我并没有继续将其托管在 BlueHost，在折腾折腾来去之后，发现可以利用 GitHub Pages 来做静态博客，于是乎捣鼓了三天，将本博客从 WordPress 迁移到了 Hexo，目前是发布在了 <strong>GitHub Pages</strong>，继续使用 <a href=\"http://winotes.net\">http://winotes.net</a> 来提供服务。</p>\n<p>由于 CloudFlare 在大陆的访问速度较慢，所以暂时没有启用 HTTPS，待出现更好的解决方案之前，先用 HTTP 来访问。</p>\n<p>WordPress 的迁移是用插件来做的，不过导出来的 md 文件并不干净，需要手工修正，顺便清理了下原来的分类目录和标签，现在至少看起来清爽了不少。</p>\n"},{"title":"MPF Service Account Error in Deployment Tools","date":"2008-05-18T03:37:03.000Z","_content":"\n如果你在部署 MPS 的时候遇到类似以下问题:\n\n>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed\nHResult: -2146233088\nMessage: Deployment interrupted because of a failure. See inner exception.\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()\nat Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() </br>\nInner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException\nHResult: -2146233088\nMessage: \n```xml\n<errorContext description=\"The network path was not found\" code=\"0x80070035\" executeSeqNo=\"27\">\n<errorSource namespace=\"Computer Management Provider\" procedure=\"Group IsMember\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"TryLocalGroupAdd_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"AddMPFConfigAdmin_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"ConfigureMPFServiceAccounts\" /></errorContext>\n```\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()\nat Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()\n\n是可以手动解决的，方法如下： \n\nPart of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value \"Configuration Server\" and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:\n\n1. Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.\n2. Add MPFServiceAccts group to the \"Windows-based Hosting Service Accounts\" group in Active Directory.\n3. In the MPS Deployment Tool, right-click \"Configure MPF Service Account\" and choose \"Force State.\" Choose the VerifiedGood state and click OK.\n\nYou should then be able to continue with your deployment.","source":"_posts/mpf-service-account-error-in-deployment-tools.md","raw":"---\ntitle: MPF Service Account Error in Deployment Tools\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-05-18 11:37:03\n---\n\n如果你在部署 MPS 的时候遇到类似以下问题:\n\n>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed\nHResult: -2146233088\nMessage: Deployment interrupted because of a failure. See inner exception.\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()\nat Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() </br>\nInner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException\nHResult: -2146233088\nMessage: \n```xml\n<errorContext description=\"The network path was not found\" code=\"0x80070035\" executeSeqNo=\"27\">\n<errorSource namespace=\"Computer Management Provider\" procedure=\"Group IsMember\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"TryLocalGroupAdd_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"AddMPFConfigAdmin_\" />\n<errorSource namespace=\"Deployment Automation\" procedure=\"ConfigureMPFServiceAccounts\" /></errorContext>\n```\nStack Trace:\nat Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()\nat Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()\n\n是可以手动解决的，方法如下： \n\nPart of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value \"Configuration Server\" and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:\n\n1. Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.\n2. Add MPFServiceAccts group to the \"Windows-based Hosting Service Accounts\" group in Active Directory.\n3. In the MPS Deployment Tool, right-click \"Configure MPF Service Account\" and choose \"Force State.\" Choose the VerifiedGood state and click OK.\n\nYou should then be able to continue with your deployment.","slug":"mpf-service-account-error-in-deployment-tools","published":1,"updated":"2017-06-16T12:51:04.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzi004c4gyr29xczfpc","content":"<p>如果你在部署 MPS 的时候遇到类似以下问题:</p>\n<blockquote>\n<p>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed<br>HResult: -2146233088<br>Message: Deployment interrupted because of a failure. See inner exception.<br>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()<br>at Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() <br><br>Inner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException<br>HResult: -2146233088<br>Message:<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorContext</span> <span class=\"attr\">description</span>=<span class=\"string\">\"The network path was not found\"</span> <span class=\"attr\">code</span>=<span class=\"string\">\"0x80070035\"</span> <span class=\"attr\">executeSeqNo</span>=<span class=\"string\">\"27\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Computer Management Provider\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"Group IsMember\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"TryLocalGroupAdd_\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"AddMPFConfigAdmin_\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ConfigureMPFServiceAccounts\"</span> /&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">errorContext</span>&gt;</span></div></pre></td></tr></table></figure></p>\n</blockquote>\n<p>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()<br>at Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()</p>\n<p>是可以手动解决的，方法如下： </p>\n<p>Part of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value “Configuration Server” and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:</p>\n<ol>\n<li>Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.</li>\n<li>Add MPFServiceAccts group to the “Windows-based Hosting Service Accounts” group in Active Directory.</li>\n<li>In the MPS Deployment Tool, right-click “Configure MPF Service Account” and choose “Force State.” Choose the VerifiedGood state and click OK.</li>\n</ol>\n<p>You should then be able to continue with your deployment.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>如果你在部署 MPS 的时候遇到类似以下问题:</p>\n<blockquote>\n<p>Exception: Microsoft.Provisioning.DeploymentTool.Engine.DeploymentExceptionDeploymentFailed<br>HResult: -2146233088<br>Message: Deployment interrupted because of a failure. See inner exception.<br>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.Deployment.DoDeploymentWork()<br>at Microsoft.Provisioning.DeploymentTool.MainForm.ExecuteDeploymentSlice() <br><br>Inner Exception (1): Microsoft.Provisioning.DeploymentTool.Engine.NamedProcedureException<br>HResult: -2146233088<br>Message:<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorContext</span> <span class=\"attr\">description</span>=<span class=\"string\">\"The network path was not found\"</span> <span class=\"attr\">code</span>=<span class=\"string\">\"0x80070035\"</span> <span class=\"attr\">executeSeqNo</span>=<span class=\"string\">\"27\"</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Computer Management Provider\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"Group IsMember\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"TryLocalGroupAdd_\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"AddMPFConfigAdmin_\"</span> /&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">errorSource</span> <span class=\"attr\">namespace</span>=<span class=\"string\">\"Deployment Automation\"</span> <span class=\"attr\">procedure</span>=<span class=\"string\">\"ConfigureMPFServiceAccounts\"</span> /&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">errorContext</span>&gt;</span></div></pre></td></tr></table></figure></p>\n</blockquote>\n<p>Stack Trace:<br>at Microsoft.Provisioning.DeploymentTool.Engine.ExecuteNamedProcDeploymentAction.CheckForFinished()<br>at Microsoft.Provisioning.DeploymentTool.Engine.DeploymentAction.Update()</p>\n<p>是可以手动解决的，方法如下： </p>\n<p>Part of the process to configure the MPF Service Account is to read registry key HKLM\\Software\\Microsoft\\Provisioning value “Configuration Server” and attempt to connect to the server listed there to add the MPFServiceAcct to the local administrators. However, since you used a named instance, that key is not the servername, it is the servername\\instancename.So we will need to configure the MPFServiceAcct manually doing the following:</p>\n<ol>\n<li>Add MPFServiceAccts group to the local Administrators group on your MPS server and all of the nodes of your MPS SQL server.</li>\n<li>Add MPFServiceAccts group to the “Windows-based Hosting Service Accounts” group in Active Directory.</li>\n<li>In the MPS Deployment Tool, right-click “Configure MPF Service Account” and choose “Force State.” Choose the VerifiedGood state and click OK.</li>\n</ol>\n<p>You should then be able to continue with your deployment.</p>\n"},{"title":"微软 CRM 2011 Beta 快速安装图解","date":"2011-09-19T07:19:36.000Z","_content":"\n微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。\n\n下载：\n\n[Microsoft Dynamics CRM 2011 Beta](http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn)\n\n[Microsoft Dynamics CRM 2011 Software Development Kit (SDK)](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200082)\n\n[Microsoft Dynamics CRM 2011 Beta Implementation Guide](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200050)\n\n界面一览\n![CRM2011_20](mscrm-2011-beta-installation/CRM2011_20.jpg)\n1. 自动更新安装程序；\n![CRM2011_0](mscrm-2011-beta-installation/CRM2011_0.jpg)\n2. 输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；\n![CRM2011_1](mscrm-2011-beta-installation/CRM2011_1.jpg)\n3. 新的组件需求；\n![CRM2011_2](mscrm-2011-beta-installation/CRM2011_2.jpg)\n![CRM2011_3](mscrm-2011-beta-installation/CRM2011_3.jpg) ![CRM2011_4](mscrm-2011-beta-installation/CRM2011_4.jpg)\n4. 选择目录，继续；\n![CRM2011_5](mscrm-2011-beta-installation/CRM2011_5.jpg)\n5. 新的角色：前端、后端、部署管理；\n![CRM2011_6](mscrm-2011-beta-installation/CRM2011_6.jpg)\n6. 和 4.0 一样的选择 AD 用户和组创建位置；\n![CRM2011_7](mscrm-2011-beta-installation/CRM2011_7.jpg)\n![CRM2011_8](mscrm-2011-beta-installation/CRM2011_8.jpg) ![CRM2011_9](mscrm-2011-beta-installation/CRM2011_9.jpg) ![CRM2011_10](mscrm-2011-beta-installation/CRM2011_10.jpg) \n![CRM2011_11](mscrm-2011-beta-installation/CRM2011_11.jpg)\n7. 创建一个 CRM 组织；\n![CRM2011_12](mscrm-2011-beta-installation/CRM2011_12.jpg)\n8. 选择报表服务器；\n![CRM2011_13](mscrm-2011-beta-installation/CRM2011_13.jpg) \n![CRM2011_14](mscrm-2011-beta-installation/CRM2011_14.jpg) \n![CRM2011_15](mscrm-2011-beta-installation/CRM2011_15.jpg)\n9. 安装前需求全部满足，开始安装；\n![CRM2011_16](mscrm-2011-beta-installation/CRM2011_16.jpg) \n![CRM2011_17](mscrm-2011-beta-installation/CRM2011_17.jpg) \n![CRM2011_18](mscrm-2011-beta-installation/CRM2011_18.jpg)\n10. 如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；\n![CRM2011_19](mscrm-2011-beta-installation/CRM2011_19.jpg)","source":"_posts/mscrm-2011-beta-installation.md","raw":"---\ntitle: 微软 CRM 2011 Beta 快速安装图解\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2011-09-19 15:19:36\n---\n\n微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。\n\n下载：\n\n[Microsoft Dynamics CRM 2011 Beta](http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn)\n\n[Microsoft Dynamics CRM 2011 Software Development Kit (SDK)](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200082)\n\n[Microsoft Dynamics CRM 2011 Beta Implementation Guide](http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200050)\n\n界面一览\n![CRM2011_20](mscrm-2011-beta-installation/CRM2011_20.jpg)\n1. 自动更新安装程序；\n![CRM2011_0](mscrm-2011-beta-installation/CRM2011_0.jpg)\n2. 输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；\n![CRM2011_1](mscrm-2011-beta-installation/CRM2011_1.jpg)\n3. 新的组件需求；\n![CRM2011_2](mscrm-2011-beta-installation/CRM2011_2.jpg)\n![CRM2011_3](mscrm-2011-beta-installation/CRM2011_3.jpg) ![CRM2011_4](mscrm-2011-beta-installation/CRM2011_4.jpg)\n4. 选择目录，继续；\n![CRM2011_5](mscrm-2011-beta-installation/CRM2011_5.jpg)\n5. 新的角色：前端、后端、部署管理；\n![CRM2011_6](mscrm-2011-beta-installation/CRM2011_6.jpg)\n6. 和 4.0 一样的选择 AD 用户和组创建位置；\n![CRM2011_7](mscrm-2011-beta-installation/CRM2011_7.jpg)\n![CRM2011_8](mscrm-2011-beta-installation/CRM2011_8.jpg) ![CRM2011_9](mscrm-2011-beta-installation/CRM2011_9.jpg) ![CRM2011_10](mscrm-2011-beta-installation/CRM2011_10.jpg) \n![CRM2011_11](mscrm-2011-beta-installation/CRM2011_11.jpg)\n7. 创建一个 CRM 组织；\n![CRM2011_12](mscrm-2011-beta-installation/CRM2011_12.jpg)\n8. 选择报表服务器；\n![CRM2011_13](mscrm-2011-beta-installation/CRM2011_13.jpg) \n![CRM2011_14](mscrm-2011-beta-installation/CRM2011_14.jpg) \n![CRM2011_15](mscrm-2011-beta-installation/CRM2011_15.jpg)\n9. 安装前需求全部满足，开始安装；\n![CRM2011_16](mscrm-2011-beta-installation/CRM2011_16.jpg) \n![CRM2011_17](mscrm-2011-beta-installation/CRM2011_17.jpg) \n![CRM2011_18](mscrm-2011-beta-installation/CRM2011_18.jpg)\n10. 如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；\n![CRM2011_19](mscrm-2011-beta-installation/CRM2011_19.jpg)","slug":"mscrm-2011-beta-installation","published":1,"updated":"2017-06-16T12:51:24.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzj004f4gyraptgzny1","content":"<p>微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。</p>\n<p>下载：</p>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Dynamics CRM 2011 Beta</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200082\" target=\"_blank\" rel=\"external\">Microsoft Dynamics CRM 2011 Software Development Kit (SDK)</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200050\" target=\"_blank\" rel=\"external\">Microsoft Dynamics CRM 2011 Beta Implementation Guide</a></p>\n<p>界面一览<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_20.jpg\" alt=\"CRM2011_20\"></p>\n<ol>\n<li>自动更新安装程序；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_0.jpg\" alt=\"CRM2011_0\"></li>\n<li>输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_1.jpg\" alt=\"CRM2011_1\"></li>\n<li>新的组件需求；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_2.jpg\" alt=\"CRM2011_2\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_3.jpg\" alt=\"CRM2011_3\"> <img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_4.jpg\" alt=\"CRM2011_4\"></li>\n<li>选择目录，继续；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_5.jpg\" alt=\"CRM2011_5\"></li>\n<li>新的角色：前端、后端、部署管理；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_6.jpg\" alt=\"CRM2011_6\"></li>\n<li>和 4.0 一样的选择 AD 用户和组创建位置；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_7.jpg\" alt=\"CRM2011_7\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_8.jpg\" alt=\"CRM2011_8\"> <img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_9.jpg\" alt=\"CRM2011_9\"> <img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_10.jpg\" alt=\"CRM2011_10\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_11.jpg\" alt=\"CRM2011_11\"></li>\n<li>创建一个 CRM 组织；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_12.jpg\" alt=\"CRM2011_12\"></li>\n<li>选择报表服务器；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_13.jpg\" alt=\"CRM2011_13\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_14.jpg\" alt=\"CRM2011_14\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_15.jpg\" alt=\"CRM2011_15\"></li>\n<li>安装前需求全部满足，开始安装；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_16.jpg\" alt=\"CRM2011_16\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_17.jpg\" alt=\"CRM2011_17\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_18.jpg\" alt=\"CRM2011_18\"></li>\n<li>如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_19.jpg\" alt=\"CRM2011_19\"></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>微软在9月17日在网站上放出了 CRM 2011 （也就是CRM5.0）的 beta 版本，我就先来个简单的快读安装图解，一睹为快，下个月会写点新版 CRM 的使用感受。</p>\n<p>下载：</p>\n<p><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;displayLang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Dynamics CRM 2011 Beta</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=3&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200082\" target=\"_blank\" rel=\"external\">Microsoft Dynamics CRM 2011 Software Development Kit (SDK)</a></p>\n<p><a href=\"http://www.microsoft.com/downloads/info.aspx?na=40&amp;p=2&amp;SrcDisplayLang=zh-cn&amp;SrcCategoryId=&amp;SrcFamilyId=0c7dcc45-9d41-4e2e-8126-895517b4274c&amp;u=http%3a%2f%2fgo.microsoft.com%2ffwlink%2f%3fLinkID%3d200050\" target=\"_blank\" rel=\"external\">Microsoft Dynamics CRM 2011 Beta Implementation Guide</a></p>\n<p>界面一览<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_20.jpg\" alt=\"CRM2011_20\"></p>\n<ol>\n<li>自动更新安装程序；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_0.jpg\" alt=\"CRM2011_0\"></li>\n<li>输入安装 Key，在 ReadMe 文件里面有， beta 版本试用有效期是 270 天；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_1.jpg\" alt=\"CRM2011_1\"></li>\n<li>新的组件需求；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_2.jpg\" alt=\"CRM2011_2\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_3.jpg\" alt=\"CRM2011_3\"> <img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_4.jpg\" alt=\"CRM2011_4\"></li>\n<li>选择目录，继续；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_5.jpg\" alt=\"CRM2011_5\"></li>\n<li>新的角色：前端、后端、部署管理；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_6.jpg\" alt=\"CRM2011_6\"></li>\n<li>和 4.0 一样的选择 AD 用户和组创建位置；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_7.jpg\" alt=\"CRM2011_7\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_8.jpg\" alt=\"CRM2011_8\"> <img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_9.jpg\" alt=\"CRM2011_9\"> <img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_10.jpg\" alt=\"CRM2011_10\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_11.jpg\" alt=\"CRM2011_11\"></li>\n<li>创建一个 CRM 组织；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_12.jpg\" alt=\"CRM2011_12\"></li>\n<li>选择报表服务器；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_13.jpg\" alt=\"CRM2011_13\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_14.jpg\" alt=\"CRM2011_14\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_15.jpg\" alt=\"CRM2011_15\"></li>\n<li>安装前需求全部满足，开始安装；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_16.jpg\" alt=\"CRM2011_16\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_17.jpg\" alt=\"CRM2011_17\"><br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_18.jpg\" alt=\"CRM2011_18\"></li>\n<li>如果分开部署，这里要安装 Reporting Extensions for SSRS Setup；<br><img src=\"/2011/09/19/mscrm-2011-beta-installation/CRM2011_19.jpg\" alt=\"CRM2011_19\"></li>\n</ol>\n"},{"title":"MSCRM 4.0 Email Router - 404 not Found","date":"2009-08-20T07:19:02.000Z","_content":"\nHere is a good article regarding to CRM 4.0 Email Router issues:\n\n[http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx](http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx)\n\nBut what I encounterd is not listed.\n\n**If you have an error type HTTP 404 (Not Found)**\n\nThe E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url 'http://servername:5555/orgname'  is correct. The request failed with HTTP status 404:**Not Found**.\"\n\nWorkaround:\n\nCheck your CRM deployment properties, make sure these 2 record are not \"LocalHost\", better use its netbios servername, ip address or FQDN.\n\n**AD App Root Domain, ****AD SDK Root Domain**\n\nHow to check:\n```sql\nSELECT Id, ColumnName, NvarCharColumn From DeploymentProperties\nWHERE ColumnName IN ('ADSdkRootDomain','ADWebApplicationRootDomain')\n```\nPost tasks:\n\n1. Restart IIS.\n\n2. Restart Microsoft Dynamics CRM Asynchronous Processing Services.","source":"_posts/mscrm-40-email-router-404-notfound.md","raw":"---\ntitle: MSCRM 4.0 Email Router - 404 not Found\ntags:\n  - MSCRM\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2009-08-20 15:19:02\n---\n\nHere is a good article regarding to CRM 4.0 Email Router issues:\n\n[http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx](http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx)\n\nBut what I encounterd is not listed.\n\n**If you have an error type HTTP 404 (Not Found)**\n\nThe E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url 'http://servername:5555/orgname'  is correct. The request failed with HTTP status 404:**Not Found**.\"\n\nWorkaround:\n\nCheck your CRM deployment properties, make sure these 2 record are not \"LocalHost\", better use its netbios servername, ip address or FQDN.\n\n**AD App Root Domain, ****AD SDK Root Domain**\n\nHow to check:\n```sql\nSELECT Id, ColumnName, NvarCharColumn From DeploymentProperties\nWHERE ColumnName IN ('ADSdkRootDomain','ADWebApplicationRootDomain')\n```\nPost tasks:\n\n1. Restart IIS.\n\n2. Restart Microsoft Dynamics CRM Asynchronous Processing Services.","slug":"mscrm-40-email-router-404-notfound","published":1,"updated":"2017-06-16T12:51:14.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzl004j4gyrhbkpieup","content":"<p>Here is a good article regarding to CRM 4.0 Email Router issues:</p>\n<p><a href=\"http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx</a></p>\n<p>But what I encounterd is not listed.</p>\n<p><strong>If you have an error type HTTP 404 (Not Found)</strong></p>\n<p>The E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url ‘<a href=\"http://servername:5555/orgname\" target=\"_blank\" rel=\"external\">http://servername:5555/orgname</a>‘  is correct. The request failed with HTTP status 404:<strong>Not Found</strong>.”</p>\n<p>Workaround:</p>\n<p>Check your CRM deployment properties, make sure these 2 record are not “LocalHost”, better use its netbios servername, ip address or FQDN.</p>\n<p><strong>AD App Root Domain, **</strong>AD SDK Root Domain**</p>\n<p>How to check:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">Id</span>, ColumnName, NvarCharColumn <span class=\"keyword\">From</span> DeploymentProperties</div><div class=\"line\"><span class=\"keyword\">WHERE</span> ColumnName <span class=\"keyword\">IN</span> (<span class=\"string\">'ADSdkRootDomain'</span>,<span class=\"string\">'ADWebApplicationRootDomain'</span>)</div></pre></td></tr></table></figure></p>\n<p>Post tasks:</p>\n<ol>\n<li><p>Restart IIS.</p>\n</li>\n<li><p>Restart Microsoft Dynamics CRM Asynchronous Processing Services.</p>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>Here is a good article regarding to CRM 4.0 Email Router issues:</p>\n<p><a href=\"http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx\" target=\"_blank\" rel=\"external\">http://blogs.msdn.com/crm/archive/2009/01/08/troubleshooting-the-microsoft-dynamics-crm-e-mail-router.aspx</a></p>\n<p>But what I encounterd is not listed.</p>\n<p><strong>If you have an error type HTTP 404 (Not Found)</strong></p>\n<p>The E-mail Router Configuration Manager was unable to retrieve user and queue information from the Dyamics CRM server. Verify the url ‘<a href=\"http://servername:5555/orgname\" target=\"_blank\" rel=\"external\">http://servername:5555/orgname</a>‘  is correct. The request failed with HTTP status 404:<strong>Not Found</strong>.”</p>\n<p>Workaround:</p>\n<p>Check your CRM deployment properties, make sure these 2 record are not “LocalHost”, better use its netbios servername, ip address or FQDN.</p>\n<p><strong>AD App Root Domain, **</strong>AD SDK Root Domain**</p>\n<p>How to check:<br><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">SELECT</span> <span class=\"keyword\">Id</span>, ColumnName, NvarCharColumn <span class=\"keyword\">From</span> DeploymentProperties</div><div class=\"line\"><span class=\"keyword\">WHERE</span> ColumnName <span class=\"keyword\">IN</span> (<span class=\"string\">'ADSdkRootDomain'</span>,<span class=\"string\">'ADWebApplicationRootDomain'</span>)</div></pre></td></tr></table></figure></p>\n<p>Post tasks:</p>\n<ol>\n<li><p>Restart IIS.</p>\n</li>\n<li><p>Restart Microsoft Dynamics CRM Asynchronous Processing Services.</p>\n</li>\n</ol>\n"},{"title":"MSCRM Contacts and Accounts are not showing up in Outlook?","date":"2008-09-08T03:09:10.000Z","_content":"\nIn Outlook, go to **Tools**|**Address Book**.\n\nFrom the drop-down list, choose the \"**CRM Contacts**\" Address Book. Is it blank?\n\nIf so, there's an easy way to correct the problem.\n\n1. In Outlook, choose Options from the CRM Menu\n2. Click on the Address Book tab\n3. Select \"Match all contacts in Microsoft Dynamics CRM\" and \"Match all items in Microsoft Dynamics CRM\"\n4. Click OK\n5. Synchronize with CRM by choose \"Synchronize with CRM\" from the CRM menu\n6. Return to CRM Address book. You should now see entries there\nYou might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.","source":"_posts/mscrm-contacts-and-accounts-are-not-showing-up-in-outlook.md","raw":"---\ntitle: MSCRM Contacts and Accounts are not showing up in Outlook?\ntags:\n  - MSCRM\n  - Outlook\ncategories:\n  - Microsoft\n  - MSCRM\ndate: 2008-09-08 11:09:10\n---\n\nIn Outlook, go to **Tools**|**Address Book**.\n\nFrom the drop-down list, choose the \"**CRM Contacts**\" Address Book. Is it blank?\n\nIf so, there's an easy way to correct the problem.\n\n1. In Outlook, choose Options from the CRM Menu\n2. Click on the Address Book tab\n3. Select \"Match all contacts in Microsoft Dynamics CRM\" and \"Match all items in Microsoft Dynamics CRM\"\n4. Click OK\n5. Synchronize with CRM by choose \"Synchronize with CRM\" from the CRM menu\n6. Return to CRM Address book. You should now see entries there\nYou might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.","slug":"mscrm-contacts-and-accounts-are-not-showing-up-in-outlook","published":1,"updated":"2017-06-16T12:51:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzm004n4gyrhzm8em06","content":"<p>In Outlook, go to <strong>Tools</strong>|<strong>Address Book</strong>.</p>\n<p>From the drop-down list, choose the “<strong>CRM Contacts</strong>“ Address Book. Is it blank?</p>\n<p>If so, there’s an easy way to correct the problem.</p>\n<ol>\n<li>In Outlook, choose Options from the CRM Menu</li>\n<li>Click on the Address Book tab</li>\n<li>Select “Match all contacts in Microsoft Dynamics CRM” and “Match all items in Microsoft Dynamics CRM”</li>\n<li>Click OK</li>\n<li>Synchronize with CRM by choose “Synchronize with CRM” from the CRM menu</li>\n<li>Return to CRM Address book. You should now see entries there<br>You might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>In Outlook, go to <strong>Tools</strong>|<strong>Address Book</strong>.</p>\n<p>From the drop-down list, choose the “<strong>CRM Contacts</strong>“ Address Book. Is it blank?</p>\n<p>If so, there’s an easy way to correct the problem.</p>\n<ol>\n<li>In Outlook, choose Options from the CRM Menu</li>\n<li>Click on the Address Book tab</li>\n<li>Select “Match all contacts in Microsoft Dynamics CRM” and “Match all items in Microsoft Dynamics CRM”</li>\n<li>Click OK</li>\n<li>Synchronize with CRM by choose “Synchronize with CRM” from the CRM menu</li>\n<li>Return to CRM Address book. You should now see entries there<br>You might need to synch several times before they all get there.  This setting is not set by default in 4.0 for some reason.</li>\n</ol>\n"},{"title":"Multi-Tenancy and Hosting Guidance for Exchange Server 2010 SP2 is released!","date":"2011-12-14T08:06:29.000Z","_content":"\nA multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.\n\nThis document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.\n\nDownload Link: [http://www.microsoft.com/download/en/confirmation.aspx?id=28192](http://www.microsoft.com/download/en/confirmation.aspx?id=28192)","source":"_posts/multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released.md","raw":"---\ntitle: Multi-Tenancy and Hosting Guidance for Exchange Server 2010 SP2 is released!\ntags:\n  - Exchange\n  - Hosting\n  - MultiTenancy\ncategories:\n  - Exchange\ndate: 2011-12-14 16:06:29\n---\n\nA multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.\n\nThis document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.\n\nDownload Link: [http://www.microsoft.com/download/en/confirmation.aspx?id=28192](http://www.microsoft.com/download/en/confirmation.aspx?id=28192)","slug":"multi-tenancy-and-hosting-guidance-for-exchange-server-2010-sp2-is-released","published":1,"updated":"2017-06-16T12:51:44.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzv004r4gyrmno42f8p","content":"<p>A multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.</p>\n<p>This document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.</p>\n<p>Download Link: <a href=\"http://www.microsoft.com/download/en/confirmation.aspx?id=28192\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/download/en/confirmation.aspx?id=28192</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>A multi-tenant Exchange deployment is defined in this document as one where the system has been configured to host multiple and discrete organizations or business units (the tenants) that ordinarily do not share e-mail, data, users, global address lists, or any of the other commonly used objects in Exchange.</p>\n<p>This document does not provide step-by-step instructions about how to achieve multi-tenancy with Exchange 2010 SP2, but provides information on the challenges and problems that need to be solved, and offers advice and direction to ensure the Exchange environment that you build can be supported by Microsoft.</p>\n<p>Download Link: <a href=\"http://www.microsoft.com/download/en/confirmation.aspx?id=28192\" target=\"_blank\" rel=\"external\">http://www.microsoft.com/download/en/confirmation.aspx?id=28192</a></p>\n"},{"title":"OCS各种资料汇总","date":"2008-11-20T15:41:55.000Z","_content":"\nOCS各种资料汇总\n\n*   [Microsoft Office Communications Server 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 客户端部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Enterprise Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP1 试用版</span>](http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn)\n*   [Windows Messenger 5.1 ADM 文件](http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：企业语音规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 联系人管理、状态和即时消息快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile（2007 发行版）](http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Active Directory 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Standard Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 客户端入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 电话和视频快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 多语言用户界面包](http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access](http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 Frequently Asked Questions](http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile](http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：存档和 CDR 服务器部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 QoE Monitoring Server 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）用户指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 会议快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn)\n*   [Communicator 2007 策略文档](http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：命令行参考指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access (2007) 语言包](http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置](http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition](http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 Group Policies](http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）疑难解答指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署 SIP/PSTN 网关](http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：通讯簿服务规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Document: Reference Guide](http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007](http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn)\n*   [Microsoft Office Communications Server 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：配置证书](http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 Quality of Experience Monitoring Server](http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access 规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：规划指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：命令行参考](http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn)\n*   [Office Communicator 自述](http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署概述](http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\"ng=zh-cn)\n*   [Communicator Mobile（2007 发行版）常见问题](http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn)","source":"_posts/ocs-docs.md","raw":"---\ntitle: OCS各种资料汇总\ntags:\n  - OCS\ncategories:\n  - 沟通协作\ndate: 2008-11-20 23:41:55\n---\n\nOCS各种资料汇总\n\n*   [Microsoft Office Communications Server 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 试用版下载](http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 客户端部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Enterprise Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP1 试用版</span>](http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn)\n*   [Windows Messenger 5.1 ADM 文件](http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：企业语音规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 联系人管理、状态和即时消息快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile（2007 发行版）](http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Active Directory 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：Standard Edition 部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 客户端入门指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 电话和视频快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 多语言用户界面包](http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access](http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 Frequently Asked Questions](http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn)\n*   [Office Communicator Mobile](http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：存档和 CDR 服务器部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 QoE Monitoring Server 指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）用户指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn)\n*   [Office Communicator 2007 会议快速参考卡](http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn)\n*   [Communicator 2007 策略文档](http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：命令行参考指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access (2007) 语言包](http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置](http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition](http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 2007 Group Policies](http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn)\n*   [Microsoft Office Live Meeting 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn)\n*   [Communicator Mobile（2007 发行版）疑难解答指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署 SIP/PSTN 网关](http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：通讯簿服务规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 Document: Reference Guide](http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007](http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn)\n*   [Microsoft Office Communications Server 2007 发行说明](http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：配置证书](http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn)\n*   [Office Communications Server 2007 Quality of Experience Monitoring Server](http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator Web Access 规划和部署指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn)\n*   [Microsoft Office Communicator 入门](http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：规划指南](http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：命令行参考](http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn)\n*   [Office Communicator 自述](http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn)\n*   [Live Communications Server 2005 文档：部署概述](http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\"ng=zh-cn)\n*   [Communicator Mobile（2007 发行版）常见问题](http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn)","slug":"ocs-docs","published":1,"updated":"2017-06-16T12:51:56.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5jzw004u4gyrwxdrucna","content":"<p>OCS各种资料汇总</p>\n<ul>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communications Server 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 2007 客户端部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：Enterprise Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 SP1 试用版</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Windows Messenger 5.1 ADM 文件</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：企业语音规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 联系人管理、状态和即时消息快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator Mobile（2007 发行版）</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：Active Directory 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：Standard Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 客户端入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 电话和视频快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 2007 多语言用户界面包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 Frequently Asked Questions</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 Enterprise Edition 文档：部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator Mobile</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：存档和 CDR 服务器部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 QoE Monitoring Server 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）用户指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 会议快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator 2007 策略文档</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：命令行参考指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access (2007) 语言包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 2007 Group Policies</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）疑难解答指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：部署 SIP/PSTN 网关</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：通讯簿服务规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 Document: Reference Guide</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communications Server 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：配置证书</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 Quality of Experience Monitoring Server</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access 规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：规划指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：命令行参考</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 自述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla&quot;http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn&quot;ng=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：部署概述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）常见问题</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>OCS各种资料汇总</p>\n<ul>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=663E5EF7-2288-46B0-9142-B2135A8FBDB9&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communications Server 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=7F5AB627-2D34-470D-9393-8B3EDE6FE3C4&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 2007 试用版下载</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3539CB05-12FD-425B-9317-CE6AB0A2E3CF&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 2007 客户端部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=53F65DC9-09DC-4748-81F7-48457469E550&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：Enterprise Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F638E94A-7CDF-4E42-B286-080240FCBCCB&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 SP1 试用版</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7E5A6B9-DF2E-420E-A0D8-C482CA4DB50E&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CB7218FC-B456-47F4-BE8C-9F16C96B3BDE&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Windows Messenger 5.1 ADM 文件</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=24E72DAC-2B26-4F43-BBA2-60488F2ACA8D&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：企业语音规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=E0C77B42-B7EE-4392-822B-7D82CCAAADB9&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 联系人管理、状态和即时消息快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=2EEA3E24-F216-4887-92B0-F37D942E26E0&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator Mobile（2007 发行版）</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=384793A6-D315-4217-B034-6D189EF6DF13&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：Active Directory 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=1068BEB2-4370-4C66-A3DC-55BDD032B857&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：Standard Edition 部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=C109B20F-33A9-4DD0-AE5B-3B753C0199E6&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 客户端入门指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3315FA6D-5A9A-443D-9795-05354B401AE6&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 电话和视频快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=86DE1E77-3406-475A-9271-24F507E20972&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 2007 多语言用户界面包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A7499AC3-09A6-4491-BDD1-1E41F4719E90&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=16C8A0CB-AD0A-4393-8297-664D9A049F4A&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 Frequently Asked Questions</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5B7A9E68-9B68-424B-A85E-041CA4D36FD7&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F8F6EA2F-021D-4AE0-AC21-1B900E6B4889&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 Enterprise Edition 文档：部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=BC89EC5E-5F3B-47D2-955B-B0C1DEAC94D8&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator Mobile</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=52627734-B354-4F74-A6ED-E298259CDA19&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：存档和 CDR 服务器部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=9ED29D74-3391-4902-BF2C-6757410F3335&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 QoE Monitoring Server 指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=739CE707-2A35-4714-95F6-1D9F394CCAE2&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）用户指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CE1BF10D-8B13-4710-8972-C47B9CEA4209&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 2007 会议快速参考卡</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=DD3CAE08-3153-4C6A-A314-DAA79D616248&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator 2007 策略文档</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=62D61142-8AC1-4E56-AFA9-E99801B703F6&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=84651696-1368-4700-AACF-DE9BD4456595&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：命令行参考指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=82FB56F5-1DFF-4B35-BE2E-B60BDC60BD96&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access (2007) 语言包</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0E21123A-8452-4B25-8CDE-57F750CD7803&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access（2007 发行版）实验室部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B185DDC6-B67B-43A1-8BBB-2CC59FA4A46D&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）快速参考卡 - 安装和配置</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=3508860C-2616-4B5A-BA00-353BE599A7B1&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 SP 1 Standard Edition 和 Enterprise Edition</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=892E9C25-1A0B-436D-B112-033D9993E034&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=69512283-7ED6-40A6-82A8-B215DA051D9A&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 2007 Group Policies</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=5634A517-5A49-4B5D-990D-C312F7BB4283&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 Enterprise Edition 文档：实验室快速入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=8102B4E6-62F2-4D33-B465-A6C5DA1B8973&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Live Meeting 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=CFD79278-AC9D-4755-AE98-5922561927B9&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）疑难解答指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=78154A69-7E6E-4B2A-97C1-64B829AB1D98&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：部署 SIP/PSTN 网关</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=80C7A511-36B4-4E34-9330-88922C7BA72B&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：通讯簿服务规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=D3371B80-D4D3-447C-8D77-3222BC56E54C&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 Document: Reference Guide</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=20F67AFC-6AF5-4A03-99BF-4150DEF36457&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 文档：迁移到 Microsoft Office Communications Server 2007</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=011D0448-3A8B-47E1-A469-32BEDF9D21BD&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communications Server 2007 发行说明</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=779DEDAA-2687-4452-901E-719CE6EC4E5A&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：配置证书</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=09115944-625F-460B-B09C-51E3C96E9F7E&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communications Server 2007 Quality of Experience Monitoring Server</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=B70782D2-C9AB-423E-A126-9E2882863969&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator Web Access 规划和部署指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=70DCC4EC-ECDF-4E7A-B14D-CDF11ADF2B74&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Microsoft Office Communicator 入门</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=F7BC430F-3CAC-4DBD-8EC3-B93186F343FA&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：规划指南</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：命令行参考</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=0A736760-03D4-4DDB-9E18-D9EDF948C167&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Office Communicator 自述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=4E3A1963-51CD-4907-9B8F-C4579ABAFCF7&amp;displayla&quot;http://www.microsoft.com/downloads/details.aspx?FamilyID=A39732DB-156F-4A53-98B1-FF3AB697F1FC&amp;displaylang=zh-cn&quot;ng=zh-cn\" target=\"_blank\" rel=\"external\">Live Communications Server 2005 文档：部署概述</a></li>\n<li><a href=\"http://www.microsoft.com/downloads/details.aspx?FamilyID=96346923-BB96-4558-908F-D11195832565&amp;displaylang=zh-cn\" target=\"_blank\" rel=\"external\">Communicator Mobile（2007 发行版）常见问题</a></li>\n</ul>\n"},{"title":"Patches for HMC4.0","date":"2008-09-21T02:44:35.000Z","_content":"\nThere are many updates released after HMC4.0 first release version, here is a simple list:\nMain rollup update:\n\n1. Update Rollup 1 for the Hosted SharePoint services\n2. Update Rollup 2 for the Hosted Exchange services\n3. Update Rollup 3 for the Hosted Exchange services (included Rollup2)\n4. Update Rollup 4 for the Hosted Exchange services (included Rollup3)\n\nOthers not included in the rollups above:\n\n*   [954965](http://support.microsoft.com/kb/954965/en-us) Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [943728](http://support.microsoft.com/kb/943728/en-us) The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [951052](http://support.microsoft.com/kb/951052/en-us) During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail\n*   [949708](http://support.microsoft.com/kb/949708/en-us) Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: \"There is no such object on the server\"\n*   [939216](http://support.microsoft.com/kb/939216/en-us) Some provisioning requests do not work, and you receive a \"0xc220140b\" error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration\n*   [952089](http://support.microsoft.com/kb/952089/en-us) The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0\n*   [945630](http://support.microsoft.com/kb/945630/en-us) Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0\n*   [954150](http://support.microsoft.com/kb/954150/en-us) You receive an error response when you call the \"EnsureServicePointers\" procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0\n*   [943864](http://support.microsoft.com/kb/943864/en-us) Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [945629](http://support.microsoft.com/kb/945629/en-us) How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0\n*   [947005](http://support.microsoft.com/kb/947005/en-us) You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit\n*   [943792](http://support.microsoft.com/kb/943792/en-us) The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0\n*   [950095](http://support.microsoft.com/kb/950095/en-us) Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0\n*   [939560](http://support.microsoft.com/kb/939560/en-us) Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [936159](http://support.microsoft.com/kb/936159/en-us) A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment\n\n**[Update Rollup 1 for the Hosted SharePoint services](http://support.microsoft.com/kb/952075/en-us) - June 30, 2008 v2.0**\n\n* [943837](http://support.microsoft.com/kb/943837/) Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components\n* [939030](http://support.microsoft.com/kb/939030/) You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0\n* [949629](http://support.microsoft.com/kb/949629/) The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0\n* [946516](http://support.microsoft.com/kb/946516/) Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\nThe **GetRoles** method in the Hosted SharePoint 2007 Web services does not return a list of roles.\n\nYou cannot modify the following site properties:\n   - Title\n   - HostHeaderIsSiteName\n   - URL\n   - Target\n   - Theme\n\nNote This update rollup provides a **ModifyCustomerSite** procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.\n• You receive an error message if you try to create a site that is larger than 4 GB.\n\n• The **GetHostingOUPath_** procedure in the Managed Helpers namespace does not exist.\n\n**[Update Rollup 2 for the Hosted Exchange services](http://support.microsoft.com/kb/948755/en-us) - April 30, 2008 v3.0**\n\nThis update rollup fixes the following issues:\n\n• [942100](http://support.microsoft.com/kb/942100/) Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\n• [946495](http://support.microsoft.com/kb/946495/) You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **ReallocateMailbox** method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox's allocation.\n\n• The new **CreateResourceMailbox** procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.\n\n• The **ModifyResourceMailbox** procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.\n\n• The **CreateAddressList** procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.\n\n**[Update Rollup 3 for the Hosted Exchange services](http://support.microsoft.com/kb/952076/en-us) - May 14, 2008 v1.1**\n\nThis update rollup includes the fixes from the following update rollup:\n\n• [948755](http://support.microsoft.com/kb/948755/) Description of **Update Rollup 2** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **DeleteMailbox** procedure in the Hosted Email 2007 namespace may fail. You may receive an \"A procedure tried to release more resources than are currently allocated to a consumer\" error message or a \"No allocations were found to update\" error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.\n\n• By default, all mailboxes that are created have the **ActiveSync** feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.\n\n> Note After you install this update, you can use the **ActiveSyncEnabled** parameter to enable or disable the ActiveSync feature.\n\n• The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):\n• OWAPublicFoldersEnabled\n• OWARecoverDeletedItemsEnabled\n• OWARulesEnabled\n• OWASMimeEnabled\n\n**[Update Rollup 4 for the Hosted Exchange services](http://support.microsoft.com/kb/952077/en-us) - July 21, 2008 v1.0\n**\n\n• [952076](http://support.microsoft.com/kb/952076/) Description of **Update Rollup 3** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n•    When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.\n\n•    When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user's **showInAddressBook** attribute may be cleared. When this occurs, the user is removed from address lists.\n\n•    In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.\n\n•    The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an \"Out Of Memory\" error message.\nAdditionally, this update rollup includes the following tools:\n•    A tool to deny Send As and Receive As rights to administrators and to customer administrators\n•    A tool to modify the names of existing mobile policies","source":"_posts/patches-for-hmc40.md","raw":"---\ntitle: Patches for HMC4.0\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2008-09-21 10:44:35\n---\n\nThere are many updates released after HMC4.0 first release version, here is a simple list:\nMain rollup update:\n\n1. Update Rollup 1 for the Hosted SharePoint services\n2. Update Rollup 2 for the Hosted Exchange services\n3. Update Rollup 3 for the Hosted Exchange services (included Rollup2)\n4. Update Rollup 4 for the Hosted Exchange services (included Rollup3)\n\nOthers not included in the rollups above:\n\n*   [954965](http://support.microsoft.com/kb/954965/en-us) Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [943728](http://support.microsoft.com/kb/943728/en-us) The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n*   [951052](http://support.microsoft.com/kb/951052/en-us) During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail\n*   [949708](http://support.microsoft.com/kb/949708/en-us) Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: \"There is no such object on the server\"\n*   [939216](http://support.microsoft.com/kb/939216/en-us) Some provisioning requests do not work, and you receive a \"0xc220140b\" error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration\n*   [952089](http://support.microsoft.com/kb/952089/en-us) The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0\n*   [945630](http://support.microsoft.com/kb/945630/en-us) Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0\n*   [954150](http://support.microsoft.com/kb/954150/en-us) You receive an error response when you call the \"EnsureServicePointers\" procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0\n*   [943864](http://support.microsoft.com/kb/943864/en-us) Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [945629](http://support.microsoft.com/kb/945629/en-us) How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0\n*   [947005](http://support.microsoft.com/kb/947005/en-us) You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit\n*   [943792](http://support.microsoft.com/kb/943792/en-us) The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0\n*   [950095](http://support.microsoft.com/kb/950095/en-us) Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0\n*   [939560](http://support.microsoft.com/kb/939560/en-us) Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0\n*   [936159](http://support.microsoft.com/kb/936159/en-us) A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment\n\n**[Update Rollup 1 for the Hosted SharePoint services](http://support.microsoft.com/kb/952075/en-us) - June 30, 2008 v2.0**\n\n* [943837](http://support.microsoft.com/kb/943837/) Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components\n* [939030](http://support.microsoft.com/kb/939030/) You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0\n* [949629](http://support.microsoft.com/kb/949629/) The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0\n* [946516](http://support.microsoft.com/kb/946516/) Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\nThe **GetRoles** method in the Hosted SharePoint 2007 Web services does not return a list of roles.\n\nYou cannot modify the following site properties:\n   - Title\n   - HostHeaderIsSiteName\n   - URL\n   - Target\n   - Theme\n\nNote This update rollup provides a **ModifyCustomerSite** procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.\n• You receive an error message if you try to create a site that is larger than 4 GB.\n\n• The **GetHostingOUPath_** procedure in the Managed Helpers namespace does not exist.\n\n**[Update Rollup 2 for the Hosted Exchange services](http://support.microsoft.com/kb/948755/en-us) - April 30, 2008 v3.0**\n\nThis update rollup fixes the following issues:\n\n• [942100](http://support.microsoft.com/kb/942100/) Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\n• [946495](http://support.microsoft.com/kb/946495/) You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **ReallocateMailbox** method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox's allocation.\n\n• The new **CreateResourceMailbox** procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.\n\n• The **ModifyResourceMailbox** procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.\n\n• The **CreateAddressList** procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.\n\n**[Update Rollup 3 for the Hosted Exchange services](http://support.microsoft.com/kb/952076/en-us) - May 14, 2008 v1.1**\n\nThis update rollup includes the fixes from the following update rollup:\n\n• [948755](http://support.microsoft.com/kb/948755/) Description of **Update Rollup 2** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n• The **DeleteMailbox** procedure in the Hosted Email 2007 namespace may fail. You may receive an \"A procedure tried to release more resources than are currently allocated to a consumer\" error message or a \"No allocations were found to update\" error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.\n\n• By default, all mailboxes that are created have the **ActiveSync** feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.\n\n> Note After you install this update, you can use the **ActiveSyncEnabled** parameter to enable or disable the ActiveSync feature.\n\n• The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):\n• OWAPublicFoldersEnabled\n• OWARecoverDeletedItemsEnabled\n• OWARulesEnabled\n• OWASMimeEnabled\n\n**[Update Rollup 4 for the Hosted Exchange services](http://support.microsoft.com/kb/952077/en-us) - July 21, 2008 v1.0\n**\n\n• [952076](http://support.microsoft.com/kb/952076/) Description of **Update Rollup 3** for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0\n\nThis update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:\n\n•    When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.\n\n•    When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user's **showInAddressBook** attribute may be cleared. When this occurs, the user is removed from address lists.\n\n•    In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.\n\n•    The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an \"Out Of Memory\" error message.\nAdditionally, this update rollup includes the following tools:\n•    A tool to deny Send As and Receive As rights to administrators and to customer administrators\n•    A tool to modify the names of existing mobile policies","slug":"patches-for-hmc40","published":1,"updated":"2017-06-16T12:52:12.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k03004z4gyrzqga35qb","content":"<p>There are many updates released after HMC4.0 first release version, here is a simple list:<br>Main rollup update:</p>\n<ol>\n<li>Update Rollup 1 for the Hosted SharePoint services</li>\n<li>Update Rollup 2 for the Hosted Exchange services</li>\n<li>Update Rollup 3 for the Hosted Exchange services (included Rollup2)</li>\n<li>Update Rollup 4 for the Hosted Exchange services (included Rollup3)</li>\n</ol>\n<p>Others not included in the rollups above:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/954965/en-us\" target=\"_blank\" rel=\"external\">954965</a> Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943728/en-us\" target=\"_blank\" rel=\"external\">943728</a> The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/951052/en-us\" target=\"_blank\" rel=\"external\">951052</a> During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail</li>\n<li><a href=\"http://support.microsoft.com/kb/949708/en-us\" target=\"_blank\" rel=\"external\">949708</a> Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: “There is no such object on the server”</li>\n<li><a href=\"http://support.microsoft.com/kb/939216/en-us\" target=\"_blank\" rel=\"external\">939216</a> Some provisioning requests do not work, and you receive a “0xc220140b” error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration</li>\n<li><a href=\"http://support.microsoft.com/kb/952089/en-us\" target=\"_blank\" rel=\"external\">952089</a> The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945630/en-us\" target=\"_blank\" rel=\"external\">945630</a> Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/954150/en-us\" target=\"_blank\" rel=\"external\">954150</a> You receive an error response when you call the “EnsureServicePointers” procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943864/en-us\" target=\"_blank\" rel=\"external\">943864</a> Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945629/en-us\" target=\"_blank\" rel=\"external\">945629</a> How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/947005/en-us\" target=\"_blank\" rel=\"external\">947005</a> You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit</li>\n<li><a href=\"http://support.microsoft.com/kb/943792/en-us\" target=\"_blank\" rel=\"external\">943792</a> The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/950095/en-us\" target=\"_blank\" rel=\"external\">950095</a> Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/939560/en-us\" target=\"_blank\" rel=\"external\">939560</a> Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/936159/en-us\" target=\"_blank\" rel=\"external\">936159</a> A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment</li>\n</ul>\n<p><strong><a href=\"http://support.microsoft.com/kb/952075/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 1 for the Hosted SharePoint services</a> - June 30, 2008 v2.0</strong></p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/943837/\" target=\"_blank\" rel=\"external\">943837</a> Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components</li>\n<li><a href=\"http://support.microsoft.com/kb/939030/\" target=\"_blank\" rel=\"external\">939030</a> You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/949629/\" target=\"_blank\" rel=\"external\">949629</a> The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/946516/\" target=\"_blank\" rel=\"external\">946516</a> Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n</ul>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>The <strong>GetRoles</strong> method in the Hosted SharePoint 2007 Web services does not return a list of roles.</p>\n<p>You cannot modify the following site properties:</p>\n<ul>\n<li>Title</li>\n<li>HostHeaderIsSiteName</li>\n<li>URL</li>\n<li>Target</li>\n<li>Theme</li>\n</ul>\n<p>Note This update rollup provides a <strong>ModifyCustomerSite</strong> procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.<br>• You receive an error message if you try to create a site that is larger than 4 GB.</p>\n<p>• The <strong>GetHostingOUPath_</strong> procedure in the Managed Helpers namespace does not exist.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/948755/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 2 for the Hosted Exchange services</a> - April 30, 2008 v3.0</strong></p>\n<p>This update rollup fixes the following issues:</p>\n<p>• <a href=\"http://support.microsoft.com/kb/942100/\" target=\"_blank\" rel=\"external\">942100</a> Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>• <a href=\"http://support.microsoft.com/kb/946495/\" target=\"_blank\" rel=\"external\">946495</a> You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>• The <strong>ReallocateMailbox</strong> method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox’s allocation.</p>\n<p>• The new <strong>CreateResourceMailbox</strong> procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.</p>\n<p>• The <strong>ModifyResourceMailbox</strong> procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.</p>\n<p>• The <strong>CreateAddressList</strong> procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/952076/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 3 for the Hosted Exchange services</a> - May 14, 2008 v1.1</strong></p>\n<p>This update rollup includes the fixes from the following update rollup:</p>\n<p>• <a href=\"http://support.microsoft.com/kb/948755/\" target=\"_blank\" rel=\"external\">948755</a> Description of <strong>Update Rollup 2</strong> for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>• The <strong>DeleteMailbox</strong> procedure in the Hosted Email 2007 namespace may fail. You may receive an “A procedure tried to release more resources than are currently allocated to a consumer” error message or a “No allocations were found to update” error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.</p>\n<p>• By default, all mailboxes that are created have the <strong>ActiveSync</strong> feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.</p>\n<blockquote>\n<p>Note After you install this update, you can use the <strong>ActiveSyncEnabled</strong> parameter to enable or disable the ActiveSync feature.</p>\n</blockquote>\n<p>• The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):<br>• OWAPublicFoldersEnabled<br>• OWARecoverDeletedItemsEnabled<br>• OWARulesEnabled<br>• OWASMimeEnabled</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/952077/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 4 for the Hosted Exchange services</a> - July 21, 2008 v1.0\n</strong></p>\n<p>• <a href=\"http://support.microsoft.com/kb/952076/\" target=\"_blank\" rel=\"external\">952076</a> Description of <strong>Update Rollup 3</strong> for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>•    When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.</p>\n<p>•    When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user’s <strong>showInAddressBook</strong> attribute may be cleared. When this occurs, the user is removed from address lists.</p>\n<p>•    In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.</p>\n<p>•    The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an “Out Of Memory” error message.<br>Additionally, this update rollup includes the following tools:<br>•    A tool to deny Send As and Receive As rights to administrators and to customer administrators<br>•    A tool to modify the names of existing mobile policies</p>\n","site":{"data":{}},"excerpt":"","more":"<p>There are many updates released after HMC4.0 first release version, here is a simple list:<br>Main rollup update:</p>\n<ol>\n<li>Update Rollup 1 for the Hosted SharePoint services</li>\n<li>Update Rollup 2 for the Hosted Exchange services</li>\n<li>Update Rollup 3 for the Hosted Exchange services (included Rollup2)</li>\n<li>Update Rollup 4 for the Hosted Exchange services (included Rollup3)</li>\n</ol>\n<p>Others not included in the rollups above:</p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/954965/en-us\" target=\"_blank\" rel=\"external\">954965</a> Event ID 50103 is logged in the Application log when you use the Exchange Data Collection tool in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943728/en-us\" target=\"_blank\" rel=\"external\">943728</a> The SMTP Mail Provider does not send usernames or passwords in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/951052/en-us\" target=\"_blank\" rel=\"external\">951052</a> During high provisioning activity in Microsoft Solution for Hosted Messaging and Collaboration 4.0, a request may fail</li>\n<li><a href=\"http://support.microsoft.com/kb/949708/en-us\" target=\"_blank\" rel=\"external\">949708</a> Error message when you call the RenameUser procedure in Hosted Messaging and Collaboration 4.0: “There is no such object on the server”</li>\n<li><a href=\"http://support.microsoft.com/kb/939216/en-us\" target=\"_blank\" rel=\"external\">939216</a> Some provisioning requests do not work, and you receive a “0xc220140b” error message after you install Windows Server 2003 Service Pack 2 on a server that is running Microsoft Solution for Hosted Messaging and Collaboration</li>\n<li><a href=\"http://support.microsoft.com/kb/952089/en-us\" target=\"_blank\" rel=\"external\">952089</a> The Provisioning Engine COM+ component stops responding in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945630/en-us\" target=\"_blank\" rel=\"external\">945630</a> Passwords are not updated in the destination directory after you configure Inbound Automatic Synchronization in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/954150/en-us\" target=\"_blank\" rel=\"external\">954150</a> You receive an error response when you call the “EnsureServicePointers” procedure of the ManagedSharePoint2007 namespace in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/943864/en-us\" target=\"_blank\" rel=\"external\">943864</a> Hosted users can see other hosted users if they can access the HMC Active Directory by using LDAP tools in Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/945629/en-us\" target=\"_blank\" rel=\"external\">945629</a> How to increase the maximum number of offline address books on an offline address book server to 10,000 in Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/947005/en-us\" target=\"_blank\" rel=\"external\">947005</a> You cannot rebuild or replicate offline address books in Hosted Messaging and Collaboration 4.0 Migration Kit</li>\n<li><a href=\"http://support.microsoft.com/kb/943792/en-us\" target=\"_blank\" rel=\"external\">943792</a> The ManagedPlans::GetAssetsByCustomer procedure returns only one result when multiple results are expected in Solution for Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/950095/en-us\" target=\"_blank\" rel=\"external\">950095</a> Memory usage increases unexpectedly in high-stress situations when you continuously call Provisioning Web Services to do duplicate tasks in Hosted Messaging and Collaboration 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/939560/en-us\" target=\"_blank\" rel=\"external\">939560</a> Users cannot download offline address books in Exchange 2007 when you use Microsoft Solution for Hosted Messaging and Collaboration version 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/936159/en-us\" target=\"_blank\" rel=\"external\">936159</a> A newly created recipient may not receive e-mail messages for up to eight hours when you use an Exchange 2007 Edge Transport server in a Microsoft Solution for Hosted Messaging and Collaboration version 4.0 environment</li>\n</ul>\n<p><strong><a href=\"http://support.microsoft.com/kb/952075/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 1 for the Hosted SharePoint services</a> - June 30, 2008 v2.0</strong></p>\n<ul>\n<li><a href=\"http://support.microsoft.com/kb/943837/\" target=\"_blank\" rel=\"external\">943837</a> Description of the update for Hosted Messaging and Collaboration 4.0 for Windows SharePoint Services provisioning components</li>\n<li><a href=\"http://support.microsoft.com/kb/939030/\" target=\"_blank\" rel=\"external\">939030</a> You receive an error message from the SharePoint 2007 provider when you try to provision a Windows SharePoint Services 3.0 site by using HMC 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/949629/\" target=\"_blank\" rel=\"external\">949629</a> The Peoplepicker function may not be fully implemented when you use Windows SharePoint Services 3.0 Service Pack 1 together with Microsoft Solution for Hosted Messaging and Collaboration (HMC) 4.0</li>\n<li><a href=\"http://support.microsoft.com/kb/946516/\" target=\"_blank\" rel=\"external\">946516</a> Null values may be returned for the Web parameter or for the site parameter after you install update 943837 in Microsoft Solution for Hosted Messaging and Collaboration 4.0</li>\n</ul>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>The <strong>GetRoles</strong> method in the Hosted SharePoint 2007 Web services does not return a list of roles.</p>\n<p>You cannot modify the following site properties:</p>\n<ul>\n<li>Title</li>\n<li>HostHeaderIsSiteName</li>\n<li>URL</li>\n<li>Target</li>\n<li>Theme</li>\n</ul>\n<p>Note This update rollup provides a <strong>ModifyCustomerSite</strong> procedure in the provider namespaces for Managed SharePoint 2007 Namespace, for Hosted SharePoint 2007 Namespace, and for SharePoint 2007 Provider.<br>• You receive an error message if you try to create a site that is larger than 4 GB.</p>\n<p>• The <strong>GetHostingOUPath_</strong> procedure in the Managed Helpers namespace does not exist.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/948755/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 2 for the Hosted Exchange services</a> - April 30, 2008 v3.0</strong></p>\n<p>This update rollup fixes the following issues:</p>\n<p>• <a href=\"http://support.microsoft.com/kb/942100/\" target=\"_blank\" rel=\"external\">942100</a> Description of the update for Exchange Server components in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>• <a href=\"http://support.microsoft.com/kb/946495/\" target=\"_blank\" rel=\"external\">946495</a> You cannot set the MaxInactivityTimeDeviceLock parameter in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>• The <strong>ReallocateMailbox</strong> method in the Exchange 2007 Resource Manager Web services cannot be used to reduce a mailbox’s allocation.</p>\n<p>• The new <strong>CreateResourceMailbox</strong> procedure in the Hosted Email 2007 namespace can illegally accept recipients in another hosted organization. Additionally, the CreateResourceMailbox procedure may not make mailboxes visible to users in the organization.</p>\n<p>• The <strong>ModifyResourceMailbox</strong> procedure in the Hosted Email 2007 namespace incorrectly accepts an e-mail address that does not exist in the environment.</p>\n<p>• The <strong>CreateAddressList</strong> procedure in the Exchange 2007 Provider namespace may return an error if the first MAPI-enabled user is created within several seconds of the organization being created and if there is more than one domain controller in the environment.</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/952076/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 3 for the Hosted Exchange services</a> - May 14, 2008 v1.1</strong></p>\n<p>This update rollup includes the fixes from the following update rollup:</p>\n<p>• <a href=\"http://support.microsoft.com/kb/948755/\" target=\"_blank\" rel=\"external\">948755</a> Description of <strong>Update Rollup 2</strong> for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>• The <strong>DeleteMailbox</strong> procedure in the Hosted Email 2007 namespace may fail. You may receive an “A procedure tried to release more resources than are currently allocated to a consumer” error message or a “No allocations were found to update” error message. These errors are caused by a mismatch in the method that the Hosted Email 2007 procedures and the Exchange Resource Manager 2007 procedures use to calculate allocations.</p>\n<p>• By default, all mailboxes that are created have the <strong>ActiveSync</strong> feature enabled. You cannot create a plan in which the ActiveSync feature is disabled.</p>\n<blockquote>\n<p>Note After you install this update, you can use the <strong>ActiveSyncEnabled</strong> parameter to enable or disable the ActiveSync feature.</p>\n</blockquote>\n<p>• The SetCASMailbox procedure in the Exchange 2007 Provider namespace does not let you control the following new Outlook Web Access features in Exchange 2007 Service Pack 1 (SP1):<br>• OWAPublicFoldersEnabled<br>• OWARecoverDeletedItemsEnabled<br>• OWARulesEnabled<br>• OWASMimeEnabled</p>\n<p><strong><a href=\"http://support.microsoft.com/kb/952077/en-us\" target=\"_blank\" rel=\"external\">Update Rollup 4 for the Hosted Exchange services</a> - July 21, 2008 v1.0\n</strong></p>\n<p>• <a href=\"http://support.microsoft.com/kb/952076/\" target=\"_blank\" rel=\"external\">952076</a> Description of <strong>Update Rollup 3</strong> for the Hosted Exchange services in Microsoft Solution for Hosted Messaging and Collaboration 4.0</p>\n<p>This update rollup also fixes the following issues that were not previously documented in a Microsoft Knowledge Base article:</p>\n<p>•    When an organization owns more than one SMTP domain, Microsoft Exchange ActiveSync mailbox policies may not be applied.</p>\n<p>•    When you use the SetUserPolicy procedure in the Hosted Mobility 2007 namespace, a user’s <strong>showInAddressBook</strong> attribute may be cleared. When this occurs, the user is removed from address lists.</p>\n<p>•    In an environment in which lots of new users are being created in quick succession, a failure may occur. This failure indicates that you tried to create a user by using a proxy address that already exists for another user.</p>\n<p>•    The GetSMTPDomain procedure in the Microsoft Exchange Server 2007 provider may fail, and you may receive an “Out Of Memory” error message.<br>Additionally, this update rollup includes the following tools:<br>•    A tool to deny Send As and Receive As rights to administrators and to customer administrators<br>•    A tool to modify the names of existing mobile policies</p>\n"},{"title":"小心安装 OCS 2007 R2 Cumulative Update 6 (CU6) 和 .NET 4.0","date":"2010-08-15T01:25:18.000Z","_content":"\n今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现\n\n> Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.\n\n最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯\n```cmd\nmsiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx\n```\n打完了数据库补丁后，启动 Front-End 服务正常。\n\n另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。\n\n我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。","source":"_posts/problem-when-installing-ocs2007-r2-cu6-dotnet-40.md","raw":"---\ntitle: 小心安装 OCS 2007 R2 Cumulative Update 6 (CU6) 和 .NET 4.0\ntags:\n  - OCS\ncategories:\n  - 沟通协作\ndate: 2010-08-15 09:25:18\n---\n\n今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现\n\n> Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.\n\n最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯\n```cmd\nmsiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx\n```\n打完了数据库补丁后，启动 Front-End 服务正常。\n\n另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。\n\n我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。","slug":"problem-when-installing-ocs2007-r2-cu6-dotnet-40","published":1,"updated":"2017-06-16T12:52:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0400524gyr2p7rwi54","content":"<p>今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现</p>\n<blockquote>\n<p>Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.</p>\n</blockquote>\n<p>最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯<br><figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">msiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx</div></pre></td></tr></table></figure></p>\n<p>打完了数据库补丁后，启动 Front-End 服务正常。</p>\n<p>另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。</p>\n<p>我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>今天发现有新的 OCS 2007 R2 的更新，于是就跑去把几台 OCS 2007 R2 的服务器都给升级了，为了偷懒，用了那个一体化更新包ServerUpdateInstaller.exe，这个东西好是好，就是下载后没有点版本信息可以从文件名看出来，每次都一样，我只好自己在后面加个尾巴标注。更新完了重启，发现 Front-End 服务死活都起不来，检查系统日志，发现</p>\n<blockquote>\n<p>Event ID: 3096 Source: Live Communications User Services Details: The component Live Communications User Services reported a critical error: code C3EE78F8 (Enterprise Edition Server successfully registered with the back-end, but a stored procedure version mismatch was detected. The service will not start until this problem is resolved. Cause: The database schema and the Enterprise Edition Server were updated by different installation packages. Resolution: Ensure both the Enterprise Edition Server and back-end were installed or modified by the same installation package. The service has to stop.</p>\n</blockquote>\n<p>最后搞了半天才发现是要先升级数据库才行，OCS2009-DBUpgrade.msi 否则会因为前端服务的版本和后端数据库版本不匹配而导致服务启动失败。唉，这种事情也不早说出来，ServerUpdateInstaller.exe 没法升级数据库，只好手动做咯<br><figure class=\"highlight cmd\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">msiexec /i OCS2009-DBUpdate.msi POOLNAME=xxx</div></pre></td></tr></table></figure></p>\n<p>打完了数据库补丁后，启动 Front-End 服务正常。</p>\n<p>另外还有个问题是关于.NET 4.0 Framework 的，如果你是新装的服务器，在安装OCS之前装了 .NET 4，你会发现安装程序老是会说 .NET 3.5x 没有安装，即便你已经装过，怎么办呢？只有先行卸载.NET 4.0 Framework, 安装 OCS，再安装 .NET 4.0 才行。</p>\n<p>我一向的原则都是新东西等等再装，因为说不准更新完后会出什么问题，先等等，大家都说没问题了，再装，这样安全。</p>\n"},{"title":"Reporting Service can't start - Event ID 107","date":"2009-12-11T12:55:31.000Z","_content":"\nToday, one of my clients reported that, the reporting service cannot started.\nThey didn't change anything and database service is running fine.\n> Event Type: Error\nEvent Source: Report Server Windows Service (MSSQLSERVER)\nEvent Category: Management\nEvent ID: 107\nDate: 12/10/2009\nTime: 11:53:21 PM\nUser: N/A\nComputer: ABC\nDescription:\nReport Server Windows Service (MSSQLSERVER) cannot connect to the report server database.\n\n> Event Type: Error\nEvent Source: Service Control Manager\nEvent Category: None\nEvent ID: 7000\nDate: 7/27/2008\nTime: 7:26:24 PM\nUser: N/A\nComputer: PRODB\nDescription:\nThe SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:\nThe service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.\n\nThe Reporting Services logs mostly just repeat that \"The Report Server Windows service 'ReportServer' is not running.\" ...\n\nThis issue was caused by a windows hotfix - **KB948109**, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.\n\nThere are 2 ways can make it resolved.\n\n**Solution A**: Use Add/Remove to uninstall this hotfix **KB948109**.\n\n**Solution B**: Change the registry to increase the timeout value.\n\nWe suggest **Solution B.**\n\n\nTo increase the timeout value in the registry, follow these steps:\n   1. Start Registry Editor (Regedit.exe).\n   2. To change the value data for the **ServicesPipeTimeout DWORD** value to 60000 in the**Control** key, follow these steps:\n    1. Locate and then click the following registry key:\n`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet`\n    2. Click the **Control** subkey\n    3. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    4. Click **Decimal**.\n    5. Type 60000, and then click **OK**.\n\n* If the **ServicesPipeTimeout** value is _not_ available, add the new **DWORD** value, and then set its value data to 60000 in the **Control** key. To do so, follow these steps:\n    1. Locate and then click the following registry key:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\n    2. Click the **Control** subkey.\n    3. On the **Edit** menu, point to **New**, and then click **DWORD Value**.\n    4. Type ServicesPipeTimeout, and then press ENTER.\n    5. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    6. Click **Decimal**.\n    7. Type a value of 60000, and then click **OK**.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.\n>**Note **This change does not take effect until the computer is restarted","source":"_posts/reporting-service-cant-start-event-id-107.md","raw":"---\ntitle: Reporting Service can't start - Event ID 107\ntags:\n  - Reporting Service\n  - MSSQL\ncategories:\n  - Microsoft\n  - SQL数据库\ndate: 2009-12-11 20:55:31\n---\n\nToday, one of my clients reported that, the reporting service cannot started.\nThey didn't change anything and database service is running fine.\n> Event Type: Error\nEvent Source: Report Server Windows Service (MSSQLSERVER)\nEvent Category: Management\nEvent ID: 107\nDate: 12/10/2009\nTime: 11:53:21 PM\nUser: N/A\nComputer: ABC\nDescription:\nReport Server Windows Service (MSSQLSERVER) cannot connect to the report server database.\n\n> Event Type: Error\nEvent Source: Service Control Manager\nEvent Category: None\nEvent ID: 7000\nDate: 7/27/2008\nTime: 7:26:24 PM\nUser: N/A\nComputer: PRODB\nDescription:\nThe SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:\nThe service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at http://go.microsoft.com/fwlink/events.asp.\n\nThe Reporting Services logs mostly just repeat that \"The Report Server Windows service 'ReportServer' is not running.\" ...\n\nThis issue was caused by a windows hotfix - **KB948109**, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.\n\nThere are 2 ways can make it resolved.\n\n**Solution A**: Use Add/Remove to uninstall this hotfix **KB948109**.\n\n**Solution B**: Change the registry to increase the timeout value.\n\nWe suggest **Solution B.**\n\n\nTo increase the timeout value in the registry, follow these steps:\n   1. Start Registry Editor (Regedit.exe).\n   2. To change the value data for the **ServicesPipeTimeout DWORD** value to 60000 in the**Control** key, follow these steps:\n    1. Locate and then click the following registry key:\n`HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet`\n    2. Click the **Control** subkey\n    3. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    4. Click **Decimal**.\n    5. Type 60000, and then click **OK**.\n\n* If the **ServicesPipeTimeout** value is _not_ available, add the new **DWORD** value, and then set its value data to 60000 in the **Control** key. To do so, follow these steps:\n    1. Locate and then click the following registry key:\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\n    2. Click the **Control** subkey.\n    3. On the **Edit** menu, point to **New**, and then click **DWORD Value**.\n    4. Type ServicesPipeTimeout, and then press ENTER.\n    5. Right-click the **ServicesPipeTimeout DWORD** value, and then click **Modify**.\n    6. Click **Decimal**.\n    7. Type a value of 60000, and then click **OK**.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.\n>**Note **This change does not take effect until the computer is restarted","slug":"reporting-service-cant-start-event-id-107","published":1,"updated":"2017-06-16T12:52:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0500564gyrfhsb6n1w","content":"<p>Today, one of my clients reported that, the reporting service cannot started.<br>They didn’t change anything and database service is running fine.</p>\n<blockquote>\n<p>Event Type: Error<br>Event Source: Report Server Windows Service (MSSQLSERVER)<br>Event Category: Management<br>Event ID: 107<br>Date: 12/10/2009<br>Time: 11:53:21 PM<br>User: N/A<br>Computer: ABC<br>Description:<br>Report Server Windows Service (MSSQLSERVER) cannot connect to the report server database.</p>\n<p>Event Type: Error<br>Event Source: Service Control Manager<br>Event Category: None<br>Event ID: 7000<br>Date: 7/27/2008<br>Time: 7:26:24 PM<br>User: N/A<br>Computer: PRODB<br>Description:<br>The SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:<br>The service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at <a href=\"http://go.microsoft.com/fwlink/events.asp\" target=\"_blank\" rel=\"external\">http://go.microsoft.com/fwlink/events.asp</a>.</p>\n</blockquote>\n<p>The Reporting Services logs mostly just repeat that “The Report Server Windows service ‘ReportServer’ is not running.” …</p>\n<p>This issue was caused by a windows hotfix - <strong>KB948109</strong>, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.</p>\n<p>There are 2 ways can make it resolved.</p>\n<p><strong>Solution A</strong>: Use Add/Remove to uninstall this hotfix <strong>KB948109</strong>.</p>\n<p><strong>Solution B</strong>: Change the registry to increase the timeout value.</p>\n<p>We suggest <strong>Solution B.</strong></p>\n<p>To increase the timeout value in the registry, follow these steps:</p>\n<ol>\n<li>Start Registry Editor (Regedit.exe).</li>\n<li>To change the value data for the <strong>ServicesPipeTimeout DWORD</strong> value to 60000 in the<strong>Control</strong> key, follow these steps:<ol>\n<li>Locate and then click the following registry key:<br><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</code></li>\n<li>Click the <strong>Control</strong> subkey</li>\n<li>Right-click the <strong>ServicesPipeTimeout DWORD</strong> value, and then click <strong>Modify</strong>.</li>\n<li>Click <strong>Decimal</strong>.</li>\n<li>Type 60000, and then click <strong>OK</strong>.</li>\n</ol>\n</li>\n</ol>\n<ul>\n<li>If the <strong>ServicesPipeTimeout</strong> value is <em>not</em> available, add the new <strong>DWORD</strong> value, and then set its value data to 60000 in the <strong>Control</strong> key. To do so, follow these steps:<ol>\n<li>Locate and then click the following registry key:<br>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</li>\n<li>Click the <strong>Control</strong> subkey.</li>\n<li>On the <strong>Edit</strong> menu, point to <strong>New</strong>, and then click <strong>DWORD Value</strong>.</li>\n<li>Type ServicesPipeTimeout, and then press ENTER.</li>\n<li>Right-click the <strong>ServicesPipeTimeout DWORD</strong> value, and then click <strong>Modify</strong>.</li>\n<li>Click <strong>Decimal</strong>.</li>\n<li>Type a value of 60000, and then click <strong>OK</strong>.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.<blockquote>\n<p><strong>Note </strong>This change does not take effect until the computer is restarted</p>\n</blockquote>\n</li>\n</ol>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>Today, one of my clients reported that, the reporting service cannot started.<br>They didn’t change anything and database service is running fine.</p>\n<blockquote>\n<p>Event Type: Error<br>Event Source: Report Server Windows Service (MSSQLSERVER)<br>Event Category: Management<br>Event ID: 107<br>Date: 12/10/2009<br>Time: 11:53:21 PM<br>User: N/A<br>Computer: ABC<br>Description:<br>Report Server Windows Service (MSSQLSERVER) cannot connect to the report server database.</p>\n<p>Event Type: Error<br>Event Source: Service Control Manager<br>Event Category: None<br>Event ID: 7000<br>Date: 7/27/2008<br>Time: 7:26:24 PM<br>User: N/A<br>Computer: PRODB<br>Description:<br>The SQL Server Reporting Services (MSSQLSERVER) service failed to start due to the following error:<br>The service did not respond to the start or control request in a timely fashion.For more information, see Help and Support Center at <a href=\"http://go.microsoft.com/fwlink/events.asp\" target=\"_blank\" rel=\"external\">http://go.microsoft.com/fwlink/events.asp</a>.</p>\n</blockquote>\n<p>The Reporting Services logs mostly just repeat that “The Report Server Windows service ‘ReportServer’ is not running.” …</p>\n<p>This issue was caused by a windows hotfix - <strong>KB948109</strong>, it changed Windows Internal Database (WYukon) security settings that could make the service start timeout.</p>\n<p>There are 2 ways can make it resolved.</p>\n<p><strong>Solution A</strong>: Use Add/Remove to uninstall this hotfix <strong>KB948109</strong>.</p>\n<p><strong>Solution B</strong>: Change the registry to increase the timeout value.</p>\n<p>We suggest <strong>Solution B.</strong></p>\n<p>To increase the timeout value in the registry, follow these steps:</p>\n<ol>\n<li>Start Registry Editor (Regedit.exe).</li>\n<li>To change the value data for the <strong>ServicesPipeTimeout DWORD</strong> value to 60000 in the<strong>Control</strong> key, follow these steps:<ol>\n<li>Locate and then click the following registry key:<br><code>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</code></li>\n<li>Click the <strong>Control</strong> subkey</li>\n<li>Right-click the <strong>ServicesPipeTimeout DWORD</strong> value, and then click <strong>Modify</strong>.</li>\n<li>Click <strong>Decimal</strong>.</li>\n<li>Type 60000, and then click <strong>OK</strong>.</li>\n</ol>\n</li>\n</ol>\n<ul>\n<li>If the <strong>ServicesPipeTimeout</strong> value is <em>not</em> available, add the new <strong>DWORD</strong> value, and then set its value data to 60000 in the <strong>Control</strong> key. To do so, follow these steps:<ol>\n<li>Locate and then click the following registry key:<br>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet</li>\n<li>Click the <strong>Control</strong> subkey.</li>\n<li>On the <strong>Edit</strong> menu, point to <strong>New</strong>, and then click <strong>DWORD Value</strong>.</li>\n<li>Type ServicesPipeTimeout, and then press ENTER.</li>\n<li>Right-click the <strong>ServicesPipeTimeout DWORD</strong> value, and then click <strong>Modify</strong>.</li>\n<li>Click <strong>Decimal</strong>.</li>\n<li>Type a value of 60000, and then click <strong>OK</strong>.The value is 60000 milliseconds and is equivalent to 60 seconds or to one minute.<blockquote>\n<p><strong>Note </strong>This change does not take effect until the computer is restarted</p>\n</blockquote>\n</li>\n</ol>\n</li>\n</ul>\n"},{"title":"Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part1","date":"2013-07-09T04:54:20.000Z","_content":"\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n![Domain relationship error](solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship/Domain-relationship-error.jpg)\n\n退出域重新加域，问题依旧。\n\n最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的\n\nservicePrincipalName:\n- HOST/SRV1\n- <span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span>\n- RestrictedKrbHost/SRV1\n- <span style=\"color: #ff0000\">\nRestrictedKrbHost/srv1.mydomainname.com</span>\nTERMSRV/SRV1\n- <span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span>\n\n缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可\n","source":"_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1.md","raw":"---\ntitle: 'Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part1'\ntags:\n  - SPN\n  - Active Directory\ncategories:\n  - Microsoft\n  - 活动目录\ndate: 2013-07-09 12:54:20\n---\n\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n![Domain relationship error](solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship/Domain-relationship-error.jpg)\n\n退出域重新加域，问题依旧。\n\n最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的\n\nservicePrincipalName:\n- HOST/SRV1\n- <span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span>\n- RestrictedKrbHost/SRV1\n- <span style=\"color: #ff0000\">\nRestrictedKrbHost/srv1.mydomainname.com</span>\nTERMSRV/SRV1\n- <span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span>\n\n缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可\n","slug":"solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1","published":1,"updated":"2017-08-16T03:45:27.509Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0600594gyr7lspuizr","content":"<p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p><img src=\"/2013/07/09/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship/Domain-relationship-error.jpg\" alt=\"Domain relationship error\"></p>\n<p>退出域重新加域，问题依旧。</p>\n<p>最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的</p>\n<p>servicePrincipalName:</p>\n<ul>\n<li>HOST/SRV1</li>\n<li><span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span></li>\n<li>RestrictedKrbHost/SRV1</li>\n<li><span style=\"color: #ff0000\"><br>RestrictedKrbHost/srv1.mydomainname.com</span><br>TERMSRV/SRV1</li>\n<li><span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span></li>\n</ul>\n<p>缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可</p>\n","site":{"data":{}},"excerpt":"","more":"<p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p><img src=\"/2013/07/09/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part1/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship/Domain-relationship-error.jpg\" alt=\"Domain relationship error\"></p>\n<p>退出域重新加域，问题依旧。</p>\n<p>最终找到了原因，在用户计算机的属性SPN里面，只有 WINS 的主机名记录，没有 FQDN 的</p>\n<p>servicePrincipalName:</p>\n<ul>\n<li>HOST/SRV1</li>\n<li><span style=\"color: #ff0000\">HOST/srv1.mydomainname.com</span></li>\n<li>RestrictedKrbHost/SRV1</li>\n<li><span style=\"color: #ff0000\"><br>RestrictedKrbHost/srv1.mydomainname.com</span><br>TERMSRV/SRV1</li>\n<li><span style=\"color: #ff0000\"> TERMSRV/srv1.mydomainname.com</span></li>\n</ul>\n<p>缺少红字部分，用 SetSPN 或者 ADSIEdit 来添加相对应的 FQDN 即可</p>\n"},{"title":"Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part2","date":"2013-10-21T02:12:38.000Z","_content":"\n在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：\n\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n![Domain relationship error](http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg)](http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg)\n\n退出域重新加域，问题解决，可是第二天早上又在出现。\n\n检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：\n\n**Event 5722**: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:\n<span style=\"color: #ff0000\">Access is denied.</span>\n\n在用户端的电脑上，也有Event 3210 NETLOGON 报错:\n\n**Event 3210:** This computer could not authenticate with \\\\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\">**another computer on the same network using the same name** or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.\n\n注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。\n\n后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。\n\n解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)\n","source":"_posts/solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2.md","raw":"---\ntitle: 'Solved: The Security Database on the Server Does Not Have a Computer Account for This Workstation Trust Relationship - Part2'\ntags:\n  - Active Directory\ncategories:\n  - Microsoft\n  - 活动目录\ndate: 2013-10-21 10:12:38\n---\n\n在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：\n\n用户计算机录域的时候出现如下错误：\n\nError: The security database on the server does not have a computer account for this workstation trust relationship\n\n![Domain relationship error](http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg)](http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg)\n\n退出域重新加域，问题解决，可是第二天早上又在出现。\n\n检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：\n\n**Event 5722**: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:\n<span style=\"color: #ff0000\">Access is denied.</span>\n\n在用户端的电脑上，也有Event 3210 NETLOGON 报错:\n\n**Event 3210:** This computer could not authenticate with \\\\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\">**another computer on the same network using the same name** or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.\n\n注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。\n\n后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。\n\n解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)\n","slug":"solved-the-security-database-on-the-server-does-not-have-a-computer-account-for-this-workstation-trust-relationship-part2","published":1,"updated":"2017-08-16T03:45:40.144Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k07005c4gyr7efwbnwm","content":"<p>在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：</p>\n<p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p><img src=\"http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg\" alt=\"Domain relationship error](http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg)\"></p>\n<p>退出域重新加域，问题解决，可是第二天早上又在出现。</p>\n<p>检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：</p>\n<p><strong>Event 5722</strong>: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:<br><span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>在用户端的电脑上，也有Event 3210 NETLOGON 报错:</p>\n<p><strong>Event 3210:</strong> This computer could not authenticate with \\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\"><strong>another computer on the same network using the same name</strong> or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.</p>\n<p>注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。</p>\n<p>后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。</p>\n<p>解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)</p>\n","site":{"data":{}},"excerpt":"","more":"<p>在 Part1 里面，我们用 ADSIEdit.msc 解决了用户登录域的问题，在 Part2，我们来看看可能的另外一个原因：</p>\n<p>用户计算机录域的时候出现如下错误：</p>\n<p>Error: The security database on the server does not have a computer account for this workstation trust relationship</p>\n<p><img src=\"http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg\" alt=\"Domain relationship error](http://winotes.net/wp-content/uploads/Domain-relationship-error.jpg)\"></p>\n<p>退出域重新加域，问题解决，可是第二天早上又在出现。</p>\n<p>检查 AD 的日志，发现有  Event 5722 NETLOGON 错误：</p>\n<p><strong>Event 5722</strong>: The session setup from the computer ComputerName failed to authenticate. The name(s) of the account(s) referenced in the security database is ComputerName$. The following error occurred:<br><span style=\"color: #ff0000\">Access is denied.</span></p>\n<p>在用户端的电脑上，也有Event 3210 NETLOGON 报错:</p>\n<p><strong>Event 3210:</strong> This computer could not authenticate with \\DC01.contoso.com, a Windows domain controller for domain Contoso, and therefore this computer might deny logon requests. This inability to authenticate might be caused by <span style=\"color: #ff0000\"><strong>another computer on the same network using the same name</strong> or the password for this computer account is not recognized</span>. If this message appears again, contact your system administrator.</p>\n<p>注意红色加粗标注部分，实际上，计算机账户的密码，也就是所说的 Secure Channel 安全通道，这个密码是由客户端发起的，一般不存在无法识别的问题，所以很有可能是在网络中有同名的计算机存在。</p>\n<p>后来经过排查，发现有两台计算机重名，两台在碰到无法登陆域的情况下都有做退域重新加域的动作，哪一台后加域，另外一台就会出现无法登陆域的情况，因为在加域的时候，会重置计算机账户密码，所以对于原来已经加域的计算机来讲，密码就不一致了，导致安全通道被破坏，无法认证，最终不能登录域。</p>\n<p>解决方法：将重名的计算机退域，改名，再重新加域，保险起见，用 netdom 重置下计算机账户密码 (重建 Secure Channel)</p>\n"},{"title":"SQL 2005 SP3 & Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5","date":"2009-02-25T01:48:56.000Z","_content":"\nOn a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.\n\nWindows update compatibility tests (**SQL Server 2005 SP3** &amp; **Exchange 2007 SP1 RU6**was included in this test) on HMC 4.0 as well as HMC 4.5 have completed successfully. This means SQL Server 2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.\n\nRef:\n\n##### [SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 ](http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)\n[Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5](http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)","source":"_posts/sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45.md","raw":"---\ntitle: SQL 2005 SP3 & Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5\ntags:\n  - HMC\n  - MSSQL\ncategories:\n  - Microsoft\n  - HMC\ndate: 2009-02-25 09:48:56\n---\n\nOn a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.\n\nWindows update compatibility tests (**SQL Server 2005 SP3** &amp; **Exchange 2007 SP1 RU6**was included in this test) on HMC 4.0 as well as HMC 4.5 have completed successfully. This means SQL Server 2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.\n\nRef:\n\n##### [SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 ](http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)\n[Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5](http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx)","slug":"sql2005-sp3-exch2007-ru6-has-been-validated-for-hmc45","published":1,"updated":"2017-06-16T12:54:14.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k08005f4gyr0xorpjjf","content":"<p>On a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.</p>\n<p>Windows update compatibility tests (<strong>SQL Server 2005 SP3</strong> &amp; <strong>Exchange 2007 SP1 RU6</strong>was included in this test) on HMC 4.0 as well as HMC 4.5 have completed successfully. This means SQL Server 2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.</p>\n<p>Ref:</p>\n<h5 id=\"SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\"><a href=\"#SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\" class=\"headerlink\" title=\"SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 \"></a><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\" target=\"_blank\" rel=\"external\">SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 </a></h5><p><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\" target=\"_blank\" rel=\"external\">Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>On a monthly basis, the HMC test team will conduct a Windows update compatibility test (where the major roll-ups and updates will be tested) on different versions of HMC environment.</p>\n<p>Windows update compatibility tests (<strong>SQL Server 2005 SP3</strong> &amp; <strong>Exchange 2007 SP1 RU6</strong>was included in this test) on HMC 4.0 as well as HMC 4.5 have completed successfully. This means SQL Server 2005 SP3 &amp; Exchange 2007 SP1 RU6 has been validated for both HM 4.0 and HMC 4.5.</p>\n<p>Ref:</p>\n<h5 id=\"SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\"><a href=\"#SQL-Server-2005-SP3-has-been-validated-for-HMC-4-0-and-HMC-4-5\" class=\"headerlink\" title=\"SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 \"></a><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/sql-server-2005-sp3-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\" target=\"_blank\" rel=\"external\">SQL Server 2005 SP3 has been validated for HMC 4.0 and HMC 4.5 </a></h5><p><a href=\"http://blogs.technet.com/provtest/archive/2009/02/23/exchange-2007-sp1-ru6-has-been-validated-for-hmc-4-0-and-hmc-4-5.aspx\" target=\"_blank\" rel=\"external\">Exchange 2007 SP1 RU6 has been validated for HMC 4.0 and HMC 4.5</a></p>\n"},{"title":"The ReportServerVirtualDirectory element is missing","date":"2009-05-29T07:58:37.000Z","_content":"\nInstall SQL Server 2005 on a Windows Server 2008, when use your browser to access http://localhost/reports, you received below error msg:\n> \"_An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing._ \"\n\nAfter doing some search&amp;research, this is the workaround.\n\nLookin the RSWebApplication.config for the\n```xml\n<ReportServerVirtualDirectory>\n```\nIt will look something like this\n```xml\n<ReportServerVirtualDirectory>\n</ReportServerVirtualDirectory>\n```\nchange to\n```xml\n<ReportServerVirtualDirectory>ReportServer</ReportServerVirtualDirectory>\n```","source":"_posts/the-reportservervirtualdirectory-element-is-missing.md","raw":"---\ntitle: The ReportServerVirtualDirectory element is missing\ntags:\n  - Reporting Service\n  - MSSQL\ncategories:\n  - Microsoft\n  - SQL数据库\ndate: 2009-05-29 15:58:37\n---\n\nInstall SQL Server 2005 on a Windows Server 2008, when use your browser to access http://localhost/reports, you received below error msg:\n> \"_An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing._ \"\n\nAfter doing some search&amp;research, this is the workaround.\n\nLookin the RSWebApplication.config for the\n```xml\n<ReportServerVirtualDirectory>\n```\nIt will look something like this\n```xml\n<ReportServerVirtualDirectory>\n</ReportServerVirtualDirectory>\n```\nchange to\n```xml\n<ReportServerVirtualDirectory>ReportServer</ReportServerVirtualDirectory>\n```","slug":"the-reportservervirtualdirectory-element-is-missing","published":1,"updated":"2017-06-16T12:54:32.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0a005j4gyrdlwfazwx","content":"<p>Install SQL Server 2005 on a Windows Server 2008, when use your browser to access <a href=\"http://localhost/reports\" target=\"_blank\" rel=\"external\">http://localhost/reports</a>, you received below error msg:</p>\n<blockquote>\n<p>“<em>An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing.</em> “</p>\n</blockquote>\n<p>After doing some search&amp;research, this is the workaround.</p>\n<p>Lookin the RSWebApplication.config for the<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>It will look something like this<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>change to<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span>ReportServer<span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div></pre></td></tr></table></figure></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Install SQL Server 2005 on a Windows Server 2008, when use your browser to access <a href=\"http://localhost/reports\" target=\"_blank\" rel=\"external\">http://localhost/reports</a>, you received below error msg:</p>\n<blockquote>\n<p>“<em>An error occurred while parsing the configuration file. The ReportServerVirtualDirectory element is missing.</em> “</p>\n</blockquote>\n<p>After doing some search&amp;research, this is the workaround.</p>\n<p>Lookin the RSWebApplication.config for the<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>It will look something like this<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div></pre></td></tr></table></figure></p>\n<p>change to<br><figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span>ReportServer<span class=\"tag\">&lt;/<span class=\"name\">ReportServerVirtualDirectory</span>&gt;</span></div></pre></td></tr></table></figure></p>\n"},{"title":"The specified CGI application encountered an error and the server terminated the process","date":"2013-03-10T04:47:37.000Z","_content":"\n最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误\n\n**The specified CGI application encountered an error and the server terminated the process**\n\n而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。\n\n而今天在访问 Google Analytics 时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！\n\n以下是 Chrome 的 Cookie 清除示例\n![Remove Chrome Cookies](the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg)\n\n在地址栏中输入 **chrome://settings/content** 回车，在 Cookies 下面选择 All cookies and site data... ，在搜索框中输入`microsoft.com` 列出所有 microsoft.com 相关的 cookies，点击 **Remove all** 清除， done 完成！","source":"_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process.md","raw":"---\ntitle: The specified CGI application encountered an error and the server terminated the process\ntags:\n  - Chrome\n  - Cookie\n  - Microsoft\n  - MSDN\ncategories:\n  - Microsoft\ndate: 2013-03-10 12:47:37\n---\n\n最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误\n\n**The specified CGI application encountered an error and the server terminated the process**\n\n而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。\n\n而今天在访问 Google Analytics 时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！\n\n以下是 Chrome 的 Cookie 清除示例\n![Remove Chrome Cookies](the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg)\n\n在地址栏中输入 **chrome://settings/content** 回车，在 Cookies 下面选择 All cookies and site data... ，在搜索框中输入`microsoft.com` 列出所有 microsoft.com 相关的 cookies，点击 **Remove all** 清除， done 完成！","slug":"the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process","published":1,"updated":"2017-06-16T12:54:52.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0c005n4gyr87oby5ya","content":"<p>最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误</p>\n<p><strong>The specified CGI application encountered an error and the server terminated the process</strong></p>\n<p>而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。</p>\n<p>而今天在访问 Google Analytics 时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！</p>\n<p>以下是 Chrome 的 Cookie 清除示例<br><img src=\"/2013/03/10/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg\" alt=\"Remove Chrome Cookies\"></p>\n<p>在地址栏中输入 <strong>chrome://settings/content</strong> 回车，在 Cookies 下面选择 All cookies and site data… ，在搜索框中输入<code>microsoft.com</code> 列出所有 microsoft.com 相关的 cookies，点击 <strong>Remove all</strong> 清除， done 完成！</p>\n","site":{"data":{}},"excerpt":"","more":"<p>最近老是发现用 Google Chrome 访问微软的 MSDN 或者 Technet 站点时，网页打不开，会显示以下错误</p>\n<p><strong>The specified CGI application encountered an error and the server terminated the process</strong></p>\n<p>而用IE访问则正常，一开始以为是 Google Chrome 的 版本问题，结果升级了 Chrome 的版本也没有用。</p>\n<p>而今天在访问 Google Analytics 时，提示 Cookie Mismatch，清空相关的 Cookie 后，Google Analytics恢复正常，于是突然想到会不会也是由于 Cookie 的问题影响了微软相关站点的访问，清除 microsoft.com 的所有相关 Cookies 后，technet 和 MSDN 站点顺利在 Chrome 中打开！</p>\n<p>以下是 Chrome 的 Cookie 清除示例<br><img src=\"/2013/03/10/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg\" alt=\"Remove Chrome Cookies\"></p>\n<p>在地址栏中输入 <strong>chrome://settings/content</strong> 回车，在 Cookies 下面选择 All cookies and site data… ，在搜索框中输入<code>microsoft.com</code> 列出所有 microsoft.com 相关的 cookies，点击 <strong>Remove all</strong> 清除， done 完成！</p>\n"},{"title":"Unofficial Consolidated Server Deployment Guide For HMC4.0","date":"2007-06-05T04:26:06.000Z","_content":"\n这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。\n\nPDF文档下载 {% asset_link HMC4.0_CDG_Draft.pdf Unofficial Consolidated Server Deployment Guide %}\n\nServer Names:\n\n* AD01 :    Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* FE01:     Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n\n* ExCAS01:  Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* ExMBX01:  Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* ISA01:    Windows Server 2003, Standard Edition SP2 with R2, 32-bit\n\n* ExEdge01: Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* MPSSQL01: Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n","source":"_posts/unofficial-consolidated-server-deployment-guide-for-hmc4.md","raw":"---\ntitle: Unofficial Consolidated Server Deployment Guide For HMC4.0\ntags:\n  - HMC\ncategories:\n  - Microsoft\n  - HMC\ndate: 2007-06-05 12:26:06\n---\n\n这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。\n\nPDF文档下载 {% asset_link HMC4.0_CDG_Draft.pdf Unofficial Consolidated Server Deployment Guide %}\n\nServer Names:\n\n* AD01 :    Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* FE01:     Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n\n* ExCAS01:  Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* ExMBX01:  Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit\n\n* ISA01:    Windows Server 2003, Standard Edition SP2 with R2, 32-bit\n\n* ExEdge01: Windows Server 2003,  Standard Edition SP2 with R2, 64-bit\n\n* MPSSQL01: Windows Server 2003, Standard Edition SP1 with R2, 32-bit\n","slug":"unofficial-consolidated-server-deployment-guide-for-hmc4","published":1,"updated":"2017-06-21T06:36:12.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0d005q4gyru6ulnl2v","content":"<p>这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。</p>\n<p>PDF文档下载 <a href=\"/2007/06/05/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf\" title=\"Unofficial Consolidated Server Deployment Guide\">Unofficial Consolidated Server Deployment Guide</a></p>\n<p>Server Names:</p>\n<ul>\n<li><p>AD01 :    Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>FE01:     Windows Server 2003, Standard Edition SP1 with R2, 32-bit</p>\n</li>\n<li><p>ExCAS01:  Windows Server 2003,  Standard Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ExMBX01:  Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ISA01:    Windows Server 2003, Standard Edition SP2 with R2, 32-bit</p>\n</li>\n<li><p>ExEdge01: Windows Server 2003,  Standard Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>MPSSQL01: Windows Server 2003, Standard Edition SP1 with R2, 32-bit</p>\n</li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<p>这是多年前写的 HMC4.0 的部署文档，权且放在这里做个纪念。</p>\n<p>PDF文档下载 <a href=\"/2007/06/05/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf\" title=\"Unofficial Consolidated Server Deployment Guide\">Unofficial Consolidated Server Deployment Guide</a></p>\n<p>Server Names:</p>\n<ul>\n<li><p>AD01 :    Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>FE01:     Windows Server 2003, Standard Edition SP1 with R2, 32-bit</p>\n</li>\n<li><p>ExCAS01:  Windows Server 2003,  Standard Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ExMBX01:  Windows Server 2003, Enterprise Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>ISA01:    Windows Server 2003, Standard Edition SP2 with R2, 32-bit</p>\n</li>\n<li><p>ExEdge01: Windows Server 2003,  Standard Edition SP2 with R2, 64-bit</p>\n</li>\n<li><p>MPSSQL01: Windows Server 2003, Standard Edition SP1 with R2, 32-bit</p>\n</li>\n</ul>\n"},{"title":"升级到 Exchange 2010 SP1 后出现的2个小问题","date":"2010-09-12T03:46:31.000Z","_content":"\n今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：\n\n1.  OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误\n2.  某台 Exchange 打开 EMS 时报错如下：\n\n```\n[server.mydomain.local] Connecting to remote server failed with the following error message :\nThe client cannot connect to the destination specified in the request. Verify that the\nservice on the destination is running and is accepting requests. Consult the logs and\ndocumentation for the WS-Management service running on the destination, most commonly IIS\nor WinRM. If the destination is the WinRM service, run the following command on the\ndestination to analyze and configure the WinRM service: \"winrm quickconfig\". For more\ninformation, see the about_Remote_Troubleshooting Help topic.\n+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException\n+ FullyQualifiedErrorId : PSSessionOpenFailed\n```\n1. 这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 \"Require SSL\" 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。\n\n2. 这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。","source":"_posts/upgrade-to-exchange-2010-sp1-issues.md","raw":"---\ntitle: 升级到 Exchange 2010 SP1 后出现的2个小问题\ntags:\n  - Exchange\n  - PowerShell\ncategories:\n  - Exchange\ndate: 2010-09-12 11:46:31\n---\n\n今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：\n\n1.  OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误\n2.  某台 Exchange 打开 EMS 时报错如下：\n\n```\n[server.mydomain.local] Connecting to remote server failed with the following error message :\nThe client cannot connect to the destination specified in the request. Verify that the\nservice on the destination is running and is accepting requests. Consult the logs and\ndocumentation for the WS-Management service running on the destination, most commonly IIS\nor WinRM. If the destination is the WinRM service, run the following command on the\ndestination to analyze and configure the WinRM service: \"winrm quickconfig\". For more\ninformation, see the about_Remote_Troubleshooting Help topic.\n+ CategoryInfo : OpenError: (System.Manageme....RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException\n+ FullyQualifiedErrorId : PSSessionOpenFailed\n```\n1. 这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 \"Require SSL\" 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。\n\n2. 这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。","slug":"upgrade-to-exchange-2010-sp1-issues","published":1,"updated":"2017-06-16T12:55:14.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0f005v4gyrtq7ipcw2","content":"<p>今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：</p>\n<ol>\n<li>OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误</li>\n<li>某台 Exchange 打开 EMS 时报错如下：</li>\n</ol>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[server.mydomain.local] Connecting <span class=\"keyword\">to</span> remote<span class=\"built_in\"> server </span>failed with the following <span class=\"builtin-name\">error</span> message :</div><div class=\"line\">The<span class=\"built_in\"> client </span>cannot connect <span class=\"keyword\">to</span> the destination specified <span class=\"keyword\">in</span> the request. Verify that the</div><div class=\"line\">service on the destination is running <span class=\"keyword\">and</span> is accepting requests. Consult the logs <span class=\"keyword\">and</span></div><div class=\"line\">documentation <span class=\"keyword\">for</span> the WS-Management<span class=\"built_in\"> service </span>running on the destination, most commonly IIS</div><div class=\"line\"><span class=\"keyword\">or</span> WinRM. <span class=\"keyword\">If</span> the destination is the WinRM service, <span class=\"builtin-name\">run</span> the following command on the</div><div class=\"line\">destination <span class=\"keyword\">to</span> analyze <span class=\"keyword\">and</span> configure the WinRM service: <span class=\"string\">\"winrm quickconfig\"</span>. <span class=\"keyword\">For</span> more</div><div class=\"line\">information, see the about_Remote_Troubleshooting Help topic.</div><div class=\"line\">+ CategoryInfo : OpenError: (System.Manageme<span class=\"built_in\">..</span><span class=\"built_in\">..</span>RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException</div><div class=\"line\">+ FullyQualifiedErrorId : PSSessionOpenFailed</div></pre></td></tr></table></figure>\n<ol>\n<li><p>这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 “Require SSL” 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。</p>\n</li>\n<li><p>这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。</p>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>今天有空把所有的 Exchange 服务器从 2010 RTM 升级到了 2010 SP1 了， 升级完了后发现了2个小问题：</p>\n<ol>\n<li>OWA打开正常，但是点到 ECP 的时候报 403 访问拒绝错误</li>\n<li>某台 Exchange 打开 EMS 时报错如下：</li>\n</ol>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div></pre></td><td class=\"code\"><pre><div class=\"line\">[server.mydomain.local] Connecting <span class=\"keyword\">to</span> remote<span class=\"built_in\"> server </span>failed with the following <span class=\"builtin-name\">error</span> message :</div><div class=\"line\">The<span class=\"built_in\"> client </span>cannot connect <span class=\"keyword\">to</span> the destination specified <span class=\"keyword\">in</span> the request. Verify that the</div><div class=\"line\">service on the destination is running <span class=\"keyword\">and</span> is accepting requests. Consult the logs <span class=\"keyword\">and</span></div><div class=\"line\">documentation <span class=\"keyword\">for</span> the WS-Management<span class=\"built_in\"> service </span>running on the destination, most commonly IIS</div><div class=\"line\"><span class=\"keyword\">or</span> WinRM. <span class=\"keyword\">If</span> the destination is the WinRM service, <span class=\"builtin-name\">run</span> the following command on the</div><div class=\"line\">destination <span class=\"keyword\">to</span> analyze <span class=\"keyword\">and</span> configure the WinRM service: <span class=\"string\">\"winrm quickconfig\"</span>. <span class=\"keyword\">For</span> more</div><div class=\"line\">information, see the about_Remote_Troubleshooting Help topic.</div><div class=\"line\">+ CategoryInfo : OpenError: (System.Manageme<span class=\"built_in\">..</span><span class=\"built_in\">..</span>RemoteRunspace:RemoteRunspace) [], PSRemotingTransportException</div><div class=\"line\">+ FullyQualifiedErrorId : PSSessionOpenFailed</div></pre></td></tr></table></figure>\n<ol>\n<li><p>这个错误在经过仔细排查后发现， 取消在 IIS 虚拟目录里面ecp的 “Require SSL” 就可以了，原来是之前为了做 SSL Offloading，把这个SSL的要求取消了，但是 Exchange 2010 SP1的安装程序在升级的时候又给加上去了，所以就报错了。</p>\n</li>\n<li><p>这个错误在网上查了好久，都没发现有用的答案，包括重装 WinRM IIS 扩展，重新配置 PowerShell 虚拟目录，运行 WinRm QuickConfig 等等，都没有用，最后发现问题还是出在IIS上面，Default Web Site 一开始给禁用了，而且默认的端口也从80改到了8080，EMS在打开的时候需要访问 Default Web Site 下面 PowerShell 的虚拟目录，找不到，报错，改回去80，错误解决。</p>\n</li>\n</ol>\n"},{"title":"Virtual Server Undo Disks - I am never going to use you again (Can't Merge Disks - Parent Disk is a part of a Saved State)","date":"2009-05-07T09:10:48.000Z","_content":"\n在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:\n\n**\"Virtual Server was unable to commit the changes made during the current session of \"_[VPC NAME]_\". The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.\"**\n\n<!--more-->\n\n解决方法如下:\n\nIf you search google for this, you come up with almost nothing.  But there's a [critical post right here](http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2) about it.  It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn't understand the concept of \"inspecting\" a virtual disk.\n\nThe basic steps are:\n\n1.  Rename the undo disks to *.vhd.  This turns them into a virtual drive in the eyes of Virtual Server.\n2.  Click on the Inspect option in the Virtual Disk section of Virtual Server.  There should be an option to then merge the disk.\n3.  Select a new disk to merge into.  If you try merging into the original parent, Virtual Server will just give you the above error again.\n4.  Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn't be merged to before).","source":"_posts/virtual-server-undo-disks-merge-parent-disk-part-of-saved-state.md","raw":"---\ntitle: Virtual Server Undo Disks - I am never going to use you again (Can't Merge Disks - Parent Disk is a part of a Saved State)\ntags:\n  - Virtual Server\n  - Microsoft\ncategories:\n  - 虚拟化\ndate: 2009-05-07 17:10:48\n---\n\n在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:\n\n**\"Virtual Server was unable to commit the changes made during the current session of \"_[VPC NAME]_\". The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.\"**\n\n<!--more-->\n\n解决方法如下:\n\nIf you search google for this, you come up with almost nothing.  But there's a [critical post right here](http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2) about it.  It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn't understand the concept of \"inspecting\" a virtual disk.\n\nThe basic steps are:\n\n1.  Rename the undo disks to *.vhd.  This turns them into a virtual drive in the eyes of Virtual Server.\n2.  Click on the Inspect option in the Virtual Disk section of Virtual Server.  There should be an option to then merge the disk.\n3.  Select a new disk to merge into.  If you try merging into the original parent, Virtual Server will just give you the above error again.\n4.  Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn't be merged to before).","slug":"virtual-server-undo-disks-merge-parent-disk-part-of-saved-state","published":1,"updated":"2017-06-16T12:55:30.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0g005x4gyr4sfg73u3","content":"<p>在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:</p>\n<p><strong>“Virtual Server was unable to commit the changes made during the current session of “<em>[VPC NAME]</em>“. The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.”</strong></p>\n<a id=\"more\"></a>\n<p>解决方法如下:</p>\n<p>If you search google for this, you come up with almost nothing.  But there’s a <a href=\"http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2\" target=\"_blank\" rel=\"external\">critical post right here</a> about it.  It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn’t understand the concept of “inspecting” a virtual disk.</p>\n<p>The basic steps are:</p>\n<ol>\n<li>Rename the undo disks to *.vhd.  This turns them into a virtual drive in the eyes of Virtual Server.</li>\n<li>Click on the Inspect option in the Virtual Disk section of Virtual Server.  There should be an option to then merge the disk.</li>\n<li>Select a new disk to merge into.  If you try merging into the original parent, Virtual Server will just give you the above error again.</li>\n<li>Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn’t be merged to before).</li>\n</ol>\n","site":{"data":{}},"excerpt":"<p>在把 Virtual Server 2005 的虚拟机迁过去 Windows Server 2008 Hyper-V 以后,原来有些虚拟机开了 undo disk 的,发现在 Hyper-V 中没有合并选项,于是又重新安装了 Virtual Server 2005 SP1, 但是合并的时候失败,出错提示如下:</p>\n<p><strong>“Virtual Server was unable to commit the changes made during the current session of “<em>[VPC NAME]</em>“. The cause of this problem is that the parent virtual hard disk is a part of a saved state. Your changes will be kept for the next time you start this virtual machine.”</strong></p>","more":"<p>解决方法如下:</p>\n<p>If you search google for this, you come up with almost nothing.  But there’s a <a href=\"http://groups.google.com/group/microsoft.public.virtualserver/browse_thread/thread/329d9fed504435e1/5aeb3f7c0b2640f2?lnk=st&amp;q=Virtual+Server+was+unable+to+commit+the+changes+made+during+the+current+session+of+.+The+cause+of+this+problem+is+that+the+parent+virtual+hard+disk+is+a+part+of+a+saved+state.+Your+changes+will+be+kept+for+the+next+time+you+start+this+virtual+machine.&amp;rnum=1&amp;hl=en&amp;fwc=2\" target=\"_blank\" rel=\"external\">critical post right here</a> about it.  It spells out exactly what you need to do, but foolishly I ignored it and kept looking for a better solution, since I didn’t understand the concept of “inspecting” a virtual disk.</p>\n<p>The basic steps are:</p>\n<ol>\n<li>Rename the undo disks to *.vhd.  This turns them into a virtual drive in the eyes of Virtual Server.</li>\n<li>Click on the Inspect option in the Virtual Disk section of Virtual Server.  There should be an option to then merge the disk.</li>\n<li>Select a new disk to merge into.  If you try merging into the original parent, Virtual Server will just give you the above error again.</li>\n<li>Take your newly merged virtual disk and replace it in the virtual machine (i.e. replace the parent that was couldn’t be merged to before).</li>\n</ol>"},{"title":"解决VirtualBox在Windows7中无法安装USB驱动等问题","date":"2013-03-19T01:32:50.000Z","_content":"\n操作系统：Windows 7 Professional with SP1 32-bit\n\nVirtualBox：VirtualBox-4.2.10-84105-Win.exe\n\n安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，\n![VirtualBox-Driver-1](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg)\n\n前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。\n\n![VirtualBox-Driver-2](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg)\n\n经过一番摸索，找到了解决之道：\n\n1. 因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；\n2. 决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；\n3. 重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);\n4. 在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；\n5. 开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；\n![VirtualBox-Driver-3](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg)\n\n退出安装程序，再重新跑一遍即可，问题解决。","source":"_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7.md","raw":"---\ntitle: 解决VirtualBox在Windows7中无法安装USB驱动等问题\ntags:\n  - VirtualBox\ncategories:\n  - 虚拟化\ndate: 2013-03-19 09:32:50\n---\n\n操作系统：Windows 7 Professional with SP1 32-bit\n\nVirtualBox：VirtualBox-4.2.10-84105-Win.exe\n\n安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，\n![VirtualBox-Driver-1](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg)\n\n前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。\n\n![VirtualBox-Driver-2](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg)\n\n经过一番摸索，找到了解决之道：\n\n1. 因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；\n2. 决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；\n3. 重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);\n4. 在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；\n5. 开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；\n![VirtualBox-Driver-3](workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg)\n\n退出安装程序，再重新跑一遍即可，问题解决。","slug":"workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7","published":1,"updated":"2017-06-16T12:55:40.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cj6eh5k0h00624gyr0rlhetan","content":"<p>操作系统：Windows 7 Professional with SP1 32-bit</p>\n<p>VirtualBox：VirtualBox-4.2.10-84105-Win.exe</p>\n<p>安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，<br><img src=\"/2013/03/19/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg\" alt=\"VirtualBox-Driver-1\"></p>\n<p>前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。</p>\n<p><img src=\"/2013/03/19/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg\" alt=\"VirtualBox-Driver-2\"></p>\n<p>经过一番摸索，找到了解决之道：</p>\n<ol>\n<li>因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；</li>\n<li>决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；</li>\n<li>重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);</li>\n<li>在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；</li>\n<li>开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；<br><img src=\"/2013/03/19/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg\" alt=\"VirtualBox-Driver-3\"></li>\n</ol>\n<p>退出安装程序，再重新跑一遍即可，问题解决。</p>\n","site":{"data":{}},"excerpt":"","more":"<p>操作系统：Windows 7 Professional with SP1 32-bit</p>\n<p>VirtualBox：VirtualBox-4.2.10-84105-Win.exe</p>\n<p>安装的时候选择默认设置，VirtualBox USB Support 和 VirtualBox Networking 都选了，<br><img src=\"/2013/03/19/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg\" alt=\"VirtualBox-Driver-1\"></p>\n<p>前面一切正常，到安装虚拟 USB 和网卡驱动的时候，跳出来这个窗口提示驱动程序证书未受信任，需要确认是否继续安装，可是到想去点 Install 安装的时候，却发现变成了 Not Responding 无法响应状态，安装过程无法继续，只好关掉驱动安装窗口退出。试过更换 VirtualBox 的版本，症状依旧。</p>\n<p><img src=\"/2013/03/19/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg\" alt=\"VirtualBox-Driver-2\"></p>\n<p>经过一番摸索，找到了解决之道：</p>\n<ol>\n<li>因为是卡在不受信任的驱动安装步骤，所以要想办法把这个驱动变成受信任的；</li>\n<li>决定是否受信实际上是看改驱动的证书是否在机器的受信颁发机构里面 (Trusted Publisher)；</li>\n<li>重新运行 VirtualBox-4.2.10-84105-Win.exe，直到跳出驱动安装提示，不理，打开我的电脑，找到 VirtualBox 的安装目录下的 drivers 文件夹，双击打开其中 USB\\device\\VBoxUSB.cat 文件，在常规 (General) 标签卡中选择查看签名(View Signature) -&gt; 查看证书 (View Certificate);</li>\n<li>在该证书的详细(Details)标签卡中选择复制到文件 (Copy to File)，导出成 .DER 文件；</li>\n<li>开始，运行 mmc，选择 Certificates -&gt; Computer account，在 Trusted Publisher 中导入刚刚的 .DER 证书文件，确认 Oracle 证书已经导入；<br><img src=\"/2013/03/19/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg\" alt=\"VirtualBox-Driver-3\"></li>\n</ol>\n<p>退出安装程序，再重新跑一遍即可，问题解决。</p>\n"}],"PostAsset":[{"_id":"source/_posts/active-directory-tips-01-extend-password-expiration-date-not-changing-it/ADUser-Properties.jpg","post":"cj6eh5jwv00014gyrnd4p2gwr","slug":"ADUser-Properties.jpg","modified":1,"renderable":1},{"_id":"source/_posts/centos-64-upgrade-to-kernel-3x/config-3.2.21-vmware1.zip","post":"cj6eh5jx300064gyrvsmrg13g","slug":"config-3.2.21-vmware1.zip","modified":1,"renderable":1},{"_id":"source/_posts/fix-java8-install-1603-error/Java8_Error_1603.png","post":"cj6eh5jxc000m4gyr54dtp2l3","slug":"Java8_Error_1603.png","modified":1,"renderable":1},{"_id":"source/_posts/fixing-piix4-host-smbus-controller-not-enabled-error-for-centos-on-vmware/piix4_smbus_not_enabled.jpg","post":"cj6eh5jxh000w4gyra00n0suk","slug":"piix4_smbus_not_enabled.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-build-geoip-database-from-maxmind-csv-format/Change_Countrycount.jpg","post":"cj6eh5jyf002i4gyrs7q2lfqv","slug":"Change_Countrycount.jpg","modified":1,"renderable":1},{"_id":"source/_posts/the-specified-cgi-application-encountered-an-error-and-the-server-terminated-the-process/Remove-Chrome-Cookies.jpg","post":"cj6eh5k0c005n4gyr87oby5ya","slug":"Remove-Chrome-Cookies.jpg","modified":1,"renderable":1},{"_id":"source/_posts/unofficial-consolidated-server-deployment-guide-for-hmc4/HMC4.0_CDG_Draft.pdf","slug":"HMC4.0_CDG_Draft.pdf","post":"cj6eh5k0d005q4gyru6ulnl2v","modified":1,"renderable":0},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today.jpg","post":"cj6eh5jz6003u4gyrlbyafk1q","slug":"Outlook_Today.jpg","modified":1,"renderable":1},{"_id":"source/_posts/kb289949-items-place-outlook-today-seem-lost/Outlook_Today_HomePage.jpg","post":"cj6eh5jz6003u4gyrlbyafk1q","slug":"Outlook_Today_HomePage.jpg","modified":1,"renderable":1},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/AdvancedSecurity-Setting.jpg","post":"cj6eh5jx9000f4gyrkqeit3rh","slug":"AdvancedSecurity-Setting.jpg","modified":1,"renderable":1},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/EventID-1053.jpg","post":"cj6eh5jx9000f4gyrkqeit3rh","slug":"EventID-1053.jpg","modified":1,"renderable":1},{"_id":"source/_posts/exchange-activesync-returned-an-http-500-response/FolderSync-Failed.jpg","post":"cj6eh5jx9000f4gyrkqeit3rh","slug":"FolderSync-Failed.jpg","modified":1,"renderable":1},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-Btree.jpg","post":"cj6eh5jxa000h4gyr6gmbkx3x","slug":"Exchange-2010-Btree.jpg","modified":1,"renderable":1},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange-2010-JRS-Files.jpg","post":"cj6eh5jxa000h4gyr6gmbkx3x","slug":"Exchange-2010-JRS-Files.jpg","modified":1,"renderable":1},{"_id":"source/_posts/exchange-log-part1-basic-knowledge/Exchange_2010_Storage.jpg","post":"cj6eh5jxa000h4gyr6gmbkx3x","slug":"Exchange_2010_Storage.jpg","modified":1,"renderable":1},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/EventID-1004.jpg","post":"cj6eh5jxg000t4gyrv3of0uev","slug":"EventID-1004.jpg","modified":1,"renderable":1},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Permissions-aw.jpg","post":"cj6eh5jxg000t4gyrv3of0uev","slug":"Permissions-aw.jpg","modified":1,"renderable":1},{"_id":"source/_posts/fixed-please-wait-windows-configures-microsoft-office-professional-plus-2010/Windows-configures-microsoft-office.jpg","post":"cj6eh5jxg000t4gyrv3of0uev","slug":"Windows-configures-microsoft-office.jpg","modified":1,"renderable":1},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/EventID-7016.jpg","post":"cj6eh5jz5003r4gyrkvevvyw0","slug":"EventID-7016.jpg","modified":1,"renderable":1},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPO-IE-Zone-Assignments.jpg","post":"cj6eh5jz5003r4gyrkvevvyw0","slug":"GPO-IE-Zone-Assignments.jpg","modified":1,"renderable":1},{"_id":"source/_posts/internet-explorer-zonemapping-failed-due-to-the-data-is-invalid-event-id-7016/GPReport.jpg","post":"cj6eh5jz5003r4gyrkvevvyw0","slug":"GPReport.jpg","modified":1,"renderable":1},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-1.jpg","post":"cj6eh5k0h00624gyr0rlhetan","slug":"VirtualBox-Driver-1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-2.jpg","post":"cj6eh5k0h00624gyr0rlhetan","slug":"VirtualBox-Driver-2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/workaround-to-resolve-cant-install-virtualbox-usb-driver-in-windows7/VirtualBox-Driver-3.jpg","post":"cj6eh5k0h00624gyr0rlhetan","slug":"VirtualBox-Driver-3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_1.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_2.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_3.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_4.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_5.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_6.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_7.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_8.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-remember-your-oc-and-outlook-password/ol_step_9.jpg","post":"cj6eh5jyp002y4gyrhe7dhcgq","slug":"ol_step_9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-1.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-10.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-10.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-11.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-11.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-12.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-12.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-13.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-13.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-14.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-14.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-2.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-3.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-4.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-5.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-6.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-7.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-8.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-use-url-rewrite-to-redirect-http-to-https-on-iis7/url-rewrite-9.jpg","post":"cj6eh5jyt003a4gyr557pmw33","slug":"url-rewrite-9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_1.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_10.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_10.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_11.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_11.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_12.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_12.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_13.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_13.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_14.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_14.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_15.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_15.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_16.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_16.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_17.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_17.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_18.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_18.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_2.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_3.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_4.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_5.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_6.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_7.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_8.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/how-to-configure-ocsr2-xmpp-to-gmail/Fig_9.jpg","post":"cj6eh5jyj002l4gyry5kp4bvw","slug":"Fig_9.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_0.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_0.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_1.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_1.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_10.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_10.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_11.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_11.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_12.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_12.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_13.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_13.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_14.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_14.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_15.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_15.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_16.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_16.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_17.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_17.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_18.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_18.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_19.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_19.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_2.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_2.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_20.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_20.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_3.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_4.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_4.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_5.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_5.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_6.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_6.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_7.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_7.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_8.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_8.jpg","modified":1,"renderable":1},{"_id":"source/_posts/mscrm-2011-beta-installation/CRM2011_9.jpg","post":"cj6eh5jzj004f4gyraptgzny1","slug":"CRM2011_9.jpg","modified":1,"renderable":1}],"PostCategory":[{"post_id":"cj6eh5jwz00034gyr2z9orjwe","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5jxb000i4gyra80pb02f"},{"post_id":"cj6eh5jx300064gyrvsmrg13g","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5jxe000o4gyrq5k2i0pt"},{"post_id":"cj6eh5jxc000m4gyr54dtp2l3","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxg000s4gyrj1ublqv8"},{"post_id":"cj6eh5jx400074gyrfehelqun","category_id":"cj6eh5jxb000k4gyr14cimqcr","_id":"cj6eh5jxh000u4gyr7dd9zhj5"},{"post_id":"cj6eh5jxf000r4gyr6lkh6l62","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxi000y4gyr0vkg8g5c"},{"post_id":"cj6eh5jwv00014gyrnd4p2gwr","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxk00104gyr12kae4th"},{"post_id":"cj6eh5jwv00014gyrnd4p2gwr","category_id":"cj6eh5jxe000p4gyr6sbh6dbt","_id":"cj6eh5jxm00144gyr9tinsgkw"},{"post_id":"cj6eh5jxh000w4gyra00n0suk","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5jxn00174gyr6jf91y10"},{"post_id":"cj6eh5jx500084gyr2ypc89bc","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxp001c4gyranr1a8gb"},{"post_id":"cj6eh5jx500084gyr2ypc89bc","category_id":"cj6eh5jxh000v4gyrrx4mu480","_id":"cj6eh5jxq001f4gyrcxs2kx14"},{"post_id":"cj6eh5jx6000b4gyr6nuipmr1","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxr001j4gyrugpkpgom"},{"post_id":"cj6eh5jx6000b4gyr6nuipmr1","category_id":"cj6eh5jxl00124gyrawgeq8k3","_id":"cj6eh5jxt001m4gyr6dz76mzn"},{"post_id":"cj6eh5jx7000c4gyryv2yuw6k","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jxu001p4gyr7899iui4"},{"post_id":"cj6eh5jx7000c4gyryv2yuw6k","category_id":"cj6eh5jxl00124gyrawgeq8k3","_id":"cj6eh5jxv001s4gyr6i28hi66"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jy2001w4gyrvts7xpij"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","category_id":"cj6eh5jxl00124gyrawgeq8k3","_id":"cj6eh5jy800204gyr0sq50q3j"},{"post_id":"cj6eh5jxa000h4gyr6gmbkx3x","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jy900244gyri59502q7"},{"post_id":"cj6eh5jxa000h4gyr6gmbkx3x","category_id":"cj6eh5jxl00124gyrawgeq8k3","_id":"cj6eh5jya00284gyrplicfpgz"},{"post_id":"cj6eh5jxd000n4gyrd99k0t31","category_id":"cj6eh5jy2001v4gyrfo6xbx1o","_id":"cj6eh5jyc002b4gyrvzswiv5u"},{"post_id":"cj6eh5jxg000t4gyrv3of0uev","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jye002f4gyry4dzmsle"},{"post_id":"cj6eh5jxg000t4gyrv3of0uev","category_id":"cj6eh5jxh000v4gyrrx4mu480","_id":"cj6eh5jyi002j4gyrxukxfofb"},{"post_id":"cj6eh5jyc002c4gyrjhbojl7u","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jyk002n4gyrx17xul0z"},{"post_id":"cj6eh5jyc002c4gyrjhbojl7u","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jym002q4gyrob5smqq0"},{"post_id":"cj6eh5jxi000z4gyr6at0yxn3","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jyn002s4gyrrk2g6q7t"},{"post_id":"cj6eh5jxi000z4gyr6at0yxn3","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jyo002x4gyrq052vyu4"},{"post_id":"cj6eh5jyd002e4gyrvegq9ggw","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jyq002z4gyr1yfab46r"},{"post_id":"cj6eh5jyd002e4gyrvegq9ggw","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jyr00334gyr122683iy"},{"post_id":"cj6eh5jyf002i4gyrs7q2lfqv","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5jys00364gyr8fik41gm"},{"post_id":"cj6eh5jxk00114gyrxu170g0u","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jyu003b4gyrvps20016"},{"post_id":"cj6eh5jxk00114gyrxu170g0u","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jyx003e4gyrqgq84bhf"},{"post_id":"cj6eh5jyl002p4gyrlsh7kv0a","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5jz2003i4gyregh1dl7g"},{"post_id":"cj6eh5jxm00154gyrrspifbik","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jz3003l4gyrew70lm4e"},{"post_id":"cj6eh5jxm00154gyrrspifbik","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jz5003q4gyrz1m80jwz"},{"post_id":"cj6eh5jxn00184gyrykd7d1tl","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jz6003s4gyreo2bmd69"},{"post_id":"cj6eh5jxn00184gyrykd7d1tl","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jz7003v4gyr2ylx6m13"},{"post_id":"cj6eh5jyq00324gyrnacjtfbx","category_id":"cj6eh5jy2001v4gyrfo6xbx1o","_id":"cj6eh5jza003y4gyrv1kxst3w"},{"post_id":"cj6eh5jxp001d4gyrr2ylh31c","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jzc00414gyrxbm62yj1"},{"post_id":"cj6eh5jxp001d4gyrr2ylh31c","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jzf00444gyrdle9pkb1"},{"post_id":"cj6eh5jys00354gyr2fhcgpnr","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jzg00474gyrhiwtr9o8"},{"post_id":"cj6eh5jys00354gyr2fhcgpnr","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jzh004a4gyrliuuiys3"},{"post_id":"cj6eh5jyt003a4gyr557pmw33","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jzj004d4gyreia5jyey"},{"post_id":"cj6eh5jxq001g4gyra1ux0f4z","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jzk004g4gyr21by0p0w"},{"post_id":"cj6eh5jxq001g4gyra1ux0f4z","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5jzm004k4gyrsb2toxpi"},{"post_id":"cj6eh5jyy003h4gyr8h9w0uds","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5jzu004o4gyrfdeqp0i4"},{"post_id":"cj6eh5jxs001l4gyrspj8dxa9","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5jzw004s4gyrm1nzqvfe"},{"post_id":"cj6eh5jxs001l4gyrspj8dxa9","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k02004w4gyrivdhu0mr"},{"post_id":"cj6eh5jz4003o4gyrj0emejek","category_id":"cj6eh5jx500094gyrk3b9n38q","_id":"cj6eh5k0400504gyr7fzea0az"},{"post_id":"cj6eh5jxt001n4gyruleef59i","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0500534gyrhg32qdyz"},{"post_id":"cj6eh5jxt001n4gyruleef59i","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0600584gyrcazor44v"},{"post_id":"cj6eh5jz5003r4gyrkvevvyw0","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k07005a4gyry6lnyz5d"},{"post_id":"cj6eh5jz6003u4gyrlbyafk1q","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k08005e4gyrkf2gi7we"},{"post_id":"cj6eh5jz6003u4gyrlbyafk1q","category_id":"cj6eh5jxh000v4gyrrx4mu480","_id":"cj6eh5k09005g4gyr09tsdowh"},{"post_id":"cj6eh5jxu001q4gyrlhnksfnd","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0b005k4gyrr2hvdejy"},{"post_id":"cj6eh5jxu001q4gyrlhnksfnd","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0c005o4gyr45eav8mn"},{"post_id":"cj6eh5jxw001u4gyrt3bdxxx2","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0e005s4gyrowv1ax87"},{"post_id":"cj6eh5jxw001u4gyrt3bdxxx2","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0f005w4gyrnmnhaxow"},{"post_id":"cj6eh5jzc00434gyrvoq1fh3z","category_id":"cj6eh5jy2001v4gyrfo6xbx1o","_id":"cj6eh5k0h005z4gyrudox8wsi"},{"post_id":"cj6eh5jy2001y4gyr189uw56n","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0i00634gyr40398gbw"},{"post_id":"cj6eh5jy2001y4gyr189uw56n","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0j00654gyrss0hi9vy"},{"post_id":"cj6eh5jzi004c4gyr29xczfpc","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0k00684gyr8cpkdszf"},{"post_id":"cj6eh5jzi004c4gyr29xczfpc","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0k00694gyrqlut8k8h"},{"post_id":"cj6eh5jy800224gyrs5zvas0a","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0l006c4gyria3mokqg"},{"post_id":"cj6eh5jy800224gyrs5zvas0a","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0l006d4gyrfjxvpfe8"},{"post_id":"cj6eh5jy900264gyr5p05wzrc","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0m006g4gyrajcimrqs"},{"post_id":"cj6eh5jy900264gyr5p05wzrc","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0m006i4gyr52dgb4n4"},{"post_id":"cj6eh5jyb00294gyrhh781qhy","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0n006m4gyr5dke2tl4"},{"post_id":"cj6eh5jyb00294gyrhh781qhy","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0n006o4gyrxbe2ubuh"},{"post_id":"cj6eh5k03004z4gyrzqga35qb","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0o006r4gyr8ir9qxao"},{"post_id":"cj6eh5k03004z4gyrzqga35qb","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0p006s4gyrvb3f5niy"},{"post_id":"cj6eh5k0400524gyr2p7rwi54","category_id":"cj6eh5k03004y4gyrtopr3iz8","_id":"cj6eh5k0q006v4gyr7hoy4v6u"},{"post_id":"cj6eh5jyj002l4gyry5kp4bvw","category_id":"cj6eh5k03004y4gyrtopr3iz8","_id":"cj6eh5k0q006w4gyrk77t1p8m"},{"post_id":"cj6eh5k0600594gyr7lspuizr","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0r006y4gyr8nr2gj9g"},{"post_id":"cj6eh5k0600594gyr7lspuizr","category_id":"cj6eh5jxe000p4gyr6sbh6dbt","_id":"cj6eh5k0s00714gyrprfloviw"},{"post_id":"cj6eh5jym002r4gyrw51tg3jv","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0s00744gyrj3arjimc"},{"post_id":"cj6eh5jym002r4gyrw51tg3jv","category_id":"cj6eh5k0500574gyrsf0apuwa","_id":"cj6eh5k0t00774gyrgmvamanm"},{"post_id":"cj6eh5k07005c4gyr7efwbnwm","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0u007a4gyr2y3jxjbd"},{"post_id":"cj6eh5k07005c4gyr7efwbnwm","category_id":"cj6eh5jxe000p4gyr6sbh6dbt","_id":"cj6eh5k0u007d4gyrtmskhs7l"},{"post_id":"cj6eh5k08005f4gyr0xorpjjf","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0v007g4gyr78a4ixq0"},{"post_id":"cj6eh5k08005f4gyr0xorpjjf","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0v007i4gyrv0f19dxo"},{"post_id":"cj6eh5jyn002w4gyruwqrstal","category_id":"cj6eh5k08005d4gyrr54ixx8v","_id":"cj6eh5k0w007k4gyrnqymg6f3"},{"post_id":"cj6eh5k0c005n4gyr87oby5ya","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0w007m4gyrtrc9f8dh"},{"post_id":"cj6eh5jyp002y4gyrhe7dhcgq","category_id":"cj6eh5k03004y4gyrtopr3iz8","_id":"cj6eh5k0x007o4gyrx92typt8"},{"post_id":"cj6eh5k0d005q4gyru6ulnl2v","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0y007q4gyr0y2qe8vj"},{"post_id":"cj6eh5k0d005q4gyru6ulnl2v","category_id":"cj6eh5jyc002a4gyr874l68xw","_id":"cj6eh5k0y007s4gyr9rcy0kl4"},{"post_id":"cj6eh5jyv003d4gyrb7fzx7ic","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k0y007v4gyrpur4itnp"},{"post_id":"cj6eh5jyv003d4gyrb7fzx7ic","category_id":"cj6eh5k0e005t4gyrciiubx43","_id":"cj6eh5k0z007x4gyrpfk2lv8k"},{"post_id":"cj6eh5k0g005x4gyr4sfg73u3","category_id":"cj6eh5jy2001v4gyrfo6xbx1o","_id":"cj6eh5k0z007z4gyr4ovrda6j"},{"post_id":"cj6eh5k0h00624gyr0rlhetan","category_id":"cj6eh5jy2001v4gyrfo6xbx1o","_id":"cj6eh5k1000814gyrcsgue9ig"},{"post_id":"cj6eh5jz2003k4gyr4aujqffk","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k1000844gyr8oefn32c"},{"post_id":"cj6eh5jz2003k4gyr4aujqffk","category_id":"cj6eh5k0e005t4gyrciiubx43","_id":"cj6eh5k1000854gyrlevaa3ia"},{"post_id":"cj6eh5jz9003x4gyrg1n6tfof","category_id":"cj6eh5k03004y4gyrtopr3iz8","_id":"cj6eh5k1100874gyrh4lw3vvx"},{"post_id":"cj6eh5jzb00404gyr1z3v2hyf","category_id":"cj6eh5k03004y4gyrtopr3iz8","_id":"cj6eh5k1100894gyra4cfjprz"},{"post_id":"cj6eh5jzf00464gyri4pn9wc2","category_id":"cj6eh5k08005d4gyrr54ixx8v","_id":"cj6eh5k12008c4gyrxjdy7xxl"},{"post_id":"cj6eh5jzh00494gyr7aar1rh9","category_id":"cj6eh5k08005d4gyrr54ixx8v","_id":"cj6eh5k12008d4gyrbasglu6s"},{"post_id":"cj6eh5jzj004f4gyraptgzny1","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k13008f4gyr4fmw8yfy"},{"post_id":"cj6eh5jzj004f4gyraptgzny1","category_id":"cj6eh5k0e005t4gyrciiubx43","_id":"cj6eh5k13008h4gyrhthz2dhh"},{"post_id":"cj6eh5jzl004j4gyrhbkpieup","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k13008k4gyrp7l9k0by"},{"post_id":"cj6eh5jzl004j4gyrhbkpieup","category_id":"cj6eh5k0e005t4gyrciiubx43","_id":"cj6eh5k13008l4gyrof2vv7se"},{"post_id":"cj6eh5jzm004n4gyrhzm8em06","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k14008n4gyraeden4is"},{"post_id":"cj6eh5jzm004n4gyrhzm8em06","category_id":"cj6eh5k0e005t4gyrciiubx43","_id":"cj6eh5k14008p4gyrzt2v6ojq"},{"post_id":"cj6eh5jzv004r4gyrmno42f8p","category_id":"cj6eh5k0s00724gyrgzhbjb2l","_id":"cj6eh5k14008s4gyruo6rk6aa"},{"post_id":"cj6eh5jzw004u4gyrwxdrucna","category_id":"cj6eh5k03004y4gyrtopr3iz8","_id":"cj6eh5k15008t4gyrx56urhr0"},{"post_id":"cj6eh5k0500564gyrfhsb6n1w","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k15008v4gyrat6mv61k"},{"post_id":"cj6eh5k0500564gyrfhsb6n1w","category_id":"cj6eh5k0u007e4gyrfodvh744","_id":"cj6eh5k15008x4gyrt0twk5ed"},{"post_id":"cj6eh5k0a005j4gyrdlwfazwx","category_id":"cj6eh5jx100044gyr6zwomofv","_id":"cj6eh5k1600904gyrvwoeg0b6"},{"post_id":"cj6eh5k0a005j4gyrdlwfazwx","category_id":"cj6eh5k0u007e4gyrfodvh744","_id":"cj6eh5k1600914gyro8j9efux"},{"post_id":"cj6eh5k0f005v4gyrtq7ipcw2","category_id":"cj6eh5k0s00724gyrgzhbjb2l","_id":"cj6eh5k1700934gyr4vsjamhg"}],"PostTag":[{"post_id":"cj6eh5jwv00014gyrnd4p2gwr","tag_id":"cj6eh5jx200054gyrh5gzj9v3","_id":"cj6eh5jxa000g4gyrm47tw8mh"},{"post_id":"cj6eh5jwv00014gyrnd4p2gwr","tag_id":"cj6eh5jx5000a4gyrdyn9bcth","_id":"cj6eh5jxb000j4gyrt78myaqe"},{"post_id":"cj6eh5jwz00034gyr2z9orjwe","tag_id":"cj6eh5jx8000e4gyr1dpqw77z","_id":"cj6eh5jxn00164gyrjmt78mvt"},{"post_id":"cj6eh5jwz00034gyr2z9orjwe","tag_id":"cj6eh5jxc000l4gyrvki1ufgx","_id":"cj6eh5jxo00194gyryl0xrz64"},{"post_id":"cj6eh5jwz00034gyr2z9orjwe","tag_id":"cj6eh5jxf000q4gyr34s0is21","_id":"cj6eh5jxp001e4gyrrx376juc"},{"post_id":"cj6eh5jwz00034gyr2z9orjwe","tag_id":"cj6eh5jxi000x4gyrtl44k3f0","_id":"cj6eh5jxr001h4gyrr5tn299v"},{"post_id":"cj6eh5jx300064gyrvsmrg13g","tag_id":"cj6eh5jxl00134gyrk6lmb04c","_id":"cj6eh5jxv001t4gyrmdb07skg"},{"post_id":"cj6eh5jx300064gyrvsmrg13g","tag_id":"cj6eh5jxo001b4gyr8bxg3w6u","_id":"cj6eh5jy2001x4gyr0u9hnywf"},{"post_id":"cj6eh5jx300064gyrvsmrg13g","tag_id":"cj6eh5jxr001k4gyr3pdhzkfa","_id":"cj6eh5jy800214gyrnyx3tb7n"},{"post_id":"cj6eh5jx400074gyrfehelqun","tag_id":"cj6eh5jxv001r4gyrz5jdqwpz","_id":"cj6eh5jy900254gyri1hec7u8"},{"post_id":"cj6eh5jx500084gyr2ypc89bc","tag_id":"cj6eh5jy7001z4gyr07xktyqn","_id":"cj6eh5jye002g4gyr5tfxxksf"},{"post_id":"cj6eh5jx500084gyr2ypc89bc","tag_id":"cj6eh5jya00274gyr5bpkv3r7","_id":"cj6eh5jyj002k4gyrnznobq57"},{"post_id":"cj6eh5jyl002p4gyrlsh7kv0a","tag_id":"cj6eh5jxl00134gyrk6lmb04c","_id":"cj6eh5jyn002u4gyr7fmr53va"},{"post_id":"cj6eh5jx6000b4gyr6nuipmr1","tag_id":"cj6eh5jyd002d4gyr8i8gbvxn","_id":"cj6eh5jyr00344gyrwhai7vmg"},{"post_id":"cj6eh5jx6000b4gyr6nuipmr1","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5jyt00374gyrajenix5p"},{"post_id":"cj6eh5jx6000b4gyr6nuipmr1","tag_id":"cj6eh5jyn002t4gyruk8c6pgf","_id":"cj6eh5jyu003c4gyrrwexmmr8"},{"post_id":"cj6eh5jx7000c4gyryv2yuw6k","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5jz2003j4gyru3p7ae5x"},{"post_id":"cj6eh5jx7000c4gyryv2yuw6k","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5jz3003m4gyr5krl0afo"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","tag_id":"cj6eh5jyy003g4gyrphdiymxs","_id":"cj6eh5jzk004h4gyrxeu55nd2"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","tag_id":"cj6eh5jz4003p4gyrubgedpxb","_id":"cj6eh5jzm004l4gyrbsgmgvk1"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5jzu004p4gyr94elpdto"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","tag_id":"cj6eh5jzc00424gyrawv1gqb3","_id":"cj6eh5jzw004t4gyrn3fc4o8n"},{"post_id":"cj6eh5jx9000f4gyrkqeit3rh","tag_id":"cj6eh5jzg00484gyre6cvwk5g","_id":"cj6eh5k02004x4gyr1w2i0725"},{"post_id":"cj6eh5jxa000h4gyr6gmbkx3x","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k0400514gyr0hxc0cl3"},{"post_id":"cj6eh5jxa000h4gyr6gmbkx3x","tag_id":"cj6eh5jzm004m4gyrgsn5zwgm","_id":"cj6eh5k0500554gyrrmjnlh6q"},{"post_id":"cj6eh5k07005c4gyr7efwbnwm","tag_id":"cj6eh5jx200054gyrh5gzj9v3","_id":"cj6eh5k0a005h4gyrv68ov3wp"},{"post_id":"cj6eh5jxc000m4gyr54dtp2l3","tag_id":"cj6eh5k02004v4gyrsuugwhp3","_id":"cj6eh5k0b005m4gyrej0nt0cd"},{"post_id":"cj6eh5jxc000m4gyr54dtp2l3","tag_id":"cj6eh5k0500544gyro9kl6mas","_id":"cj6eh5k0d005p4gyrs3ipbmjq"},{"post_id":"cj6eh5jxc000m4gyr54dtp2l3","tag_id":"cj6eh5k07005b4gyreundv9gz","_id":"cj6eh5k0e005u4gyrv5j3n16u"},{"post_id":"cj6eh5jxd000n4gyrd99k0t31","tag_id":"cj6eh5k0a005i4gyr7ksiv8zu","_id":"cj6eh5k0h00614gyriulqs9ez"},{"post_id":"cj6eh5jxd000n4gyrd99k0t31","tag_id":"cj6eh5jxr001k4gyr3pdhzkfa","_id":"cj6eh5k0i00644gyrnt58anf9"},{"post_id":"cj6eh5jxf000r4gyr6lkh6l62","tag_id":"cj6eh5k0g005y4gyrzs2lyrgx","_id":"cj6eh5k0m006h4gyrblvqsz30"},{"post_id":"cj6eh5jxf000r4gyr6lkh6l62","tag_id":"cj6eh5k0j00664gyrsrdj1sg5","_id":"cj6eh5k0m006j4gyru2dtxstx"},{"post_id":"cj6eh5jxf000r4gyr6lkh6l62","tag_id":"cj6eh5k0k006a4gyrq3y9n0ga","_id":"cj6eh5k0n006n4gyret3sb3si"},{"post_id":"cj6eh5jxg000t4gyrv3of0uev","tag_id":"cj6eh5k0j00664gyrsrdj1sg5","_id":"cj6eh5k0s00704gyro283dgpm"},{"post_id":"cj6eh5jxg000t4gyrv3of0uev","tag_id":"cj6eh5k07005b4gyreundv9gz","_id":"cj6eh5k0s00734gyrpx2hsjr6"},{"post_id":"cj6eh5jxg000t4gyrv3of0uev","tag_id":"cj6eh5k0o006q4gyrl7les8au","_id":"cj6eh5k0t00764gyr3zd8l4ff"},{"post_id":"cj6eh5jxg000t4gyrv3of0uev","tag_id":"cj6eh5k0q006u4gyr91d8h5cn","_id":"cj6eh5k0t00794gyrb1etakxi"},{"post_id":"cj6eh5jxh000w4gyra00n0suk","tag_id":"cj6eh5jxl00134gyrk6lmb04c","_id":"cj6eh5k0u007c4gyr3ctjzvx8"},{"post_id":"cj6eh5jxh000w4gyra00n0suk","tag_id":"cj6eh5jxr001k4gyr3pdhzkfa","_id":"cj6eh5k0v007f4gyrju8ocjgr"},{"post_id":"cj6eh5jxi000z4gyr6at0yxn3","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k0y007r4gyro7id9o5o"},{"post_id":"cj6eh5jxi000z4gyr6at0yxn3","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k0y007t4gyr9e8rchu1"},{"post_id":"cj6eh5jxi000z4gyr6at0yxn3","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5k0z007w4gyr0vd22azg"},{"post_id":"cj6eh5jxk00114gyrxu170g0u","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k0z00804gyr1xbkj8ls"},{"post_id":"cj6eh5jxk00114gyrxu170g0u","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5k1000824gyr845e2je0"},{"post_id":"cj6eh5jxm00154gyrrspifbik","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k1100884gyrtzdte8d1"},{"post_id":"cj6eh5jxm00154gyrrspifbik","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k11008a4gyrk2t8tr1s"},{"post_id":"cj6eh5jxn00184gyrykd7d1tl","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k13008g4gyrcwrt6eah"},{"post_id":"cj6eh5jxn00184gyrykd7d1tl","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k13008i4gyrq23jk3j0"},{"post_id":"cj6eh5jxp001d4gyrr2ylh31c","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k14008o4gyr7dyo92m2"},{"post_id":"cj6eh5jxp001d4gyrr2ylh31c","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k14008q4gyrluhmaluw"},{"post_id":"cj6eh5jxq001g4gyra1ux0f4z","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k15008w4gyr782hd42x"},{"post_id":"cj6eh5jxq001g4gyra1ux0f4z","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k15008y4gyr9lcy2vef"},{"post_id":"cj6eh5jxs001l4gyrspj8dxa9","tag_id":"cj6eh5k15008u4gyryn1b0n3p","_id":"cj6eh5k1800964gyryagejkki"},{"post_id":"cj6eh5jxs001l4gyrspj8dxa9","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k1800974gyrw2zdlw5h"},{"post_id":"cj6eh5jxs001l4gyrspj8dxa9","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1800994gyr5zg165hx"},{"post_id":"cj6eh5jxs001l4gyrspj8dxa9","tag_id":"cj6eh5k1700944gyrvjnemd6m","_id":"cj6eh5k19009a4gyryladsfl1"},{"post_id":"cj6eh5jxt001n4gyruleef59i","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k19009c4gyr8tvkqwte"},{"post_id":"cj6eh5jxu001q4gyrlhnksfnd","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1a009e4gyr4hu1jfpn"},{"post_id":"cj6eh5jxu001q4gyrlhnksfnd","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5k1a009f4gyrbcgz9ooo"},{"post_id":"cj6eh5jxw001u4gyrt3bdxxx2","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1b009i4gyrmgs0asj7"},{"post_id":"cj6eh5jxw001u4gyrt3bdxxx2","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5k1b009j4gyruql623ty"},{"post_id":"cj6eh5jy2001y4gyr189uw56n","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k1c009n4gyrv8ykgehy"},{"post_id":"cj6eh5jy2001y4gyr189uw56n","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1d009o4gyrcg7bh06r"},{"post_id":"cj6eh5jy2001y4gyr189uw56n","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5k1d009q4gyrvkglzsn2"},{"post_id":"cj6eh5jy800224gyrs5zvas0a","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1d009r4gyrj2e5fzci"},{"post_id":"cj6eh5jy900264gyr5p05wzrc","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1e009u4gyrq5agjx2l"},{"post_id":"cj6eh5jy900264gyr5p05wzrc","tag_id":"cj6eh5jyt00384gyr4hf9slu5","_id":"cj6eh5k1e009v4gyrym5kzhz1"},{"post_id":"cj6eh5jyb00294gyrhh781qhy","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1f009x4gyr0an0jfqf"},{"post_id":"cj6eh5jyc002c4gyrjhbojl7u","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1f009z4gyrhyoqz81n"},{"post_id":"cj6eh5jyd002e4gyrvegq9ggw","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1g00a14gyrydpsxn0b"},{"post_id":"cj6eh5jyf002i4gyrs7q2lfqv","tag_id":"cj6eh5k1g00a04gyr5x6s7mt5","_id":"cj6eh5k1h00a44gyrvlfjjq98"},{"post_id":"cj6eh5jyf002i4gyrs7q2lfqv","tag_id":"cj6eh5k1g00a24gyr3l64j5o7","_id":"cj6eh5k1h00a54gyrbvmjyxkj"},{"post_id":"cj6eh5jyj002l4gyry5kp4bvw","tag_id":"cj6eh5k1g00a34gyrtpv9qwpr","_id":"cj6eh5k1h00a84gyrfwoy7fcg"},{"post_id":"cj6eh5jyj002l4gyry5kp4bvw","tag_id":"cj6eh5k1h00a64gyrk37vzbly","_id":"cj6eh5k1h00a94gyrx9q05z15"},{"post_id":"cj6eh5jym002r4gyrw51tg3jv","tag_id":"cj6eh5k1h00a74gyrt63mjqfe","_id":"cj6eh5k1i00ad4gyrsy9jx89w"},{"post_id":"cj6eh5jym002r4gyrw51tg3jv","tag_id":"cj6eh5k1h00aa4gyrfz9t1opo","_id":"cj6eh5k1i00ae4gyr8awl21wt"},{"post_id":"cj6eh5jym002r4gyrw51tg3jv","tag_id":"cj6eh5k1i00ab4gyr8wn847ux","_id":"cj6eh5k1j00ag4gyrfnde85dl"},{"post_id":"cj6eh5jyn002w4gyruwqrstal","tag_id":"cj6eh5k1i00ac4gyr6k7250vn","_id":"cj6eh5k1j00ah4gyrs90g1vc6"},{"post_id":"cj6eh5jyp002y4gyrhe7dhcgq","tag_id":"cj6eh5k1g00a34gyrtpv9qwpr","_id":"cj6eh5k1o00ak4gyrsar1wkiw"},{"post_id":"cj6eh5jyp002y4gyrhe7dhcgq","tag_id":"cj6eh5k1j00ai4gyrx9769w3t","_id":"cj6eh5k1o00al4gyrz5k67d4e"},{"post_id":"cj6eh5jyq00324gyrnacjtfbx","tag_id":"cj6eh5k1j00aj4gyrrb9wj2v0","_id":"cj6eh5k1p00ao4gyrv0p6i7cq"},{"post_id":"cj6eh5jyq00324gyrnacjtfbx","tag_id":"cj6eh5k1o00am4gyrmfhchc59","_id":"cj6eh5k1q00ap4gyrgxdunt15"},{"post_id":"cj6eh5jys00354gyr2fhcgpnr","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k1q00ar4gyrlo6vnx2k"},{"post_id":"cj6eh5jyt003a4gyr557pmw33","tag_id":"cj6eh5k1q00aq4gyr9dy8yfuk","_id":"cj6eh5k1q00au4gyr2r9uhwwu"},{"post_id":"cj6eh5jyt003a4gyr557pmw33","tag_id":"cj6eh5k1q00as4gyr14x844ss","_id":"cj6eh5k1r00av4gyrd0biua83"},{"post_id":"cj6eh5jyv003d4gyrb7fzx7ic","tag_id":"cj6eh5k1q00at4gyr4fs3bwoz","_id":"cj6eh5k1r00ax4gyr29tyoske"},{"post_id":"cj6eh5jyy003h4gyr8h9w0uds","tag_id":"cj6eh5jxl00134gyrk6lmb04c","_id":"cj6eh5k1s00b04gyrq1m0ive6"},{"post_id":"cj6eh5jyy003h4gyr8h9w0uds","tag_id":"cj6eh5k1r00aw4gyr8ql5ayom","_id":"cj6eh5k1s00b14gyrgnawh3kp"},{"post_id":"cj6eh5jyy003h4gyr8h9w0uds","tag_id":"cj6eh5k1r00ay4gyrr495avql","_id":"cj6eh5k1t00b34gyr20867ueb"},{"post_id":"cj6eh5jyy003h4gyr8h9w0uds","tag_id":"cj6eh5jxf000q4gyr34s0is21","_id":"cj6eh5k1u00b44gyru2fyl8v0"},{"post_id":"cj6eh5jz2003k4gyr4aujqffk","tag_id":"cj6eh5k1q00at4gyr4fs3bwoz","_id":"cj6eh5k1v00b64gyr65cybr6g"},{"post_id":"cj6eh5jz4003o4gyrj0emejek","tag_id":"cj6eh5jxl00134gyrk6lmb04c","_id":"cj6eh5k1v00b74gyrt4c30nlh"},{"post_id":"cj6eh5jz4003o4gyrj0emejek","tag_id":"cj6eh5jxr001k4gyr3pdhzkfa","_id":"cj6eh5k1v00b94gyr1w4m5o1a"},{"post_id":"cj6eh5jz4003o4gyrj0emejek","tag_id":"cj6eh5k1s00b24gyrl2hwkwya","_id":"cj6eh5k1v00ba4gyr8v2bajha"},{"post_id":"cj6eh5jz5003r4gyrkvevvyw0","tag_id":"cj6eh5k1u00b54gyrl26hjcgl","_id":"cj6eh5k2000be4gyrihp7zrrd"},{"post_id":"cj6eh5jz5003r4gyrkvevvyw0","tag_id":"cj6eh5k1v00b84gyrs2oinn36","_id":"cj6eh5k2100bf4gyr3dlm2ky4"},{"post_id":"cj6eh5jz5003r4gyrkvevvyw0","tag_id":"cj6eh5k1v00bb4gyr2p45ifej","_id":"cj6eh5k2100bh4gyrc5thltym"},{"post_id":"cj6eh5jz5003r4gyrkvevvyw0","tag_id":"cj6eh5k1v00bc4gyrx02n6axd","_id":"cj6eh5k2100bi4gyrgbowbndv"},{"post_id":"cj6eh5jz6003u4gyrlbyafk1q","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k2200bk4gyrb4j6z3ds"},{"post_id":"cj6eh5jz6003u4gyrlbyafk1q","tag_id":"cj6eh5k2000bd4gyremwvlovg","_id":"cj6eh5k2200bl4gyrj0jyyx3h"},{"post_id":"cj6eh5jz9003x4gyrg1n6tfof","tag_id":"cj6eh5k1j00ai4gyrx9769w3t","_id":"cj6eh5k2200bn4gyr9wm6t07n"},{"post_id":"cj6eh5jzb00404gyr1z3v2hyf","tag_id":"cj6eh5k2200bj4gyrkxagt0mw","_id":"cj6eh5k2400bq4gyrhrr18wc1"},{"post_id":"cj6eh5jzb00404gyr1z3v2hyf","tag_id":"cj6eh5k2200bm4gyrc3a7yidb","_id":"cj6eh5k2400br4gyrdrtcoyqx"},{"post_id":"cj6eh5jzb00404gyr1z3v2hyf","tag_id":"cj6eh5k1h00a74gyrt63mjqfe","_id":"cj6eh5k2400bt4gyrxigqumwv"},{"post_id":"cj6eh5jzc00434gyrvoq1fh3z","tag_id":"cj6eh5k1h00a74gyrt63mjqfe","_id":"cj6eh5k2500bu4gyrn7plfcc7"},{"post_id":"cj6eh5jzc00434gyrvoq1fh3z","tag_id":"cj6eh5jxr001k4gyr3pdhzkfa","_id":"cj6eh5k2500bw4gyra27ce50d"},{"post_id":"cj6eh5jzf00464gyri4pn9wc2","tag_id":"cj6eh5k2400bs4gyr4v3yk8lc","_id":"cj6eh5k2600by4gyrdfo2h1c4"},{"post_id":"cj6eh5jzf00464gyri4pn9wc2","tag_id":"cj6eh5k1i00ac4gyr6k7250vn","_id":"cj6eh5k2700bz4gyrsysohp5w"},{"post_id":"cj6eh5jzh00494gyr7aar1rh9","tag_id":"cj6eh5k1i00ac4gyr6k7250vn","_id":"cj6eh5k2800c34gyri3ux2a4f"},{"post_id":"cj6eh5jzh00494gyr7aar1rh9","tag_id":"cj6eh5k2700c04gyrb78na35j","_id":"cj6eh5k2800c44gyrvp8yy268"},{"post_id":"cj6eh5jzh00494gyr7aar1rh9","tag_id":"cj6eh5k2700c14gyrdj8lp3ha","_id":"cj6eh5k2900c64gyr9ukr2qwr"},{"post_id":"cj6eh5jzi004c4gyr29xczfpc","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k2900c74gyrgr6fh4hn"},{"post_id":"cj6eh5jzj004f4gyraptgzny1","tag_id":"cj6eh5k1q00at4gyr4fs3bwoz","_id":"cj6eh5k2a00c94gyr3o8xh93l"},{"post_id":"cj6eh5jzl004j4gyrhbkpieup","tag_id":"cj6eh5k1q00at4gyr4fs3bwoz","_id":"cj6eh5k2a00cb4gyrke77vt70"},{"post_id":"cj6eh5jzm004n4gyrhzm8em06","tag_id":"cj6eh5k1q00at4gyr4fs3bwoz","_id":"cj6eh5k2c00ce4gyr2pbqmixq"},{"post_id":"cj6eh5jzm004n4gyrhzm8em06","tag_id":"cj6eh5k2000bd4gyremwvlovg","_id":"cj6eh5k2c00cf4gyrrijov2qg"},{"post_id":"cj6eh5jzv004r4gyrmno42f8p","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k2d00ci4gyr65i1t6vn"},{"post_id":"cj6eh5jzv004r4gyrmno42f8p","tag_id":"cj6eh5k2b00cd4gyrofso99bp","_id":"cj6eh5k2d00cj4gyrzw92sl5l"},{"post_id":"cj6eh5jzv004r4gyrmno42f8p","tag_id":"cj6eh5k1700944gyrvjnemd6m","_id":"cj6eh5k2d00cl4gyru2nvabf7"},{"post_id":"cj6eh5jzw004u4gyrwxdrucna","tag_id":"cj6eh5k2200bm4gyrc3a7yidb","_id":"cj6eh5k2e00cm4gyrfsu9neu7"},{"post_id":"cj6eh5k03004z4gyrzqga35qb","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k2e00co4gyrzekucm3w"},{"post_id":"cj6eh5k0400524gyr2p7rwi54","tag_id":"cj6eh5k2200bm4gyrc3a7yidb","_id":"cj6eh5k2f00cq4gyr27lft3um"},{"post_id":"cj6eh5k0500564gyrfhsb6n1w","tag_id":"cj6eh5k2e00cp4gyrgkslb7y6","_id":"cj6eh5k2f00ct4gyrvmtbxno2"},{"post_id":"cj6eh5k0500564gyrfhsb6n1w","tag_id":"cj6eh5k1h00a74gyrt63mjqfe","_id":"cj6eh5k2g00cu4gyrtx332pix"},{"post_id":"cj6eh5k0600594gyr7lspuizr","tag_id":"cj6eh5k2f00cs4gyrgylvk25o","_id":"cj6eh5k2g00cw4gyre0gpbdxr"},{"post_id":"cj6eh5k0600594gyr7lspuizr","tag_id":"cj6eh5jx200054gyrh5gzj9v3","_id":"cj6eh5k2g00cx4gyrs3vf87sf"},{"post_id":"cj6eh5k08005f4gyr0xorpjjf","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k2i00d04gyr10jbdwuv"},{"post_id":"cj6eh5k08005f4gyr0xorpjjf","tag_id":"cj6eh5k1h00a74gyrt63mjqfe","_id":"cj6eh5k2i00d14gyrpe7b8w28"},{"post_id":"cj6eh5k0a005j4gyrdlwfazwx","tag_id":"cj6eh5k2e00cp4gyrgkslb7y6","_id":"cj6eh5k2p00d44gyrvdwz5q6o"},{"post_id":"cj6eh5k0a005j4gyrdlwfazwx","tag_id":"cj6eh5k1h00a74gyrt63mjqfe","_id":"cj6eh5k2q00d54gyrqwn8okuw"},{"post_id":"cj6eh5k0c005n4gyr87oby5ya","tag_id":"cj6eh5k2i00d34gyr84sibjk4","_id":"cj6eh5k2s00da4gyrr72dd1i2"},{"post_id":"cj6eh5k0c005n4gyr87oby5ya","tag_id":"cj6eh5k2q00d64gyri78l4ifk","_id":"cj6eh5k2s00db4gyrh4jmq0sm"},{"post_id":"cj6eh5k0c005n4gyr87oby5ya","tag_id":"cj6eh5k0j00664gyrsrdj1sg5","_id":"cj6eh5k2s00dd4gyrpskj5ku7"},{"post_id":"cj6eh5k0c005n4gyr87oby5ya","tag_id":"cj6eh5k2r00d84gyrv0l6eimm","_id":"cj6eh5k2s00de4gyr65h7oq2j"},{"post_id":"cj6eh5k0d005q4gyru6ulnl2v","tag_id":"cj6eh5k0v007h4gyr58uznuzz","_id":"cj6eh5k2t00dg4gyr5adwhu4d"},{"post_id":"cj6eh5k0f005v4gyrtq7ipcw2","tag_id":"cj6eh5jyk002m4gyri39l26n2","_id":"cj6eh5k2t00dh4gyr1l5n1gjt"},{"post_id":"cj6eh5k0f005v4gyrtq7ipcw2","tag_id":"cj6eh5k2s00dc4gyrb4ee4ws3","_id":"cj6eh5k2t00dj4gyrzz676ht7"},{"post_id":"cj6eh5k0g005x4gyr4sfg73u3","tag_id":"cj6eh5k2s00df4gyrcrzh10p3","_id":"cj6eh5k2u00dl4gyr3lac8b8a"},{"post_id":"cj6eh5k0g005x4gyr4sfg73u3","tag_id":"cj6eh5k0j00664gyrsrdj1sg5","_id":"cj6eh5k2u00dm4gyrbild010t"},{"post_id":"cj6eh5k0h00624gyr0rlhetan","tag_id":"cj6eh5k2t00dk4gyrsdmbtqfx","_id":"cj6eh5k2u00dn4gyr3z6u033s"}],"Tag":[{"name":"Active Directory","_id":"cj6eh5jx200054gyrh5gzj9v3"},{"name":"Tips","_id":"cj6eh5jx5000a4gyrdyn9bcth"},{"name":"APC","_id":"cj6eh5jx8000e4gyr1dpqw77z"},{"name":"PECL","_id":"cj6eh5jxc000l4gyrvki1ufgx"},{"name":"PHP","_id":"cj6eh5jxf000q4gyr34s0is21"},{"name":"Yum","_id":"cj6eh5jxi000x4gyrtl44k3f0"},{"name":"CentOS","_id":"cj6eh5jxl00134gyrk6lmb04c"},{"name":"Kernel","_id":"cj6eh5jxo001b4gyr8bxg3w6u"},{"name":"VMware","_id":"cj6eh5jxr001k4gyr3pdhzkfa"},{"name":"Vobsub","_id":"cj6eh5jxv001r4gyrz5jdqwpz"},{"name":"DCOM","_id":"cj6eh5jy7001z4gyr07xktyqn"},{"name":"Excel","_id":"cj6eh5jya00274gyr5bpkv3r7"},{"name":"最佳实践","_id":"cj6eh5jyd002d4gyr8i8gbvxn"},{"name":"Exchange","_id":"cj6eh5jyk002m4gyri39l26n2"},{"name":"Kerberos","_id":"cj6eh5jyn002t4gyruk8c6pgf"},{"name":"Rollup","_id":"cj6eh5jyt00384gyr4hf9slu5"},{"name":"Activesync","_id":"cj6eh5jyy003g4gyrphdiymxs"},{"name":"Android","_id":"cj6eh5jz4003p4gyrubgedpxb"},{"name":"Google","_id":"cj6eh5jzc00424gyrawv1gqb3"},{"name":"Nexus","_id":"cj6eh5jzg00484gyre6cvwk5g"},{"name":"日志","_id":"cj6eh5jzm004m4gyrgsn5zwgm"},{"name":"Java","_id":"cj6eh5k02004v4gyrsuugwhp3"},{"name":"JRE","_id":"cj6eh5k0500544gyro9kl6mas"},{"name":"MSI","_id":"cj6eh5k07005b4gyreundv9gz"},{"name":"Virtual Center","_id":"cj6eh5k0a005i4gyr7ksiv8zu"},{"name":"BITS","_id":"cj6eh5k0g005y4gyrzs2lyrgx"},{"name":"Microsoft","_id":"cj6eh5k0j00664gyrsrdj1sg5"},{"name":"WSUS","_id":"cj6eh5k0k006a4gyrq3y9n0ga"},{"name":"Office","_id":"cj6eh5k0o006q4gyrl7les8au"},{"name":"Windows","_id":"cj6eh5k0q006u4gyr91d8h5cn"},{"name":"HMC","_id":"cj6eh5k0v007h4gyr58uznuzz"},{"name":"Autodiscover","_id":"cj6eh5k15008u4gyryn1b0n3p"},{"name":"MultiTenancy","_id":"cj6eh5k1700944gyrvjnemd6m"},{"name":"GeoIP","_id":"cj6eh5k1g00a04gyr5x6s7mt5"},{"name":"MaxMind","_id":"cj6eh5k1g00a24gyr3l64j5o7"},{"name":"XMPP","_id":"cj6eh5k1g00a34gyrtpv9qwpr"},{"name":"Gmail","_id":"cj6eh5k1h00a64gyrk37vzbly"},{"name":"MSSQL","_id":"cj6eh5k1h00a74gyrt63mjqfe"},{"name":"SSRS","_id":"cj6eh5k1h00aa4gyrfz9t1opo"},{"name":"TeraData","_id":"cj6eh5k1i00ab4gyr8wn847ux"},{"name":"WordPress","_id":"cj6eh5k1i00ac4gyr6k7250vn"},{"name":"Communicator","_id":"cj6eh5k1j00ai4gyrx9769w3t"},{"name":"SCVMM","_id":"cj6eh5k1j00aj4gyrrb9wj2v0"},{"name":"VMHost","_id":"cj6eh5k1o00am4gyrmfhchc59"},{"name":"IIS","_id":"cj6eh5k1q00aq4gyr9dy8yfuk"},{"name":"Rewrite","_id":"cj6eh5k1q00as4gyr14x844ss"},{"name":"MSCRM","_id":"cj6eh5k1q00at4gyr4fs3bwoz"},{"name":"Lighttpd","_id":"cj6eh5k1r00aw4gyr8ql5ayom"},{"name":"MySQL","_id":"cj6eh5k1r00ay4gyrr495avql"},{"name":"VMware Tools","_id":"cj6eh5k1s00b24gyrl2hwkwya"},{"name":"Event ID","_id":"cj6eh5k1u00b54gyrl26hjcgl"},{"name":"Group Policy","_id":"cj6eh5k1v00b84gyrs2oinn36"},{"name":"Internet Explorer","_id":"cj6eh5k1v00bb4gyr2p45ifej"},{"name":"Zonemapping","_id":"cj6eh5k1v00bc4gyrx02n6axd"},{"name":"Outlook","_id":"cj6eh5k2000bd4gyremwvlovg"},{"name":"Lync","_id":"cj6eh5k2200bj4gyrkxagt0mw"},{"name":"OCS","_id":"cj6eh5k2200bm4gyrc3a7yidb"},{"name":"Movable Type","_id":"cj6eh5k2400bs4gyr4v3yk8lc"},{"name":"Hexo","_id":"cj6eh5k2700c04gyrb78na35j"},{"name":"GitHub","_id":"cj6eh5k2700c14gyrdj8lp3ha"},{"name":"Hosting","_id":"cj6eh5k2b00cd4gyrofso99bp"},{"name":"Reporting Service","_id":"cj6eh5k2e00cp4gyrgkslb7y6"},{"name":"SPN","_id":"cj6eh5k2f00cs4gyrgylvk25o"},{"name":"Chrome","_id":"cj6eh5k2i00d34gyr84sibjk4"},{"name":"Cookie","_id":"cj6eh5k2q00d64gyri78l4ifk"},{"name":"MSDN","_id":"cj6eh5k2r00d84gyrv0l6eimm"},{"name":"PowerShell","_id":"cj6eh5k2s00dc4gyrb4ee4ws3"},{"name":"Virtual Server","_id":"cj6eh5k2s00df4gyrcrzh10p3"},{"name":"VirtualBox","_id":"cj6eh5k2t00dk4gyrsdmbtqfx"}]}}